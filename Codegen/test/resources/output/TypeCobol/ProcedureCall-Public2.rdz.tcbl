Simplified Codegen for reference only. DO NOT ATTEMPT TO BUILD, DO NOT DEPLOY !
       IDENTIFICATION DIVISION.
       PROGRAM-ID. PGM1.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-370.
       SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
       DATA DIVISION.
       Working-STORAGE SECTION.
       01 TypeCobol-Generated.
           05 TC-Callee pic X(08) value 'CALLEE'.
           05 Callee-Fct-ebb060ea-MyPublicPr pic X(30)
                value 'Fct=ebb060ea-MyPublicProcedure'.
           05 Callee-Fct-ca0ab46c-check pic X(30)
                value 'Fct=ca0ab46c-check'.
           05 Callee-Fct-d0a59141-check2 pic X(30)
                value 'Fct=d0a59141-check2'.
                               

      *01  somedate     TYPE Date.
       01 somedate.
           02 YYYY PIC 9(4).
           02 MM PIC 9(2).
           02 DD PIC 9(2).
                                  
       01  someformat   PIC X(08).
      *01  flag         TYPE Bool.
       01  flag-value PIC X VALUE LOW-VALUE.
           88  flag       VALUE 'T'.
           88  flag-false VALUE 'F'
                           X'00' thru 'S'
                           'U' thru X'FF'.
                                  
       01  realformat   PIC X(08).

       PROCEDURE DIVISION.

      *declare procedure check private
      *   input mydate        TYPE Date
      *  .

      *DECLARE PROCEDURE Pgm1PrivateValidateDateFormat PRIVATE
      *    INPUT mydate        TYPE Date
      *          format        PIC X(08)
      *   OUTPUT okay          TYPE Bool
      *          actual-format PIC X(08).
      *  .

           move someformat to realformat

      * __________________________________________________
      * OK : proper parameter list (TCRFUN_CALL_PUBLIC_ANY_PGM)
      *    CALL Callee::MyPublicProcedure
      *             INPUT      somedate someformat
      *             OUTPUT     flag     realformat
           CALL 'zcallpgm' using TC-Callee
                    Callee-Fct-ebb060ea-MyPublicPr
                                 somedate
                                 someformat
                    by reference flag-value
                                 realformat
           end-call
                                                   
      * OK : proper parameter list (TCRFUN_CALL_PUBLIC_ANY_PGM)
      *    CALL CALLEE::MyPublicProcedure
      *             INPUT      somedate someformat
      *             OUTPUT     flag     realformat
           CALL 'zcallpgm' using TC-Callee
                    Callee-Fct-ebb060ea-MyPublicPr
                                 somedate
                                 someformat
                    by reference flag-value
                                 realformat
           end-call
                                                   
         
      * __________________________________________________
      * OK : proper parameter list (TCRFUN_CALL_PRIVATE_ONLY_SAME_PGM)
      *    CALL Pgm1PrivateValidateDateFormat
      *             INPUT      somedate someformat
      *             OUTPUT     flag     realformat
           CALL 'fde394fb' USING
                                 somedate
                                 someformat
                    by reference flag-value
                                 realformat
           end-call
                                                  
      * __________________________________________________
      * OK : proper parameter list (TCRFUN_CALL_PRIVATE_ONLY_SAME_PGM)
      *    CALL PGM1::Pgm1PrivateValidateDateFormat
      *             INPUT      somedate someformat
      *             OUTPUT     flag     realformat
           CALL 'fde394fb' USING
                                 somedate
                                 someformat
                    by reference flag-value
                                 realformat
           end-call
                                                  


      *OK  call check of PGM1
      *   call check input somedate
          CALL 'a0508f35' USING
                                 somedate
           end-call
                                   
      *OK 
      *   call PGM1::check input somedate
          CALL 'a0508f35' USING
                                 somedate
           end-call
                                         
      *OK 
      *   call Callee::check input somedate
          CALL 'zcallpgm' using TC-Callee
                    Callee-Fct-ca0ab46c-check
                                 somedate
           end-call
                                           
      *OK 
      *   call Callee::check2 input somedate
          CALL 'zcallpgm' using TC-Callee
                    Callee-Fct-d0a59141-check2
                                 somedate
           end-call
                                            
        .

       END PROGRAM PGM1.

      *Callee contains public procedure
       IDENTIFICATION DIVISION.
       PROGRAM-ID. Callee.

       DATA DIVISION.
       working-storage section.

      *01  somedate     TYPE Date.
       01 somedate.
           02 YYYY PIC 9(4).
           02 MM PIC 9(2).
           02 DD PIC 9(2).
                                  
       01  someformat   PIC X(08).
      *01  flag         TYPE Bool.
       01  flag-value PIC X VALUE LOW-VALUE.
           88  flag       VALUE 'T'.
           88  flag-false VALUE 'F'
                           X'00' thru 'S'
                           'U' thru X'FF'.
                                  
       01  realformat   PIC X(08).

       LINKAGE SECTION.
       01 TC-FunctionCode pic X(30).
      * Function which call program ca0ab46c
      * Which is generated code for Callee.check
           88 Fct-ca0ab46c-check
              value 'Fct=ca0ab46c-check'.
      * Function which call program d0a59141
      * Which is generated code for Callee.check2
           88 Fct-d0a59141-check2
              value 'Fct=d0a59141-check2'.
      * Function which call program e5b741a8
      * Which is generated code for Callee.check2
           88 Fct-e5b741a8-check2
              value 'Fct=e5b741a8-check2'.
      * Function which call program ebb060ea
      * Which is generated code for Callee.MyPublicProcedure
           88 Fct-ebb060ea-MyPublicProcedure
              value 'Fct=ebb060ea-MyPublicProcedure'.

       01 arg1 pic X.
       01 arg2 pic X.
       01 arg3 pic X.
       01 arg4 pic X.

       PROCEDURE DIVISION USING TC-FunctionCode
                          arg1
                          arg2
                          arg3
                          arg4.
           PERFORM INIT-LIBRARY
           PERFORM FctList-Process-Mode
           GOBACK.

       FctList-Process-Mode.
           evaluate true

              when Fct-ca0ab46c-check
                 call 'ca0ab46c' using arg1
              when Fct-d0a59141-check2
                 call 'd0a59141' using arg1
              when Fct-e5b741a8-check2
                 call 'e5b741a8' using arg1
                                        arg2
              when Fct-ebb060ea-MyPublicProcedure
                 call 'ebb060ea' using arg1
                                        arg2
                                        arg3
                                        arg4
              when other
                 Perform Handle-Error
           end-evaluate
           .
       Handle-Error.
           continue
           .
                          
       
      *declare procedure check public
      *   input mydate        TYPE Date
      *  .

      *declare procedure check2 public
      *   input mydate        TYPE Date
      *  .
      *declare procedure check2 public
      *   input mydate        TYPE Date
      *         myDate2       type date
      *  .

      *DECLARE PROCEDURE MyPublicProcedure PUBLIC
      *    INPUT mydate        TYPE Date
      *          format        PIC X(08)
      *   OUTPUT okay          TYPE Bool
      *          actual-format PIC X(08).
      *  .
       END PROGRAM Callee.
      *
      *declare procedure check private
      *   input mydate        TYPE Date
      *  .
      *_________________________________________________________________
       IDENTIFICATION DIVISION.
       PROGRAM-ID. a0508f35.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-370.
       SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
       DATA DIVISION.
       LINKAGE SECTION.
      *PGM1.check - Params :
      *     input(mydate: DATE)
       01 mydate.
           02 YYYY PIC 9(4).
           02 MM PIC 9(2).
           02 DD PIC 9(2).
       PROCEDURE DIVISION
             USING BY REFERENCE mydate
           .
      *PGM1.check - Params :
      *     input(mydate: DATE)
           CONTINUE.
       END PROGRAM a0508f35.


      *
      *DECLARE PROCEDURE Pgm1PrivateValidateDateFormat PRIVATE
      *    INPUT mydate        TYPE Date
      *          format        PIC X(08)
      *   OUTPUT okay          TYPE Bool
      *          actual-format PIC X(08).
      *  .
      *_________________________________________________________________
       IDENTIFICATION DIVISION.
       PROGRAM-ID. fde394fb.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-370.
       SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
       DATA DIVISION.
       LINKAGE SECTION.
      *PGM1.Pgm1PrivateValidateDateFormat - Params :
      *     input(mydate: DATE, format: pic X(08))
      *     output(okay: BOOL, actual-format: pic X(08))
       01 mydate.
           02 YYYY PIC 9(4).
           02 MM PIC 9(2).
           02 DD PIC 9(2).
       01 format PIC X(08).
       01 okay-value PIC X     VALUE LOW-VALUE.
           88 okay       VALUE 'T'.
           88 okay-false VALUE 'F'
                             X'00' thru 'S'
                             'U' thru X'FF'.
       01 actual-format PIC X(08).
       PROCEDURE DIVISION
             USING BY REFERENCE mydate
                   BY REFERENCE format
                   BY REFERENCE okay-value
                   BY REFERENCE actual-format
           .
      *PGM1.Pgm1PrivateValidateDateFormat - Params :
      *     input(mydate: DATE, format: pic X(08))
      *     output(okay: BOOL, actual-format: pic X(08))
           CONTINUE.
       END PROGRAM fde394fb.


      *
      *declare procedure check public
      *   input mydate        TYPE Date
      *  .
      *_________________________________________________________________
       IDENTIFICATION DIVISION.
       PROGRAM-ID. ca0ab46c.
       DATA DIVISION.
       LINKAGE SECTION.
      *PGM1.check - Params :
      *     input(mydate: DATE)
       01 mydate.
           02 YYYY PIC 9(4).
           02 MM PIC 9(2).
           02 DD PIC 9(2).
       PROCEDURE DIVISION
             USING BY REFERENCE mydate
           .
      *PGM1.check - Params :
      *     input(mydate: DATE)
           CONTINUE.
       END PROGRAM ca0ab46c.


      *
      *declare procedure check2 public
      *   input mydate        TYPE Date
      *  .
      *_________________________________________________________________
       IDENTIFICATION DIVISION.
       PROGRAM-ID. d0a59141.
       DATA DIVISION.
       LINKAGE SECTION.
      *PGM1.check2 - Params :
      *     input(mydate: DATE)
       01 mydate.
           02 YYYY PIC 9(4).
           02 MM PIC 9(2).
           02 DD PIC 9(2).
       PROCEDURE DIVISION
             USING BY REFERENCE mydate
           .
      *PGM1.check2 - Params :
      *     input(mydate: DATE)
           CONTINUE.
       END PROGRAM d0a59141.


      *
      *declare procedure check2 public
      *   input mydate        TYPE Date
      *         myDate2       type date
      *  .
      *_________________________________________________________________
       IDENTIFICATION DIVISION.
       PROGRAM-ID. e5b741a8.
       DATA DIVISION.
       LINKAGE SECTION.
      *PGM1.check2 - Params :
      *     input(mydate: DATE, myDate2: DATE)
       01 mydate.
           02 YYYY PIC 9(4).
           02 MM PIC 9(2).
           02 DD PIC 9(2).
       01 myDate2.
           02 YYYY PIC 9(4).
           02 MM PIC 9(2).
           02 DD PIC 9(2).
       PROCEDURE DIVISION
             USING BY REFERENCE mydate
                   BY REFERENCE myDate2
           .
      *PGM1.check2 - Params :
      *     input(mydate: DATE, myDate2: DATE)
           CONTINUE.
       END PROGRAM e5b741a8.


      *
      *DECLARE PROCEDURE MyPublicProcedure PUBLIC
      *    INPUT mydate        TYPE Date
      *          format        PIC X(08)
      *   OUTPUT okay          TYPE Bool
      *          actual-format PIC X(08).
      *  .
      *_________________________________________________________________
       IDENTIFICATION DIVISION.
       PROGRAM-ID. ebb060ea.
       DATA DIVISION.
       LINKAGE SECTION.
      *PGM1.MyPublicProcedure - Params :
      *     input(mydate: DATE, format: pic X(08))
      *     output(okay: BOOL, actual-format: pic X(08))
       01 mydate.
           02 YYYY PIC 9(4).
           02 MM PIC 9(2).
           02 DD PIC 9(2).
       01 format PIC X(08).
       01 okay-value PIC X     VALUE LOW-VALUE.
           88 okay       VALUE 'T'.
           88 okay-false VALUE 'F'
                             X'00' thru 'S'
                             'U' thru X'FF'.
       01 actual-format PIC X(08).
       PROCEDURE DIVISION
             USING BY REFERENCE mydate
                   BY REFERENCE format
                   BY REFERENCE okay-value
                   BY REFERENCE actual-format
           .
      *PGM1.MyPublicProcedure - Params :
      *     input(mydate: DATE, format: pic X(08))
      *     output(okay: BOOL, actual-format: pic X(08))
           CONTINUE.
       END PROGRAM ebb060ea.


