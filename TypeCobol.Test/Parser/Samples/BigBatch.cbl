000010*  CBL OPTIMIZE(FULL)                                             0000000
000020*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-  0000000
000030*-Maintenance frame - Created on 20 May 2011 at 11:33:00          0000000
000040*-============================================================    0000000
000550*-End of frame                                                    0000000
000560*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-  0000000
000570*                                                                 0000000
000580                                                                  0000000
000590 IDENTIFICATION DIVISION.                                         0000000
000600 PROGRAM-ID. IPPBATCH.                                            0000000
000610**********************************************************        0000000
002170*---------------------------------------------------------------- 0000000
002180                                                                  0000000
002190*                                                                 0000000
002200*REMARKS.  COPY=(YIPPMA2   YIPPMA2R  YIPPCPL   YIPPCPLB  YIPPCPLR 0000000
002210*                YIPPCPLE  YIPPCPLO  YPRTBSP                      0000000
002220*                YIPPPRI   YIPPEDG   YIPPCAI   YIDPTXT            0000000
002230*                YINIPGM   YPRTSAY                                0000000
002240*                YGARFIC   YPRTIDC   YPRTDOS                      0000000
002250*                YPRTCPT   YPRTCTE             YPRTTFA   YPRTTFAA 0000000
002260*                YPRTTFAB  YPRTTFAC  YPRTTFAD  YIDPTAM            0000000
002270*                YMSGCTL   YI01PCB   YI01PCBB  YI01PCBC  YI01PCBD 0000000
002280*                YI01PCBF  YI01PCBG  YI01PCBH  YI01PCBI           0000000
002290*                YI01PCBJ  YI01PCBK  YI01PCBL  YI01PCBM  YI01PCBN 0000000
002300*                YI01PCBO  YI01PCBP  YI01PCBQ  YI01PCBR  YI01PCBS 0000000
002310*                YI99PCB   YI01PCB4  YPRTSAYZ  YPRTSAYT  YPRTSAYP 0000000
002320*                YI00COP   YIDPSTA   YPRTCOA   YIPPRGT   YIPIOCA  0000000
002330*                YCONINT             YEVTE10                      0000000
002340*                YIDPASS   YCLIRAD   YTIECOP                      0000000
002350*                YI99PCB1  YI99PCB2  YI99PCB3  YI03PCB   YPRTLNK  0000000
002360*                YTIEFAL   YTIEFRE   YTIEE10   YTIES10            0000000
002370*                YPRTSA2   YPRTCP2                                0000000
002380*                YIPCOND   YTRETAU   YIDXTAU                      0000000
002390*                YPRTREG                                          0000000
002400*                YDATS20   YITFTAU                                0000000
002410*                YPRTCO1   YPRTCO3   YPRTCO4                      0000000
002420*                YORGENT   YORGS01   YORGS01G  YORGS04   YIPXPRO  0000000
002430*                YIPXROU   YIPPPRD   YISCPAR   YISCSIT   YIPXSSP  0000000
002440*                YMESENT   YMESSOR   YCDCREC   YORGS03   YORGS03A 0000000
002450*                YIPCTIM                                          0000000
002460*                YAPRE11   YAPRS11   YATMXAR YACMPSB              0000000
002470*                YORGS01C  YORGS03G  YORGS03B                     0000000
002480*                YIPXCAL   YIPXCA5   YPRTSMP                      0000000
002490*                YIPXFRE   YIPXFAL   YIPXESM                      0000000
002500*                YIPXFAL1  YIPXFRE1  YIPXESM1                     0000000
002510*                YARKPCB   YGAR32C   YGARNAG                      0000000
002520*                YIPXAPX                                          0000000
002530*                YAPXTA5   YAPXTR5   YAPXPTR   YIPXMES   YPSOVAL  0000000
002540*                YAPXTRE                                          0000000
002550*                YIPXDLG                                          0000000
002560*                YIPXMAJ                                          0000000
002570*                YTIES10A                                         0000000
002580*                YTIEE01                                          0000000
002590*                YTIES01                                          0000000
002600*                YTIES02                                          0000000
002610*                YTIEE03                                          0000000
002620*                YTIES03                                          0000000
002630*                YTIEVAL                                          0000000
002640*                YTIEVAL1                                         0000000
002650*                YTIEVAL2                                         0000000
002660*                YTIECOI                                          0000000
002670*                YSBCFAL                                          0000000
002680*                YSBCFRE                                          0000000
002690*                YSBCE01                                          0000000
002700*                YSBCS01                                          0000000
002710*                YCLOFAL YCLOFRE YCLOESP                          0000000
002720*                YAUCGSP                                          0000000
002730*                YPARFAL   YPARFRE   YZPAVAL  YZPAVRE  YPARGTB    0000000
002740*                YPRTCPTB  YPRTCP2B                               0000000
002750*                YIPX020   YIPXLCH                                0000000
002760*                YICHCOM   YICHPRT  YIDHFRE YIDHFAL YIDHESG       0000000
002770*                YPARFON                                          0000000
002780*                ).                                               0000000
002790 ENVIRONMENT DIVISION.                                            0000000
002800 CONFIGURATION SECTION.                                           0000000
002810 SOURCE-COMPUTER. IBM-370                                         0000000
002820*                  WITH DEBUGGING MODE                            0000000
002830      .                                                           0000000
002840 OBJECT-COMPUTER. IBM-370.                                        0000000
002850 SPECIAL-NAMES. DECIMAL-POINT IS COMMA.                           0000000
002860                                                                  0000000
002870 INPUT-OUTPUT SECTION.                                            0000000
002880 FILE-CONTROL.                                                    0000000
002890*                                                                 0000000
002900***> APPEL                                                        0000000
002910     SELECT  FAPPEL  ASSIGN TO UT-S-FAPPEL.                       0000000
002920*                                                                 0000000
002930**** SORTIE                                                       0000000
002940     SELECT  FANOM    ASSIGN TO UT-S-ANOMALIE.                    0000000
002950     SELECT  FRECYC   ASSIGN TO UT-S-FRECYC.                      0000000
002960     SELECT  FEVT     ASSIGN TO UT-S-FEVT.                        0000000
002970     SELECT  IPXMAJ   ASSIGN TO UT-S-IPXMAJ.                      0000000
002980                                                                  0000000
002990                                                                  0000000
003000 DATA DIVISION.                                                   0000000
003010 FILE SECTION.                                                    0000000
003020*      FICHIER D'APPEL POUR EDITION PROVENANT DE SC1000           0000000
003030 FD  FAPPEL BLOCK 0 RECORDS                                       0000000
003040            LABEL RECORD STANDARD                                 0000000
003050            RECORDING MODE F.                                     0000000
003060 01  FIC-APPEL PIC X(128).                                        0000000
003070*      FICHIER EDITION DES ANOMALIES                              0000000
003080 FD  FANOM   LABEL RECORD STANDARD                                0000000
003090             RECORDING MODE F                                     0000000
003100             BLOCK CONTAINS 0 RECORDS                             0000000
003110             DATA RECORD IS EANOM.                                0000000
003120 01  EANOM.                                                       0000000
003130     02  EANOM-SAUT           PIC X.                              0000000
003140     02  FILLER               PIC X(079).                         0000000
003150*      FICHIER D'APPEL POUR MOUVEMENTS RECYCLES                   0000000
003160*      (FICHIER CLIENT PAS OUVERT PAR EXEMPLE)                    0000000
003170 FD  FRECYC  LABEL RECORD STANDARD                                0000000
003180             RECORDING MODE F                                     0000000
003190             BLOCK CONTAINS 0 RECORDS                             0000000
003200             DATA RECORD IS EFREC.                                0000000
003210 01  EFREC     PIC X(128).                                        0000000
003220*                                                                 0000000
003280                                                                  0000000
003290                                                                  0000000
003300*                                                                 0000000
003310*                                                                 0000000
003320 FD  FEVT  LABEL RECORD STANDARD                                  0000000
003330             RECORDING MODE F                                     0000000
003340             BLOCK CONTAINS 0 RECORDS                             0000000
003350             DATA RECORD IS IPPEVT.                               0000000
003360 01  IPPEVT     PIC X(4000).                                      0000000
003370*                                                                 0000000
003380 FD  IPXMAJ                                                       0000000
003390     BLOCK CONTAINS 0 RECORDS                                     0000000
003400     RECORDING MODE F                                             0000000
003410              LABEL RECORD STANDARD.                              0000000
003420 01 YIPXMAJ.                   COPY YIPXMAJ.                      0000000
003430                                                                  0000000
003440 WORKING-STORAGE SECTION.                                         0000000
003450*=========================                                        0000000
003460 77  FILLER PIC X(30) VALUE '*** DEBUT WORKING IPPBATCH ***'.     0000000
003470* ZONES COMPLEMENTAIRES                                           0000000
003480 01 WA2-PER                     PIC 9(2).                         0000000
003490* ZONES POUR GESTION DES SIECLE ZDAT2000.                         0000000
003500 01  ZDAT2000-GESTION-SIECLE  PIC X(01).                          0000000
003510     88 ZDAT2000-GESTION-SIECLE-OUI  VALUE 'O'.                   0000000
003520     88 ZDAT2000-GESTION-SIECLE-NON  VALUE 'N'.                   0000000
003530* ZONES POUR REMPLACEMENT ZDATE PAR ZDAT2000                      0000000
003540 01  CV-ZDATE-GROUPE.                                             0000000
003550   05  CV-ZDATE-DATE1.                                            0000000
003560     10  FILLER                   PIC X(10).                      0000000
003570   05  CV-ZDATE-DATE2.                                            0000000
003580     10  FILLER                   PIC X(10).                      0000000
003590   05  CV-ZDATE-PARAM-GROUPE.                                     0000000
003600     10  CV-ZDATE-PARAM-F1        PIC 9.                          0000000
003610       88 CV-ZDATE-PARAM-F1-TYPEJ VALUE 1, 2, 5, 6, 7, 8, 9.      0000000
003620       88 CV-ZDATE-PARAM-F1-TYPEQ VALUE 3, 4.                     0000000
003630       88 CV-ZDATE-PARAM-F1-SENSJ VALUE 1, 2, 5, 7.               0000000
003640       88 CV-ZDATE-PARAM-F1-SENSM VALUE 6.                        0000000
003650       88 CV-ZDATE-PARAM-F1-SENSA VALUE 3, 4, 8, 9.               0000000
003660     10  CV-ZDATE-PARAM-F2        PIC 9.                          0000000
003670       88 CV-ZDATE-PARAM-F2-TYPEJ VALUE 1, 2, 5, 6, 7, 8, 9.      0000000
003680       88 CV-ZDATE-PARAM-F2-TYPEQ VALUE 3, 4.                     0000000
003690       88 CV-ZDATE-PARAM-F2-SENSJ VALUE 1, 2, 5, 7.               0000000
003700       88 CV-ZDATE-PARAM-F2-SENSM VALUE 6.                        0000000
003710       88 CV-ZDATE-PARAM-F2-SENSA VALUE 3, 4, 8, 9.               0000000
003720       88 CV-ZDATE-PARAM-F2-SEP   VALUE 5, 6, 7.                  0000000
003730       88 CV-ZDATE-PARAM-F2-PASSEP VALUE 1, 2, 3, 4, 8, 9.        0000000
003740     10  CV-ZDATE-PARAM-SEP       PIC X.                          0000000
003750     10  CV-ZDATE-PARAM-SIECLE    PIC 99.                         0000000
003760     10  CV-ZDATE-PARAM-RETOUR    PIC 99.                         0000000
003770 01  nb-pret-salarie pic 99.                                      0000000
003780 01  W-TAXE       PIC X.                                          0000000
003790 01  W-BUTMIN     pic 99v9(5) comp-3.                             0000000
003800 01  W-BUTMAX     pic 99v9(5) comp-3.                             0000000
003810 01  W-ZonRob     pic X.                                          0000000
003820 01  W-MajPtz     pic X.                                          0000000
003830 01  W-Type       pic XX.                                         0000000
003840 01  Filler       pic X.                                          0000000
003850     88 W-TypAnc    Value 'A'.                                    0000000
003860     88 W-TypNeu    Value 'N'.                                    0000000
003870 01  W-DOM        pic X.                                          0000000
003880     88 W-Dom-Oui     value 'o'.                                  0000000
003890     88 W-Dom-Non     value 'n'.                                  0000000
003900 01  W-RES6        PIC X(17).                                     0000000
003910 01  W-CNAT-RTA    PIC X(03).                                     0000000
003920     88  COND-CNAT-RTA    VALUE '601' '602' '603' '604' '605'     0000000
003930                                '606' '607' '608' '609' '611'     0000000
003940                                '613'                             0000000
003950                                '280'  THRU  '285'.               0000000
003960                                                                  0000000
003970 01  NBGAR-PRET              PIC 99.                              0000000
003980 01  NB-PRET-DOSS            PIC 9.                               0000000
003990 01  NB-PRET-MAX             PIC 9.                               0000000
004000 01  NB-CLA                  PIC 99  value 20.                    0000000
004010 01  W-TMIXF                 PIC 99,999.                          0000000
004020 01  W-TMIXV                 PIC 99,999.                          0000000
004030 01  W-PCT                   PIC 99.                              0000000
004040 01  V-DATREF-5              PIC 9(5)    COMP-3.                  0000000
004050 01  V-DATREF-8              PIC 9(8).                            0000000
004060 01  I                       PIC 99.                              0000000
004070 01  J                       PIC 99.                              0000000
004080 01  NB-MAJ-KO               PIC 9(4).                            0000000
004090 01  TOP-ADRESSE-CAU   PIC X.                                     0000000
004100     88  ADRESSE-CAUTION   VALUE '1'.                             0000000
004110 01  CODE-INSEE              PIC X(5).                            0000000
004120                                                                  0000000
004130 01  W-DESC5.                                                     0000000
004140     05  W-DESC                  PIC X(400).                      0000000
004150                                                                  0000000
004160 01  TYPPRT.                                                      0000000
004170     03  TYPPRT12        PIC XX.                                  0000000
004180     03  FILLER          PIC X(16).                               0000000
004190*  edition immo avec exemplaire selon  la banque.                 0000000
004200 01                     PIC  9.                                   0000000
004210     88  immo-sans-taxe   VALUE ZERO.                             0000000
004220     88  immo-avec-taxe   VALUE    1.                             0000000
004230                                                                  0000000
004240 01                    PIC X.                                     0000000
004250     88  pas-modif-index     VALUE 'N'.                           0000000
004260     88  modif-index         VALUE 'O'.                           0000000
004270                                                                  0000000
004280 01                    PIC X.                                     0000000
004290     88  88-DELEG-ASS-O      VALUE 'O'.                           0000000
004300     88  88-DELEG-ASS-N      VALUE 'N'.                           0000000
004310                                                                  0000000
004320 01                    PIC X.                                     0000000
004330     88  y-a-des-anos        VALUE 'O'.                           0000000
004340     88  y-a-pas-ano         VALUE 'N'.                           0000000
004350 01                    PIC X.                                     0000000
004360     88  Pret-a-lire         VALUE '1'.                           0000000
004370     88  Pret-deja-lu        VALUE '2'.                           0000000
004380                                                                  0000000
004390 01                    PIC X.                                     0000000
004400     88  88-GAR1             VALUE '1'.                           0000000
004410     88  88-GAR3             VALUE '3'.                           0000000
004420                                                                  0000000
004430 01                    PIC X.                                     0000000
004440     88  88-IPPBATC1-CONT    VALUE '0'.                           0000000
004450     88  88-IPPBATC1-I-O     VALUE '1'.                           0000000
004460                                                                  0000000
004470                                                                  0000000
004480 01                    PIC X.                                     0000000
004490     88  PTZ-BAREM-NN        VALUE '0'.                           0000000
004500     88  PTZ-BAREM-21        VALUE '1'.                           0000000
004510                                                                  0000000
004520 01                    PIC X.                                     0000000
004530     88  NBRE-CLAUSE-RTA-ABS VALUE '0'.                           0000000
004540     88  NBRE-CLAUSE-RTA-OK  VALUE '1'.                           0000000
004550                                                                  0000000
004560 01                    PIC X.                                     0000000
004570     88  Y-A-PAS-UNE-254     VALUE '0'.                           0000000
004580     88  Y-A-UNE-254         VALUE '1'.                           0000000
004590 01                    PIC X.                                     0000000
004600     88  CAISSE-AUTRE      VALUE '0'.                             0000000
004610     88  CAISSE-CME        VALUE '1'.                             0000000
004620                                                                  0000000
004630 01                    PIC X.                                     0000000
004640     88  IPPMA2-TROUVE     VALUE '1'.                             0000000
004650     88  PAS-DE-IPPMA2     VALUE '0'.                             0000000
004660                                                                  0000000
004670 01                    PIC X.                                     0000000
004680     88  TS-ABS            VALUE '0'.                             0000000
004690     88  TS-TROUVE         VALUE '1'.                             0000000
004700                                                                  0000000
004710 01                    PIC X.                                     0000000
004720     88  88-ps-oui         VALUE 'O'.                             0000000
004730     88  88-ps-non         VALUE 'N'.                             0000000
004740                                                                  0000000
004750 01                    PIC X.                                     0000000
004760     88  langue-francaise  VALUE 'F'.                             0000000
004770     88  langue-allemande  VALUE 'A'.                             0000000
004780     88  Dossier-goethe    VALUE 'G'.                             0000000
004790                                                                  0000000
004800 01                    PIC X.                                     0000000
004810     88  CAI-CAIDEVC-NON-FORCE   VALUE ZERO.                      0000000
004820     88  CAI-CAIDEVC-FORCE       VALUE '1'.                       0000000
004830*                                                                 0000000
004840*msc-GAR3-05/2005                                                 0000000
004850 01                          pic x(01).                           0000000
004860     88  TOP-PRET-XXXX-GARANTIE  value 'X'.                       0000000
004870     88  TOP-PRET-SANS-GARANTIE  value 'S'.                       0000000
004880     88  TOP-PRET-AVEC-GARANTIE  value 'A'.                       0000000
004890                                                                  0000000
004900 01  W-LIB1               PIC X(80).                              0000000
004910 01  W-LIBOBJ             PIC X(350).                             0000000
004920 01  W-IPPPRI-DATEJ-14    PIC X(10)  VALUE SPACES.                0000000
004930 01  Z-IPPPRI             PIC X(4000).                            0000000
004940                                                                  0000000
004950 77  ZPRTNBMO-D1                 PIC X(8).                        0000000
004960 77  ZPRTNBMO-D2                 PIC X(8).                        0000000
004970                                                                  0000000
004980*                                                                 0000000
004990 01  AUTO-CTR-DLG     PIC X.                                      0000000
005000     88  AUTO-CTR-DLG-OUI      VALUE 'O'.                         0000000
005010     88  AUTO-CTR-DLG-NON      VALUE 'N'.                         0000000
005020*                                                                 0000000
005030 01  IPXDLG.      COPY YIPXDLG SUPPRESS.                          0000000
005040                                                                  0000000
005050 01  ZPRTBARM-I.                                                  0000000
005060     05  ZPRTBARM-I-BAREME           PIC 9(2).                    0000000
005070     05  ZPRTBARM-I-TYPE             PIC X.                       0000000
005080     05  ZPRTBARM-I-ZONE             PIC X.                       0000000
005090     05  ZPRTBARM-I-DATEF            PIC X(8).                    0000000
005100     05  ZPRTBARM-I-DURDIF           PIC X(3).                    0000000
005110                                                                  0000000
005120 01  ZPRTBARM-O.                                                  0000000
005130     05  ZPRTBARM-O-DATEF            PIC X(8).                    0000000
005140     05  ZPRTBARM-O-DUREE            PIC 9(3)         COMP-3.     0000000
005150     05  ZPRTBARM-O-DURDIF           PIC 9(3)         COMP-3.     0000000
005160     05  ZPRTBARM-O-TXREF            PIC 9(2)V9(3)    COMP-3.     0000000
005170     05  ZPRTBARM-O-MARGE            PIC 9(2)V9(3)    COMP-3.     0000000
005180     05  ZPRTBARM-O-MACTU            PIC 9(2)V9(3)    COMP-3.     0000000
005190     05  ZPRTBARM-O-COEFF            PIC 9V9(3)       COMP-3.     0000000
005200     05  ZPRTBARM-O-BONIF            PIC 9(7)V9(3)    COMP-3.     0000000
005210     05  FILLER                      PIC X(10).                   0000000
005220     05  ZPRTBARM-O-TAB-COEFF.                                    0000000
005230         10  ZPRTBARM-O-COEFF-BONIF  OCCURS 30 PIC 9V9(15) COMP.  0000000
005240     05  ZPRTBARM-O-FACT-K           PIC 9V9(6)       COMP-3.     0000000
005250                                                                  0000000
005260  01  W-CPROD.                                                    0000000
005270      05  W-CNAT   PIC XXX.                                       0000000
005280      05  W-CSPRD  PIC  XX.                                       0000000
005290                                                                  0000000
005300  01  W-INDIC-SAYX.                                               0000000
005310      05  FILLER            OCCURS  05.                           0000000
005320          10  W-INDIC-SAY       PIC  9.                           0000000
005330                                                                  0000000
005340  01  W-INDIC-SAY2X.                                              0000000
005350      05  FILLER            OCCURS  05.                           0000000
005360          10  W-INDIC-SAY2       PIC  9.                          0000000
005370                                                                  0000000
005380  01  W-INDIC-GARX.                                               0000000
005390      05  FILLER            OCCURS  1000.                         0000000
005400          10  W-INDIC-GAR       PIC  9.                           0000000
005410                                                                  0000000
005420*  100 postes                                                     0000000
005430 01  W-MTGAR.                                                     0000000
005440     05  W-MTGAR-MT       OCCURS  100.                            0000000
005450*        10  W-MTGAR-MONT     PIC S9(13)V   COMP-3.               0000000
005460         10  W-MTGAR-MONT     PIC S9(13).                         0000000
005470*  9 prets possible par dossier                                   0000000
005480*  poste 10 -> total des prets garantis par hypot.                0000000
005490 01  W-MTPRET.                                                    0000000
005500     05  W-MTPRET-MT       OCCURS  10.                            0000000
005510         10  W-MTPRET-MONT     PIC S9(13)V99   COMP-3.            0000000
005520                                                                  0000000
005530* LISTE DES GARANTIES GAR3 DEJA PRISES POUR CUMUL HYPOTHEQUE      0000000
005540 01  W-LSTGAR3HYP.                                                0000000
005550     05 W-GAR3HYP                    PIC X(11)  OCCURS 2.         0000000
005560                                                                  0000000
005570 01  W-MT-GARANTIE-DEJA-CUMULE       PIC X.                       0000000
005580     88 MT-GARANTIE-PAS-ENCORE-CUMULE    VALUE 'N'.               0000000
005590     88 MT-GARANTIE-DEJA-CUMULE          VALUE 'O'.               0000000
005600                                                                  0000000
005610 01  IDPMSGX.                                                     0000000
005620     05  IDPMSGX-FED      PIC XX.                                 0000000
005630     05  IDPMSGX-CAISSE   PIC X(5).                               0000000
005640                                                                  0000000
005650 01  WORK-ASVI.                                                   0000000
005660     05  WORK-ASVI1     PIC X.                                    0000000
005670     05  WORK-ASVI2     PIC X.                                    0000000
005680                                                                  0000000
005690 01  W-OBJET            pic x(236).                               0000000
005700                                                                  0000000
005710 01  W-TAB-GAR.                                                   0000000
005720     05 W-TAB-GAR1        OCCURS 04.                              0000000
005730        10 W-TAB-GAR2         OCCURS 08.                          0000000
005740            15  WP-CODE-GARANTIE      PIC XX.                     0000000
005750                    88  COND-HYPO  VALUE                          0000000
005760                 '10'    '11'    '12'    '13'    '14'   '16'      0000000
005770                 '17'    '18'    '19'    '03'    'AZ'   'QA'      0000000
005780                 'QB'    'QC' .                                   0000000
005790            15  WP-NO-ORDRE.                                      0000000
005800                20  WP-NO-ORDRE9      PIC 999.                    0000000
005810            15  WP-CODE-GARGAR     PIC  999.                      0000000
005820            15  WP-CODE-GARNAG     PIC  xxx.                      0000000
005830                88  COND-WP-CODE-GARNAG   value                   0000000
005840                '150' '160' '161' '180' '215'  '910'  '650'       0000000
005850                '019' '260' '261' '262' '006'  '020'  '024'       0000000
005860                '720' '005' '615' '616' '025'  '662'  '591'       0000000
005870                '617' '618' '913' '027' '960'  '660'              0000000
005880                '042'.                                            0000000
005890            15  WP-TYPEGAR         PIC   XX.                      0000000
005900                                                                  0000000
005910 01  W-DAT-ECH   PIC  X(8).                                       0000000
005920                                                                  0000000
005930                                                                  0000000
005940 01  W-MGARCAPI          PIC S9(15)V99.                           0000000
005950 01  W-MTNFC             PIC S9(15)V99.                           0000000
005960 01  AAAA-MM-JJ.                                                  0000000
005970     05 AAAA             PIC X(4).                                0000000
005980     05 FIL1             PIC X.                                   0000000
005990     05 MM               PIC XX.                                  0000000
006000     05 FIL2             PIC X.                                   0000000
006010     05 JJ               PIC XX.                                  0000000
006020                                                                  0000000
006030 01  JJ-MM-AAAA.                                                  0000000
006040     05 JJ               PIC XX.                                  0000000
006050     05 FIL1             PIC X.                                   0000000
006060     05 MM               PIC XX.                                  0000000
006070     05 FIL2             PIC X.                                   0000000
006080     05 AAAA             PIC X(4).                                0000000
006090                                                                  0000000
006100 01  W-SCRIVENER-EUR     PIC 9(9)   COMP-3.                       0000000
006110 01  W-MAX-266-EUR       PIC 9(9)   COMP-3.                       0000000
006120 01  WS-DURTOT           PIC 999   COMP-3.                        0000000
006130*01  WS-DURAM            PIC 999   COMP-3.                        0000000
006140 01  WS-BONIF            PIC 9(15)V99     COMP-3.                 0000000
006150 01  WS-MTOTHYP          PIC 9(15)V99     COMP-3.                 0000000
006160 01  WS-DEVMHF           PIC 9(15)V99     COMP-3.                 0000000
006170*01  WS-CAPASS           PIC S9(15)V99    COMP-3.                 0000000
006180 01  W-KRDU              PIC S9(15)V99    COMP-3.                 0000000
006190 01  W-tau1j             PIC  9(03)V9(8)  COMP-3.                 0000000
006200 01  W-int1j             PIC S9(15)V99    COMP-3.                 0000000
006210*01  W-assdeleg          PIC S9(09)V99    COMP-3.                 0000000
006220 01  W-TotDlg            PIC S9(09)V99    COMP-3.                 0000000
006230                                                                  0000000
006240 01  W-TXX.                                                       0000000
006250     03  W-TX9          PIC  -9,9(5).                             0000000
006260                                                                  0000000
006270 01  W-ANCIEN-TEG        PIC 9(03)V9(8).                          0000000
006280 01  WS-TAUX             PIC 9(03)V9(8)   COMP-3.                 0000000
006290 01  WS-TAUX-FR          PIC 9(03)V9(8)   COMP-3.                 0000000
006300 01  W-TRAV-TX           PIC 9(02)V9(3)   COMP-3.                 0000000
006310 01  W-TRAV-TEG          PIC 9(02)V9(3)   COMP-3.                 0000000
006320*01  WS-COTAS-T          PIC 9(09)V99     COMP-3.                 0000000
006330*01  WS-COTAS-TERME      PIC 9(09)V99     COMP-3.                 0000000
006340*01  WS-COTAS-TE-FA      PIC 9(09)V99     COMP-3.                 0000000
006350*01  WS-ASS-TEG          PIC 9(03)V9(6)   COMP-3  VALUE ZERO.     0000000
006360                                                                  0000000
006370 01  W-ANCIEN-TCOM       PIC 9(03)V9(8).                          0000000
006380 01  W-ANCIEN-TAFR       PIC 9(03)V9(8).                          0000000
006390 01  W-ANCIEN-TFRH       PIC 9(03)V9(8).                          0000000
006400 01  W-ANCIEN-TCAS       PIC 9(03)V9(8).                          0000000
006410 01  W-MTASS             PIC S9(12)V9(3)   COMP-3.                0000000
006420 01  W-TXASS             PIC S9(3)V9(8)    COMP-3.                0000000
006430 01  W-MTASS1            PIC S9(12)V9(3)   COMP-3.                0000000
006440 01  W-TXASS1            PIC S9(3)V9(8)    COMP-3.                0000000
006450                                                                  0000000
006460 01  TEG-CONSO           PIC X.                                   0000000
006470     88  TEG-SANS-ASSUR  VALUE  'N'.                              0000000
006480     88  TEG-AVEC-ASSUR  VALUE  'O'.                              0000000
006490                                                                  0000000
006500 01  TEG-IMMO            PIC X.                                   0000000
006510     88  TEG-SANS-ASS-I  VALUE  'N'.                              0000000
006520     88  TEG-AVEC-ASS-I  VALUE  'O'.                              0000000
006530                                                                  0000000
006540*         INDICATEUR DE TRAITEMENT OK OU ANOMALIE                 0000000
006550 01  TEST-1                    PIC 99.                            0000000
006560     88  SUITE                          VALUE ZERO.               0000000
006570     88  ARRET                          VALUE 01 THRU 99.         0000000
006580 77  RUPTURE-LYON              PIC X.                             0000000
006590                                                                  0000000
006600 77  INDIC-DOSSIER             PIC X.                             0000000
006610     88  DOSSIER-OK                   VALUE 'O'.                  0000000
006620     88  DOSSIER-KO                   VALUE 'N'  ' ' '0'.         0000000
006630                                                                  0000000
006640 77  FILLER                    PIC X.                             0000000
006650     88  PRET-AVEC-HYPO               VALUE 'O'.                  0000000
006660     88  PRET-SANS-HYPO               VALUE 'N' ' ' '0'.          0000000
006670                                                                  0000000
006680*                                                                 0000000
006690 77  INDIC-TAUX-BECM           PIC 99   VALUE ZERO.               0000000
006700 77  IND-ANOM                  PIC 99   VALUE ZERO.               0000000
006710 77  IND-TRAIT-GDP             PIC X    VALUE SPACE.              0000000
006720 77  NOTARIE                   PIC 9    VALUE ZERO.               0000000
006730**** IPI                                                          0000000
006740 77  SALARIE                   PIC 9    VALUE ZERO.               0000000
006750 77  SALARIE-TR1-2             PIC 9    VALUE ZERO.               0000000
006760 77  GAR-MARSEILLE             PIC 9    VALUE ZERO.               0000000
006770 77  SALARIE-MARSEILLE         PIC 9    VALUE ZERO.               0000000
006780 77  DROIT-LOCAL               PIC X    VALUE SPACE.              0000000
006790 77  AUCUNE-HYP-EXIST          PIC X    VALUE SPACE.              0000000
006800 77  HYP-EXIST                 PIC X    VALUE SPACE.              0000000
006810 77  42-EXIST                  PIC X    VALUE SPACE.              0000000
006820 77  HYP-DECRIT                PIC X    VALUE SPACE.              0000000
006830 77  PPD-EXIST                 PIC X    VALUE SPACE.              0000000
006840 77  GENDARME-EXIST            PIC X    VALUE SPACE.              0000000
006850 77  CAU-HYP-EXIST             PIC X    VALUE SPACE.              0000000
006860 77  CAU-EXIST                 PIC X    VALUE SPACE.              0000000
006870 77  MADELIN-EXIST             PIC X    VALUE SPACE.              0000000
006880 77  RETOUR                    PIC X(2) VALUE SPACE.              0000000
006890 77  FF-APPEL                  PIC 9    VALUE ZERO.               0000000
006900 77  GDP-OK                    PIC X    VALUE SPACE.              0000000
006910 77  EDT-OK                    PIC X    VALUE SPACE.              0000000
006920 77  CONTRAT-EDITE             PIC X.                             0000000
006930*                                                                 0000000
006940 77  IA                        PIC 999.                           0000000
006950 77  IT                        PIC 999.                           0000000
006960 77  W-IT                      PIC 999.                           0000000
006970 77  I-POS                     PIC 999.                           0000000
006980 77  I-POS2                    PIC 999.                           0000000
006990 77  ITER                      PIC 999.                           0000000
007000 77  JT                        PIC 99.                            0000000
007010 77  IG                        PIC 99.                            0000000
007020 77  II                        PIC 999.                           0000000
007030 77  II2                       PIC 999.                           0000000
007040 77  IY                        PIC 99.                            0000000
007050 77  I-TS                      PIC 99.                            0000000
007060 77  JG                        PIC 9999.                          0000000
007070 77  IP                        PIC 999.                           0000000
007080 77  K                         PIC 99.                            0000000
007090 77  K1                        PIC 99.                            0000000
007100 77  IR                        PIC 99.                            0000000
007110 77  KJ                        PIC 9.                             0000000
007120 77  ICLAU                     PIC 99.                            0000000
007130 77  ICLAU2                    PIC 9(4) COMP.                     0000000
007140**** ICLAU SPECIFIQUE A CLAUSES-VARTAUX                           0000000
007150 77  ICLAUV                    PIC 99.                            0000000
007160**** ICLAU SPECIFIQUE A CLAUSES-AUTRES                            0000000
007170 77  ICLAUA                    PIC 99.                            0000000
007180 77  ICLAUT                    PIC 99.                            0000000
007190 77  I-DEST                    PIC 99.                            0000000
007200 77  TX                        PIC 999.                           0000000
007210 77  TZ                        PIC 999.                           0000000
007220 77  TY                        PIC 999.                           0000000
007230 77  IGAR                      PIC 9(4) COMP.                     0000000
007240 77  IGAR2                     PIC 9(4) COMP.                     0000000
007250 77  I-P2                      PIC 9(4) COMP.                     0000000
007260 77  I-Pal                     PIC 9(4) COMP.                     0000000
007270 77  I-xxx                     PIC 99.                            0000000
007280*                                                                 0000000
007290 77  PROBLEME-DATE             PIC X.                             0000000
007300                                                                  0000000
007310 77  Z-TYPPRET                 PIC XX.                            0000000
007320                                                                  0000000
007330 01  Z-TYPCRED.                                                   0000000
007340     03  Z-TYPCRED-AGRI          PIC X(10).                       0000000
007350         88  PRET-AGRI-BONIFIE   VALUE 'PROF-AGRIB'.              0000000
007360     03  FILLER                  PIC X.                           0000000
007370                                                                  0000000
007380 77  Z-MODEGEST                PIC 9.                             0000000
007390 77  Z-TYPEPC                  PIC 99.                            0000000
007400 77  Z-VARIANTE-PC             PIC 9.                             0000000
007410 77  Z-DOSS-PC                 PIC 9.                             0000000
007420 77  Z-INDGARTI                PIC X.                             0000000
007430 77  Z-CNP                     PIC 9.                             0000000
007440 77  Z-INDDIFF                 PIC 9.                             0000000
007450 77  Z-TYPINDEX                PIC X.                             0000000
007460 77  W-SEXE                    PIC X.                             0000000
007470 77  W-SITFAM                  PIC X.                             0000000
007480 01  W-VARTAUXX.                                                  0000000
007490     05 W-VARTAUX              PIC 9(4).                          0000000
007500 77  W-CLAUSE                  PIC XXX.                           0000000
007510 77  W-AUTRES                  PIC 9(6).                          0000000
007520 77  W-VEHDEPT                 PIC X(3).                          0000000
007530 77  ZONE-ALPHA                PIC X(40).                         0000000
007540 77  CLE-ALPHA                 PIC X(10).                         0000000
007550 77  W-MOIS1                   PIC X(12).                         0000000
007560 77  W-MOIS2                   PIC X(12).                         0000000
007570 77  BOOL-RECYCLE              PIC X.                             0000000
007580 77  ASSURANCE-EXTERNE         PIC X.                             0000000
007590*                                                                 0000000
007600 77  Z-TAUX1                   PIC 99V999  COMP-3.                0000000
007610 77  Z-TAUX2                   PIC 99V999  COMP-3.                0000000
007620 77  Z-MREMBMIN                PIC 9(9)V99 COMP-3.                0000000
007630 77  W-MTCOM9                  PIC 9(9)V99 COMP-3.                0000000
007640 77  W-DEVPRC                  PIC 9(13)   COMP-3.                0000000
007650 77  W-DEVPRC2                 PIC 9(13)   COMP-3.                0000000
007660 77  W-MONT                    PIC 9(15)V99 COMP-3.               0000000
007670 77  WS-TFRAIS                 PIC 9(09).                         0000000
007680 77  WS-TOTFRAIS               PIC 9(09).                         0000000
007690 77  W-TOTAL-MONT120           PIC 9(10)V99.                      0000000
007700 77  WS-EPAECH                 PIC 9(09)V99.                      0000000
007710 77  WS-TERME                  PIC 9(09)V99.                      0000000
007720 77  Z-MCOTOCM                 PIC 9(9)V99 COMP-3.                0000000
007730 77  Z-MVERSOCM                PIC 9(9)V99 COMP-3.                0000000
007740 77  Z-TOTINTER                PIC 9(15)V99 COMP-3.               0000000
007750 77  W-TOTINTV                 PIC 9(15)V99 COMP-3.               0000000
007760 77  W-TAUX                  PIC S9(5)V9(4).                      0000000
007770 77  WS-CLAUSE               PIC 9(4).                            0000000
007780 77  W-MRG-FIXE-MOINS12      PIC S9(5)V9(4).                      0000000
007790 77  W-MRG-FIXE-12-15        PIC S9(5)V9(4).                      0000000
007800 77  W-MRG-FIXE-15-20        PIC S9(5)V9(4).                      0000000
007810 77  W-MRG-FIXE-PLUS20       PIC S9(5)V9(4).                      0000000
007820 77  W-MRG-VAR-MOINS12       PIC S9(5)V9(4).                      0000000
007830 77  W-MRG-VAR-12-15         PIC S9(5)V9(4).                      0000000
007840 77  W-MRG-VAR-15-20         PIC S9(5)V9(4).                      0000000
007850 77  W-MRG-VAR-PLUS20        PIC S9(5)V9(4).                      0000000
007860 77  W-TAUMAX                PIC S9(5)V9(4).                      0000000
007870 77  W-DATRAIT               PIC 9(5) COMP-3.                     0000000
007880                                                                  0000000
007890 01             PIC X.                                            0000000
007900     88  Y-A-DES-FRAIS  VALUE  'O'.                               0000000
007910     88  Y-A-PAS-FRAIS  VALUE  'N'.                               0000000
007920 01             PIC X.                                            0000000
007930     88  AVEC-ASS-FA    VALUE  'O'.                               0000000
007940     88  SANS-ASS-FA    VALUE  'N'.                               0000000
007950*-----                                                            0000000
007960*                                                                 0000000
007970*   ZONES POUR MODULE RECHERCHE SITE SUR 2 POSITIONS              0000000
007980*-----                                                            0000000
007990*                                                                 0000000
008000 01  PT-SITE-LOCAL USAGE IS POINTER.                              0000000
008010                                                                  0000000
008020 01  PARAM-ISC. COPY YISCPAR.                                     0000000
008030                                                                  0000000
008040 01  XX-SITE-MODULE.                                              0000000
008050    02  ZISC-IMS                 PIC X.                           0000000
008060        88 SITE-DE-TEST  VALUE 'N'.                               0000000
008070    02  FILLER                   PIC X.                           0000000
008080                                                                  0000000
008090*      ZONE DE WORKING POUR PRET RELAIS                           0000000
008100*                                                                 0000000
008110 77  NBECHREL                  PIC 9.                             0000000
008120 01  W-CINDEX                  PIC X(05).                         0000000
008130     88  index-cee-ancien   value                                 0000000
008140                        '07227'    '07327'                        0000000
008150                        '06827'    '06927'                        0000000
008160                        '07527'    '70770'                        0000000
008170                        '70772'    '70652'                        0000000
008180                        '70756'.                                  0000000
008190                                                                  0000000
008200*  Stbg                                                           0000000
008210     88  index-cee-conso  value  '06114' '06214'.                 0000000
008220                                                                  0000000
008230     88  index-cee-tr1    value  '06414' '06514' '08514'          0000000
008240                                 '13714' '15514'                  0000000
008250                                 '14114' '14414' '14714'          0000000
008260                                 '16614' '16714'.                 0000000
008270                                                                  0000000
008280     88  index-cee-tr1-pc value  '37372'.                         0000000
008290                                                                  0000000
008300     88  index-cee-tr2    value  '06614' '06714' '08614'          0000000
008310                                 '13814' '14014'                  0000000
008320                                 '14214' '14514' '14814'          0000000
008330                                 '16814' '16914'.                 0000000
008340                                                                  0000000
008350     88  index-cee-tr2-pc value  '37370'.                         0000000
008360                                                                  0000000
008370     88  index-cee-ex     value  '08314' '08414'                  0000000
008380                                 '14314' '14614' '14914'.         0000000
008390                                                                  0000000
008400*  Annecy                                                         0000000
008410     88  index-f33-conso  value  '46114' '46314'.                 0000000
008420                                                                  0000000
008430     88  index-f33-tr1    value  '46414' '46514'                  0000000
008440                                 '47914' '48514'.                 0000000
008450                                                                  0000000
008460                                                                  0000000
008470     88  index-f33-tr2    value  '46614' '46714' '48614'.         0000000
008480                                                                  0000000
008490                                                                  0000000
008500 01  W-DATE-10                 PIC X(10) VALUE ZEROES.            0000000
008510 01  WS-SPECH1X.                                                  0000000
008520     03  WS-SPECH1             PIC 9(2).                          0000000
008530 01  WS-SPECH2X.                                                  0000000
008540     03  WS-SPECH2             PIC 9(2).                          0000000
008550 01  WS-DATE-X.                                                   0000000
008560     03  WS-DATE-9             PIC 9(8).                          0000000
008570 01  W-DATE.                                                      0000000
008580     03  W-DATE-8              PIC 9(8).                          0000000
008590 01  W-DURDIF-PTZ        PIC 9(3).                                0000000
008600 01  W-DUREE               PIC  9999.                             0000000
008610 01  W-AAAAX.                                                     0000000
008620     05  W-AAAA                PIC  9999.                         0000000
008630 01  W-MOIS.                                                      0000000
008640     03  W-MOIS9               PIC 9(3).                          0000000
008650 01  W-MOISZZ.                                                    0000000
008660     03  W-MOISZ              PIC ZZ9.                            0000000
008670 01  W-AN.                                                        0000000
008680     03  W-AN9                 PIC 9(3).                          0000000
008690 01  W-ANZZ.                                                      0000000
008700     03  W-ANZ                PIC ZZ9.                            0000000
008710                                                                  0000000
008720 01  WS-HEURE-8                PIC 9(8).                          0000000
008730 01  WS-HEURE-R  REDEFINES  WS-HEURE-8.                           0000000
008740     03  WS-HEURE-12   PIC XX.                                    0000000
008750     03  WS-HEURE-34   PIC XX.                                    0000000
008760     03  WS-HEURE-SC   PIC XX.                                    0000000
008770     03  FILLER        PIC XX.                                    0000000
008780                                                                  0000000
008790 77  NBR-PERIOD                PIC 9(2).                          0000000
008800*01  PJA-INDPRTJA              PIC 9  VALUE ZERO.                 0000000
008810 01  NBR-PRET-ACM              PIC 9  VALUE ZERO.                 0000000
008820 01  EXIST-INDEX               PIC 9  VALUE ZERO.                 0000000
008830 01  EXIST-OBJET-PRT           PIC 9  VALUE ZERO.                 0000000
008840 01  EXIST-CPL-EIG             PIC 9  VALUE ZERO.                 0000000
008850*                                                                 0000000
008860*****                                                             0000000
008870 77  Z-TOTINTER-PC             PIC 9(15)V99 COMP-3.               0000000
008880 77  Z-TOTCOUT                 PIC 9(15)V99 COMP-3.               0000000
008890 77  Z-TOTCOUT-FA              PIC 9(15)V99 COMP-3.               0000000
008900 77  Z-MFRGARAN                PIC 9(15)V99 COMP-3.               0000000
008910 77  Z-PARSOCIA                PIC 9(15)V99 COMP-3.               0000000
008920 77  W-PARSOC9                 PIC 9(5)V99  COMP-3.               0000000
008930 77  Z-NBPS                    PIC 9(03).                         0000000
008940 77  Z-TXGARAN                 PIC 99V999  COMP-3.                0000000
008950 77  Z-TXCOTOCM                PIC 99V999  COMP-3.                0000000
008960 77  Z-TXCOMMIS                PIC 99V999  COMP-3.                0000000
008970 77  Z-DURTOTAL                PIC 9(3)    COMP-3.                0000000
008980 77  Z-DURFRANC                PIC 9(3)    COMP-3.                0000000
008990 77  Z-DURAMORT                PIC 9(3)    COMP-3.                0000000
009000 77  Z-DURAMOR2                PIC 9(3)    COMP-3.                0000000
009010 77  Z-DURAMOR1                PIC 9(3)    COMP-3.                0000000
009020 77  Z-DURB-RECTIF             PIC 9(3)    COMP-3.                0000000
009030 77  Z-PER                     PIC 99.                            0000000
009040 77  Z-PER-9                   PIC 9.                             0000000
009050 77  Z-RESTE                   PIC 9(3)    COMP-3.                0000000
009060 77  Z-DIVIDENDE               PIC 9(3)    COMP-3.                0000000
009070 77  Z-NBTERME                 PIC 9(3)    COMP-3.                0000000
009080 77  Z-NBTERME1                PIC 9(3)    COMP-3.                0000000
009090 77  Z-NBTERME2                PIC 9(3)    COMP-3.                0000000
009100 77  W-MTTERME1                PIC S9(11)V99 COMP-3.              0000000
009110 77  W-MTTERME2                PIC S9(11)V99 COMP-3.              0000000
009120 77  Z-NBTERM                  PIC 9(3)    COMP-3.                0000000
009130 77  Z-NBTERM-FR               PIC 9(3)    COMP-3.                0000000
009140 77  Z-NBPALIER                PIC 9(3)    COMP-3.                0000000
009150 77  Z-NBMOIS                  PIC 9(3)    COMP-3.                0000000
009160 01  Z-NUMCLAUP                PIC 999.                           0000000
009170 77  PARAM-CODGAR              PIC X(2).                          0000000
009180                                                                  0000000
009190 77  Z-TOTAL-HYPOTHETIQUE      PIC  9(15)V99 COMP-3.              0000000
009200 77  Z-SUPP-CAPITAL            PIC  9(15)V99 COMP-3.              0000000
009210*77  Z-SUPP-ASSU               PIC  9(15)V99 COMP-3.              0000000
009220 77  Z-MTCRED                  PIC  9(15)V99.                     0000000
009230 01  W-say-mtcred              PIC  9(15)V99.                     0000000
009240 01  Z-TYPINS.                                                    0000000
009250     05  FILLER                PIC X.                             0000000
009260     05  Z-INDINSCR            PIC X.                             0000000
009270 77  Z-RANG                    PIC XX.                            0000000
009280 77  Z-LIBRANG                 PIC X(10).                         0000000
009290 77  TROUVE                    PIC X(01).                         0000000
009300 77  W-CAURAISO                PIC X(48).                         0000000
009310 77  W-DESTTYP                 PIC X(03).                         0000000
009320 77  W-NO-ORDRE                PIC 9(03).                         0000000
009330                                                                  0000000
009340 01  W-NOTAIRE-TROUVE          PIC X.                             0000000
009350     88 NOTAIRE-NON-TROUVE     VALUE 'N'.                         0000000
009360     88 NOTAIRE-TROUVE         VALUE 'O'.                         0000000
009370*                                                                 0000000
009380*---          COMPTEURS DU RAPPORT D'ACTIVITE                     0000000
009390 77  CPT-FACT                  PIC  9(8) COMP VALUE ZERO.         0000000
009400 77  CPT-ANOM                  PIC  9(8) COMP VALUE ZERO.         0000000
009410 77  CPT-EDIT                  PIC  9(8) COMP VALUE ZERO.         0000000
009420 77  CPT-RECYC                 PIC  9(8) COMP VALUE ZERO.         0000000
009430 77  CPT-FMVT                  PIC  9(8) COMP VALUE ZERO.         0000000
009440 77  CPT-IPPMA2                PIC  9(8) COMP VALUE ZERO.         0000000
009450 77  CPT-IPPCPL                PIC  9(8) COMP VALUE ZERO.         0000000
009460 77  TOT-CPT1                  PIC  9(8) COMP VALUE ZERO.         0000000
009470 77  TOT-CPT2                  PIC  9(8) COMP VALUE ZERO.         0000000
009480 77  TOT-CPT3                  PIC  9(8) COMP VALUE ZERO.         0000000
009490 77  CPT-APPEL                 PIC  9(9) COMP VALUE ZERO.         0000000
009500 77  CPT-PRETDEV               PIC  9(9) COMP VALUE ZERO.         0000000
009510 77  CPT-PRETEUR               PIC  9(9) COMP VALUE ZERO.         0000000
009520 77  CPT-EVT                   PIC  9(9) COMP VALUE ZERO.         0000000
009530 77  CPT-AVENANT               PIC  9(9) COMP VALUE ZERO.         0000000
009540 77  CPT-AVENANT-ptz           PIC  9(9) COMP VALUE ZERO.         0000000
009550 77  NB-ENREG-EDITION          PIC Z(8)9.                         0000000
009560 77  CPT-DISP1                 PIC Z(8)9.                         0000000
009570 77  CPT-DISP2                 PIC Z(8)9.                         0000000
009580 77  CPT-DISP3                 PIC Z(8)9.                         0000000
009590 01  CPT-IPC                   PIC 9(8).                          0000000
009600 01  CPT-IPI                   PIC 9(8).                          0000000
009610 01  CPT-IPP                   PIC 9(8).                          0000000
009620 01  CPT-IPXMAJ-ECRITS         PIC 9(8).                          0000000
009630 77  NOMBRE-ANOMALIE           PIC 9(5)  COMP-3.                  0000000
009640*      ****   LIBELLES DEVISES ETRANGERES  ****                   0000000
009650*      SI AJOUT DEVISE --------->     VOIR AUSSI ZPRTLETT         0000000
009660 01  LIB1-CHF    PIC X(30)                                        0000000
009670                 VALUE 'FRANCS SUISSES                '.          0000000
009680 01  LIB1-CHF-AL PIC X(30)                                        0000000
009690                 VALUE 'SCHWEIZER FRANK               '.          0000000
009700 01  LIB1-DEM    PIC X(30)                                        0000000
009710                 VALUE 'DEUTSCHE MARK                 '.          0000000
009720 01  LIB1-EUR    PIC X(30)                                        0000000
009730                 VALUE 'EUROS                         '.          0000000
009740 01  LIB1-USD    PIC X(30)                                        0000000
009750                 VALUE 'DOLLARS                       '.          0000000
009760 01  LIB1-JPY    PIC X(30)                                        0000000
009770                 VALUE 'YENS                          '.          0000000
009780 01  W-GAR-DEVISE  PIC XXX  VALUE  SPACE.                         0000000
009790                                                                  0000000
009800*                                                                 0000000
009810*  CONSTANTE (PAR SYSIN)                                          0000000
009820 01  CST.                                                         0000000
009830     02  CST-PGM      PIC X(8).                                   0000000
009840     02  FILLER       PIC X.                                      0000000
009850*                                                                 0000000
009860     02  CST-TRAIT    PIC X(4).                                   0000000
009870         88  TRAIT-PASSAGE-OK      VALUE 'JOUR' 'NUIT'.           0000000
009880         88  PASSAGE-JOUR          VALUE 'JOUR'.                  0000000
009890         88  PASSAGE-NUIT          VALUE 'NUIT'.                  0000000
009900     02  CST-TESTI    PIC X(3).                                   0000000
009910         88  EDIT-INDEX            VALUE 'OUI'.                   0000000
009920         88  EDIT-TEST             VALUE 'TES'.                   0000000
009930*VFI - R40388 - 18/03/2011 - DEB                                  0000000
009940*    02  CST-MAIL     PIC X(20).                                  0000000
009950     02  CST-MAIL     PIC X(60).                                  0000000
009960*VFI - R40388 - 18/03/2011 - FIN                                  0000000
009970                                                                  0000000
009980*                                                                 0000000
009990*** ATTENTION : on est oblig de conserver TFM-MOIS car on ne     0000000
010000***             prend pas en compte les annes.                   0000000
010010 01  FIN-MOIS.                                                    0000000
010020     05  FINMOIS PIC X(24)                                        0000000
010030          VALUE '312831303130313130313031'.                       0000000
010040 01  TFIN-MOIS REDEFINES FIN-MOIS.                                0000000
010050     05  TFM-JOUR  PIC XX OCCURS 12.                              0000000
010060*                                                                 0000000
010070 01  W-JTERME-S.                                                  0000000
010080     05  W-JTERME-S-M1.                                           0000000
010090         10  W-JTERME-S-M1-JJ    PIC XX.                          0000000
010100         10  W-JTERME-S-M1-S     PIC X.                           0000000
010110         10  W-JTERME-S-M1-MM    PIC XX.                          0000000
010120     05  W-JTERME-S-S1           PIC XXX.                         0000000
010130     05  W-JTERME-S-M2.                                           0000000
010140         10  W-JTERME-S-M2-JJ    PIC XX.                          0000000
010150         10  W-JTERME-S-M2-S     PIC X.                           0000000
010160         10  W-JTERME-S-M2-MM    PIC XX.                          0000000
010170 01  W-JTERME-T.                                                  0000000
010180     05  W-JTERME-T-M1.                                           0000000
010190         10  W-JTERME-T-M1-JJ    PIC XX.                          0000000
010200         10  W-JTERME-T-M1-S     PIC X.                           0000000
010210         10  W-JTERME-T-M1-MM    PIC XX.                          0000000
010220     05  W-JTERME-T-S1           PIC XXX.                         0000000
010230     05  W-JTERME-T-M2.                                           0000000
010240         10  W-JTERME-T-M2-JJ    PIC XX.                          0000000
010250         10  W-JTERME-T-M2-S     PIC X.                           0000000
010260         10  W-JTERME-T-M2-MM    PIC XX.                          0000000
010270     05  W-JTERME-T-S2           PIC XXX.                         0000000
010280     05  W-JTERME-T-M3.                                           0000000
010290         10  W-JTERME-T-M3-JJ    PIC XX.                          0000000
010300         10  W-JTERME-T-M3-S     PIC X.                           0000000
010310         10  W-JTERME-T-M3-MM    PIC XX.                          0000000
010320     05  W-JTERME-T-S3           PIC XXX.                         0000000
010330     05  W-JTERME-T-M4.                                           0000000
010340         10  W-JTERME-T-M4-JJ    PIC XX.                          0000000
010350         10  W-JTERME-T-M4-S     PIC X.                           0000000
010360         10  W-JTERME-T-M4-MM    PIC XX.                          0000000
010370 01  PLF-PLANTCRE.                                                0000000
010380     05  PLF-PLANTCRE9        PIC 9(13)V99 COMP-3.                0000000
010390 01  PLF-PLANPERS.                                                0000000
010400     05  PLF-PLANPERS9        PIC 9(13)V99 COMP-3.                0000000
010410 01  PLF-PLANTMOY.                                                0000000
010420     05  PLF-PLANTMOY9        PIC 9(13)V99 COMP-3.                0000000
010430*                                                                 0000000
010440 01  DINDEX-10                   PIC X(10).                       0000000
010450 01  PRTINDXX.                                                    0000000
010460     02  PRTINDXX-CLE.                                            0000000
010470         05  PRTINDXX-NUMINDEX   PIC XXX.                         0000000
010480         05  PRTINDXX-COND       PIC XX.                          0000000
010490     02  PRTINDXX-DEBEFF         PIC X(8).                        0000000
010500     02  PRTINDXX-FINEFF         PIC X(8).                        0000000
010510     02  PRTINDXX-NUMINDEX-IPP   PIC X(4).                        0000000
010520         88  COND-PRTIND-IPP  VALUE  '1999'  '9999'.              0000000
010530     02  PRTINDXX-NOMINDEX15-IPX PIC X(15).                       0000000
010540     02  PRTINDXX-NUMINDEX-IPI   PIC X(4).                        0000000
010550         88  COND-PRTIND-IPI  VALUE  '1999'  '9999'.              0000000
010560     02  PRTINDXX-NUMINDEX-IPC   PIC X(4).                        0000000
010570         88  COND-PRTIND-IPC  VALUE  '1999'  '9999'.              0000000
010580*                                                                 0000000
010590 01  PRTIND02.                                                    0000000
010600     02  PRTIND02-COND          PIC XX.                           0000000
010610     02  PRTIND02-TMIN          PIC S9(2)V999  COMP-3.            0000000
010620     02  PRTIND02-TMAX          PIC S9(2)V999  COMP-3.            0000000
010630 01  W-PRTIND02-TMIN          PIC S9(2)V999  COMP-3.              0000000
010640 01  W-PRTIND02-TMAX          PIC S9(2)V999  COMP-3.              0000000
010650*                                                                 0000000
010660 01  WS-EMP1NOM                PIC X(60).                         0000000
010670 01  WS-EMP1PROF               PIC X(30)    VALUE SPACE.          0000000
010680 01  WS-EMP2PROF               PIC X(30)    VALUE SPACE.          0000000
010690 01  WS-CAU1PROF               PIC X(30)    VALUE SPACE.          0000000
010700 01  WS-CAU2PROF               PIC X(30)    VALUE SPACE.          0000000
010710 01  W-CAUADR1                 PIC X(30).                         0000000
010720 01  W-CAUADRC                 PIC X(30).                         0000000
010730 01  W-CAULOC                  PIC X(30).                         0000000
010740                                                                  0000000
010750*                                                                 0000000
010760 01  W-LSBONIF.                                                   0000000
010770     05  W-BONIF               PIC X(5).                          0000000
010780         88  W-BONIF-OK1       VALUE   'PB011'                    0000000
010790                                       'PB012'                    0000000
010800                                       'PB013'.                   0000000
010810         88  W-BONIF-OK2       VALUE   'PB021'                    0000000
010820                                       'PB022'                    0000000
010830                                       'PB023'.                   0000000
010840     05  FILLER                PIC X(10).                         0000000
010850*                                                                 0000000
010860 01  TRAV-POSTE             PIC X(09).                            0000000
010870 01  TABLE-DESTINATAIRES.                                         0000000
010880     05  POSTE-DEST OCCURS 52.                                    0000000
010890         10  D-DESTTYP PIC X(03).                                 0000000
010900         10  D-DESTNUM.                                           0000000
010910             15  D-PRETNUM  PIC 9(02).                            0000000
010920             15  D-GARNUM   PIC 9(02).                            0000000
010930             15  D-INDEX    PIC 9(02).                            0000000
010940                                                                  0000000
010950                                                                  0000000
010960*           CLAUSIER EDITION                                      0000000
010970 01  CLAUSIER-VARTAUX.                                            0000000
010980     05  TAB-VARTAUX                OCCURS 10.                    0000000
010990       07  D-VARTAUX-TOUT.                                        0000000
011000         10  D-VARTAUX       PIC 9(04).                           0000000
011010         10  D-VARTAUX-PRET  PIC 9(02).                           0000000
011020                                                                  0000000
011030*           CLAUSIER DES AUTRES CLAUSES . EDITION                 0000000
011040 01  CLAUSIER-AUTRES.                                             0000000
011050     05  TAB-AUTRES                 OCCURS 20.                    0000000
011060       07  D-AUTRES-TOUT.                                         0000000
011070         10  D-AUTRES        PIC 9(04).                           0000000
011080         10  D-AUTRES-PRET   PIC 9(02).                           0000000
011090                                                                  0000000
011100 01  W-TOUT  PIC X(6).                                            0000000
011110*                                                                 0000000
011120 01  CLAUSIER-TYPGAR.                                             0000000
011130     05  TAB-TYPGAR.                                              0000000
011140         10  D-GARCLAU      PIC X(01) OCCURS 35.                  0000000
011150                                                                  0000000
011160*                   nbpret                                        0000000
011170 01  TAB-FEEDBACK.                                                0000000
011180     05  FEEDBACK-PRET                OCCURS 4.                   0000000
011190****     08.02.90                                                 0000000
011200         10  FEED-CAT        PIC XX.                              0000000
011210         10  FEED-MONTANT    PIC 9(13).                           0000000
011220         10  FEED-DATECH     PIC 9(08).                           0000000
011230         10  FEED-DEVISE     PIC XXX.                             0000000
011240         10  FEEDBACK-PRET-GAR            OCCURS 8.               0000000
011250             15  FEED-RED        PIC X(1).                        0000000
011260             15  FEED-GAR        PIC X(1).                        0000000
011270             15  FEED-HYPO       PIC X(1).                        0000000
011280     05  FEED-DATSIGN.                                            0000000
011290         10  FEED-DATSIGJJ       PIC 9(02).                       0000000
011300         10  FEED-DATSIGMM       PIC 9(02).                       0000000
011310         10  FEED-DATSIG19       PIC 9(02).                       0000000
011320         10  FEED-DATSIGAA       PIC 9(02).                       0000000
011330*                                                                 0000000
011340 01  DPROEC.                                                      0000000
011350     05  DPROEC1                 PIC X(08).                       0000000
011360 01  DPROEC9 REDEFINES DPROEC    PIC 9(08).                       0000000
011370 01  DATFIN.                                                      0000000
011380     05  DATFIN-AAAA             PIC X(04).                       0000000
011390     05  DATFIN-MM               PIC X(02).                       0000000
011400     05  DATFIN-JJ               PIC X(02).                       0000000
011410 01  W-DATFIN.                                                    0000000
011420     05 W-DATFIN-AAAA             PIC X(04).                      0000000
011430     05 W-DATFIN-MM               PIC X(02).                      0000000
011440     05 W-DATFIN-JJ               PIC X(02).                      0000000
011450 01  W-DATDEB.                                                    0000000
011460     05 W-DATDEB-AAAA             PIC X(04).                      0000000
011470     05 W-DATDEB-MM               PIC X(02).                      0000000
011480     05 W-DATDEB-JJ               PIC X(02).                      0000000
011490 77  ZNBR                        PIC S9(8)   COMP.                0000000
011500 77  NB-MOIS-FRANCHISE           PIC S9(4)   COMP.                0000000
011510 77  DURAM1                      PIC S9(3) COMP-3.                0000000
011520 77  PER                         PIC 9.                           0000000
011530 77  NB                          PIC S9(8) COMP.                  0000000
011540*                                                                 0000000
011550 01  APPEL.                                                       0000000
011560     05  APPEL-PREFIX          PIC X(21).                         0000000
011570     05  APPEL-CAT             PIC X(02).                         0000000
011580     05  APPEL-PREFIX2         PIC X(02).                         0000000
011590     05  APPEL-COMMUN.                                            0000000
011600         10 APPEL-IDENT        PIC X(35).                         0000000
011610         10 APPEL-CLE.                                            0000000
011620            15 APPEL-FEDECAIS.                                    0000000
011630               20 APPEL-FED    PIC X(2).                          0000000
011640                  88  STRBG      VALUE '11'.                      0000000
011650                  88  LAVAL      VALUE '14'.                      0000000
011660                  88  LILLE      VALUE '17'.                      0000000
011670                  88  PARIS      VALUE '19'.                      0000000
011680                  88  FAG        VALUE '20'.                      0000000
011690                  88  MARSEILLE  VALUE '21'.                      0000000
011700                  88  ANNECY     VALUE '33'.                      0000000
011710                  88  CICP       VALUE '47'.                      0000000
011720                  88  CIC-ROUEN  VALUE '48'.                      0000000
011730                  88  CIC        VALUE '47' '48'.                 0000000
011740               20 APPEL-CAI    PIC X(5).                          0000000
011750            15 APPEL-RAC       PIC X(6).                          0000000
011760            15 APPEL-DOS       PIC X(3).                          0000000
011770         10 APPEL-LIBRE1       PIC X(15).                         0000000
011780         10 APPEL-APPLI        PIC X(03).                         0000000
011790         10 APPEL-JOUR         PIC X.                             0000000
011800*           APPEL-JOUR  = 'O'   SI RECYCLAGE DU TRAITEMENT "JOUR".0000000
011810         10 APPEL-DATE-IP      PIC 9(05).                         0000000
011820         10 APPEL-HEURE-IP     PIC 9(08).                         0000000
011830         10 APPEL-DR           PIC X.                             0000000
011840         10 APPEL-NBJ          PIC 9.                             0000000
011850         10 APPEL-ROUT.                                           0000000
011860            12 APPEL-ROUTAGE      PIC X(05).                      0000000
011870            12 APPEL-ROUT-FILL    PIC X(03).                      0000000
011880         10 APPEL-USER50       PIC X(08).                         0000000
011890         10 APPEL-LIBRE        PIC X(02).                         0000000
011900                                                                  0000000
011910 01  SEQ-CAIS.                                                    0000000
011920     05  SEQ-APPEL-FEDE        PIC X(02).                         0000000
011930     05  SEQ-APPEL-CAIS        PIC X(05).                         0000000
011940                                                                  0000000
011950 01  SEQ-ROUT.                                                    0000000
011960     05  SEQ-ROUTAGE           PIC X(08).                         0000000
011970*                                                                 0000000
011980**   FEDE/CAISSE/RACINE/DOSSIER                                   0000000
011990 01  ZREF-FCRD                 PIC X(16).                         0000000
012000 01  W-FCRD                    PIC X(16) Value all '?'.           0000000
012010*                                                                 0000000
012020 01  APPLI-FED                 PIC XX.                            0000000
012030                                                                  0000000
012040 01  W-HEURE-5          PIC X(5)  VALUE SPACE.                    0000000
012050 01  W-HEURE.                                                     0000000
012060     02  W-HH                  PIC XX.                            0000000
012070     02  W-MIN                 PIC XX.                            0000000
012080     02  W-SEC                 PIC XX.                            0000000
012090     02  W-CEN                 PIC XX.                            0000000
012100 01  W-HEURE9 REDEFINES W-HEURE  PIC 9(8).                        0000000
012110*                                                                 0000000
012120 01  WW-SSAAMMJJ.                                                 0000000
012130     02  WW-SS             PIC XX.                                0000000
012140     02  WW-AA2            PIC XX.                                0000000
012150     02  WW-MM             PIC 99.                                0000000
012160     02  WW-JJ             PIC XX.                                0000000
012170*                                                                 0000000
012180 01  W-DATE-SSAAMMJJ.                                             0000000
012190     02  W-DATE-SS             PIC XX.                            0000000
012200     02  W-DATE-AA2            PIC XX.                            0000000
012210     02  W-DATE-MM             PIC XX.                            0000000
012220     02  W-DATE-JJ             PIC XX.                            0000000
012230*                                                                 0000000
012240*                                                                 0000000
012250 01  W-DAT2-SSAAMMJJ.                                             0000000
012260     02  W-DAT2-SS             PIC XX.                            0000000
012270     02  W-DAT2-AA2            PIC XX.                            0000000
012280     02  W-DAT2-MM             PIC XX.                            0000000
012290     02  W-DAT2-JJ             PIC XX.                            0000000
012300*                                                                 0000000
012310*                                                                 0000000
012320 01  DATJOUR.                                                     0000000
012330         10  DATJOUR-AA      PIC 9(4).                            0000000
012340         10  DATJOUR-MM      PIC XX.                              0000000
012350         10  DATJOUR-JJ      PIC XX.                              0000000
012360 01  DATJOURN    REDEFINES    DATJOUR                             0000000
012370                             PIC 9(8).                            0000000
012380 01  HEUJOUR            PIC X(8).                                 0000000
012390 01  HEUJOURN    REDEFINES  HEUJOUR                               0000000
012400                        PIC 9(8).                                 0000000
012410 01  datouv-ptz         PIC x(8).                                 0000000
012420 01  W-DATACCOR         PIC x(8).                                 0000000
012430*                                                                 0000000
012440 01  DATE10.                                                      0000000
012450     05 DATE10-SSAA           PIC 9(4).                           0000000
012460     05 FILLER                PIC X    VALUE '-'.                 0000000
012470     05 DATE10-MM             PIC 9(2).                           0000000
012480     05 FILLER                PIC X    VALUE '-'.                 0000000
012490     05 DATE10-JJ             PIC 9(2).                           0000000
012500*                                                                 0000000
012510*                                                                 0000000
012520 01  DATOUV-SSAAMMJJ.                                             0000000
012530     05  DATOUV-SS             PIC XX.                            0000000
012540     05  DATOUV-AAMMJJ.                                           0000000
012550         10  DATOUV-AA         PIC XX.                            0000000
012560         10  DATOUV-MM         PIC XX.                            0000000
012570         10  DATOUV-JJ         PIC XX.                            0000000
012580*NDE-27/05/2003 - Dbut                                           0000000
012590 01  DATOUV-SSAAQQQ            PIC S9(7) COMP-3.                  0000000
012600 01  DATOUV-SSAAQQQ-D          PIC Z9(7) .                        0000000
012610 01  YACMPSB EXTERNAL.         COPY YACMPSB SUPPRESS.             0000000
012620*NDE-27/05/2003 - Fin                                             0000000
012630*                                                                 0000000
012640 01  TEXTE.                                                       0000000
012650     02  TEXTE-1               PIC X(8).                          0000000
012660     02  TEXTE-2               PIC X(8).                          0000000
012670     02  TEXTE-3               PIC X(8).                          0000000
012680*                                                                 0000000
012690 01  COMPILE-QUAND.                                               0000000
012700     02  COMPILE-DATE          PIC X(8).                          0000000
012710     02  COMPILE-HEURE         PIC X(8).                          0000000
012720**** ANTILLES EXPLE PLAQUE : 324XA972 OU 42AAA972                 0000000
012730 01  W-IMMAT.                                                     0000000
012740     02  W-IMMAT-1             PIC X(5).                          0000000
012750     02  W-IMMAT-2             PIC XXX.                           0000000
012760                                                                  0000000
012770 01  W-IMMAT6.                                                    0000000
012780     02  W-IMMAT6-1             PIC X(6).                         0000000
012790     02  W-IMMAT6-2             PIC XXX.                          0000000
012800                                                                  0000000
012810 01  W-LIB-01-36.                                                 0000000
012820     05  W-LIB-01-05           PIC X(05).                         0000000
012830     05  W-LIB-06-36           PIC X(31).                         0000000
012840 01  W-LIB-BIS      REDEFINES           W-LIB-01-36.              0000000
012850     05  W-LIB-01-04           PIC X(04).                         0000000
012860     05  W-LIB-05-36           PIC X(32).                         0000000
012870 01  W-LIB-TER      REDEFINES           W-LIB-01-36.              0000000
012880     05  W-LIB-01-03           PIC X(03).                         0000000
012890     05  W-LIB-04-36           PIC X(33).                         0000000
012900*                                                                 0000000
012910*     STOCKAGE CODES DERNIERE MISE A JOUR POUR CONTROLE GDP       0000000
012920*                                                                 0000000
012930 01  Z-DCMAJ                   PIC X.                             0000000
012940 01  Z-CMAJ-TAB.                                                  0000000
012950     02  Z-CMAJ   PIC X OCCURS 4.                                 0000000
012960 01  Z-MONT-TAB.                                                  0000000
012970     02  Z-MONT    OCCURS 4.                                      0000000
012980         03  Z-MONTANT          PIC 9(15)V99.                     0000000
012990         03  Z-TERME            PIC 9(15)V99.                     0000000
013000         03  Z-TAUDB            PIC 99V9(5).                      0000000
013010         03  Z-DURAM            PIC 999.                          0000000
013020         03  Z-CODRET           PIC X.                            0000000
013030                                                                  0000000
013040 01  Z-DOMICIL-TAB.                                               0000000
013050     02  Z-DOMICIL OCCURS 4.                                      0000000
013060         03  Z-DOMICIL-APBR     PIC X(5).                         0000000
013070         03  Z-DOMICIL-CAISSE   PIC X(5).                         0000000
013080         03  Z-DOMICIL-ZERO     PIC X(3).                         0000000
013090         03  Z-DOMICIL-RACINE   PIC X(6).                         0000000
013100         03  Z-DOMICIL-CAT      PIC XX.                           0000000
013110         03  Z-DOMICIL-CLE      PIC XX.                           0000000
013120   01  Z-ASVI-X.                                                  0000000
013130       02  Z-ASVI   OCCURS  4.                                    0000000
013140             05  Z-ASVI-1   PIC X.                                0000000
013150             05  Z-ASVI-2   PIC X.                                0000000
013160                                                                  0000000
013170*                                                                 0000000
013180*     ZONES PROVENANT DE L'APPEL DU TABLEAU D'AMORTISSEMENT       0000000
013190*                                                                 0000000
013200 01  SAI-TRAVAIL.                                                 0000000
013210     02  SAI-NPER              PIC 999      COMP-3.               0000000
013220     02  SAI-TABELT.                                              0000000
013230         05  SAI-TAB   OCCURS 20.                                 0000000
013240             10  SAI-TER       PIC S9(15)V99 COMP-3.              0000000
013250             10  SAI-NB        PIC 999      COMP-3.               0000000
013260             10  SAI-TAUX      PIC 99V9(8)  COMP-3.               0000000
013270**** IPI                                                          0000000
013280             10  SAI-PR        PIC 999V9(8) COMP-3.               0000000
013290     02  SAI-TINT              PIC S9(15)V99 COMP-3.              0000000
013300     02  SAI-TINT1             PIC S9(15)V99 COMP-3.              0000000
013310     02  SAI-TCOM              PIC 99V999   COMP-3.               0000000
013320     02  SAI-TPS               PIC 99V999.                        0000000
013330     02  SAI-TFRAUT            PIC 99V999   COMP-3.               0000000
013340     02  SAI-TFRH              PIC 99V999   COMP-3.               0000000
013350     02  SAI-MTASS             PIC 9(5)V99  COMP-3.               0000000
013360     02  SAI-TCAS              PIC 99V999   COMP-3.               0000000
013370     02  SAI-TEFF              PIC 99V999   COMP-3.               0000000
013380     02  SAI-TEGL              PIC 99V999   COMP-3.               0000000
013390**** IPI                                                          0000000
013400     02  SAI-TEMH              PIC 99V999   COMP-3.               0000000
013410*                                                                 0000000
013420*---TABLE DES SOUS-PROGRAMMES                                     0000000
013430*                                                                 0000000
013440 01  TABPGM.                                                      0000000
013450     02  LEPGM                 PIC X(8)      VALUE 'IPPBATCH'.    0000000
013460     02  ZDAT2000              PIC X(8)      VALUE 'ZDAT2000'.    0000000
013470     02  ZCLOPGM2              PIC X(8)      VALUE 'ZCLOPGM2'.    0000000
013480     02  ZINIPGM2              PIC X(8)      VALUE 'ZINIPGM2'.    0000000
013490     02  PROGSITE              PIC X(8)      VALUE 'ISC    '.    0000000
013500     02  IPPABCPL              PIC X(8)      VALUE 'IPPABCPL'.    0000000
013510     02  IPPGBPR2              PIC X(8)      VALUE 'IPPGBPR2'.    0000000
013520     02  IPPBATC1              PIC X(8)      VALUE 'IPPBATC1'.    0000000
013530     02  IPPALPHA              PIC X(8)      VALUE 'IPPALPHA'.    0000000
013540     02  IDPBOOL0              PIC X(8)      VALUE 'IDPBOOL0'.    0000000
013550     02  FORMJUR2              PIC X(8)      VALUE 'FORMJUR2'.    0000000
013560     02  FORMJURI              PIC X(8)      VALUE 'FORMJURI'.    0000000
013570     02  ZDEPART2              PIC X(8)      VALUE 'ZDEPART2'.    0000000
013580     02  ZPREFEC2              PIC X(8)      VALUE 'ZPREFEC2'.    0000000
013590     02  ZPRTLETT              PIC X(8)      VALUE 'ZPRTLETT'.    0000000
013600     02  ZTAUXLET              PIC X(8)      VALUE 'ZTAUXLET'.    0000000
013610     02  TIEGAPEL              PIC X(8)      VALUE 'TIEGAPEL'.    0000000
013620     02  IPPRBPR2              PIC X(8)      VALUE 'IPPRBPR2'.    0000000
013630     02  IPPRBPR9              PIC X(8)      VALUE 'IPPRBPR9'.    0000000
013640     02  ZCDFBCC               PIC X(8)      VALUE 'ZCDFBCC '.    0000000
013650     02  ZCDFBCCL              PIC X(8)      VALUE 'ZCDFBCCL'.    0000000
013660     02  ZPRTLNK               PIC X(8)      VALUE 'ZPRTLNK '.    0000000
013670     02  EPLRCECH              PIC X(8)      VALUE 'EPLRCECH'.    0000000
013680     02  IPPRCFRA              PIC X(8)      VALUE 'IPPRCFRA'.    0000000
013690     02  ZPRTCOAR              PIC X(8)      VALUE 'ZPRTCOAR'.    0000000
013700     02  IPIRCADR              PIC X(8)      VALUE 'IPIRCADR'.    0000000
013710     02  SBCGAPEL              PIC X(8)      VALUE 'SBCGAPEL'.    0000000
013720     02  ZPRTBARM              PIC X(8)      VALUE 'ZPRTBARM'.    0000000
013730     02  IDPATASS              PIC X(8)      VALUE 'IDPATASS'.    0000000
013740     02  RADSP805              PIC X(8)      VALUE 'RADSP805'.    0000000
013750     02  ZPRTZDA1              PIC X(8)      VALUE 'ZPRTZDA1'.    0000000
013760     02  ZPRTZDA2              PIC X(8)      VALUE 'ZPRTZDA2'.    0000000
013770     02  ZPRTCOND              PIC X(8)      VALUE 'ZPRTCOND'.    0000000
013780     02  PRTZREGT              PIC X(8)      VALUE 'PRTZREGT'.    0000000
013790     02  PRTSDONK              PIC X(8)      VALUE 'PRTSDONK'.    0000000
013800     02  ACCEPTA2              PIC X(8)      VALUE 'ACCEPTA2'.    0000000
013810     02  IPIOBJFI              PIC X(8)      VALUE 'IPIOBJFI'.    0000000
013820     02  IPIOBJAL              PIC X(8)      VALUE 'IPIOBJAL'.    0000000
013830     02  ZMVPXSPR              PIC X(8)      VALUE 'ZMVPXSPR'.    0000000
013840     02  ZITFTAU               PIC X(8)      VALUE 'ZITFTAU '.    0000000
013850     02  UNDELETE              PIC X(8)      VALUE 'UNDELETE'.    0000000
013860     02  ZCLERIB               PIC X(8)      VALUE 'ZCLERIB '.    0000000
013870     02  IPXZPROD              PIC X(8)      VALUE 'IPXZPROD'.    0000000
013880     02  ZPRT360J              PIC X(8)      VALUE 'ZPRT360J'.    0000000
013890     02  ZORGFBC               PIC X(8)      VALUE 'ZORGFBC '.    0000000
013900     02  IPXZROUT              PIC X(8)      VALUE 'IPXZROUT'.    0000000
013910     02  IPXZSPRE              PIC X(8)      VALUE 'IPXZSPRE'.    0000000
013920     02  ZCDCREC               PIC X(8)      VALUE 'ZCDCREC '.    0000000
013930     02  ZPRTTIMB              PIC X(8)      VALUE 'ZPRTTIMB'.    0000000
013940     02  ZPRTTAUN              PIC X(8)      VALUE 'ZPRTTAUN'.    0000000
013950     02  APRGAPEL              PIC X(8)      VALUE 'APRGAPEL'.    0000000
013960     02  IPXZCALY              PIC X(8)      VALUE 'IPXZCALY'.    0000000
013970     02  IPXZMA2G              PIC X(8)      VALUE 'IPXZMA2G'.    0000000
013980     02  IPXZGAR3              PIC X(8)      VALUE 'IPXZGAR3'.    0000000
013990     02  IPXM0003              PIC X(8)      VALUE 'IPXM0003'.    0000000
014000     02  IPXZAPPP              PIC X(8)      VALUE 'IPXZAPPP'.    0000000
014010     02  ZPSOVAL               PIC X(8)      VALUE 'ZPSOVAL '.    0000000
014020     02  IPXZMAIL              PIC X(8)      VALUE 'IPXZMAIL'.    0000000
014030     02  IPXZADLG              PIC X(8)      VALUE 'IPXZADLG'.    0000000
014040     02  CLOPGES               PIC X(8)      VALUE 'CLOPGES '.    0000000
014050     02  AUCZGESP              PIC X(8)      VALUE 'AUCZGESP'.    0000000
014060     02  ZPARAPEL              PIC X(8)      VALUE 'ZPARAPEL'.    0000000
014070     02  IPXZ0020              PIC X(8)      VALUE 'IPXZ0020'.    0000000
014080     02  IPXZLCHA              PIC X(8)      VALUE 'IPXZLCHA'.    0000000
014090     02  ICHPPRT               PIC X(8)      VALUE 'ICHPPRT '.    0000000
014100     02  IDHGAPEL              PIC X(8)      VALUE 'IDHGAPEL'.    0000000
014110     02  IDPSEPVA              PIC X(8)      VALUE 'IDPSEPVA'.    0000000
014120                                                                  0000000
014130*                                                                 0000000
014140 01  ZPRTTAUN-PARMS.                                              0000000
014150     02  ZT-CAPI      PIC S9(12)V9(3) COMP-3.                     0000000
014160     02  ZT-PERIO     PIC 99.                                     0000000
014170       88  PERIODICITE-VALIDE VALUE 1 , 2 , 3 , 4 , 6 , 12.       0000000
014180     02  ZT-DURAM     PIC 9(5)        COMP-3.                     0000000
014190     02  ZT-TERME     PIC S9(12)V9(3) COMP-3.                     0000000
014200     02  ZT-TAUX      PIC S9(3)V9(8)  COMP-3.                     0000000
014210     02  ZT-NBDEC     PIC X.                                      0000000
014220*                                                                 0000000
014230 01  IDPSEPVA-LNG        PIC 9(4) COMP.                           0000000
014240 01  IDPSEPVA-POS        PIC 9(4) COMP.                           0000000
014250 01  IDPSEPVA-NBR        PIC 9(4) COMP.                           0000000
014260 01  IDPSEPVA-RET        PIC 9(2).                                0000000
014270*                                                                 0000000
014280*                                                                 0000000
014290 01  BIDON1   PIC  X(16322).                                      0000000
014300 01  PRTSMP.  COPY YPRTSMP SUPPRESS.                              0000000
014310 01  IPXCAL.  COPY YIPXCAL SUPPRESS.                              0000000
014320 01  IPXCA5.  COPY YIPXCA5 SUPPRESS.                              0000000
014330 01  IPXFAL.  COPY YIPXFAL SUPPRESS.                              0000000
014340 01  IPXFRE.  COPY YIPXFRE SUPPRESS.                              0000000
014350 01  IPXESM.  COPY YIPXESM SUPPRESS.                              0000000
014360 01  IPXFAL1. COPY YIPXFAL1 SUPPRESS.                             0000000
014370 01  IPXFRE1. COPY YIPXFRE1 SUPPRESS.                             0000000
014380 01  IPXESM1. COPY YIPXESM1 SUPPRESS.                             0000000
014390 01  GAR32C.  COPY YGAR32C  SUPPRESS.                             0000000
014400 01  GARNAG.  COPY YGARNAG  SUPPRESS.                             0000000
014410 01  PSOVAL.  COPY YPSOVAL  SUPPRESS.                             0000000
014420 01  ICHCOM.  COPY YICHCOM  SUPPRESS.                             0000000
014430 01  ICHPRT.  COPY YICHPRT  SUPPRESS.                             0000000
014440 01  IDHFRE.  COPY YIDHFRE  SUPPRESS.                             0000000
014450 01  IDHFAL.  COPY YIDHFAL  SUPPRESS.                             0000000
014460 01  IDHESG.  COPY YIDHESG  SUPPRESS.                             0000000
014470*                                                                 0000000
014480 01  W-ALTPCB    PIC X(32)  VALUE SPACE.                          0000000
014490                                                                  0000000
014500 01  PARAM-ZMVPXSPR.                                              0000000
014510     05  ZMVPXSPR-TYPE      PIC X.                                0000000
014520     05  ZMVPXSPR-CODRET    PIC XX.                               0000000
014530     05  ZMVPXSPR-ENRCLE    PIC X(48).                            0000000
014540     05  ZMVPXSPR-SC        PIC X(02).                            0000000
014550     05  ZMVPXSPR-FILLER    PIC X(47).                            0000000
014560                                                                  0000000
014570 01  W-TIT11            pic xx.                                   0000000
014580 01  W-TIT.                                                       0000000
014590     02  W-TIT1         PIC X(1)  VALUE '0'.                      0000000
014600     02  W-TIT2         PIC X(1).                                 0000000
014610                                                                  0000000
014620 01  W-PER              PIC  99.                                  0000000
014630*                                                                 0000000
014640***  W-ADRLIG1 : D1 = Destinataire                                0000000
014650***  W-ADRLIG2 : D2 = Complment destinataire                     0000000
014660***  W-ADRLIG3 : RC = Complment Rue                              0000000
014670***  W-ADRLIG4 : RU = Rue                                         0000000
014680***  W-ADRLIG5 : LC = Localit non distributrice                  0000000
014690***  W-ADRLIG6 : LD = Acheminement                                0000000
014700*                                                                 0000000
014710 01  W-ADRESSE.                                                   0000000
014720     05  W-ADRLIG1        PIC X(32).                              0000000
014730     05  W-ADRLIG2        PIC X(32).                              0000000
014740     05  W-ADRLIG3        PIC X(32).                              0000000
014750     05  W-ADRLIG4        PIC X(32).                              0000000
014760     05  W-ADRLIG5        PIC X(32).                              0000000
014770     05  W-ADRLIG6        PIC X(32).                              0000000
014780                                                                  0000000
014790 01  W-ADRLIG-ACHEMIN.                                            0000000
014800     05  W-ADRLIG-CDPOST  PIC X(05).                              0000000
014810     05  FILLER           PIC X(01).                              0000000
014820     05  W-ADRLIG-BUDIS   PIC X(26).                              0000000
014830 01  W-ADRLIG-TAB-ACHEMIN REDEFINES W-ADRLIG-ACHEMIN.             0000000
014840     05 W-ADRLIG-TABACH   PIC X OCCURS 32.                        0000000
014850 01  TAB-ADRC.                                                    0000000
014860     05  W-ADRC           PIC X OCCURS 10.                        0000000
014870 01  TAB-ADRLOC.                                                  0000000
014880     05  W-ADRLOC         PIC X OCCURS 26.                        0000000
014890                                                                  0000000
014900 01  WADR-BANQUE          PIC X(5).                               0000000
014910 01  WADR-CAISSE          PIC X(5).                               0000000
014920 01  WADR-RACINE9.                                                0000000
014930     05  FILLER           PIC X(3)  VALUE '000'.                  0000000
014940     05  WADR-RACINE6     PIC X(6).                               0000000
014950 01  WADR-TITUL           PIC X(1).                               0000000
014960 01  WADR-ADRESSE.                                                0000000
014970     05  WADR-RUE         PIC X(32).                              0000000
014980     05  WADR-LOC         PIC X(32).                              0000000
014990     05  WADR-CPBUR       PIC X(32).                              0000000
015000*                                                                 0000000
015010***************                                                   0000000
015020*                                                                 0000000
015030 01  ZDEBPGM-DATES-AND-CO.                                        0000000
015040   05  ZDEBPGM-JJMMSSAA.                                          0000000
015050      10  ZDEBPGM-JJ         PIC X(02).                           0000000
015060      10  ZDEBPGM-MM         PIC X(02).                           0000000
015070      10  ZDEBPGM-SSAA       PIC X(04).                           0000000
015080   05  ZDEBPGM-AAAAQQQ       PIC S9(7) COMP-3.                    0000000
015090   05  ZDEBPGM-HHMMSSTH      PIC S9(8) COMP-3.                    0000000
015100   05  ZDEBPGM-CENTRE        PIC X(02).                           0000000
015110   05  ZDEBPGM-NOM           PIC X(04).                           0000000
015120*                                                                 0000000
015130 01  Z-NUM15                   PIC 9(15).                         0000000
015140 01  WORK-AAAAQQQ              PIC S9(7) COMP-3.                  0000000
015150*                                                                 0000000
015160*    ZONE DEBUT DE TRAITEMENT                                     0000000
015170 01  INIPGM.   COPY YINIPGM SUPPRESS.                             0000000
015180*                                                                 0000000
015190*           PARAMETRES POUR MODULES ZDATE                         0000000
015200*                                                                 0000000
015210 01  ZDATE-PARMS.                                                 0000000
015220     05  ZDATE-FORMAT-I        PIC 9(01).                         0000000
015230     05  ZDATE-FORMAT-O        PIC 9(01).                         0000000
015240     05  ZDATE-SEPAR           PIC X(01).                         0000000
015250     05  ZDATE-SIECLE          PIC X(02).                         0000000
015260     05  ZDATE-RETOUR          PIC X(02).                         0000000
015270                                                                  0000000
015280 01  ZDATE-INPUT             PIC S9(5)   COMP-3.                  0000000
015290     88  ZDATE-INPUT-1900       VALUE +50000                      0000000
015300                                THRU  +99999.                     0000000
015310     88  ZDATE-INPUT-2000       VALUE ZERO                        0000000
015320                                THRU  +49999.                     0000000
015330                                                                  0000000
015340 01  ZDATE-OUTPUT.                                                0000000
015350     05  ZDATE-AAAA.                                              0000000
015360         10  ZDATE-AAAA9         PIC 9(4).                        0000000
015370     05  ZDATE-MM            PIC X(2).                            0000000
015380     05  ZDATE-JJ            PIC X(2).                            0000000
015390                                                                  0000000
015400*                                                                 0000000
015410 01  FILLER                  PIC X.                               0000000
015420     88  GAR-TROUVE-1        VALUE '1'.                           0000000
015430     88  GAR-ABS-1           VALUE '0'.                           0000000
015440 01  FILLER                  PIC X.                               0000000
015450     88  GAR-TROUVE-2        VALUE '1'.                           0000000
015460     88  GAR-ABS-2           VALUE '0'.                           0000000
015470                                                                  0000000
015480*                                                                 0000000
015490                                                                  0000000
015500 01  W-CODASS                 PIC X(2).                           0000000
015510                                                                  0000000
015520*              ZONES SSA POUR IPPABMAS ET IPPABCPL                0000000
015530*                                                                 0000000
015540 01  CODOP-SSA-IPPMA2          PIC XX.                            0000000
015550 01  CODOP-SSA-IPPCPL          PIC XX.                            0000000
015560*                                                                 0000000
015570*     PARAMETRES POUR MODULE IPPGBPR2                             0000000
015580*                                                                 0000000
015590 01  GBPR2-ACCES               PIC X(8).                          0000000
015600 01  GBPR2-APPEL               PIC X(4).                          0000000
015610 01  GBPR2-ORIGINE             PIC X(9).                          0000000
015620 01  GBPR2-INTERVENTION        PIC XXX.                           0000000
015630 01  GBPR2-TYPENREG            PIC XXX.                           0000000
015640 01  GBPR2-CLEMIN-IPPMA2       PIC X(16).                         0000000
015650 01  GBPR2-CLEMAX-IPPMA2       PIC X(16).                         0000000
015660 01  GBPR2-CLEMIN-IPPCPL       PIC X(19).                         0000000
015670 01  GBPR2-CLEMAX-IPPCPL       PIC X(19).                         0000000
015680                                                                  0000000
015690*                                                                 0000000
015700 01   ZONE-DOCU.                                                  0000000
015710      05  ZDOCU-DN  OCCURS 150.                                   0000000
015720          10  ZDOCU-DEST       PIC XXX.                           0000000
015730          10  ZDOCU-NOM        PIC X(08).                         0000000
015740***                                                               0000000
015750*     TABLE DES CODES GARANTIES (SPITAB)                          0000000
015760***                                                               0000000
015770 01  IPP11GAR-POSTE.                                              0000000
015780   02  IPP11GAR-POSTE-CLE.                                        0000000
015790     05  CODEGAR-IPP           PIC X(2).                          0000000
015800   02  IPP11GAR-POSTE-DONNEE.                                     0000000
015810     05  CODEGAR-GAR           PIC X(3).                          0000000
015820     05  LIBELLE-IPP           PIC X(80).                         0000000
015830     05  LIBRED-IPP            PIC X(30).                         0000000
015840     05  INDIC-ACTE-NOT        PIC X(3).                          0000000
015850         88  ACTE-NOT     VALUE 'HYP'.                            0000000
015860         88  ACTE-SSP     VALUE 'SSP'.                            0000000
015870     05  INDGAR-IPP            PIC X(2).                          0000000
015880     05  RESERVE-DIDO          PIC X(2).                          0000000
015890     05  INDIC-EDT             PIC X(3).                          0000000
015900     05  RANG-GAR              PIC X(2).                          0000000
015910     05  POURCENT-GAR          PIC X(3).                          0000000
015920     05  DESCRIPTION-OBLIG     PIC X(3).                          0000000
015930     05  MODNAME-GAR           PIC X(8).                          0000000
015940     05  TYPEGAR-GAR           PIC X(2).                          0000000
015950*                                                                 0000000
015960 01  EXIST-PRTSAYG         PIC X.                                 0000000
015970 01  EXIST-PRTSAYGB        PIC X.                                 0000000
015980 01  EXIST-IPPCPL          PIC X.                                 0000000
015990*                                                                 0000000
016000*     PARAMETRES POUR MODULE TIEGAPEL (ACCES BASE TIERS)          0000000
016010*                                                                 0000000
016020 01  W-RACINE9.                                                   0000000
016030     05  FILLER             PIC X(3)  VALUE ZERO.                 0000000
016040     05  W-RACINE6          PIC 9(6).                             0000000
016050                                                                  0000000
016060 01  W-TITUL2.                                                    0000000
016070     05  FILLER             PIC X     VALUE ZERO.                 0000000
016080     05  W-TITUL1           PIC 9.                                0000000
016090                                                                  0000000
016100 77  W-TIERS-pmo                PIC 9(13).                        0000000
016110 77  W-TIERS-pmoX REDEFINES W-TIERS-pmo PIC X(13).                0000000
016120 77  W-TIERS-pmoS9              PIC S9(13).                       0000000
016130                                                                  0000000
016140 77  W-TIERS-phy                   PIC 9(13).                     0000000
016150 77  W-TIERS-phyX REDEFINES W-TIERS-phy PIC X(13).                0000000
016160 77  W-NOM-TIERS-RLP               PIC X(64).                     0000000
016170                                                                  0000000
016180 01  TIEGAPEL-BID1          PIC X.                                0000000
016190 01  TIEGAPEL-BID2          PIC X.                                0000000
016200*                                                                 0000000
016210*     PARAMETRES POUR MODULE FORMJUR2                             0000000
016220*                                                                 0000000
016230 01  FORMJUR2-PARMS.                                              0000000
016240     05  FORMJUR2-LIBELLE          PIC X(20).                     0000000
016250     05  FORMJUR2-SIGLE            PIC X(10).                     0000000
016260*                                                                 0000000
016270*     PARAMETRES POUR MODULE FORMJURI                             0000000
016280*                                                                 0000000
016290 01  FORMJURIX.                                                   0000000
016300     05  FORMJURI-CODE             PIC X(03).                     0000000
016310     05  FORMJURI-PARMS.                                          0000000
016320         10  FORMJURI-CODE-CLI     PIC X(02).                     0000000
016330         10  FORMJURI-SIGLE        PIC X(10).                     0000000
016340         10  FORMJURI-TYPLIEU      PIC X(02).                     0000000
016350         10  FORMJURI-NOMLIEU      PIC X(20).                     0000000
016360         10  FORMJURI-LET-RCS      PIC X(01).                     0000000
016370         10  FORMJURI-TOPCAPIT     PIC X(01).                     0000000
016380         10  FORMJURI-RESERVE      PIC X(11).                     0000000
016390         10  FORMJURI-LIBELLE      PIC X(50).                     0000000
016400*                                                                 0000000
016410*     PARAMETRES POUR MODULE ZDEPART                              0000000
016420*                                                                 0000000
016430 01  ZDEPART-PARMS.                                               0000000
016440     05  ZDEPART-CODE              PIC X(03).                     0000000
016450     05  ZDEPART-LIBELLE           PIC X(27).                     0000000
016460*                                                                 0000000
016470*                                                                 0000000
016480 01  Z-DICO.                                                      0000000
016490     05 Z-DICO-NBR-POSTE PIC 99 VALUE 3.                          0000000
016500     05 Z-DICO-DATA.                                              0000000
016510        10 Z-DICO-01  PIC X(16) VALUE 'D       N0001020'.         0000000
016520        10 Z-DICO-02  PIC X(16) VALUE 'A       N0003010'.         0000000
016530        10 Z-DICO-03  PIC X(16) VALUE 'C       N0004020'.         0000000
016540*                                                                 0000000
016550 01  Z-FORMULE                 PIC X(1024).                       0000000
016560 01  Z-REPONSE                 PIC X(1).                          0000000
016570     88  PAS-DE-REPONSE        VALUE SPACE.                       0000000
016580     88  REGLE-RESPECTEE       VALUE '1'.                         0000000
016590     88  REGLE-NON-RESPECTEE   VALUE '0'.                         0000000
016600*                                                                 0000000
016610*                                                                 0000000
016620*     PARAMETRES POUR MODULE ZPREFEC2 (ACCES TABLE PREFECTURES)   0000000
016630*                                                                 0000000
016640 01  ZPREFECT-CODE             PIC X(3).                          0000000
016650 01  ZPREFECT-PARMS.                                              0000000
016660     02 ZPREFECT-NOM           PIC X(49).                         0000000
016670     02 ZPREFECT-RUE           PIC X(25).                         0000000
016680     02 ZPREFECT-LOCALITE      PIC X(22).                         0000000
016690     02 ZPREFECT-CODE-POSTAL   PIC X(05).                         0000000
016700     02 ZPREFECT-CODE-CEDEX    PIC X(05).                         0000000
016710     02 ZPREFECT-BUREAU-POSTAL PIC X(25).                         0000000
016720     02 ZPREFECT-BOITE-POSTALE PIC X(07).                         0000000
016730     02 ZPREFECT-DUDELA        PIC X(06).                         0000000
016740     02 ZPREFECT-RESERVE       PIC X(03).                         0000000
016750*                                                                 0000000
016760*     PARAMETRES POUR MODULE IPPRBPR2                             0000000
016770*                                                                 0000000
016780 01  IPPMSGX.                                                     0000000
016790     05  IPPMSGX-FED           PIC XX.                            0000000
016800     05  IPPMSGX-BANQUE        PIC X(5).                          0000000
016810     05  IPPMSGX-CAISSE        PIC X(5).                          0000000
016820     05  IPPMSGX-RACINE        PIC X(6).                          0000000
016830     05  IPPMSGX-DOSS          PIC XXX.                           0000000
016840     05  IPPMSGX-CAT           PIC XX.                            0000000
016850 01  EXIST-PRTIDC              PIC X.                             0000000
016860 01  EXIST-PRTDOS              PIC X.                             0000000
016870 01  EXIST-PRTCPT              PIC X.                             0000000
016880 01  IPIOBJFI-RC               PIC 9(4).                          0000000
016890*                                                                 0000000
016900*     PARAMETRES POUR MODULE IPPRCFRA (CALCUL NB DE MOIS DE FRANCH0000000
016910*                                                                 0000000
016920 01  IPPRCFRA-DATDEB           PIC X(8).                          0000000
016930 01  IPPRCFRA-DATFIN           PIC X(8).                          0000000
016940 01  IPPRCFRA-TYPECH           PIC X(2).                          0000000
016950 01  IPPRCFRA-NBRECH           PIC S9(7).                         0000000
016960*                                                                 0000000
016970 01  FIN-DE-FRANCHISE          PIC X(8).                          0000000
016980*                                                                 0000000
016990 01  ZPRTLETT-PARAMS.                                             0000000
017000     03  ZPRTLETT-ENTREES.                                        0000000
017010         05  ZPRTLETT-MONTANT-N  PIC 9(12)V99.                    0000000
017020         05  ZPRTLETT-LONGUEUR   PIC 9(4).                        0000000
017030         05  ZPRTLETT-OPTION     PIC X(1).                        0000000
017040         05  ZPRTLETT-DEVISE     PIC X(3).                        0000000
017050     03  ZPRTLETT-SORTIES.                                        0000000
017060         05  ZPRTLETT-MONTANT-L  PIC X(160).                      0000000
017070         05  ZPRTLETT-CODRET     PIC X(3).                        0000000
017080         05  ZPRTLETT-LIBERR     PIC X(27).                       0000000
017090*                                                                 0000000
017100 01  ZTAUXLET-PARMS.                                              0000000
017110     05  ZTAUXLET-TAUX         PIC 9(3)V9(3).                     0000000
017120     05  ZTAUXLET-NBRDEC       PIC 9(4)  COMP.                    0000000
017130     05  ZTAUXLET-OPTION       PIC 9(4)  COMP.                    0000000
017140     05  ZTAUXLET-LONGUEUR     PIC 9(4)  COMP.                    0000000
017150     05  ZTAUXLET-TEXTE        PIC X(250).                        0000000
017160     05  ZTAUXLET-RETOUR       PIC X(2).                          0000000
017170*                                                                 0000000
017180*     PARAMETRES POUR ZPRTCOAR                                    0000000
017190 01  PRTCOA.  COPY YPRTCOA SUPPRESS.                              0000000
017200 01  IPCOND.  COPY YIPCOND SUPPRESS.                              0000000
017210                                                                  0000000
017220*     PARAMETRES PRTZREGT                                         0000000
017230 01  PRTREG.  COPY YPRTREG SUPPRESS.                              0000000
017240                                                                  0000000
017250 01  PRTBSP.  COPY YPRTBSP SUPPRESS.                              0000000
017260 01  ITFTAU.  COPY YITFTAU SUPPRESS.                              0000000
017270 01  IPXPRO.  COPY YIPXPRO SUPPRESS.                              0000000
017280 01  YIPX020. COPY YIPX020 SUPPRESS.                              0000000
017290                                                                  0000000
017300*    paramtres pour ZORGFBC                                      0000000
017310 01  ORGENT.     COPY YORGENT  SUPPRESS.                          0000000
017320 01  ORGS01.     COPY YORGS01  SUPPRESS.                          0000000
017330 01  ORGS01G.    COPY YORGS01G SUPPRESS.                          0000000
017340 01  ORGS03.     COPY YORGS03  SUPPRESS.                          0000000
017350 01  ORGS03A.    COPY YORGS03A SUPPRESS.                          0000000
017360 01  ORGS04.     COPY YORGS04  SUPPRESS.                          0000000
017370                                                                  0000000
017380*    paramtres pour CLOPGES                                      0000000
017390 01  CLOFAL.                 COPY YCLOFAL SUPPRESS.               0000000
017400 01  CLOFRE.                 COPY YCLOFRE SUPPRESS.               0000000
017410 01  CLOESP.                 COPY YCLOESP SUPPRESS.               0000000
017420                                                                  0000000
017430*    paramtres pour Zcdcrec                                      0000000
017440 01  CDCREC.     COPY YCDCREC  SUPPRESS.                          0000000
017450                                                                  0000000
017460*                                                                 0000000
017470 01  IPXSSP.  COPY YIPXSSP SUPPRESS.                              0000000
017480*                                                                 0000000
017490 01  IPXROU.  COPY YIPXROU SUPPRESS.                              0000000
017500*                                                                 0000000
017510 01  IDXTAU.  COPY YIDXTAU SUPPRESS.                              0000000
017520*                                                                 0000000
017530 01  TRETAU.  COPY YTRETAU SUPPRESS.                              0000000
017540*                                                                 0000000
017550 01  IPPPRD.  COPY YIPPPRD SUPPRESS.                              0000000
017560                                                                  0000000
017570*                                                                 0000000
017580 01  DATS20.  COPY YDATS20  SUPPRESS.                             0000000
017590*     PARAMETRES IPIOCA                                           0000000
017600 01  IPIOCA.  COPY YIPIOCA SUPPRESS.                              0000000
017610*     PARAMETRES IDP11ASS                                         0000000
017620 01  IDPASS.  COPY YIDPASS SUPPRESS.                              0000000
017630*                                                                 0000000
017640*            PARAMETRES POUR IPPBATC1                             0000000
017650*                                                                 0000000
017660 01  FILLER PIC X(32) VALUE '****  ICI STOCKAGE IPPPRI   ****'.   0000000
017670 01  ZONE1-STOCK.                                                 0000000
017680     05  TABL1-STOCK              OCCURS 04.                      0000000
017690         10  IPPPRI-STOCK        PIC X(4000).                     0000000
017700*                                                                 0000000
017710* gar8  gar 8                                                     0000000
017720 01  FILLER PIC X(32) VALUE '****  ICI STOCKAGE IPPEDG  '.        0000000
017730 01  ZONE2-STOCK.                                                 0000000
017740     05  TABL2-STOCK              OCCURS 32.                      0000000
017750         10  IPPEDG-STOCK        PIC X(1651).                     0000000
017760         10  NO-ORDRE-STOCK      PIC 9(3).                        0000000
017770* gar8  gar 8                                                     0000000
017780 01  FILLER PIC X(32) VALUE '****  ICI STOCKAGE CPLEDG   '.       0000000
017790 01  ZONE3-STOCK.                                                 0000000
017800     05  TABL3-STOCK              OCCURS 32.                      0000000
017810         10  CPLEDG-STOCK        PIC X(650).                      0000000
017820         10  VEHDEPT-STOCK       PIC X(3).                        0000000
017830*                                                                 0000000
017840 01  FILLER PIC X(32) VALUE '****  ICI STOCKAGE CLAUSES  ****'.   0000000
017850 01  ZONE4-STOCK.                                                 0000000
017860     05  CLAUSES-STOCK              OCCURS 5.                     0000000
017870*             OCCURENCES 01 - 04 : CLAUSES / PRET                 0000000
017880*             OCCURENCES 05 - 05 : CLAUSES DOSSIER                0000000
017890*    **  INDICATEUR CLAUSES PARTICULIERES                         0000000
017900         10  INDCLAUP-STOCK                 PIC X.                0000000
017910         10  NUMCLAUP-G-STOCK      OCCURS 10.                     0000000
017920             15  NUMCLAUP-X-STOCK.                                0000000
017930                 20  NUMCLAUP-STOCK         PIC 9(4).             0000000
017940*    **  INDICATEUR CLAUSES SPECIALES                             0000000
017950         10  INDCLAUS-STOCK                 PIC X.                0000000
017960         10  NUMCLAUS-STOCK                 PIC 9(4).             0000000
017970         10  CLAUSTLT-STOCK                 PIC X(45).            0000000
017980         10  CLAUS-STOCK                    PIC X(474).           0000000
017990         10  FILLER                         PIC X(6).             0000000
018000*        10  CLAUS-STOCK                    PIC X(480).           0000000
018010*                                                                 0000000
018020 01  FILLER PIC X(32) VALUE '****  ICI STOCKAGE PRTCO4   ****'.   0000000
018030 01  PRTCO41.  COPY YPRTTFAA SUPPRESS.                            0000000
018040 01  PRTCO42.  COPY YPRTTFAB SUPPRESS.                            0000000
018050 01  PRTCO43.  COPY YPRTTFAC SUPPRESS.                            0000000
018060 01  PRTCO44.  COPY YPRTTFAD SUPPRESS.                            0000000
018070*                                                                 0000000
018080 01  FILLER PIC X(32) VALUE '****  ICI STOCKAGE TABAMO PC ***'.   0000000
018090*                                                                 0000000
018100 01  ZONE5-STOCK.                                                 0000000
018110     05  IDPTAM-STOCK             OCCURS 4.                       0000000
018120         10  SAI-NPER-STOCK             PIC 999 COMP-3.           0000000
018130         10  SAI-DATEC-STOCKX.                                    0000000
018140             15  SAI-DATEC-STOCK            PIC 9(8).             0000000
018150         10  SAI-CNAT-STOCK             PIC XXX.                  0000000
018160         10  SAI-TYPB-STOCK             PIC XX.                   0000000
018170         10  SAI-PERFR-STOCK            PIC X.                    0000000
018180*            TABLEAUX D'EDITION                                   0000000
018190 01  FILLER PIC X(32) VALUE '****  ICI RETOUR LIG EDIT.  ****'.   0000000
018200 01  FEDIT-STOCK.                                                 0000000
018210     05  EEDIT-STOCK              OCCURS 200.                     0000000
018220         10  LIG-STOCK                  PIC X(132).               0000000
018230 01  FILLER PIC X(32) VALUE '****  ICI RETOUR ENR. FACT. ****'.   0000000
018240 01  IDPSTA.    COPY YIDPSTA SUPPRESS.                            0000000
018250 01  FILLER PIC X(32) VALUE '****  ICI INDIC. TRAITEMENT ****'.   0000000
018260 01  INDIC-TRAIT.                                                 0000000
018270     05  DIDO-ETAT                PIC X.                          0000000
018280     05  TOP-INTERCALAIRE         PIC X.                          0000000
018290     05  CAI-CPT1                 PIC  9(8) COMP VALUE ZERO.      0000000
018300     05  CAI-CPT2                 PIC  9(8) COMP VALUE ZERO.      0000000
018310     05  CAI-CPT3                 PIC  9(8) COMP VALUE ZERO.      0000000
018320     05  Z-MTOTPRET               PIC 9(15)V99 COMP-3.            0000000
018330     05  Z-TIMB                   PIC 9(5)V99 COMP-3  OCCURS 4.   0000000
018340     05  Z-COMM                   PIC 9(5)V99 COMP-3  OCCURS 4.   0000000
018350     05  NBR-DESTINATAIRES        PIC 9(2).                       0000000
018360     05  NBR-EMPRUNTEURS          PIC 9(2).                       0000000
018370     05  EDITION-GAGE-ONLY        PIC X.                          0000000
018380     05  LABEL-APPLI              PIC XXX.                        0000000
018390     05  CAUTION-PREVUE           PIC X.                          0000000
018400     05  NANTVAL-PREVUE           PIC X.                          0000000
018410     05  WARRANT-PREVUE           PIC X.                          0000000
018420     05  LETEN00-PREVUE           PIC X.                          0000000
018430     05  NANFC00-PREVUE           PIC X.                          0000000
018440     05  NANFA00-PREVUE           PIC X.                          0000000
018450     05  MADELIN-PREVUE           PIC XXXX.                       0000000
018460     05  NANTI67-PREVUE           PIC X.                          0000000
018470     05  CREMO65-PREVUE           PIC X.                          0000000
018480     05  TEG-ASS                  PIC X.                          0000000
018490         88  L-TEG-AVEC-IPC          VALUE  ZERO.                 0000000
018500         88  L-TEG-SANS-IPC          VALUE  '1'.                  0000000
018510     05  MOD-ASS-DOS         PIC X  OCCURS  4.                    0000000
018520     05  CONTRAT-AVENANT         PIC X.                           0000000
018530         88   AVENANT      VALUE '1' '3'.                         0000000
018540         88   CONTRAT      VALUE '0'.                             0000000
018550         88   CONTRAT-GPR  VALUE '2'.                             0000000
018560         88   AVENANT-PTZ  VALUE '3'.                             0000000
018570     05  SL-AUTO                 PIC X.                           0000000
018580         88   SL-AUTO-OK  VALUE '1'.                              0000000
018590         88   SL-AUTO-KO  VALUE ZERO.                             0000000
018600     05  MD-DEVISE               PIC X.                           0000000
018610     05  RIB-PREVU               PIC X.                           0000000
018620     05  GRUND-PREVU             PIC X.                           0000000
018630     05  L-ALLEMANDE             PIC X.                           0000000
018640     05  LEBEN-PREVU             PIC X.                           0000000
018650     05  TODES-PREVU             PIC X.                           0000000
018660     05  SIAGI-PREVU             PIC X.                           0000000
018670     05  PTZ-PREVU               PIC X.                           0000000
018680     05  PPL-PREVU.                                               0000000
018690         07  ppl-prevu9             pic 9.                        0000000
018700     05  PL92-PREVU.                                              0000000
018710         07  pl92-prevu9             pic 9.                       0000000
018720     05  PAS-PREVU               PIC X.                           0000000
018730     05  METEO-PREVU             PIC X.                           0000000
018740     05  GAR-AL-PREVUE       PIC X.                               0000000
018750     05  GAR-E5-PREVUE       PIC X.                               0000000
018760     05  GAR-EA-PREVUE       PIC X.                               0000000
018770     05  GAR-14-PREVUE       PIC X.                               0000000
018780     05  GAR-19-PREVUE       PIC X.                               0000000
018790     05  GAR-EB-PREVUE       PIC X.                               0000000
018800     05  GAR-EC-PREVUE       PIC X.                               0000000
018810     05  GAR-E4-PREVUE       PIC X.                               0000000
018820     05  GAR-EE-PREVUE       PIC X.                               0000000
018830     05  GAR-10-PREVUE       PIC X.                               0000000
018840     05  GAR-50-PREVUE       PIC X.                               0000000
018850     05  GAR-51-PREVUE       PIC X.                               0000000
018860     05  GAR-68-PREVUE       PIC X.                               0000000
018870     05  GAR-95-PREVUE       PIC X.                               0000000
018880     05  GAR-97-PREVUE       PIC X.                               0000000
018890     05  GAR-E7-PREVUE       PIC X.                               0000000
018900     05  GAR-E7-PRET         PIC 99.                              0000000
018910     05  GAR-E7-GAR          PIC 99.                              0000000
018920     05  GAR-E8-PREVUE       PIC X.                               0000000
018930     05  GAR-E8-PRET         PIC 99.                              0000000
018940     05  GAR-E8-GAR          PIC 99.                              0000000
018950     05  GAR-42-PREVUE       PIC X.                               0000000
018960     05  NOTAIRE-PREVUE      PIC X.                               0000000
018970     05  LETAS000-PREVUE     PIC X.                               0000000
018980     05  CREDIPLAN-55        pic x.                               0000000
018990         88  CREDIPLAN-55-KO  VALUE 'N'.                          0000000
019000         88  CREDIPLAN-55-OK  VALUE 'O'.                          0000000
019010     05  GAR-EN-PREVUE       PIC X.                               0000000
019020     05  ASS-DELEG           PIC X  occurs 4.                     0000000
019030     05  GAR-SX-PREVUE       PIC X.                               0000000
019040     05  NAASS000-PREVUE     PIC X.                               0000000
019050     05  CMO-CMA-01          PIC X.                               0000000
019060        88  88-entete-init     value SPACE.                       0000000
019070        88  88-entete-cmo-cma  value 'O' 'A' 'S'.                 0000000
019080        88  88-entete-cmo-c    value 'O'.                         0000000
019090        88  88-entete-cma-c    value 'A'.                         0000000
019100        88  88-entete-cms      value 'S'.                         0000000
019110        88  88-entete          value 'X'.                         0000000
019120                                                                  0000000
019130**** PARAMETRES NECESSAIRES A ZPARAPEL *                          0000000
019140 01  PARFAL.          COPY YPARFAL  SUPPRESS.                     0000000
019150 01  PARFRE.          COPY YPARFRE  SUPPRESS.                     0000000
019160 01  ZPAVAL.          COPY YZPAVAL  SUPPRESS.                     0000000
019170 01  ZPAVRE.          COPY YZPAVRE  SUPPRESS.                     0000000
019180 01  PARFON.          COPY YPARFON  SUPPRESS.                     0000000
019190                                                                  0000000
019200 01  W-ZPAVAL-L1003-COD-TAB      PIC X(8).                        0000000
019210 01  W-ZPAVAL-L1003-CLE-POS-TAB  PIC X(50).                       0000000
019220                                                                  0000000
019230**** IPI                                                          0000000
019240 01  FILLER PIC X(32) VALUE '****  ICI DONNEES PLAN FINCT****'.   0000000
019250 01  DONNEES-PLF.                                                 0000000
019260     05  PLF-PLANNBPR.                                            0000000
019270         10  PLF-PLANNBPR9        PIC 9.                          0000000
019280     05  PLF-PLAN-TABLE           OCCURS 7.                       0000000
019290         10  PLF-PLANLIB          PIC X(30).                      0000000
019300         10  PLF-PLANMONT.                                        0000000
019310             15  PLF-PLANMONT9    PIC 9(9)V99  COMP-3.            0000000
019320         10  PLF-PLANPOUR.                                        0000000
019330             15  PLF-PLANPOUR9    PIC 999V999  COMP-3.            0000000
019340*    FICHIER TRAVAIL DE RANG 3 POUR SPECIF.PC/PALIERS             0000000
019350 01  IPPRGT.      COPY YIPPRGT SUPPRESS.                          0000000
019360 01  FILLER PIC X(32) VALUE '****  ICI STOCKAGE IPPRGT   ****'.   0000000
019370 01  ZONE6-STOCK.                                                 0000000
019380     05  TABL6-STOCK              OCCURS 04.                      0000000
019390         10  IPPRGT-STOCK        PIC X(4000).                     0000000
019400*                                                                 0000000
019410                                                                  0000000
019420*     ***************************************************         0000000
019430*     ***                                             ***         0000000
019440*     ***          C L A U S E S   C O P Y            ***         0000000
019450*     ***                                             ***         0000000
019460*     ***                    E T                      ***         0000000
019470*     ***                                             ***         0000000
019480*     ***            D E S C R I P T I O N            ***         0000000
019490*     ***                                             ***         0000000
019500*     ***               F I C H I E R S               ***         0000000
019510*     ***                                             ***         0000000
019520*     ***************************************************         0000000
019530*                                                                 0000000
019540*    ZONE DE DECLARATION DES CODES OPERATION                      0000000
019550 01  YI00COP.                  COPY YI00COP SUPPRESS.             0000000
019560*    ZONE DE CONTROLE                                             0000000
019570 01  CTL.                      COPY YMSGCTL SUPPRESS.             0000000
019580*    BASE MASTER IPP                                              0000000
019590 01  IPPMA2.                   COPY YIPPMA2 SUPPRESS.             0000000
019600 01  IPPMA2R.                  COPY YIPPMA2R SUPPRESS.            0000000
019610*    BASE COMPLEMENT IPP : CLAUSES SPECIFIQUES ET DONNEES GDP     0000000
019620 01  IPPCPL.                   COPY YIPPCPL SUPPRESS.             0000000
019630 01  IPPCPLB.                  COPY YIPPCPLB SUPPRESS.            0000000
019640 01  IPPCPLR.                  COPY YIPPCPLR SUPPRESS.            0000000
019650 01  IPPCPLE.                  COPY YIPPCPLE SUPPRESS.            0000000
019660 01  IPPCPLO.                  COPY YIPPCPLO SUPPRESS.            0000000
019670*         IMAGE BORDEREAU 800 CARACTERES                          0000000
019680 01  PRTSAY.                   COPY YPRTSAY SUPPRESS.             0000000
019690 01  PRTSAYZ.                  COPY YPRTSAYZ SUPPRESS.            0000000
019700*                                                                 0000000
019710 01  PRTSAYT.                  COPY YPRTSAYT SUPPRESS.            0000000
019720 01  PRTSAYP.                  COPY YPRTSAYP SUPPRESS.            0000000
019730*  date de say en x(8).                                           0000000
019740 01  PRTSA2.                   COPY YPRTSA2 SUPPRESS.             0000000
019750*    FICHIER TEXTE                                                0000000
019760 01  IDPTXT.                   COPY YIDPTXT SUPPRESS.             0000000
019770*    FICHIER TRAVAIL EDITION PRIMAIRE                             0000000
019780 01  IPPPRI.                   COPY YIPPPRI  SUPPRESS.            0000000
019790*    FICHIER TRAVAIL EDITION GARANTIE                             0000000
019800 01  IPPEDG.                  COPY YIPPEDG   SUPPRESS.            0000000
019810*    FICHIER TRAVAIL EDITION CAISSE                               0000000
019820 01  IPPCAI.                   COPY YIPPCAI SUPPRESS.             0000000
019830*         ****    ADRESSE CLIENT D'UNE RACINE                     0000000
019840 01  CLIRAD.                   COPY YCLIRAD suppress.             0000000
019850*         ****   BASE TIERS   ****                                0000000
019860 01  PRTLNK.                   COPY YPRTLNK  SUPPRESS.            0000000
019870 01  TIECOP.                   COPY YTIECOP  SUPPRESS.            0000000
019880 01  TIEFAL.                   COPY YTIEFAL  SUPPRESS.            0000000
019890 01  TIEFRE.                   COPY YTIEFRE  SUPPRESS.            0000000
019900 01  TIEE10.                   COPY YTIEE10  SUPPRESS.            0000000
019910 01  TIES10.                   COPY YTIES10  SUPPRESS.            0000000
019920 01  TIES10A.                  COPY YTIES10A SUPPRESS.            0000000
019930 01  TIEE01.                   COPY YTIEE01  SUPPRESS.            0000000
019940 01  TIES01.                   COPY YTIES01  SUPPRESS.            0000000
019950 01  TIEE03.                   COPY YTIEE03  SUPPRESS.            0000000
019960 01  TIES03.                   COPY YTIES03  SUPPRESS.            0000000
019970 01  TIEVAL.                   COPY YTIEVAL  SUPPRESS.            0000000
019980 01  TIEVAL1.                  COPY YTIEVAl1 SUPPRESS.            0000000
019990 01  TIEVAL2.                  COPY YTIEVAl2 SUPPRESS.            0000000
020000 01  TIECOI.                   COPY YTIECOI  SUPPRESS.            0000000
020010                                                                  0000000
020020 01  PRTCO1.                   COPY YPRTCO1   SUPPRESS.           0000000
020030 01  PRTCO3.                   COPY YPRTCO3   SUPPRESS.           0000000
020040 01  PRTCO4.                   COPY YPRTCO4   SUPPRESS.           0000000
020050                                                                  0000000
020060                                                                  0000000
020070*         ****   BASE PRETS   ****                                0000000
020080 01  PRTIDC.                   COPY YPRTIDC SUPPRESS.             0000000
020090 01  PRTDOS.                   COPY YPRTDOS SUPPRESS.             0000000
020100 01  PRTCPT.                   COPY YPRTCPT SUPPRESS.             0000000
020110 01  PRTCP2.                   COPY YPRTCP2 SUPPRESS.             0000000
020120 01  PRTCPTB.                  COPY YPRTCPTB SUPPRESS.            0000000
020130 01  PRTCP2B.                  COPY YPRTCP2B SUPPRESS.            0000000
020140 01  PRTCTE.                   COPY YPRTCTE SUPPRESS.             0000000
020150*01  SPI-PAR.                  COPY YPARSPI SUPPRESS.             0000000
020160 01  TABAMO.                   COPY YPRTTFA SUPPRESS.             0000000
020170 01  IDPTAM.                   COPY YIDPTAM SUPPRESS.             0000000
020180*    BASE GARANTIES                                               0000000
020190 01  GARFIC.                   COPY YGARFIC SUPPRESS.             0000000
020200*    BASE CONDITIONS                                              0000000
020210 01  CONINT.                   COPY YCONINT  SUPPRESS.            0000000
020220*                                                                 0000000
020230 01 YAUCGSP.                   COPY YAUCGSP SUPPRESS.             0000000
020240*                                                                 0000000
020250 01  SBCFAL.      COPY YSBCFAL  SUPPRESS.                         0000000
020260 01  SBCFRE.      COPY YSBCFRE  SUPPRESS.                         0000000
020270 01  SBCE01.      COPY YSBCE01  SUPPRESS.                         0000000
020280 01  SBCS01.      COPY YSBCS01  SUPPRESS.                         0000000
020290*                                                                 0000000
020300 01  IOPCB-BIDON             PIC X.                               0000000
020310 01  SPIPCB-BIDON            PIC X.                               0000000
020320*                                                                 0000000
020330 01  COND-NUMERO             PIC 9(7).                            0000000
020340*                                                                 0000000
020350 01  PARA-ERR-SBC               PIC X(25).                        0000000
020360*                                                                 0000000
020370*                                                                 0000000
020380*                                                                 0000000
020390 01  LIGNE-A.                                                     0000000
020400     05  LIGNE-A-SAUT            PIC X.                           0000000
020410     05  LIGNE-A-DETAIL          PIC X(079).                      0000000
020420                                                                  0000000
020430 01  LIGNE-ANOM.                                                  0000000
020440     05  LIGNE-ANOM-SAUT         PIC X.                           0000000
020450     05  LIGNE-ANOM-DETAIL.                                       0000000
020460         10  LIG-ANOM-NB         PIC ZZZ.                         0000000
020470         10  LIG-ANOM-BLX        PIC X(01).                       0000000
020480         10  LIG-ANOM-LABEL      PIC XXX.                         0000000
020490         10  LIG-ANOM-BLX        PIC X(01).                       0000000
020500         10  LIG-ANOM-CLE.                                        0000000
020510             15  LIG-ANOM-CAISSE  PIC X(5).                       0000000
020520             15  LIG-ANOM-BLC     PIC X(1).                       0000000
020530             15  LIG-ANOM-RACINE  PIC 9(6).                       0000000
020540         10  LIG-ANOM-BL1        PIC X(01).                       0000000
020550         10  LIG-ANOM-DOSSIER    PIC X(03).                       0000000
020560         10  LIG-ANOM-BL2        PIC X(01).                       0000000
020570         10  LIG-ANOM-CATEGORIE  PIC X(02).                       0000000
020580         10  LIG-ANOM-BL3        PIC X(01).                       0000000
020590         10  LIG-ANOM-TYPE       PIC X(02).                       0000000
020600         10  LIG-ANOM-BL4        PIC X(01).                       0000000
020610         10  LIG-ANOM-TEST       PIC   Z9.                        0000000
020620         10  LIG-ANOM-BL5        PIC X(01).                       0000000
020630         10  LIG-ANOM-MOTIF      PIC X(40).                       0000000
020640 01  LISTE-ANOMALIES.                                             0000000
020650     05  ANOM-01 PIC X(40) VALUE                                  0000000
020660         'rserv  zorgfbc                       '.              0000000
020670     05  ANOM-02 PIC X(40) VALUE                                  0000000
020680         'RACINE NON TROUVEE / FICHIER CLIENT     '.              0000000
020690     05  ANOM-03 PIC X(40) VALUE                                  0000000
020700         'ERREUR LECTURE FICHIER CLIENT           '.              0000000
020710     05  ANOM-04 PIC X(40) VALUE                                  0000000
020720         'CODE TITULAIRE EMPRUNTEUR 1 INVALIDE    '.              0000000
020730     05  ANOM-05 PIC X(40) VALUE                                  0000000
020740         'EMPRUNTEUR 1 NON TROUVE / FICHIER CLIENT'.              0000000
020750     05  ANOM-06 PIC X(40) VALUE                                  0000000
020760         'EMPRUNTEUR 2 NON TROUVE / FICHIER CLIENT'.              0000000
020770     05  ANOM-07 PIC X(40) VALUE                                  0000000
020780         'ERREUR TRAITEMENT OBJET DE FINANCEMENT  '.              0000000
020790     05  ANOM-08 PIC X(40) VALUE                                  0000000
020800         'DOSSIER NON TRAITE - ZONE NON CONFORME  '.              0000000
020810     05  ANOM-09 PIC X(40) VALUE                                  0000000
020820         'ERREUR TRAITEMENT CAPITAL EN LETTRES    '.              0000000
020830     05  ANOM-10 PIC X(40) VALUE                                  0000000
020840         'ERREUR TRAITEMENT TAUX EN LETTRES       '.              0000000
020850     05  ANOM-11 PIC X(40) VALUE                                  0000000
020860         'INCOHERENCE ENTRE LES NOMBRES DE TERMES '.              0000000
020870     05  ANOM-12 PIC X(40) VALUE                                  0000000
020880         'DATE ACCORD INVALIDE                    '.              0000000
020890     05  ANOM-13 PIC X(40) VALUE                                  0000000
020900         'MONTANT CREDIT NON CONFORME             '.              0000000
020910     05  ANOM-14 PIC X(40) VALUE                                  0000000
020920         'DUREE AMORTISSEMENT NON CONFORME        '.              0000000
020930     05  ANOM-15 PIC X(40) VALUE                                  0000000
020940         'FRAIS DE DOSSIER NON NUMERIQUE          '.              0000000
020950     05  ANOM-16 PIC X(40) VALUE                                  0000000
020960         'AUTRES FRAIS NON NUMERIQUES             '.              0000000
020970     05  ANOM-17 PIC X(40) VALUE                                  0000000
020980         'FRAIS HYPOTHECAIRES NON NUMERIQUES      '.              0000000
020990     05  ANOM-18 PIC X(40) VALUE                                  0000000
021000         'TAUX DEBITEUR NON CONFORME              '.              0000000
021010     05  ANOM-19 PIC X(40) VALUE                                  0000000
021020         'ANOMALIE 19                             '.              0000000
021030     05  ANOM-20 PIC X(40) VALUE                                  0000000
021040         'PLUS DE TROIS PRETS DANS LE MEME DOSSIER'.              0000000
021050     05  ANOM-21 PIC X(40) VALUE                                  0000000
021060         '                                        '.              0000000
021070     05  ANOM-22 PIC X(40) VALUE                                  0000000
021080         'ERREUR LECTURE PRET VIA IPPGBPR2        '.              0000000
021090     05  ANOM-23 PIC X(40) VALUE                                  0000000
021100         'CODE PRODUIT INEXISTANT                 '.              0000000
021110     05  ANOM-24 PIC X(40) VALUE                                  0000000
021120         'TYPE DE PRET NON TRAITE                 '.              0000000
021130     05  ANOM-25 PIC X(40) VALUE                                  0000000
021140         'ERREUR TRAITEMENT MGARCAPI EN LETTRE    '.              0000000
021150     05  ANOM-26 PIC X(40) VALUE                                  0000000
021160         'ERREUR TRAITEMENT MGARFRAC EN LETTRE    '.              0000000
021170     05  ANOM-27 PIC X(40) VALUE                                  0000000
021180         'libre                                   '.              0000000
021190     05  ANOM-28 PIC X(40) VALUE                                  0000000
021200         'CLE APPEL NON TROUVEE DANS MASTER       '.              0000000
021210     05  ANOM-29 PIC X(40) VALUE                                  0000000
021220         'ERREUR DE LECTURE MASTER                '.              0000000
021230     05  ANOM-30 PIC X(40) VALUE                                  0000000
021240         'CAUTION NON TROUVEE SUR FICHIER CLIENT  '.              0000000
021250     05  ANOM-31 PIC X(40) VALUE                                  0000000
021260         'ERREUR ACCES BASE NOTAIRE               '.              0000000
021270     05  ANOM-32 PIC X(40) VALUE                                  0000000
021280         'CODE GARANTIE NON TROUVE                '.              0000000
021290     05  ANOM-33 PIC X(40) VALUE                                  0000000
021300         'ERREUR DE LECTURE GARANTIE              '.              0000000
021310     05  ANOM-34 PIC X(40) VALUE                                  0000000
021320         'COMPLEMENT NON TROUVE SUR IPPCPL        '.              0000000
021330     05  ANOM-35 PIC X(40) VALUE                                  0000000
021340         'ERREUR DE LECTURE IPPCPL                '.              0000000
021350     05  ANOM-36 PIC X(40) VALUE                                  0000000
021360         'CODE BANQUE NON TROUVE VIA ZCDFBCC      '.              0000000
021370     05  ANOM-37 PIC X(40) VALUE                                  0000000
021380         'ERREUR RETOUR ISC                      '.              0000000
021390     05  ANOM-38 PIC X(40) VALUE                                  0000000
021400         'libre                                   '.              0000000
021410     05  ANOM-39 PIC X(40) VALUE                                  0000000
021420         'libre                                   '.              0000000
021430     05  ANOM-40 PIC X(40) VALUE                                  0000000
021440         'TROP D''ANOMALIES !!  ARRET ET RECYCLAGE'.              0000000
021450     05  ANOM-41 PIC X(40) VALUE                                  0000000
021460         'PRET ABS BASE PRET                      '.              0000000
021470     05  ANOM-42 PIC X(40) VALUE                                  0000000
021480         'reserve calcul   TAM'.                                  0000000
021490     05  ANOM-43 PIC X(40) VALUE                                  0000000
021500         'libre                  '.                               0000000
021510     05  ANOM-44 PIC X(40) VALUE                                  0000000
021520         'RESERVE'.                                               0000000
021530     05  ANOM-45 PIC X(40) VALUE                                  0000000
021540         'ERREUR RETOUR IPPBATC1'.                                0000000
021550     05  ANOM-46 PIC X(40) VALUE                                  0000000
021560         'ERREUR BASE CAISSE'.                                    0000000
021570     05  ANOM-47 PIC X(40) VALUE                                  0000000
021580         'ERREUR LECTURE CLIENT/TIERS'.                           0000000
021590     05  ANOM-48 PIC X(40) VALUE                                  0000000
021600         'EMPRUNTEUR NON TROUVE / BASES ADRESSES'.                0000000
021610     05  ANOM-49 PIC X(40) VALUE                                  0000000
021620         'date bareme 0%  erronee               '.                0000000
021630     05  ANOM-50 PIC X(40) VALUE                                  0000000
021640         'erreur appel ZPRTBARM                 '.                0000000
021650     05  ANOM-51 PIC X(40) VALUE                                  0000000
021660         'Nbre de maj KO > 20 : pb PRET1001 ?   '.                0000000
021670     05  ANOM-52 PIC X(40) VALUE                                  0000000
021680         'Erreur lecture spitab PRTIND          '.                0000000
021690     05  ANOM-53 PIC X(40) VALUE                                  0000000
021700         'reserv garsp002                      '.                0000000
021710     05  ANOM-54 PIC X(40) VALUE                                  0000000
021720         'Pret divers et mode de gestion diff. 6'.                0000000
021730     05  ANOM-55 PIC X(40) VALUE                                  0000000
021740         'Le code assurance est faux            '.                0000000
021750     05  ANOM-56.                                                 0000000
021760       07  FILLER       PIC X(13)  VALUE                          0000000
021770         'PB ZPRTTIMB '.                                          0000000
021780       07  ANOM-LIB-56  PIC X(27)  VALUE SPACES.                  0000000
021790     05  ANOM-57.                                                 0000000
021800       07  FILLER       PIC X(13)  VALUE                          0000000
021810         'PB IPXzgar3 '.                                          0000000
021820       07  ANOM-LIB-57  PIC X(27)  VALUE SPACES.                  0000000
021830     05  ANOM-58.                                                 0000000
021840       07  FILLER       PIC X(13)  VALUE                          0000000
021850         'PB IPXm0003 '.                                          0000000
021860       07  ANOM-LIB-58  PIC X(27)  VALUE SPACES.                  0000000
021870     05  ANOM-59.                                                 0000000
021880       07  FILLER       PIC X(13)  VALUE                          0000000
021890         'PB IPXZAPPP '.                                          0000000
021900       07  ANOM-LIB-59  PIC X(27)  VALUE SPACES.                  0000000
021910     05  ANOM-60        PIC X(40) VALUE                           0000000
021920         'Pb IPXZADLG                           '.                0000000
021930     05  ANOM-61        PIC X(40) VALUE                           0000000
021940         'PB RECH PRTCONDI                      '.                0000000
021950     05  ANOM-62        PIC X(40) VALUE                           0000000
021960         'PB Recherche adresse TIERS RADSP805   '.                0000000
021970     05  ANOM-63        PIC X(40) VALUE                           0000000
021980         'PB CLOPGES                            '.                0000000
021990     05  ANOM-64        PIC X(40) VALUE                           0000000
022000         'PB ZPRTBARM                           '.                0000000
022010     05  ANOM-65        PIC X(40) VALUE                           0000000
022020         'PB IDHGAPEL                           '.                0000000
022030*                                                                 0000000
022040 01  TABLE-ANOMALIES REDEFINES LISTE-ANOMALIES.                   0000000
022050     05  POSTE-ANOMALIE OCCURS 65.                                0000000
022060         10  LIB-ANOM PIC X(40).                                  0000000
022070                                                                  0000000
022080* VARIABLES DE TRAVAIL POUR FORMATAGE DU NUM. TEL. SUR 15 POSITION0000000
022090 01  W-TEL15.                                                     0000000
022100     05 W-TEL14    PIC X(14).                                     0000000
022110     05 FILLER     PIC X.                                         0000000
022120*                                                                 0000000
022130 01  EVTE10.   COPY YEVTE10 SUPPRESS.                             0000000
022140*                                                                 0000000
022150 01  BIDON-ENTITE.                                                0000000
022160     05 BIDON-FED      PIC XX.                                    0000000
022170     05 BIDON-BANQ     PIC X(5).                                  0000000
022180     05 BIDON-NCAI     PIC X(5).                                  0000000
022190     05 BIDON-BUREAU   PIC 99.                                    0000000
022200     05 BIDON-RACINE.                                             0000000
022210        10 BIDON-RACINE0  PIC 9(3).                               0000000
022220        10 BIDON-RACINE6  PIC 9(6).                               0000000
022230     05 BIDON-RACINE9  REDEFINES BIDON-RACINE  PIC 9(6).          0000000
022240     05 BIDON-TYPSER   PIC X(2).                                  0000000
022250     05 BIDON-DEVISE   PIC XXX.                                   0000000
022260*                                                                 0000000
022270 01 BIDON-DATE.                                                   0000000
022280    05 BIDON-DATE-SSAA PIC X(4).                                  0000000
022290    05 FILLER          PIC X  VALUE '-'.                          0000000
022300    05 BIDON-DATE-MM   PIC XX.                                    0000000
022310    05 FILLER          PIC X  VALUE '-'.                          0000000
022320    05 BIDON-DATE-JJ   PIC XX.                                    0000000
022330*                                                                 0000000
022340 01 BIDON-HEURE.                                                  0000000
022350    05 BIDON-HEURE-HH  PIC XX.                                    0000000
022360    05 FILLER          PIC X  VALUE ':'.                          0000000
022370    05 BIDON-HEURE-MN  PIC XX.                                    0000000
022380    05 FILLER          PIC X  VALUE ':'.                          0000000
022390    05 BIDON-HEURE-SC  PIC XX.                                    0000000
022400                                                                  0000000
022410******************************                                    0000000
022420*  zone adresse pour ippepg  *                                    0000000
022430******************************                                    0000000
022440*                                                                 0000000
022450                                                                  0000000
022460 01  ZZ-EMP1DOMI                    PIC X(12).                    0000000
022470                                                                  0000000
022480 01  ZZ-EMP1ADR.                                                  0000000
022490   03  ZZ-EMP1ADR1                  PIC X(32).                    0000000
022500   03  ZZ-EMP1ADR2                  PIC X(32).                    0000000
022510   03  ZZ-EMP1ADR3.                                               0000000
022520     05  ZZ-EMP1ADRC.                                             0000000
022530       07  ZZ-EMP1CPAYS             PIC X(04).                    0000000
022540       07  ZZ-EMP1CPOST             PIC X(05).                    0000000
022550       07  ZZ-EMP1BLANC             PIC X(01).                    0000000
022560     05  ZZ-EMP1LOC                 PIC X(26).                    0000000
022570   03  ZZ-EMP1RESERA                PIC X(03).                    0000000
022580                                                                  0000000
022590*                                                                 0000000
022600*                                                                 0000000
022610*** ZONES MAN POUR CALCUL FRAIS DE TIMBRES                        0000000
022620*                                                                 0000000
022630                                                                  0000000
022640 01  ZZ-FRAIS-TIMBRE.                                             0000000
022650   02  ZZ-FRAIS-TIMB           PIC 9(9)V99.                       0000000
022660 01  ZZ-FRAIS-TIMBA    REDEFINES    ZZ-FRAIS-TIMBRE.              0000000
022670   02  ZZ-FRAIS-TIMBA5         PIC 9(5).                          0000000
022680   02  ZZ-FRAIS-TIMBA2         PIC 99.                            0000000
022690                                                                  0000000
022700 01  IPCTIM.     COPY  YIPCTIM  SUPPRESS.                         0000000
022710                                                                  0000000
022720 01  ZZ-FRAUT.                                                    0000000
022730     15  ZZ-FRAUT9             PIC 9(5).                          0000000
022740                                                                  0000000
022750*                                                                 0000000
022760*** ZONES table ipxpresc pour recup num clause si prescripteur    0000000
022770*                                                 existe          0000000
022780                                                                  0000000
022790 01  TAB-PRESCRIP.                                                0000000
022800   02  NUM-PRESCRIP            PIC X(13).                         0000000
022810   02  LIBEL-PRESCRIP.                                            0000000
022820     04  LIBEL1-PRESCRIP       PIC X(50).                         0000000
022830     04  LIBEL2-PRESCRIP       PIC X(50).                         0000000
022840   02  NO-CLAUSE-PRESCRIP      PIC X(4).                          0000000
022850 01  FILLER REDEFINES TAB-PRESCRIP.                               0000000
022860   02  FILLER                  PIC X(13).                         0000000
022870   02  GESPAR-PRESCRIP         PIC X(104).                        0000000
022880                                                                  0000000
022890*NDE-27/05/2003 - Dbut                                           0000000
022900 01  ATMXAR.  COPY YATMXAR    SUPPRESS.                           0000000
022910 01  APRE11.  COPY YAPRE11    SUPPRESS.                           0000000
022920 01  APRS11.  COPY YAPRS11    SUPPRESS.                           0000000
022930*                                                                 0000000
022940 01  CAI-NOCAI.                                                   0000000
022950   02  CAI-FEDE           PIC XX.                                 0000000
022960   02  CAI-CAISSE         PIC X(5).                               0000000
022970                                                                  0000000
022980* pour extase                                                     0000000
022990 01  APXTA5.  COPY  YAPXTA5  SUPPRESS.                            0000000
023000 01  APXTR5.  COPY  YAPXTR5  SUPPRESS.                            0000000
023010 01  APXPTR.  COPY  YAPXPTR  SUPPRESS.                            0000000
023020 01  IPXAPX.  COPY  YIPXAPX  SUPPRESS.                            0000000
023030* renseigner apres appel IPXZCALY                                 0000000
023040 01  APXTRE.  COPY  YAPXTRE  SUPPRESS.                            0000000
023050*                                                                 0000000
023060*********  Copy ORGS01C ORGS03B ORGS03G                           0000000
023070*                                                                 0000000
023080* copy ORGS01C car pour Fede LAVAL (14) on surcharge cetaines     0000000
023090*                                    caisses par la caisse 00399  0000000
023100 01  ORGS01C.    COPY YORGS01C SUPPRESS.                          0000000
023110* copy ORGS03B   pour appel bureau                                0000000
023120 01  ORGS03B.     COPY YORGS03B  SUPPRESS.                        0000000
023130* copy ORGS03G   pour appel guichet                               0000000
023140 01  ORGS03G.     COPY YORGS03G SUPPRESS.                         0000000
023150*                                                                 0000000
023160*--> PCB pour appel accesseur bases correspondant GCOR            0000000
023170 01  ARKPCB EXTERNAL.        COPY YARKPCB.                        0000000
023180                                                                  0000000
023190 01  PCBBIDPSO  pic x(32).                                        0000000
023200*     DEBUT WORKING IPXZMAIL.                                     0000000
023210*                                                                 0000000
023220 01  YIPXMES.         COPY   YIPXMES.                             0000000
023230 01  IPXLCH.          COPY   YIPXLCH.                             0000000
023240 01  LCHATEL.                                                     0000000
023250   03  LCHATEL-O  Occurs 4.                                       0000000
023260         05  CHA-PAL         PIC X.                               0000000
023270         05  CHA-DUR-FIX     PIC 999.                             0000000
023280         05  CHA-MODGES      PIC X.                               0000000
023290         05  CHA-VTER        PIC X.                               0000000
023300         05  CHA-SIG-PLUS    PIC X.                               0000000
023310         05  CHA-VAR-PLUS    PIC Z9,99.                           0000000
023320         05  CHA-TER-PLUS    PIC ZZZ.ZZZ.ZZ9,99  OCCURS 10.       0000000
023330         05  CHA-DUR-PLUS    PIC 999             OCCURS 10.       0000000
023340         05  CHA-SIGDD-PLUS  PIC X.                               0000000
023350         05  CHA-DIFDU-PLUS  PIC 999.                             0000000
023360         05  CHA-SIGDC-PLUS  PIC X.                               0000000
023370         05  CHA-COUT-PLUS   PIC ZZZ.ZZZ.ZZ9,99.                  0000000
023380                                                                  0000000
023390         05  CHA-SIG-MOINS   PIC X.                               0000000
023400         05  CHA-VAR-MOINS   PIC Z9,99.                           0000000
023410         05  CHA-TER-MOINS   PIC ZZZ.ZZZ.ZZ9,99  OCCURS 10.       0000000
023420         05  CHA-DUR-MOINS   PIC 999             OCCURS 10.       0000000
023430         05  CHA-SIGDD-MOINS PIC X.                               0000000
023440         05  CHA-DIFDU-MOINS PIC 999.                             0000000
023450         05  CHA-SIGDC-MOINS PIC X.                               0000000
023460         05  CHA-COUT-MOINS  PIC ZZZ.ZZZ.ZZ9,99.                  0000000
023470                                                                  0000000
023480         05  CHA-SIG-AUT     PIC X.                               0000000
023490         05  CHA-VAR-AUT     PIC Z9,99.                           0000000
023500         05  CHA-TER-AUT     PIC ZZZ.ZZZ.ZZ9,99  OCCURS 10.       0000000
023510         05  CHA-DUR-AUT     PIC 999             OCCURS 10.       0000000
023520         05  CHA-SIGDD-AUT   PIC X.                               0000000
023530         05  CHA-DIFDU-AUT   PIC 999.                             0000000
023540         05  CHA-SIGDC-AUT   PIC X.                               0000000
023550         05  CHA-COUT-AUT    PIC ZZZ.ZZZ.ZZ9,99.                  0000000
023560                                                                  0000000
023570 01  INDIC-FIN-FIC    PIC X.                                      0000000
023580     88  OUI-FF-ANOM         VALUE 'O'.                           0000000
023590     88  NON-FF-ANOM         VALUE 'N'.                           0000000
023600                                                                  0000000
023610 01  INDIC-PREM-LEC   PIC X.                                      0000000
023620     88  OUI-PREMIERE        VALUE 'O'.                           0000000
023630     88  NON-PREMIERE        VALUE 'N'.                           0000000
023640                                                                  0000000
023650 01  CPT-NB-MES              PIC 9(8)  VALUE  ZEROS.              0000000
023660 01  GG                      PIC 9(8)  VALUE  ZEROS.              0000000
023670                                                                  0000000
023680*                                                                 0000000
023690 01  LIB-ANOM-SUIT1.                                              0000000
023700   02  FILLER                PIC X(28)  VALUE                     0000000
023710                    '   ** SUITE DU COMPTE RENDU '.               0000000
023720   02  FILLER                PIC X(32)  VALUE                     0000000
023730                    'IPPPBATCH SUR MESSAGE SUIVANT **'.           0000000
023740 01  LIB-ANOM-SUIT2          PIC X(40)  VALUE                     0000000
023750                    '   ** SUITE DU COMPTE RENDU IPPBATCH ** '.   0000000
023760 01  LIB-FIC-VIDE            PIC X(50)  VALUE                     0000000
023770             '   ** PAS DE COMPTE RENDU IPPBATCH POUR LE SITE **'.0000000
023780*                                                                 0000000
023790 01  XX-SITE-NOM             PIC X(32).                           0000000
023800*                                                                 0000000
023810 01 W-TYPE-MAJ-IPMA2         PIC X.                               0000000
023820    88 MAJ-IPPMA2-INDETERMINE          VALUE '0'.                 0000000
023830    88 MAJ-IPPMA2-IPPBATCH-NUIT        VALUE '1'.                 0000000
023840    88 MAJ-IPPMA2-PAR-IPXBMA2J         VALUE '2'.                 0000000
023850                                                                  0000000
023860 01 W-DOSSIER-FACTURE        PIC X.                               0000000
023870    88 DOSSIER-FACTURE                 VALUE '0'.                 0000000
023880    88 DOSSIER-NON-FACTURE             VALUE '1'.                 0000000
023890                                                                  0000000
023900*                                                                 0000000
023910*                                                                 0000000
023920*                               idx                               0000000
023930 01  w-tab-renego-1.                                              0000000
023940     02  filler pic x(29) value '240Y1 1602 1670 1674 1679 060'.  0000000
023950     02  filler pic x(29) value '240Y2 1603 1670 1675 1679 084'.  0000000
023960     02  filler pic x(29) value '240Y3 1604 1670 1676 1679 120'.  0000000
023970     02  filler pic x(29) value '240Y4 1605 1670 1677 1679 180'.  0000000
023980     02  filler pic x(29) value '240Y9 1650 1670 1678 1679 240'.  0000000
023990*                                                                 0000000
024000     02  filler pic x(29) value '245Y1 1606 1671 1680 1685 060'.  0000000
024010     02  filler pic x(29) value '245Y2 1607 1671 1681 1685 084'.  0000000
024020     02  filler pic x(29) value '245Y3 1608 1671 1682 1685 120'.  0000000
024030     02  filler pic x(29) value '245Y4 1609 1671 1683 1685 180'.  0000000
024040     02  filler pic x(29) value '245Y9 1652 1671 1684 1685 240'.  0000000
024050*                                                                 0000000
024060     02  filler pic x(29) value '281Y5 1646 1672 1686 1691 060'.  0000000
024070     02  filler pic x(29) value '281Y6 1647 1672 1687 1691 084'.  0000000
024080     02  filler pic x(29) value '281Y7 1648 1672 1688 1691 120'.  0000000
024090     02  filler pic x(29) value '281Y8 1649 1672 1689 1691 180'.  0000000
024100     02  filler pic x(29) value '281YI 1654 1672 1690 1691 240'.  0000000
024110*                                                                 0000000
024120     02  filler pic x(29) value '283Y1 1642 1673 1692 1697 060'.  0000000
024130     02  filler pic x(29) value '283Y2 1643 1673 1693 1697 084'.  0000000
024140     02  filler pic x(29) value '283Y3 1644 1673 1694 1697 120'.  0000000
024150     02  filler pic x(29) value '283Y4 1645 1673 1695 1697 180'.  0000000
024160     02  filler pic x(29) value '283Y9 1655 1673 1696 1697 240'.  0000000
024170*                                                                 0000000
024180* 3 mois                                                          0000000
024190*                                                                 0000000
024200     02  filler pic x(29) value '243Y5 1704 1714 1716 1726 060'.  0000000
024210     02  filler pic x(29) value '243Y6 1705 1714 1717 1726 084'.  0000000
024220     02  filler pic x(29) value '243Y7 1706 1714 1718 1726 120'.  0000000
024230     02  filler pic x(29) value '243Y8 1707 1714 1719 1726 180'.  0000000
024240     02  filler pic x(29) value '243YI 1708 1714 1720 1726 240'.  0000000
024250*                                                                 0000000
024260     02  filler pic x(29) value '243Y5 1709 1715 1721 1727 060'.  0000000
024270     02  filler pic x(29) value '243Y6 1710 1715 1722 1727 084'.  0000000
024280     02  filler pic x(29) value '243Y7 1711 1715 1723 1727 120'.  0000000
024290     02  filler pic x(29) value '243Y8 1712 1715 1724 1727 180'.  0000000
024300     02  filler pic x(29) value '243YI 1713 1715 1725 1727 240'.  0000000
024310*                                                                 0000000
024320 01  w-tab-renego-2  redefines  w-tab-renego-1.                   0000000
024330     02  w-tab-renego                   occurs  30.               0000000
024340         04  w-ren-idx                 pic x(5).                  0000000
024350         04  fiiler                    pic x.                     0000000
024360         04  w-ren-cl-ouv              pic 9(4).                  0000000
024370         04  fiiler                    pic x.                     0000000
024380         04  w-ren-cl-ouv-plus         pic 9(4).                  0000000
024390         04  fiiler                    pic x.                     0000000
024400         04  w-ren-cl                  pic 9(4).                  0000000
024410         04  fiiler                    pic x.                     0000000
024420         04  w-ren-cl-plus             pic 9(4).                  0000000
024430         04  fiiler                    pic x.                     0000000
024440         04  w-ren-cl-duree            pic 9(3).                  0000000
024450 01  w-clause-ren     pic x(4).                                   0000000
024460 01  i-ren            pic 9(4)  comp.                             0000000
024470                                                                  0000000
024480 01 TARIF-INITIO             PIC X.                               0000000
024490    88 TARIF-INITIO-OK                 VALUE 'O'.                 0000000
024500    88 TARIF-INITIO-KO                 VALUE 'N'.                 0000000
024510*                                                                 0000000
024520 01  ed-txass        pic 999,999999999+.                          0000000
024530*                                                                 0000000
024540                                                                  0000000
024550 01  GESPAR-PRTINDXX.                                             0000000
024560     05  GESPAR-PRTINDXX-DEBEFF         PIC X(8).                 0000000
024570     05  GESPAR-PRTINDXX-FINEFF         PIC X(8).                 0000000
024580     05  GESPAR-PRTINDXX-NUMINDEX-IPP   PIC X(4).                 0000000
024590     05  GESPAR-PRTINDXX-NOMINDEX15-IPX PIC X(15).                0000000
024600     05  GESPAR-PRTINDXX-NUMINDEX-IPI   PIC X(4).                 0000000
024610     05  GESPAR-PRTINDXX-NUMINDEX-IPC   PIC X(4).                 0000000
024620     05  GESPAR-PRTINDXX-UTIL           PIC X(1).                 0000000
024630                                                                  0000000
024640                                                                  0000000
024650 01  GESPAR-PRTIND02.                                             0000000
024660     05  GESPAR-PRTIND02-REPMINI-S    PIC X.                      0000000
024670     05  GESPAR-PRTIND02-REPMINI      PIC S9(2)V9(3).             0000000
024680     05  GESPAR-PRTIND02-REPMAXI-S    PIC X.                      0000000
024690     05  GESPAR-PRTIND02-REPMAXI      PIC S9(2)V9(3).             0000000
024700     05  GESPAR-PRTIND02-TXPLAN-S     PIC X.                      0000000
024710     05  GESPAR-PRTIND02-TXPLAN       PIC S9(2)V9(3).             0000000
024720     05  GESPAR-PRTIND02-TXPLAF-S     PIC X.                      0000000
024730     05  GESPAR-PRTIND02-TXPLAF       PIC S9(2)V9(3).             0000000
024740     05  GESPAR-PRTIND02-PERIO        PIC 9(01).                  0000000
024750     05  GESPAR-PRTIND02-MOIS         PIC 9(02).                  0000000
024760     05  GESPAR-PRTIND02-DREF         PIC X(01).                  0000000
024770     05  GESPAR-PRTIND02-DEF          PIC X(01).                  0000000
024780     05  GESPAR-PRTIND02-CDV          PIC X(08).                  0000000
024790                                                                  0000000
024800 01  Pret-TSE              PIC X.                                 0000000
024810     88  PRET-TSE-OUI           VALUE '5'.                        0000000
024820                                                                  0000000
024830 01 W-Titulaires-trouves        PIC X.                            0000000
024840    88 Titulaires-non-trouves   VALUE '0'.                        0000000
024850    88 Titulaires-trouves       VALUE '1'.                        0000000
024860*                                                                 0000000
024870*--> age                                                          0000000
024880 01  W-NBANNEES              PIC ZZ9.                             0000000
024890 01  W-CPT-NOM               PIC X(50).                           0000000
024900 01  XX-SSAAMMJJ.                                                 0000000
024910     05  XX-SSAA                 PIC X(4).                        0000000
024920     05  XX-mois                 PIC X(2).                        0000000
024930     05  XX-jour                 PIC X(2).                        0000000
024940 01  W-date-nais.                                                 0000000
024950     05  W-date-naisaa       PIC X(4).                            0000000
024960     05  W-date-sep1         PIC X(1).                            0000000
024970     05  W-date-naismm       PIC X(2).                            0000000
024980     05  W-date-sep2         PIC X(1).                            0000000
024990     05  W-date-naisjj       PIC X(2).                            0000000
025000*                                                                 0000000
025010*GESPAR                                                           0000000
025020*-                                                                0000000
025030*------------------------------------------------------------     0000000
025040*    PARAMETRES D'APPEL A GESPAR / LECTURE TABLE                  0000000
025050*    recherche destinataire via GESPAR IDCCDEST                   0000000
025060*------------------------------------------------------------     0000000
025070*                                                                 0000000
025080*---------------------------------------------------------------- 0000000
025090 01  YOURPGM PIC X(8) VALUE 'IPPBATCH'.                           0000000
025100*---------------------------------------------------------------- 0000000
025110 01 DESTINATAIRE                 PIC X.                           0000000
025120     88 DESTOK-ANOM               VALUE 'O'.                      0000000
025130     88 DESTNOT-ANOM              VALUE 'N'.                      0000000
025140     88 DESTPLANT                 VALUE 'X'.                      0000000
025150*                                                                 0000000
025160*---------------------------------------------------------------  0000000
025170* adresses mails                                                  0000000
025180*---------------------------------------------------------------  0000000
025190 01  W-DEST1  PIC X(80) VALUE SPACE.                              0000000
025200 01  W-DEST2  PIC X(80) VALUE SPACE.                              0000000
025210 01  W-DEST3  PIC X(80) VALUE SPACE.                              0000000
025220 01  W-DEST4  PIC X(80) VALUE SPACE.                              0000000
025230 01  W-DEST5  PIC X(80) VALUE SPACE.                              0000000
025240 01  W-COPY1  PIC X(80) VALUE SPACE.                              0000000
025250 01  W-COPY2  PIC X(80) VALUE SPACE.                              0000000
025260*                                                                 0000000
025270*                                                                 0000000
025280 01                              PIC X.                           0000000
025290     88 NORMAL                    VALUE 'O'.                      0000000
025300     88 TORDU                     VALUE 'N'.                      0000000
025310*--------------------                                             0000000
025320 LINKAGE   SECTION.                                               0000000
025330*--------------------                                             0000000
025340*---------------------------------------------------------------  0000000
025350* ZONE LINKAGE POUR MODULE ISC RECHERCHE SITE SUR 2 POSITIONS    0000000
025360*---------------------------------------------------------------  0000000
025370 01  SITE-ACTUEL.                 COPY YISCSIT.                   0000000
025380                                                                  0000000
025390 01  PCBSPI.                                                      0000000
025400     05  PCBSPI-DDNAME   PIC X(08)  VALUE  'SPITAB  '.            0000000
025410     05  PCBSPI-RESERVE  PIC X(02).                               0000000
025420     05  PCBSPI-STATUS   PIC X(02).                               0000000
025430                                                                  0000000
025440 01  PCBCAI.        COPY YI01PCBB SUPPRESS.                       0000000
025450* a supprimer                                                     0000000
025460 01  PCBCLI.        COPY YI01PCBC SUPPRESS.                       0000000
025470 01  PCBPRT.        COPY YI01PCBD SUPPRESS.                       0000000
025480* a supprimer                                                     0000000
025490 01  PCBBAR    PIC X.                                             0000000
025500* a supprimer                                                     0000000
025510 01  PCBIND.        COPY YI01PCBF SUPPRESS.                       0000000
025520 01  PCBMAS.        COPY YI01PCBG SUPPRESS.                       0000000
025530 01  PCBCPL.        COPY YI01PCBH SUPPRESS.                       0000000
025540 01  PCBNOT.        COPY YI01PCBJ SUPPRESS.                       0000000
025550 01  PCBGPR.        COPY YI01PCBK SUPPRESS.                       0000000
025560 01  PCBGIN.        COPY YI01PCBL SUPPRESS.                       0000000
025570 01  PCBGCP.        COPY YI01PCBM SUPPRESS.                       0000000
025580* a supprimer                                                     0000000
025590 01  PCBREL.        COPY YI01PCBN SUPPRESS.                       0000000
025600 01  PCBCO1.        COPY YI01PCBO SUPPRESS.                       0000000
025610 01  PCBCO2.        COPY YI01PCBP SUPPRESS.                       0000000
025620 01  PCBCO3.        COPY YI01PCBQ SUPPRESS.                       0000000
025630 01  PCBCO4.        COPY YI01PCBR SUPPRESS.                       0000000
025640 01  PCBCO5.        COPY YI01PCBS SUPPRESS.                       0000000
025650*----------------------- PCB BASE sous - produit dbd0671          0000000
025660 01  PCBMSP.        COPY YI01PCB4 SUPPRESS.                       0000000
025670*  gar3 d                                                         0000000
025680*----------------------- PCB BASE REPERTOIRE ADRESSE CLIENT       0000000
025690*01  PCBCLT.        COPY YI99PCB1 SUPPRESS.                       0000000
025700*----------------------- PCB BASE REPERTOIRE ADRESSE DESTINATAIRE 0000000
025710*01  PCBDES.        COPY YI99PCB2 SUPPRESS.                       0000000
025720*----------------------- PCB BASE REPERTOIRE ADRESSE              0000000
025730*01  PCBADR.        COPY YI99PCB3 SUPPRESS.                       0000000
025740*--> BASE ADRESSE CLIENT                  DBD0586                 0000000
025750 01  ADRCLI                  PIC X(32).                           0000000
025760*--> BASE RPERTOIRE ADRESSE INDEX        DBD0588                 0000000
025770 01  ADRIND                  PIC X(32).                           0000000
025780*--> BASE RPERTOIRE ADRESSE DESTINATAIRE DBD0587                 0000000
025790 01  ADRDES                  PIC X(32).                           0000000
025800*--> BASE RPERTOIRE ADRESSE CLIENT       DBD0589                 0000000
025810 01  ADRADR                  PIC X(32).                           0000000
025820*=== 24 ==============================                            0000000
025830*--> BASE RPERTOIRE ADRESSE LITERALE     DBD0585                 0000000
025840 01  ADRLIT                  PIC X(32).                           0000000
025850*=== 25 ==============================                            0000000
025860*--> BASE RPERTOIRE MAJ A REPERCUTER     DBD0590                 0000000
025870 01  REPMAJ                  PIC X(32).                           0000000
025880*=== 26 ==============================                            0000000
025890*--> BASE BAREME                          TABDBD01                0000000
025900 01  BARRAC                  PIC X(32).                           0000000
025910*  gar3 f                                                         0000000
025920 01  IOPCB.         COPY YI03PCB  SUPPRESS.                       0000000
025930                                                                  0000000
025940                                                                  0000000
025950*================================================================ 0000000
025960 PROCEDURE DIVISION   USING PCBSPI                                0000000
025970                            PCBCAI                                0000000
025980                            PCBCLI                                0000000
025990                            PCBPRT                                0000000
026000                            PCBBAR                                0000000
026010                            PCBIND                                0000000
026020                            PCBMAS                                0000000
026030                            PCBCPL                                0000000
026040                            PCBNOT                                0000000
026050                            PCBGPR                                0000000
026060                            PCBGIN                                0000000
026070                            PCBGCP                                0000000
026080                            PCBREL                                0000000
026090                            PCBCO1                                0000000
026100                            PCBCO2                                0000000
026110                            PCBCO3                                0000000
026120                            PCBCO4                                0000000
026130                            PCBCO5                                0000000
026140                            PCBMSP                                0000000
026150*  gar3 d                                                         0000000
026160*                           PCBCLT                                0000000
026170*                           PCBDES                                0000000
026180*                           PCBADR                                0000000
026190                            ADRCLI                                0000000
026200                            ADRIND                                0000000
026210                            ADRDES                                0000000
026220                            ADRADR                                0000000
026230                            ADRLIT                                0000000
026240                            REPMAJ                                0000000
026250*  gar3 f                                                         0000000
026260                            BARRAC                                0000000
026270                            IOPCB.                                0000000
026280*                                                                 0000000
026290*    READY TRACE.                                                 0000000
026300*                                                                 0000000
026310dDECLARATIVES.                                                    0000000
026320dDEBUG SECTION.                                                   0000000
026330d    USE FOR DEBUGGING ON ALL PROCEDURES.                         0000000
026340D    DISPLAY 'Ippbatch = ' cpt-crd    ' - '  DEBUG-ITEM.          0000000
026350dEND DECLARATIVES.                                                0000000
026360*                                                                 0000000
026370     ACCEPT  CST.                                                 0000000
026380     IF  NOT  TRAIT-PASSAGE-OK                                    0000000
026390         DISPLAY 'CARTE CONSTANTE FAUSSE EN COL 10,LG 4'          0000000
026400         DISPLAY 'DOIT CONTENIR "JOUR" OU "NUIT"'                 0000000
026410         MOVE  'NUIT'    TO  CST-TRAIT.                           0000000
026420                                                                  0000000
026430d    display 'pcbmas ' pcbmas                                     0000000
026440d    display 'pcbcpl ' pcbcpl                                     0000000
026450d    display 'PCBSPI ' PCBSPI                                     0000000
026460d    display 'PCBCAI ' PCBCAI                                     0000000
026470d    display 'PCBCLI ' PCBCLI                                     0000000
026480d    display 'PCBPRT ' PCBPRT                                     0000000
026490d    display 'PCBBAR ' PCBBAR                                     0000000
026500d    display 'PCBIND ' PCBIND                                     0000000
026510d    display 'PCBMAS ' PCBMAS                                     0000000
026520d    display 'PCBCPL ' PCBCPL                                     0000000
026530d    display 'PCBNOT ' PCBNOT                                     0000000
026540d    display 'PCBGPR ' PCBGPR                                     0000000
026550d    display 'PCBGIN ' PCBGIN                                     0000000
026560d    display 'PCBGCP ' PCBGCP                                     0000000
026570d    display 'PCBREL ' PCBREL                                     0000000
026580d    display 'PCBCO1 ' PCBCO1                                     0000000
026590d    display 'PCBCO2 ' PCBCO2                                     0000000
026600d    display 'PCBCO3 ' PCBCO3                                     0000000
026610d    display 'PCBCO4 ' PCBCO4                                     0000000
026620d    display 'PCBCO5 ' PCBCO5                                     0000000
026630d    display 'PCBMSP ' PCBMSP                                     0000000
026640                                                                  0000000
026650                                                                  0000000
026660     PERFORM DEBUT-STANDARD.                                      0000000
026670     PERFORM OUVERTURE-FICHIERS.                                  0000000
026680     PERFORM APPEL-APRGAPEL-O                                     0000000
026690                                                                  0000000
026700     IF   CTL-R34 = ZERO                                          0000000
026710          PERFORM LECTURE-APPEL.                                  0000000
026720                                                                  0000000
026730                                                                  0000000
026740     PERFORM TRAIT-APPEL                                          0000000
026750             UNTIL FF-APPEL = 1                                   0000000
026760                OR CTL-R34  NOT = ZERO.                           0000000
026770                                                                  0000000
026780     IF   TOP-INTERCALAIRE = '1' OR '2'                           0000000
026790          MOVE '2' TO TOP-INTERCALAIRE                            0000000
026800          PERFORM RUPTURE-DERN-CAISSE.                            0000000
026810     IF   DIDO-ETAT = '1'                                         0000000
026820          MOVE '2' TO DIDO-ETAT.                                  0000000
026830     IF   DIDO-ETAT = '2'                                         0000000
026840          PERFORM FERMETURE-DIDO.                                 0000000
026850     PERFORM APPEL-APRGAPEL-F                                     0000000
026860     PERFORM FIN-PGM.                                             0000000
026870                                                                  0000000
026880*---------------                                                  0000000
026890 DEBUT-STANDARD.                                                  0000000
026900*---------------                                                  0000000
026910     Set  y-a-pas-ano   to  true                                  0000000
026920     Set  88-entete-init         to true                          0000000
026930                                                                  0000000
026940     MOVE      SPACE             TO INIPGM.                       0000000
026950     MOVE      WHEN-COMPILED     TO PGM-KOMPIL.                   0000000
026960     CALL     'ZCALLPGM'  USING ZINIPGM2                          0000000
026970                                 INIPGM.                          0000000
026980                                                                  0000000
026990D    DISPLAY  'INIPGM'   INIPGM.                                  0000000
027000                                                                  0000000
027010* RENSEIGNEMENT DE LA ZONE ZDEBPGM-DATE-AND-CO                    0000000
027020                                                                  0000000
027030     MOVE PGM-DATE8    TO ZDEBPGM-JJMMSSAA                        0000000
027040     MOVE PGM-HEURE    TO ZDEBPGM-HHMMSSTH                        0000000
027050     MOVE PGM-CENTRE   TO ZDEBPGM-CENTRE                          0000000
027060     MOVE PGM-NOM      TO ZDEBPGM-NOM                             0000000
027070     STRING PGM-JJ '/'                                            0000000
027080            PGM-MM '/'                                            0000000
027090            PGM-AA                                                0000000
027100            DELIMITED BY SIZE INTO W-IPPPRI-DATEJ-14.             0000000
027110     MOVE WHEN-COMPILED TO COMPILE-QUAND.                         0000000
027120     DISPLAY SPACE.                                               0000000
027130     DISPLAY '*** VERSION DU PROGRAMME  : '.                      0000000
027140     DISPLAY '*** DATE  DE COMPILATION  : ' COMPILE-DATE.         0000000
027150     DISPLAY '*** HEURE DE COMPILATION  : ' COMPILE-HEURE.        0000000
027160                                                                  0000000
027170     DISPLAY SPACE.                                               0000000
027180     MOVE ZERO TO WORK-AAAAQQQ.                                   0000000
027190     COMPUTE WORK-AAAAQQQ = PGM-AAAAQQQ + 1.                      0000000
027200                                                                  0000000
027210*                                                                 0000000
027220**** RECHERCHE DE L'IMS SOUS LEQUEL ON EXECUTE                    0000000
027230*                                                                 0000000
027240                                                                  0000000
027250     MOVE  SPACES                     TO XX-SITE-MODULE           0000000
027260     SET PAR-ISC-FONCTION-SITE-LOCAL  TO  TRUE                    0000000
027270     CALL 'ZCALLPGM' USING PROGSITE                               0000000
027280                           PARAM-ISC                              0000000
027290     END-CALL                                                     0000000
027300     IF  NOT  PAR-ISC-RETOUR-NORMAL                               0000000
027310         MOVE  ' ERREUR APPEL ISC '  TO  ANOM-37                 0000000
027320         MOVE  PAR-ISC-RETOUR         TO  CTL-R34                 0000000
027330         MOVE  37                     TO  TEST-1                  0000000
027340         PERFORM  TRAIT-ANOMALIE                                  0000000
027350     END-IF                                                       0000000
027360                                                                  0000000
027370     SET  ADDRESS OF SITE-ACTUEL  TO  PAR-ISC-POINTEUR-YISCSIT    0000000
027380     SET  PT-SITE-LOCAL           TO  PAR-ISC-POINTEUR-YISCSIT    0000000
027390                                                                  0000000
027400     MOVE SIT-ISC-CODE-IMS        TO  XX-SITE-MODULE              0000000
027410     MOVE SIT-ISC-NOM-CENTRE      TO  XX-SITE-NOM                 0000000
027420                                                                  0000000
027430     ACCEPT  W-HEURE  FROM  TIME.                                 0000000
027440     STRING  W-HH ':' W-MIN DELIMITED BY SIZE INTO W-HEURE-5.     0000000
027450*                                                                 0000000
027460* DETERMINER LA DATE DE TRAITEMENT                                0000000
027470*                                                                 0000000
027480     IF  W-HEURE9  <  08000000                                    0000000
027490D        DISPLAY '  PGM-AAAAQQQ '  PGM-AAAAQQQ                    0000000
027500         IF PGM-AAAAQQQ > 0                                       0000000
027510            INITIALIZE DATS20                                     0000000
027520            MOVE PGM-AAAAQQQ TO DATS20-I-DATE1-P                  0000000
027530            MOVE 'D01' TO DATS20-I-FONCTION                       0000000
027540            MOVE 'Q'   TO DATS20-I-ENTREE-TYPE1                   0000000
027550            MOVE 'A'   TO DATS20-I-ENTREE-SENS1                   0000000
027560            MOVE -1    TO DATS20-I-NBJOURS                        0000000
027570            MOVE 'O'   TO DATS20-I-RETOUR-PACKE                   0000000
027580            MOVE 'N'   TO DATS20-I-RETOUR-SIECLE                  0000000
027590            CALL 'ZCALLPGM' USING ZDAT2000 DATS20                 0000000
027600D           DISPLAY DATS20-O-CODRET                               0000000
027610D           DISPLAY DATS20-O-LIBRET                               0000000
027620            MOVE DATS20-O-MSG  TO W-DATRAIT                       0000000
027630D           DISPLAY 'DATE DE TRAI av : ' W-DATRAIT                0000000
027640         ELSE                                                     0000000
027650            MOVE  ZERO         TO W-DATRAIT                       0000000
027660D           DISPLAY 'PB DATE DE TRT INVALIDE'                     0000000
027670         END-IF                                                   0000000
027680     ELSE                                                         0000000
027690         MOVE    PGM-AAQQQ    TO  W-DATRAIT.                      0000000
027700D    DISPLAY 'PGM-AAQQQ          : ' PGM-AAQQQ.                   0000000
027710     DISPLAY 'DATE DE TRAITEMENT : ' W-DATRAIT.                   0000000
027720                                                                  0000000
027730     MOVE W-DATRAIT         TO ZDATE-INPUT  V-DATREF-5.           0000000
027740     PERFORM TSFO-AAQQQ-SSAAMMJJ.                                 0000000
027750     MOVE   ZDATE-OUTPUT    TO  W-DATE-8    V-DATREF-8.           0000000
027760     DISPLAY 'DATE DE TRAITEMENT SUR 8  : ' W-DATE-8.             0000000
027770                                                                  0000000
027780*     APPEL SOUS-PROG PRTLNK                                      0000000
027790     MOVE 'IPPBATCH'        TO PRTLNK-PGM-A                       0000000
027800     CALL 'ZCALLPGM' USING  ZPRTLNK                               0000000
027810                            PRTLNK                                0000000
027820                            IOPCB.                                0000000
027830                                                                  0000000
027840*--> Sauvegarde des PCB pour GCOR                                 0000000
027850* gar3                                                            0000000
027860     set ARKPCB-PTR(1)   to address of PCBSPI                     0000000
027870     set ARKPCB-PTR(8)   to address of ADRIND                     0000000
027880     set ARKPCB-PTR(9)   to address of ADRDES                     0000000
027890     set ARKPCB-PTR(10)  to address of ADRADR                     0000000
027900     set ARKPCB-PTR(11)  to address of ADRLIT                     0000000
027910     set ARKPCB-PTR(12)  to address of ADRCLI                     0000000
027920     set ARKPCB-PTR(13)  to address of REPMAJ                     0000000
027930                                                                  0000000
027940d    display 'ADRCLI '  ADRCLI                                    0000000
027950d    display 'ADRIND '  ADRIND                                    0000000
027960d    display 'ADRDES '  ADRDES                                    0000000
027970d    display 'ADRADR '  ADRADR                                    0000000
027980d    display 'ADRLIT '  ADRLIT                                    0000000
027990d    display 'REPMAJ '  REPMAJ                                    0000000
028000                                                                  0000000
028010     PERFORM  LECTURE-SCRIVENER.                                  0000000
028020*                                                                 0000000
028030     PERFORM  ALIM-YACMPSB.                                       0000000
028040                                                                  0000000
028050     SET MAJ-IPPMA2-INDETERMINE   TO TRUE                         0000000
028060     .                                                            0000000
028070*                                                                 0000000
028080*-------------------                                              0000000
028090 OUVERTURE-FICHIERS.                                              0000000
028100*------------------------- PLUS INITIALISATION -----              0000000
028110                                                                  0000000
028120     MOVE  4    TO NB-PRET-MAX.                                   0000000
028130     MOVE  8    TO NBGAR-PRET.                                    0000000
028140     MOVE  20   TO NB-CLA                                         0000000
028150     MOVE ZERO  TO RETOUR.                                        0000000
028160     MOVE ZERO  TO FF-APPEL.                                      0000000
028170     MOVE SPACE TO TEXTE.                                         0000000
028180     MOVE SPACE TO CTL.                                           0000000
028190     MOVE ZERO  TO CTL-R34.                                       0000000
028200*AN  MOVE   ZDEBPGM-AAQQQ    TO  CTL-DATE.                        0000000
028210     MOVE   PGM-AAQQQ     TO  CTL-DATE.                           0000000
028220     MOVE W-HEURE9   TO  CTL-TIME.                                0000000
028230     MOVE ZERO  TO NOMBRE-ANOMALIE.                               0000000
028240     MOVE ZERO  TO NB-MAJ-KO.                                     0000000
028250                                                                  0000000
028260     PERFORM   OUVERTURE-ADRESSE-CLIENT.                          0000000
028270                                                                  0000000
028280     OPEN INPUT  FAPPEL.                                          0000000
028290     OPEN OUTPUT FANOM.                                           0000000
028300     OPEN OUTPUT FRECYC.                                          0000000
028310     OPEN OUTPUT FEVT.                                            0000000
028320     DISPLAY '*** IPPBATCH FICHIER  APPEL    OUVERT ***'.         0000000
028330     DISPLAY '*** IPPBATCH FICHIER  FACTURE  OUVERT ***'.         0000000
028340     DISPLAY '*** IPPBATCH FICHIER  EDITION  OUVERT ***'.         0000000
028350     DISPLAY '*** IPPBATCH FICHIER  ANOMALIE OUVERT ***'.         0000000
028360     DISPLAY '*** IPPBATCH FICHIER  FMVTEDT  OUVERT ***'.         0000000
028370     DISPLAY '*** IPPBATCH FICHIER  FRECYC   OUVERT ***'.         0000000
028380     DISPLAY '*** IPPBATCH FICHIER  FEVT     OUVERT ***'.         0000000
028390                                                                  0000000
028400     MOVE ZERO TO DIDO-ETAT.                                      0000000
028410     PERFORM OUVERTURE-XICS.                                      0000000
028420     DISPLAY SPACE.                                               0000000
028430*                                                                 0000000
028440**** INITIALISATION DES VArIABLES DE RUPTURE                      0000000
028450     MOVE LOW-VALUE TO SEQ-CAIS.                                  0000000
028460     MOVE LOW-VALUE TO SEQ-ROUT.                                  0000000
028470     MOVE ZERO      TO TOP-INTERCALAIRE.                          0000000
028480     MOVE ZERO      TO RUPTURE-LYON.                              0000000
028490     MOVE ZERO      TO CPT-IPC                                    0000000
028500     MOVE ZERO      TO CPT-IPP                                    0000000
028510     MOVE ZERO      TO CPT-IPI                                    0000000
028520     MOVE ZERO      TO CPT-IPXMAJ-ECRITS                          0000000
028530*                                                                 0000000
028540**** RAJOUT 13/08/91 POUR PARAMETRAGE SIAGI : DATE DU JOUR        0000000
028550*                                                                 0000000
028560     CALL 'ZCALLPGM' USING ACCEPTA2                               0000000
028570                           DATJOUR    HEUJOUR.                    0000000
028580*                                                                 0000000
028590     MOVE  DATJOUR-AA TO DATE10-SSAA                              0000000
028600     MOVE  DATJOUR-MM TO DATE10-MM                                0000000
028610     MOVE  DATJOUR-JJ TO DATE10-JJ                                0000000
028620     .                                                            0000000
028630                                                                  0000000
028640                                                                  0000000
028650***  OUVERTURE DES BASES POUR LA RECHERCHE DES ADRESSES CLIENTS   0000000
028660*--------------------------------                                 0000000
028670 OUVERTURE-ADRESSE-CLIENT.                                        0000000
028680*--------------------------------                                 0000000
028690                                                                  0000000
028700     MOVE SPACES  TO CLIRAD                                       0000000
028710*    ** RECHERCHE PAR PROGRAMME BATCH                             0000000
028720     MOVE '2'   TO CLIRAD-APPEL                                   0000000
028730*    ** CODE D'OUVERTURE DES BASES                                0000000
028740     MOVE '5'   TO CLIRAD-ACTION.                                 0000000
028750*    ** CODE ZKSDSIN 1, 2 ET 3                                    0000000
028760     MOVE '123' TO CLIRAD-ZKSDSNR.                                0000000
028770                                                                  0000000
028780     PERFORM APPEL-RADSP805.                                      0000000
028790                                                                  0000000
028800                                                                  0000000
028810***  FERMETURE DES BASES POUR LA RECHERCHE DES ADRESSES CLIENTS   0000000
028820*--------------------------------                                 0000000
028830 FERMETURE-ADRESSE-CLIENT.                                        0000000
028840*--------------------------------                                 0000000
028850                                                                  0000000
028860     MOVE SPACES  TO CLIRAD                                       0000000
028870*    ** RECHERCHE PAR PROGRAMME BATCH                             0000000
028880     MOVE '2'   TO CLIRAD-APPEL                                   0000000
028890*    ** CODE DE FERMETURE DES BASES                               0000000
028900     MOVE '6'   TO CLIRAD-ACTION.                                 0000000
028910*    ** CODE ZKSDSIN 1, 2 ET 3                                    0000000
028920     MOVE '123' TO CLIRAD-ZKSDSNR.                                0000000
028930                                                                  0000000
028940     PERFORM APPEL-RADSP805.                                      0000000
028950                                                                  0000000
028960                                                                  0000000
028970                                                                  0000000
028980*------------                                                     0000000
028990 TRAIT-APPEL.                                                     0000000
029000*------------                                                     0000000
029010D    DISPLAY 'TRAIT-APPEL'                                        0000000
029020D            ' / SEQ-CAIS = '       SEQ-CAIS                      0000000
029030D            ' / SEQ-ROUT = '       SEQ-ROUT                      0000000
029040D            ' / APPEL-FEDECAIS = ' APPEL-FEDECAIS.               0000000
029050*                                                                 0000000
029060     MOVE ZERO TO TEST-1.                                         0000000
029070                                                                  0000000
029080**** TEST RUPTURE FEDERATION                                      0000000
029090*    IF   SEQ-APPEL-FEDE NOT = APPEL-FED                          0000000
029100     PERFORM  RECHERCHE-CM-CIC                                    0000000
029110d         DISPLAY 'RUPTURE FEDE --->'.                            0000000
029120                                                                  0000000
029130* SBO22032006                                                     0000000
029140* lecture du parametre pour decider du type de maj ippma2         0000000
029150     IF MAJ-IPPMA2-INDETERMINE                                    0000000
029160        PERFORM LECTURE-PRTCONDI                                  0000000
029170        IF MAJ-IPPMA2-PAR-IPXBMA2J                                0000000
029180           OPEN OUTPUT IPXMAJ                                     0000000
029190           PERFORM ECRITURE-MAJ-IPPMA2-ENTETE                     0000000
029200           DISPLAY '*** IPPBATCH FICHIER  IPXMAJ   OUVERT ***'    0000000
029210        END-IF                                                    0000000
029220     END-IF                                                       0000000
029230                                                                  0000000
029240**** TEST RUPTURE CAISSE  /  SERVICE                              0000000
029250     IF   SUITE                                                   0000000
029260* 28/10/10 P NEDELEC : Rubis 32459 Convergence CMLACO             0000000
029270           If    ORGS01-ASSIMILE-LACO                             0000000
029280                if  SEQ-ROUT  NOT  =  APPEL-ROUT                  0000000
029290                    DISPLAY 'RUPTURE ROUT  '                      0000000
029300                    PERFORM RECHERCHE-CM-CIC                      0000000
029310                    PERFORM LECTURE-MT-ASSUR                      0000000
029320                                                                  0000000
029330                    IF   SUITE                                    0000000
029340                         PERFORM RUPTURE-PREM-CAISSE              0000000
029350                    END-IF                                        0000000
029360                Else                                              0000000
029370                    IF  SEQ-CAIS NOT = APPEL-FEDECAIS             0000000
029380                        DISPLAY 'RUPTURE CAISSE'                  0000000
029390                        PERFORM RECHERCHE-CM-CIC                  0000000
029400                        PERFORM LECTURE-CAISSE                    0000000
029410                    END-IF                                        0000000
029420           ELSE                                                   0000000
029430            IF   ORGS01-ASSIMILE-IDF AND                          0000000
029440                 APPEL-ROUT (1:1) =  'C'                          0000000
029450                 if  SEQ-ROUT  NOT  =  APPEL-ROUT                 0000000
029460D                    DISPLAY 'RUPTURE ROUT paris '                0000000
029470                     PERFORM RECHERCHE-CM-CIC                     0000000
029480                     PERFORM LECTURE-MT-ASSUR                     0000000
029490                                                                  0000000
029500                     IF   SUITE                                   0000000
029510                          PERFORM RUPTURE-PREM-CAISSE             0000000
029520                     END-IF                                       0000000
029530                 Else                                             0000000
029540                     PERFORM LECTURE-CAISSE                       0000000
029550                 End-if                                           0000000
029560            Else                                                  0000000
029570              IF  SEQ-CAIS NOT = APPEL-FEDECAIS                   0000000
029580D                 DISPLAY 'RUPTURE CAISSE'                        0000000
029590                  PERFORM RECHERCHE-CM-CIC                        0000000
029600                  PERFORM LECTURE-MT-ASSUR                        0000000
029610                                                                  0000000
029620                  IF   SUITE                                      0000000
029630                       PERFORM RUPTURE-PREM-CAISSE                0000000
029640                  END-IF                                          0000000
029650              END-IF                                              0000000
029660            END-IF                                                0000000
029670     END-IF.                                                      0000000
029680                                                                  0000000
029690     if suite                                                     0000000
029700        perform LECT-SPI-DELEG                                    0000000
029710     end-if                                                       0000000
029720                                                                  0000000
029730**** TRAITEMENTS A EFFECTUER :                                    0000000
029740*    . GDP SI IPPMA2-ETAT-VALID-TP       =  2                     0000000
029750*      ---> CONTROLE SUR BASE PRETS                               0000000
029760*      ---> MISE A JOUR IPPMA2                                    0000000
029770*    . EDT SI IPPMA2-ETAT-IMP-TP         =  2                     0000000
029780*      ---> EDITION DES DOCUMENTS                                 0000000
029790*      ---> MISE A JOUR IPPMA2                                    0000000
029800*    . FEEDBACK                                                   0000000
029810                                                                  0000000
029820**** ACCES BASE IPP MASTER                                        0000000
029830     IF   SUITE                                                   0000000
029840          PERFORM LECTURE-IPPMA2-GU.                              0000000
029850*                                                                 0000000
029860d    display 'AUTO-CTR-DLG = ' AUTO-CTR-DLG                       0000000
029870d    display 'IPPMA2-CTR-DLG = ' IPPMA2-CTR-DLG                   0000000
029880     IF   SUITE                                                   0000000
029890          IF AUTO-CTR-DLG-OUI                                     0000000
029900             if (IPPMA2-LABEL-APPLI = 'IPP') or                   0000000
029910                (IPPMA2-LABEL-APPLI = 'IPC' AND IPPMA2-FED = '11')0000000
029920                 continue                                         0000000
029930             else                                                 0000000
029940                IF NOT  IPPMA2-CTR-DLG-OUI                        0000000
029950*                 If  not ( appel-appli = 'SIM' )                 0000000
029960d                  display 'annulation validation deleg'          0000000
029970                   MOVE '0' TO IPPMA2-ETAT-IMP-TP                 0000000
029980                   MOVE '0' TO IPPMA2-ETAT-VALID-TP.              0000000
029990                                                                  0000000
030000                                                                  0000000
030010     IF   SUITE                                                   0000000
030020          PERFORM TRAIT-APPEL-OK.                                 0000000
030030                                                                  0000000
030040     IF  CTL-R34  =  ZERO                                         0000000
030050D        DISPLAY 'NOUVELLE LECTURE APPEL '                        0000000
030060         IF  FF-APPEL   =   ZERO                                  0000000
030070             PERFORM LECTURE-APPEL.                               0000000
030080                                                                  0000000
030090*---------------                                                  0000000
030100 TRAIT-APPEL-OK.                                                  0000000
030110*---------------                                                  0000000
030120     MOVE ZERO TO GDP-OK EDT-OK.                                  0000000
030130     MOVE ZERO TO BOOL-RECYCLE.                                   0000000
030140     MOVE ZERO TO SALARIE.                                        0000000
030150     MOVE ZERO TO SALARIE-TR1-2.                                  0000000
030160     MOVE ZERO TO SALARIE-MARSEILLE.                              0000000
030170     MOVE 'N'  TO DROIT-LOCAL.                                    0000000
030180     MOVE 'O'  TO AUCUNE-HYP-EXIST.                               0000000
030190     MOVE 'N'  TO CONTRAT-EDITE.                                  0000000
030200     MOVE 'N'  TO HYP-EXIST.                                      0000000
030210     MOVE 'N'  TO HYP-DECRIT.                                     0000000
030220     MOVE 'N'  TO 42-EXIST.                                       0000000
030230     MOVE 'N'  TO PPD-EXIST.                                      0000000
030240     MOVE 'N'  TO CAU-HYP-EXIST.                                  0000000
030250     MOVE 'N'  TO CAU-EXIST.                                      0000000
030260     MOVE 'N'  TO MADELIN-EXIST.                                  0000000
030270     MOVE 'N'  TO GENDARME-EXIST.                                 0000000
030280     MOVE 'N'  TO MD-DEVISE.                                      0000000
030290     MOVE 'N'  TO RIB-PREVU.                                      0000000
030300     MOVE 'N'  TO   SIAGI-PREVU.                                  0000000
030310     MOVE 'N'  TO   PTZ-PREVU.                                    0000000
030320     MOVE 'N'  TO   PPL-PREVU.                                    0000000
030330     MOVE 'N'  TO   PL92-PREVU.                                   0000000
030340     MOVE 'N'  TO   PAS-PREVU.                                    0000000
030350     MOVE 'N'  TO   METEO-PREVU.                                  0000000
030360     MOVE 'N'  TO   GAR-AL-PREVUE                                 0000000
030370     MOVE 'N'  TO   GAR-E4-PREVUE                                 0000000
030380     MOVE 'N'  TO   GAR-E5-PREVUE                                 0000000
030390     MOVE 'N'  TO   GAR-EA-PREVUE                                 0000000
030400     MOVE 'N'  TO   GAR-EB-PREVUE                                 0000000
030410     MOVE 'N'  TO   GAR-EC-PREVUE                                 0000000
030420     MOVE 'N'  TO   GAR-EE-PREVUE                                 0000000
030430     MOVE 'N'  TO   GAR-EN-PREVUE                                 0000000
030440     MOVE 'N'  TO   ASS-DELEG (1)  ASS-DELEG (2)                  0000000
030450     MOVE 'N'  TO   ASS-DELEG (3)  ASS-DELEG (4)                  0000000
030460     MOVE 'N'  TO   GAR-SX-PREVUE                                 0000000
030470     MOVE 'N'  TO   GAR-14-PREVUE                                 0000000
030480     MOVE 'N'  TO   GAR-19-PREVUE                                 0000000
030490     MOVE 'N'  TO   GAR-10-PREVUE                                 0000000
030500     MOVE 'N'  TO   GAR-50-PREVUE                                 0000000
030510     MOVE 'N'  TO   GAR-51-PREVUE                                 0000000
030520     MOVE 'N'  TO   GAR-68-PREVUE                                 0000000
030530     MOVE 'N'  TO   GAR-95-PREVUE                                 0000000
030540     MOVE 'N'  TO   GAR-97-PREVUE                                 0000000
030550     MOVE 'N'  TO   GAR-E7-PREVUE                                 0000000
030560     MOVE ZERO TO   GAR-E7-PRET      GAR-E7-GAR                   0000000
030570     MOVE 'N'  TO   GAR-E8-PREVUE                                 0000000
030580     MOVE ZERO TO   GAR-E8-PRET      GAR-E8-GAR                   0000000
030590     MOVE 'N'  TO   GAR-42-PREVUE                                 0000000
030600     MOVE 'N'  TO   LETAS000-PREVUE                               0000000
030610     MOVE 'N'  TO   NOTAIRE-PREVUE                                0000000
030620     MOVE 'N'  TO   IND-TRAIT-GDP                                 0000000
030630     MOVE 'N'  TO   NAASS000-PREVUE                               0000000
030640     SET DOSSIER-NON-FACTURE   TO TRUE                            0000000
030650                                                                  0000000
030660     SET   CREDIPLAN-55-KO  TO TRUE                               0000000
030670     MOVE SPACES      TO  W-TAB-GAR.                              0000000
030680     SET  DOSSIER-OK  TO  TRUE.                                   0000000
030690                                                                  0000000
030700     IF   CTL-R34  =  ZERO                                        0000000
030710          IF  AVENANT                                             0000000
030720* re edition le soir des mvts du midi   ooooooooooo               0000000
030730*             IF  (APPEL-JOUR  =  SPACES  OR  ZERO OR 'O' )       0000000
030740              IF  (APPEL-JOUR  =  SPACES  OR  ZERO )              0000000
030750                   MOVE 'O' TO CONTRAT-EDITE                      0000000
030760                   PERFORM TRAITEMENT-EDT                         0000000
030770              END-IF                                              0000000
030780          ELSE                                                    0000000
030790                                                                  0000000
030800          IF  (( IPPMA2-ETAT-IMP-TP   = '2') OR                   0000000
030810               ( CONTRAT-GPR )                                    0000000
030820               OR appel-appli = 'SIM'                             0000000
030830               OR  (ORGS01-FEDE-LAVAL  AND                        0000000
030840                   IPPMA2-DERN-ACTION-TP  =  'INS' ))             0000000
030850                                                                  0000000
030860* re edition le soir des mvts du midi  ooooooooooo                0000000
030870*              IF  (APPEL-JOUR  =  SPACES OR ZERO OR 'O' )        0000000
030880               IF  (APPEL-JOUR  =  SPACES OR ZERO )               0000000
030890                   If appel-appli  not  =  'IPC'                  0000000
030900                        MOVE 'O' TO CONTRAT-EDITE                 0000000
030910                        PERFORM TRAITEMENT-EDT.                   0000000
030920                                                                  0000000
030930D    DISPLAY ' CTL-R34 = ' CTL-R34                                0000000
030940D    DISPLAY ' CONTRAT : ' CONTRAT-AVENANT                        0000000
030950D    DISPLAY ' IPPMA2-ETAT-VALID-TP : ' IPPMA2-ETAT-VALID-TP      0000000
030960D    DISPLAY ' IPPMA2-DERN-ACTION-TP : ' IPPMA2-DERN-ACTION-TP    0000000
030970                                                                  0000000
030980     IF   CTL-R34 = ZERO  AND  CONTRAT                            0000000
030990          IF   IPPMA2-ETAT-VALID-TP = '2'                         0000000
031000****           OUVERTURE OU (EDITION + OUV)                       0000000
031010               IF ( (IPPMA2-DERN-ACTION-TP = 'OUV'                0000000
031020               OR    IPPMA2-DERN-ACTION-TP = 'E+O'))              0000000
031030                 if (PASSAGE-JOUR  and MAJ-IPPMA2-PAR-IPXBMA2J )  0000000
031040                     PERFORM TRAITEMENT-GDP                       0000000
031050                 end-if                                           0000000
031060****           PAS D'OUVERTURE DEMANDEE                           0000000
031070               ELSE MOVE '2' TO GDP-OK.                           0000000
031080                                                                  0000000
031090     IF   CTL-R34 = ZERO  AND (AVENANT OR CONTRAT-GPR)            0000000
031100          MOVE '2' TO GDP-OK.                                     0000000
031110*                                                                 0000000
031120* Valeur de GDP :                                                 0000000
031130*       0  ouverture/maj pret demande et OK                      0000000
031140*       1  ouverture/maj pret demande et KO                      0000000
031150*       2  pas d'ouverture/maj prets demande.                    0000000
031160*                                                                 0000000
031170     IF   CTL-R34 = ZERO                                          0000000
031180          IF  DOSSIER-OK                                          0000000
031190              PERFORM TRAIT-COPIE-DUSOIR.                         0000000
031200*                                                                 0000000
031210*   RECYCLAGE AVEC FLAG POUR TRAITEMENT DU SOIR                   0000000
031220*                                                                 0000000
031230 TRAIT-COPIE-DUSOIR.                                              0000000
031240                                                                  0000000
031250     IF  ( APPEL-JOUR  NOT  =  'R' )                              0000000
031260         MOVE  'O'  TO  APPEL-JOUR                                0000000
031270     end-if                                                       0000000
031280                                                                  0000000
031290     PERFORM ECRITURE-RECYCLE                                     0000000
031300                                                                  0000000
031310*sbo21032006 maj ippma2 directe par appel  IPPGBPR2 ou batch     0000000
031320*                                                       IPPBMA2J  0000000
031330     IF MAJ-IPPMA2-PAR-IPXBMA2J AND DOSSIER-FACTURE               0000000
031340        PERFORM ECRITURE-MAJ-IPPMA2                               0000000
031350     END-IF                                                       0000000
031360     .                                                            0000000
031370                                                                  0000000
031380*                                                                 0000000
031390****     G . D . P.                                               0000000
031400****     =========                                                0000000
031410*                                                                 0000000
031420****  - CONTROLE TRAITEMENT EFFECTUE                              0000000
031430*                                                                 0000000
031440*       OUVERTURE    DOSSIER / PRET (CODE MAJ = 1) :              0000000
031450*          EXISTENCE SUR BASE PRET                                0000000
031460*          DATE OUVERTURE > DATE SYSTEME                          0000000
031470*       MISE A JOUR  DOSSIER / PRET (CODE MAJ = 3) :              0000000
031480*          EXISTENCE SUR BASE PRET                                0000000
031490*          DATE MISE A JOUR > DATE SYSTEME                        0000000
031500*       SUPPRESSION  DOSSIER / PRET (CODE MAJ = 9) :              0000000
031510*          EXISTENCE SUR BASE PRET                                0000000
031520*          DATE MISE A JOUR > DATE SYSTEME                        0000000
031530*          CODE ANNULATION POSITIONNE A "9"                       0000000
031540                                                                  0000000
031550*---------------                                                  0000000
031560 TRAITEMENT-GDP.                                                  0000000
031570*---------------                                                  0000000
031580D    DISPLAY 'TRAITEMENT GDP'                                     0000000
031590     MOVE 'O'            TO IND-TRAIT-GDP                         0000000
031600     MOVE ZERO           TO IND-ANOM.                             0000000
031610                                                                  0000000
031620*                                                                 0000000
031630**** LECTURE BASE IPPMA2 ET IPPCPL                                0000000
031640                                                                  0000000
031650     PERFORM LECTURE-IPPMA2-GU.                                   0000000
031660                                                                  0000000
031670     IF   SUITE                                                   0000000
031680          PERFORM            LECTURE-IPPCPL                       0000000
031690          VARYING IT FROM 1 BY 1 UNTIL IT > 4                     0000000
031700               OR IPPMA2-2-TAB-PRET (IT) = SPACE                  0000000
031710               OR IPPMA2-2-CAT    (IT) NOT NUMERIC                0000000
031720               OR IPPMA2-2-CNAT   (IT) NOT NUMERIC                0000000
031730               OR ARRET.                                          0000000
031740                                                                  0000000
031750**** LECTURE BASE PRET                                            0000000
031760                                                                  0000000
031770     IF   SUITE                                                   0000000
031780          PERFORM LECTURE-PRTIDC                                  0000000
031790          VARYING IT FROM 1 BY 1 UNTIL IT > 4                     0000000
031800               OR IPPMA2-2-TAB-PRET (IT) = SPACE                  0000000
031810               OR IPPMA2-2-CAT    (IT) NOT NUMERIC                0000000
031820               OR IPPMA2-2-CNAT   (IT) NOT NUMERIC                0000000
031830               OR GDP-OK  = '1'                                   0000000
031840               OR ARRET.                                          0000000
031850                                                                  0000000
031860     IF   CTL-R34 = ZERO                                          0000000
031870          IF   SUITE AND GDP-OK = '0'                             0000000
031880               PERFORM CONTROLE-GDP-DOSSIER.                      0000000
031890                                                                  0000000
031900     IF   CTL-R34 = ZERO                                          0000000
031910          IF   SUITE AND not APPEL-JOUR = 'O'                     0000000
031920               PERFORM  TRAITEMENT-EVT                            0000000
031930          VARYING IT FROM 1 BY 1 UNTIL IT > 4                     0000000
031940               OR IPPMA2-2-TAB-PRET (IT) = SPACE                  0000000
031950               OR IPPMA2-2-CAT    (IT) NOT NUMERIC                0000000
031960               OR IPPMA2-2-CNAT   (IT) NOT NUMERIC                0000000
031970               OR GDP-OK  = '1'                                   0000000
031980               OR ARRET.                                          0000000
031990                                                                  0000000
032000*---------------                                                  0000000
032010 LECTURE-IPPCPL.                                                  0000000
032020*---------------                                                  0000000
032030                                                                  0000000
032040     MOVE ZERO            TO EXIST-PRTSAYG                        0000000
032050     MOVE ZERO            TO EXIST-PRTCPT                         0000000
032060     MOVE ZERO            TO EXIST-IPPCPL                         0000000
032070     MOVE SPACES          TO DATOUV-SSAAMMJJ                      0000000
032080     IF (IPPMA2-ETAT-TRAITE-TR   =  '2'                           0000000
032090         OR  (IPPMA2-2-EXIST-PRT(IT)    NOT = '1'))               0000000
032100         OR  (AVENANT OR  CONTRAT-GPR)                            0000000
032110         MOVE  IT  TO  IY                                         0000000
032120         PERFORM LECTURE-BASE-PRET                                0000000
032130         If  suite                                                0000000
032140             Set  Pret-deja-lu  to  True                          0000000
032150         End-if                                                   0000000
032160                                                                  0000000
032170     ELSE                                                         0000000
032180       IF IPPMA2-2-EXIST-PRT(IT)  = '1'                           0000000
032190          MOVE IPPMA2-2-CAT9(IT)  TO IPPCPL-CAT                   0000000
032200          MOVE 'G'              TO IPPCPL-CODENR                  0000000
032210          PERFORM LECTURE-IPPCPL-GU                               0000000
032220                                                                  0000000
032230          IF SUITE                                                0000000
032240             MOVE IPPCPL-PRTSAY TO PRTSAY                         0000000
032250                                                                  0000000
032260*mpe : adaptations pour tse                                       0000000
032270             Move SAY-CodGesAss to pret-tse                       0000000
032280d            display 'pret-tse :' pret-tse                        0000000
032290D            DISPLAY 'SAY-TAUDB = ' SAY-TAUDB                     0000000
032300D            DISPLAY 'SAY-TAUDB = ' SAY-TAUDB                     0000000
032310D            DISPLAY 'SAY-TAUFR = ' SAY-TAUFR                     0000000
032320D            DISPLAY 'SAY-MIXT-TAUDb-V :' SAY-MIXT-TAUDb-V        0000000
032330D            DISPLAY 'SAY-MIXT-TAUDb-F :' SAY-MIXT-TAUDb-F        0000000
032340D            DISPLAY 'IPPCPL-TAUDB-HA  :' IPPCPL-TAUDB-HA         0000000
032350D            DISPLAY 'IPPCPL-TAUFR-HA  :' IPPCPL-TAUFR-HA         0000000
032360D            DISPLAY 'IPPCPL-MIXT-TAUHA-V :' IPPCPL-MIXT-TAUHA-v  0000000
032370D            DISPLAY 'IPPCPL-MIXT-TAUHA-f :' IPPCPL-MIXT-TAUHA-f  0000000
032380             MOVE SAY-MTCRED    TO Z-MONTANT(IT)                  0000000
032390                                                                  0000000
032400             if IND-TRAIT-GDP = 'O'                               0000000
032410                Perform  appel-ipxzappp                           0000000
032420d               display 'APXTR5-TAUASSPRT:' APXTR5-TAUASSPRT      0000000
032430                IF APXTR5-TYPTAR-ENCOURS                          0000000
032440d                     display 'SAY-TAUDB :' SAY-TAUDB             0000000
032450                      COMPUTE WS-TAUX =                           0000000
032460                              SAY-TAUDB - APXTR5-TAUASSPRT        0000000
032470d                     display 'ws-taux :' ws-taux                 0000000
032480                      MOVE WS-TAUX TO Z-TAUDB (IT)                0000000
032490                ELSE                                              0000000
032500                   MOVE SAY-TAUDB TO Z-TAUDB  (IT)                0000000
032510                END-IF                                            0000000
032520             ELSE                                                 0000000
032530                MOVE SAY-TAUDB  TO Z-TAUDB  (IT)                  0000000
032540             END-IF                                               0000000
032550D            DISPLAY 'Aprs recalcul :'                           0000000
032560D            DISPLAY 'SAY-TAUDB = ' SAY-TAUDB                     0000000
032570D            DISPLAY 'SAY-MIXT-TAUDb-V :' SAY-MIXT-TAUDb-V        0000000
032580D            DISPLAY 'SAY-MIXT-TAUDb-F :' SAY-MIXT-TAUDb-F        0000000
032590                                                                  0000000
032600             MOVE SAY-TERME           TO Z-TERME  (IT)            0000000
032610             MOVE SAY-DURAM           TO Z-DURAM  (IT)            0000000
032620             MOVE SAY-CODRET          TO Z-CODRET (IT)            0000000
032630             MOVE SAY-DCMAJ           TO Z-DCMAJ                  0000000
032640             MOVE SAY-CMAJ            TO Z-CMAJ   (IT)            0000000
032650             MOVE SAY-DOMICIL         TO Z-DOMICIL(IT)            0000000
032660*            PERFORM APPEL-IPXZPROD                               0000000
032670             PERFORM AN-2000.                                     0000000
032680                                                                  0000000
032690                                                                  0000000
032700D    DISPLAY 'SAY-NB-TIMBRE9 = ' SAY-NB-TIMBRE9                   0000000
032710     IF  (EXIST-PRTSAYG  =  1   OR                                0000000
032720          EXIST-IPPCPL   =  1)                                    0000000
032730          PERFORM  TRAITEMENT-FRAIS-TIMBRE                        0000000
032740     END-IF                                                       0000000
032750     .                                                            0000000
032760                                                                  0000000
032770*----------------                                                 0000000
032780 RECH-DATOUV-PTZ.                                                 0000000
032790*----------------                                                 0000000
032800                                                                  0000000
032810     MOVE ZERO            TO CTL-R34                              0000000
032820     MOVE ZERO            TO EXIST-PRTSAYGB                       0000000
032830     MOVE IPPMA2-FED      TO IPPMSGX-FED                          0000000
032840     MOVE ORGS01-BANQUE   TO IPPMSGX-BANQUE                       0000000
032850                                                                  0000000
032860     MOVE IPPMA2-CAISSE   TO IPPMSGX-CAISSE                       0000000
032870     MOVE IPPMA2-RACINE   TO IPPMSGX-RACINE                       0000000
032880     MOVE IPPMA2-DOSS     TO IPPMSGX-DOSS                         0000000
032890     MOVE IPPMA2-2-CAT9(1) TO IPPMSGX-CAT                         0000000
032900                                                                  0000000
032910     Perform  varying i-p2  from 1 by 1                           0000000
032920              until  i-p2  > nb-pret-max                          0000000
032930d       display ' ippma2-2-cnat ' i-p2 '  ' ippma2-2-cnat (i-p2)  0000000
032940        If  ippma2-2-cnat (i-p2)  =  '291'                        0000000
032950            MOVE IPPMA2-2-CAT9(I-P2)  TO  IPPMSGX-CAT             0000000
032960        End-if                                                    0000000
032970     End-perform                                                  0000000
032980                                                                  0000000
032990d    display 'ippmsgx-cat '  ippmsgx-cat                          0000000
033000                                                                  0000000
033010     CALL 'ZCALLPGM' USING   IPPRBPR9                             0000000
033020                             IPPMSGX                              0000000
033030                             EXIST-PRTSAYGB                       0000000
033040                             PRTSAYP                              0000000
033050                             PRTCPTB                              0000000
033060                             CTL                                  0000000
033070                             PCBPRT                               0000000
033080                                                                  0000000
033090     IF   EXIST-PRTSAYGB  =  1   AND  CTL-R34  =  ZERO            0000000
033100          CALL  'ZCALLPGM'  USING  ZPRTZDA1                       0000000
033110                                   PRTCPTB                        0000000
033120                                   PRTCP2B                        0000000
033130                                                                  0000000
033140          IF   CP2B-DATOUV NUMERIC                                0000000
033150          AND  CP2B-DATOUV GREATER THAN ZERO                      0000000
033160               MOVE CP2B-DATOUV TO  DATOUV-PTZ                    0000000
033170          ELSE                                                    0000000
033180               MOVE   W-DATE-8 TO  DATOUV-PTZ                     0000000
033190     ELSE                                                         0000000
033200          MOVE   W-DATE-8 TO  DATOUV-PTZ                          0000000
033210     END-IF                                                       0000000
033220D    DISPLAY 'DATOUV-SSAAMMJJ ' DATOUV-PTZ                        0000000
033230     .                                                            0000000
033240                                                                  0000000
033250                                                                  0000000
033260*----------------                                                 0000000
033270 RECH-DATOUV-SAY.                                                 0000000
033280*----------------                                                 0000000
033290                                                                  0000000
033300     MOVE ZERO            TO CTL-R34                              0000000
033310     MOVE IPPMA2-FED      TO IPPMSGX-FED                          0000000
033320     MOVE ORGS01-BANQUE   TO IPPMSGX-BANQUE                       0000000
033330                                                                  0000000
033340     MOVE IPPMA2-CAISSE   TO IPPMSGX-CAISSE                       0000000
033350     MOVE IPPMA2-RACINE   TO IPPMSGX-RACINE                       0000000
033360     MOVE IPPMA2-DOSS     TO IPPMSGX-DOSS                         0000000
033370     MOVE IPPMA2-2-CAT9(IP) TO IPPMSGX-CAT                        0000000
033380                                                                  0000000
033390     CALL 'ZCALLPGM' USING   IPPRBPR9                             0000000
033400                             IPPMSGX                              0000000
033410                             EXIST-PRTSAYG                        0000000
033420                             PRTSAYT                              0000000
033430                             PRTCPT                               0000000
033440                             CTL                                  0000000
033450                             PCBPRT                               0000000
033460                                                                  0000000
033470     IF   EXIST-PRTSAYG   =  1   AND  CTL-R34  =  ZERO            0000000
033480          CALL  'ZCALLPGM'  USING  ZPRTZDA1                       0000000
033490                                   PRTCPT                         0000000
033500                                   PRTCP2                         0000000
033510                                                                  0000000
033520          IF   CP2-DATOUV NUMERIC                                 0000000
033530          AND  CP2-DATOUV GREATER THAN ZERO                       0000000
033540               MOVE CP2-DATOUV TO  DATOUV-SSAAMMJJ                0000000
033550          ELSE                                                    0000000
033560               MOVE   W-DATE-8 TO  DATOUV-SSAAMMJJ                0000000
033570     ELSE                                                         0000000
033580          MOVE   W-DATE-8 TO  DATOUV-SSAAMMJJ                     0000000
033590     END-IF                                                       0000000
033600D    DISPLAY 'DATOUV-SSAAMMJJ ' DATOUV-SSAAMMJJ                   0000000
033610     .                                                            0000000
033620                                                                  0000000
033630                                                                  0000000
033640 LECTURE-BASE-PRET.                                               0000000
033650                                                                  0000000
033660     MOVE ZERO            TO CTL-R34                              0000000
033670     MOVE IPPMA2-FED      TO IPPMSGX-FED                          0000000
033680     MOVE ORGS01-BANQUE   TO IPPMSGX-BANQUE.                      0000000
033690     MOVE IPPMA2-CAISSE   TO IPPMSGX-CAISSE                       0000000
033700     MOVE IPPMA2-RACINE   TO IPPMSGX-RACINE                       0000000
033710     MOVE IPPMA2-DOSS     TO IPPMSGX-DOSS                         0000000
033720     MOVE IPPMA2-2-CAT9(IY) TO IPPMSGX-CAT                        0000000
033730                                                                  0000000
033740     CALL 'ZCALLPGM' USING   IPPRBPR9                             0000000
033750                             IPPMSGX                              0000000
033760                             EXIST-PRTSAYG                        0000000
033770                             PRTSAY                               0000000
033780                             PRTCPT                               0000000
033790                             CTL                                  0000000
033800                             PCBPRT.                              0000000
033810                                                                  0000000
033820     if   CTL-R34  not = zero                                     0000000
033830          DISPLAY  ' sbo21032007 ctl ' ctl                        0000000
033840          DISPLAY  ' IPPMA2-CLE ' IPPMA2-CLE                      0000000
033850          DISPLAY  ' IPPMSGX    ' IPPMSGX                         0000000
033860          MOVE  IY  TO IND-ANOM                                   0000000
033870          MOVE  41  TO  TEST-1                                    0000000
033880          move  'Pb base  pret  CTL retour err    '               0000000
033890                          to  ANOM-41                             0000000
033900          PERFORM TRAIT-ANOMALIE                                  0000000
033910     ELSE                                                         0000000
033920     IF   EXIST-PRTSAYG  NOT  =  1                                0000000
033930D         DISPLAY  ' IY '  IY                                     0000000
033940D         DISPLAY  ' IPPMA2-CLE ' IPPMA2-CLE                      0000000
033950D         DISPLAY  ' IPPMSGX    ' IPPMSGX                         0000000
033960          MOVE  IY  TO IND-ANOM                                   0000000
033970          MOVE  41  TO  TEST-1                                    0000000
033980          move  'Pret abs base pret  lecture-base-pret '          0000000
033990                          to  ANOM-41                             0000000
034000          PERFORM TRAIT-ANOMALIE                                  0000000
034010     ELSE                                                         0000000
034020          MOVE  PRTSAY  TO  PRTSAYT                               0000000
034030                                                                  0000000
034040          MOVE  1  TO  EXIST-PRTCPT                               0000000
034050D         DISPLAY 'CPT-TX-MINI-IND' CPT-TX-MINI-IND               0000000
034060D         DISPLAY 'CPT-TX-MAXI-IND' CPT-TX-MAXI-IND               0000000
034070D         DISPLAY 'SAY-TX-MINI-IND' SAY-TX-MINI-IND               0000000
034080D         DISPLAY 'SAY-TX-MAXI-IND' SAY-TX-MAXI-IND               0000000
034090D         DISPLAY 'SAY-NO-DOSSIER ' SAY-NO-DOSSIER                0000000
034100D         DISPLAY 'SAY-NO-PRET    ' SAY-NO-PRET                   0000000
034110D         DISPLAY 'CPT-DATOUV     ' CPT-DATOUV                    0000000
034120D         DISPLAY 'CPT-CD-COND-SAL ' CPT-CD-COND-SAL              0000000
034130          CALL  'ZCALLPGM'  USING  ZPRTZDA1                       0000000
034140                                   PRTCPT                         0000000
034150                                   PRTCP2                         0000000
034160                                                                  0000000
034170          IF   CP2-DATOUV NUMERIC                                 0000000
034180          AND  CP2-DATOUV GREATER THAN ZERO                       0000000
034190               MOVE CP2-DATOUV TO  DATOUV-SSAAMMJJ                0000000
034200          ELSE                                                    0000000
034210               MOVE   W-DATE-8 TO  DATOUV-SSAAMMJJ                0000000
034220          END-IF                                                  0000000
034230D         DISPLAY 'CP2-DATOUV     ' CP2-DATOUV                    0000000
034240          IF  AVENANT                                             0000000
034250              PERFORM  MAJ-SAY                                    0000000
034260          END-IF                                                  0000000
034270*  Lecture prtcondi pour savoir si a la date d'ouverture          0000000
034280*           l'assurance etait dans le teg ou pas.                 0000000
034290          PERFORM  PRTCONDI-5001                                  0000000
034300                                                                  0000000
034310          MOVE SAY-MTCRED    TO Z-MONTANT(IY)                     0000000
034320          MOVE SAY-TAUDB     TO Z-TAUDB  (IY)                     0000000
034330D         DISPLAY 'SAY-TAUDB = ' SAY-TAUDB                        0000000
034340          MOVE SAY-TERME     TO Z-TERME  (IY)                     0000000
034350          MOVE SAY-DURAM     TO Z-DURAM  (IY)                     0000000
034360          MOVE SAY-CODRET    TO Z-CODRET (IY)                     0000000
034370          MOVE SAY-DCMAJ     TO Z-DCMAJ                           0000000
034380          MOVE SAY-CMAJ      TO Z-CMAJ   (IY)                     0000000
034390          MOVE SAY-DOMICIL   TO Z-DOMICIL(IY)                     0000000
034400*         PERFORM  APPEL-IPXZPROD                                 0000000
034410          PERFORM  AN-2000.                                       0000000
034420                                                                  0000000
034430 APPEL-IPXZPROD.                                                  0000000
034440                                                                  0000000
034450     MOVE ZERO              TO CTL-RETOUR.                        0000000
034460*                                                                 0000000
034470     INITIALIZE  IPXPRO.                                          0000000
034480     MOVE SAY-NCAIS        TO IPXPRO-NCAIS.                       0000000
034490     MOVE SAY-FED          TO IPXPRO-FEDE.                        0000000
034500     MOVE SAY-CNAT         TO IPXPRO-CNAT            W-CNAT       0000000
034510     MOVE SAY-CD-SOUS-PROD TO IPXPRO-CD-SOUS-PROD                 0000000
034520     MOVE SAY-CD-SOUS-PROD (2:2)                 to  W-csprd      0000000
034530     MOVE SAY-DEVISE       TO IPXPRO-DEVISE.                      0000000
034540     MOVE  'X'             TO CTL-TRAIT.                          0000000
034550     move DATOUV-SSAAMMJJ  to ipxpro-datouv                       0000000
034560                                                                  0000000
034570D    DISPLAY  'IPXPRO ' IPXPRO                                    0000000
034580                                                                  0000000
034590     CALL 'ZCALLPGM' USING IPXZPROD                               0000000
034600                           CTL                                    0000000
034610                           IPXPRO                                 0000000
034620                           IPPPRD                                 0000000
034630                           PCBSPI.                                0000000
034640*                                                                 0000000
034650                                                                  0000000
034660     IF  CTL-R34  NOT  =  ZERO                                    0000000
034670D    DISPLAY  'ctl    ' ctl                                       0000000
034680         MOVE 23 TO TEST-1                                        0000000
034690         PERFORM  TRAIT-ANOMALIE                                  0000000
034700     ELSE                                                         0000000
034710         MOVE  IPPPRD-TYPE-CREDIT   TO Z-TYPCRED                  0000000
034720         MOVE  IPPPRD-TYPPRT        TO Z-TYPPRET                  0000000
034730         IF    SAY-CNAT      =  '293'                             0000000
034740               MOVE  1  TO  IPPPRI-MODULA                         0000000
034750         END-IF                                                   0000000
034760     END-IF.                                                      0000000
034770                                                                  0000000
034780D    IF  IPXPRO-OPTION-TX-FIXE                                    0000000
034790D        DISPLAY 'OPTION-TX-FIXE '                                0000000
034800D    END-IF.                                                      0000000
034810                                                                  0000000
034820     IF SUITE                                                     0000000
034830*          if  w-cprod  =  '29171'                                0000000
034840*              Perform  warning-1                                 0000000
034850*          End-if                                                 0000000
034860           MOVE IPPPRD-LIBELLE        TO IPPPRI-TITPRET1          0000000
034870           PERFORM TRAIT-PRET-TYPE-X                              0000000
034880                                                                  0000000
034890d       DISPLAY   SAY-CNAT ' ' SAY-CD-SOUS-PROD                   0000000
034900d       DISPLAY   IPPPRD-LIBELLE                                  0000000
034910     END-IF.                                                      0000000
034920                                                                  0000000
034930 AN-2000.                                                         0000000
034940                                                                  0000000
034950     CALL  'ZCALLPGM'  USING  ZPRTZDA2                            0000000
034960                              PRTSAY                              0000000
034970                              PRTSA2.                             0000000
034980                                                                  0000000
034990D    DISPLAY  'SAY-TZDBAR ' SAY-TZDBAR.                           0000000
035000D    DISPLAY  'SA2-TZDBAR ' SA2-TZDBAR.                           0000000
035010                                                                  0000000
035020     IF AVENANT                                                   0000000
035030        IF  SAY-CNAT  =  '226'                                    0000000
035040            MOVE  '265'  TO  SAY-CNAT.                            0000000
035050                                                                  0000000
035060 MAJ-SAY.                                                         0000000
035070                                                                  0000000
035080     MOVE     CPT-DURAM1  TO  SAY-DURAM                           0000000
035090     MOVE     SAY-MTCRED  TO  W-SAY-MTCRED                        0000000
035100*    COMPUTE SAY-MTCRED   =  CPT-CRDBTH  - CPT-CDCIN              0000000
035110     If  cpt-crdb  not =  zero                                    0000000
035120         MOVE cpt-mont  to  SAY-MTCRED  CPT-CRD                   0000000
035130     Else                                                         0000000
035140         COMPUTE SAY-MTCRED   =  CPT-CRD     + CPT-SOLDAUX        0000000
035150     End-if                                                       0000000
035160d    display 'maj-say say-mtcred ' say-mtcred                     0000000
035170     If  say-mges  =  '6'     and                                 0000000
035180         say-mtcre   numeric  and                                 0000000
035190         say-m6 (1)  numeric                                      0000000
035200         if  say-m6(1)  >  say-mtcred                             0000000
035210             Move  say-mtcred  to  say-m6 (1)                     0000000
035220         End-if                                                   0000000
035230     End-if.                                                      0000000
035240                                                                  0000000
035250     MOVE  ZERO  TO  SAY-FRAUT9  SAY-FRHYP9  SAY-MTCOM9.          0000000
035260     MOVE  ZERO  TO  SAY-PARSOC9.                                 0000000
035270                                                                  0000000
035280     IF   SAY-MTCRED  =  ZERO                                     0000000
035290          MOVE cpt-mont  to  SAY-MTCRED  CPT-CRD.                 0000000
035300D    DISPLAY  'CPT-TAUX' CPT-TAUX.                                0000000
035310D    DISPLAY  'CPT-CRD ' CPT-CRD.                                 0000000
035320                                                                  0000000
035330     IF  PAS-DE-IPPMA2                                            0000000
035340         MOVE  SAY-FED            TO  IPPMA2-FED                  0000000
035350         MOVE  SAY-NCAIS          TO  IPPMA2-CAISSE               0000000
035360         MOVE  SAY-RACINE         TO  IPPMA2-RACINE               0000000
035370         IF    SAY-TITUL   NOT    = '0'                           0000000
035380               MOVE SAY-TITUL        TO  IPPMA2-EMP-TITUL         0000000
035390         ELSE                                                     0000000
035400               MOVE  '1'             TO  IPPMA2-EMP-TITUL         0000000
035410               MOVE  '2'             TO  IPPMA2-COEMP-TITUL       0000000
035420               MOVE  SAY-FED         TO  IPPMA2-COEMP-FED         0000000
035430               MOVE  SAY-NCAIS       TO  IPPMA2-COEMP-NCAIS       0000000
035440               MOVE  SAY-RACINE      TO  IPPMA2-COEMP-RACINE      0000000
035450         END-IF                                                   0000000
035460         MOVE  SAY-CNAT           TO  IPPMA2-2-CNAT (1)           0000000
035470         MOVE  SAY-CAT            TO  IPPMA2-2-CAT (1)            0000000
035480         MOVE  SAY-DEVISE         TO  IPPMA2-DEVISE               0000000
035490         MOVE  SAY-COUT9          TO  IPPMA2-COUT-DOS9            0000000
035500         MOVE  'IPI'              TO  IPPMA2-LABEL-APPLI          0000000
035510         MOVE  SPACE              TO  IPPCPLO                     0000000
035520         MOVE  SAY-LOG9           TO  IPPCPLO-OBJ-LOG-NB9         0000000
035530         MOVE  SAY-PIEC9          TO  IPPCPLO-OBJ-LOG-NBP9        0000000
035540         MOVE  SAY-SURF9          TO  IPPCPLO-OBJ-LOG-SURFH9      0000000
035550D        DISPLAY  'IPPMA2 AV OBJ ' IPPMA2                         0000000
035560         CALL  'ZCALLPGM'  USING IPIOBJFI                         0000000
035570                                 SAY-OBJET                        0000000
035580                                 IPPCPLO                          0000000
035590                                 W-LIBOBJ                         0000000
035600                                 IPIOBJFI-RC                      0000000
035610                                                                  0000000
035620D        DISPLAY  'IPPMA2 Ap OBJ ' IPPMA2                         0000000
035630         IF  IPIOBJFI-RC  NOT  =  ZERO                            0000000
035640             MOVE SPACE  TO IPPMA2-OBJET-IMM-LIBOBJ               0000000
035650d            DISPLAY  ' ERR IPIOBJFI ' IPIOBJFI-RC                0000000
035660         ELSE                                                     0000000
035670             MOVE  W-LIBOBJ  TO  IPPMA2-OBJET-IMM-LIBOBJ.         0000000
035680                                                                  0000000
035690                                                                  0000000
035700*---------------                                                  0000000
035710 LECTURE-PRTIDC-2.                                                0000000
035720*---------------                                                  0000000
035730     MOVE ZERO            TO CTL-R34.                             0000000
035740     MOVE SPACE           TO IPPMSGX.                             0000000
035750     MOVE IPPMA2-FED      TO IPPMSGX-FED.                         0000000
035760     MOVE ORGS01-BANQUE   TO IPPMSGX-BANQUE.                      0000000
035770     MOVE IPPMA2-CAISSE   TO IPPMSGX-CAISSE.                      0000000
035780     MOVE IPPMA2-RACINE   TO IPPMSGX-RACINE.                      0000000
035790     MOVE IPPMA2-DOSS     TO IPPMSGX-DOSS.                        0000000
035800     MOVE IPPMA2-2-CAT (IT) TO IPPMSGX-CAT.                       0000000
035810     MOVE '0'             TO EXIST-PRTIDC                         0000000
035820                             EXIST-PRTDOS                         0000000
035830                             EXIST-PRTCPT.                        0000000
035840                                                                  0000000
035850     CALL 'ZCALLPGM'   USING IPPRBPR2                             0000000
035860                             IPPMSGX                              0000000
035870                             EXIST-PRTIDC                         0000000
035880                             EXIST-PRTDOS                         0000000
035890                             EXIST-PRTCPT                         0000000
035900                             PRTIDC                               0000000
035910                             PRTDOS                               0000000
035920                             PRTCPT                               0000000
035930                             CTL                                  0000000
035940                             PCBPRT.                              0000000
035950                                                                  0000000
035960d    DISPLAY  'EXIST-PRTCPT '   EXIST-PRTCPT.                     0000000
035970     IF  EXIST-PRTCPT  =  1                                       0000000
035980         CALL  'ZCALLPGM'  USING ZPRTZDA1                         0000000
035990                                  PRTCPT                          0000000
036000                                  PRTCP2.                         0000000
036010*                                                                 0000000
036020 LECTURE-PRTIDC-3.                                                0000000
036030*---------------                                                  0000000
036040     MOVE ZERO            TO CTL-R34.                             0000000
036050     MOVE SPACE           TO IPPMSGX.                             0000000
036060     MOVE IPPMA2-FED      TO IPPMSGX-FED.                         0000000
036070     MOVE ORGS01-BANQUE   TO IPPMSGX-BANQUE.                      0000000
036080     MOVE IPPMA2-CAISSE   TO IPPMSGX-CAISSE.                      0000000
036090     MOVE IPPMA2-RACINE   TO IPPMSGX-RACINE.                      0000000
036100     MOVE IPPMA2-DOSS     TO IPPMSGX-DOSS.                        0000000
036110     MOVE IPPMA2-2-CAT (IP) TO IPPMSGX-CAT.                       0000000
036120     MOVE '0'             TO EXIST-PRTIDC                         0000000
036130                             EXIST-PRTDOS                         0000000
036140                             EXIST-PRTCPT.                        0000000
036150                                                                  0000000
036160     CALL 'ZCALLPGM' USING   IPPRBPR2                             0000000
036170                             IPPMSGX                              0000000
036180                             EXIST-PRTIDC                         0000000
036190                             EXIST-PRTDOS                         0000000
036200                             EXIST-PRTCPT                         0000000
036210                             PRTIDC                               0000000
036220                             PRTDOS                               0000000
036230                             PRTCPT                               0000000
036240                             CTL                                  0000000
036250                             PCBPRT.                              0000000
036260                                                                  0000000
036270     IF  EXIST-PRTCPT  =  1                                       0000000
036280         CALL  'ZCALLPGM'  USING ZPRTZDA1                         0000000
036290                                 PRTCPT                           0000000
036300                                 PRTCP2.                          0000000
036310                                                                  0000000
036320                                                                  0000000
036330*---------------                                                  0000000
036340 LECTURE-PRTIDC.                                                  0000000
036350*---------------                                                  0000000
036360                                                                  0000000
036370     PERFORM   LECTURE-PRTIDC-2.                                  0000000
036380                                                                  0000000
036390     IF   CTL-R34 NOT = ZERO                                      0000000
036400          MOVE  IT  TO IND-ANOM                                   0000000
036410          MOVE  41  TO TEST-1                                     0000000
036420          PERFORM  TRAIT-ANOMALIE                                 0000000
036430          move  'Pret abs base pret  lecture-prtidc'              0000000
036440                          to  ANOM-41                             0000000
036450     ELSE PERFORM CONTROLE-GDP-PRET.                              0000000
036460                                                                  0000000
036470*---------------------                                            0000000
036480 TRAITEMENT-EVT.                                                  0000000
036490*---------------------                                            0000000
036500     IF  IPPMA2-2-ALRRIS (IT)  = 'O'                              0000000
036510         PERFORM  ECRITURE-EVT                                    0000000
036520     END-IF.                                                      0000000
036530*                                                                 0000000
036540*---------------------                                            0000000
036550 ECRITURE-EVT.                                                    0000000
036560*---------------------                                            0000000
036570* ENRICHISSEMENT DE YEVTE10                                       0000000
036580                                                                  0000000
036590     IF  ORGS01-FEDE-LAVAL            AND                         0000000
036600         IPPMA2-2-CNAT (IT)  = '214'  AND                         0000000
036610         IPPMA2-OBJET-DOS9   =  420                               0000000
036620         NEXT SENTENCE                                            0000000
036630     ELSE                                                         0000000
036640*VFI - R40388 - 11/03/2011 - DEB                                  0000000
036650*        PERFORM  ECRITURE-EVT-S                                  0000000
036660         PERFORM  ECRITURE-EVT-2                                  0000000
036670*VFI - R40388 - 11/03/2011 - FIN                                  0000000
036680     END-IF                                                       0000000
036690     .                                                            0000000
036700*VFI - R40388 - 11/03/2011 - DEB                                  0000000
036710*---------------------                                            0000000
036720 ECRITURE-EVT-2.                                                  0000000
036730*---------------------                                            0000000
036740* ENRICHISSEMENT DE YEVTE10                                       0000000
036750                                                                  0000000
036760* CODES PRODUIT B 266 - B 31902-03-04-05                          0000000
036770* D'UNE DUREE INFERIEURE OU EGALE A 24 MOIS : NE PAS DECLENCHER   0000000
036780     EVALUATE TRUE                                                0000000
036790       WHEN SAY-DURAM  > 24                                       0000000
036800         PERFORM  ECRITURE-EVT-S                                  0000000
036810       WHEN IPPMA2-2-CNAT (IT) = '266'                            0000000
036820         CONTINUE                                                 0000000
036830D    DISPLAY 'PAS ECRITURE EVT22 : PRET 266, duree < 24 mois'     0000000
036840       WHEN ((IPPMA2-2-CNAT (IT) = '319')                         0000000
036850         AND (IPPMA2-CD-SOUS-PROD (IT) = '002' OR '003'           0000000
036860                                      OR '004' OR '005'))         0000000
036870           CONTINUE                                               0000000
036880D    DISPLAY 'PAS ECRITURE EVT22 = PRET 319002 ou 3,4,5 duree<24m'0000000
036890       WHEN OTHER                                                 0000000
036900         PERFORM  ECRITURE-EVT-S                                  0000000
036910     END-EVALUATE                                                 0000000
036920     .                                                            0000000
036930*VFI - R40388 - 11/03/2011 - FIN                                  0000000
036940*---------------------                                            0000000
036950 ECRITURE-EVT-S.                                                  0000000
036960*---------------------                                            0000000
036970                                                                  0000000
036980D    DISPLAY 'ECRITURE EVT22'                                     0000000
036990     MOVE    SPACES         TO IPPEVT.                            0000000
037000     MOVE    ZERO           TO EVTE10-C0001-SOLDE                 0000000
037010                               EVTE10-C0001-MT                    0000000
037020                               EVTE10-C0001-TAUX                  0000000
037030                               EVTE10-C0001-NOMBRE.               0000000
037040     MOVE ORGS01-FEDE       TO BIDON-FED.                         0000000
037050     MOVE ORGS01-BANQUE     TO BIDON-BANQ.                        0000000
037060     MOVE IPPMA2-CAISSE     TO BIDON-NCAI.                        0000000
037070     MOVE '00'              TO BIDON-BUREAU.                      0000000
037080     MOVE IPPMA2-RACINE     TO BIDON-RACINE6.                     0000000
037090     MOVE    ZERO           TO BIDON-RACINE0.                     0000000
037100     MOVE IPPMA2-2-CAT (IT) TO BIDON-TYPSER.                      0000000
037110     MOVE IPPMA2-DEVISE     TO BIDON-DEVISE.                      0000000
037120     MOVE DATJOUR           TO WS-DATE-9.                         0000000
037130     MOVE WS-DATE-9 (1:4)   TO BIDON-DATE-SSAA.                   0000000
037140     MOVE WS-DATE-9 (5:2)   TO BIDON-DATE-MM.                     0000000
037150     MOVE WS-DATE-9 (7:2)   TO BIDON-DATE-JJ.                     0000000
037160     MOVE IPPMA2-HEUREMAJ   TO WS-HEURE-8.                        0000000
037170     MOVE WS-HEURE-12       TO BIDON-HEURE-HH.                    0000000
037180     MOVE WS-HEURE-34       TO BIDON-HEURE-MN.                    0000000
037190     MOVE WS-HEURE-SC       TO BIDON-HEURE-SC.                    0000000
037200*                                                                 0000000
037210     INITIALIZE                EVTE10-C0001.                      0000000
037220     MOVE   '0022'          TO EVTE10-C0001-CODE-TYPE.            0000000
037230     MOVE Z-TAUDB (IT)      TO EVTE10-C0001-TAUX.                 0000000
037240     MOVE Z-MONTANT (IT)    TO EVTE10-C0001-MT.                   0000000
037250     MOVE IPPMA2-DEVISE     TO EVTE10-C0001-DEVISE-MT.            0000000
037260     MOVE BIDON-ENTITE      TO EVTE10-C0001-CODE-ENTITE(1).       0000000
037270     MOVE BIDON-HEURE       TO EVTE10-C0001-HEUR-1.               0000000
037280     MOVE BIDON-DATE        TO EVTE10-C0001-DATE-1.               0000000
037290     MOVE 'CPT'             TO EVTE10-C0001-TYPE-ENTITE(1).       0000000
037300        MOVE ALL SPACE           TO TIEE10.                       0000000
037310     MOVE 'B '             TO TIEE10-L0001-COD-ORG.               0000000
037320     MOVE 'C '             TO TIEE10-L0001-ROL.                   0000000
037330     MOVE 'C'              TO TIEE10-L0001-TYP-APE.               0000000
037340     MOVE 'I'              TO TIEE10-L0001-CODIF-PAY              0000000
037350     MOVE 'N'              TO TIEE10-L0001-TOP-EI.                0000000
037360     MOVE 'O'              TO TIEE10-L0001-TOP-EI.                0000000
037370     MOVE 'N'              TO TIEE10-L0001-TOP-TLC.               0000000
037380     MOVE DATJOUR          TO TIEE10-DAT-FRAICHEUR.               0000000
037390     MOVE HEUJOUR          TO TIEE10-HEU-FRAICHEUR.               0000000
037400           MOVE ORGS01-BANQUE       TO TIEE10-L0001-BQE.          0000000
037410           MOVE IPPMA2-CAISSE       TO TIEE10-L0001-CAI.          0000000
037420           MOVE IPPMA2-RACINE       TO W-RACINE6.                 0000000
037430           MOVE W-RACINE9           TO TIEE10-L0001-RAC.          0000000
037440           MOVE IPPMA2-EMP-TITUL    TO W-TITUL1.                  0000000
037450           MOVE W-TITUL2            TO TIEE10-L0001-NUM-TTL.      0000000
037460d    display 'banque  = ' TIEE10-L0001-BQE.                       0000000
037470d    display 'Caisse  = ' TIEE10-L0001-CAI.                       0000000
037480d    display 'racine  = ' TIEE10-L0001-RAC.                       0000000
037490d    display 'Num-ttl = ' TIEE10-L0001-NUM-TTL.                   0000000
037500     PERFORM    LECTURE-CLIENT-TIERS.                             0000000
037510     perform    calcul-age  thru     calcul-age-fin.              0000000
037520     MOVE CPT-NOM           TO EVTE10-C0001-INTITULE(1).          0000000
037530     MOVE W-NBANNEES        TO EVTE10-C0001-NOMBRE.               0000000
037540d    display '=============================================='     0000000
037550d    display ' generation evt 22 pour '                           0000000
037560d            EVTE10-C0001-CODE-ENTITE(1)                          0000000
037570d    display 'montant =' EVTE10-C0001-MT                          0000000
037580d    display 'taux    =' EVTE10-C0001-TAUX                        0000000
037590d    display 'nom     =' EVTE10-C0001-INTITULE(1)                 0000000
037600d    display 'age     =' EVTE10-C0001-NOMBRE                      0000000
037610d    display '=============================================='     0000000
037620     WRITE IPPEVT FROM EVTE10.                                    0000000
037630     ADD  1  TO  CPT-EVT.                                         0000000
037640*                                                                 0000000
037650*---------------------                                            0000000
037660*                                                                 0000000
037670*---------------------                                            0000000
037680 CONTROLE-GDP-DOSSIER.                                            0000000
037690*---------------------                                            0000000
037700**** OUVERTURE / MISE A JOUR DOSSIER                              0000000
037710     MOVE  ZERO TO IND-ANOM.                                      0000000
037720     IF   Z-DCMAJ   =  '1'                                        0000000
037730          IF   EXIST-PRTIDC = '0' OR EXIST-PRTDOS = '0'           0000000
037740               MOVE '1'           TO GDP-OK                       0000000
037750          ELSE IF   DOS-DATOUV = ZERO                             0000000
037760                    MOVE '1'      TO GDP-OK.                      0000000
037770     IF   Z-DCMAJ   =  '3'                                        0000000
037780          IF   EXIST-PRTIDC = '0' OR EXIST-PRTDOS = '0'           0000000
037790               MOVE '1'           TO GDP-OK.                      0000000
037800     IF   Z-DCMAJ   =  '9'                                        0000000
037810     AND  EXIST-PRTIDC = '1' AND EXIST-PRTDOS = '1'               0000000
037820          IF DOS-CANNUL NOT = '9'                                 0000000
037830             MOVE '1'             TO GDP-OK.                      0000000
037840                                                                  0000000
037850     IF  GDP-OK  NOT = ZERO                                       0000000
037860         DISPLAY 'PB GDP DOS!!'                                   0000000
037870         DISPLAY 'CLE        =' APPEL-CLE.                        0000000
037880         DISPLAY 'Z-DCMAJ    =' Z-DCMAJ                           0000000
037890         DISPLAY 'EXIST-IDC  =' EXIST-PRTIDC                      0000000
037900         DISPLAY 'EXIST-DOS  =' EXIST-PRTDOS                      0000000
037910         DISPLAY 'DOS-DATOUV =' DOS-DATOUV.                       0000000
037920                                                                  0000000
037930*------------------                                               0000000
037940 CONTROLE-GDP-PRET.                                               0000000
037950*------------------                                               0000000
037960**** OUVERTURE / MISE A JOUR PRET                                 0000000
037970     IF   Z-CMAJ (IT)  =  '1'                                     0000000
037980          IF   EXIST-PRTIDC = '0' OR EXIST-PRTDOS = '0'           0000000
037990          OR   EXIST-PRTCPT = '0'                                 0000000
038000               MOVE '1'           TO GDP-OK                       0000000
038010          ELSE IF   CPT-DATOUV = ZERO                             0000000
038020                    MOVE '1'           TO GDP-OK.                 0000000
038030     IF   Z-CMAJ (IT)  =  '3'                                     0000000
038040          IF   EXIST-PRTIDC = '0' OR EXIST-PRTDOS = '0'           0000000
038050          OR   EXIST-PRTCPT = '0'                                 0000000
038060               MOVE '1'           TO GDP-OK.                      0000000
038070     IF   Z-CMAJ (IT)  =  '9'                                     0000000
038080     AND  EXIST-PRTIDC = '1' AND EXIST-PRTDOS = '1'               0000000
038090     AND  EXIST-PRTCPT = '1'                                      0000000
038100          IF CPT-CANNUL NOT = '9'                                 0000000
038110             MOVE '1'             TO GDP-OK.                      0000000
038120* (not = 0 avant le 6/5/97)                                       0000000
038130     IF  GDP-OK   =  1                                            0000000
038140         ADD  1   TO  NB-MAJ-KO                                   0000000
038150     ELSE                                                         0000000
038160          PERFORM AFFEC-FEED-PRET.                                0000000
038170                                                                  0000000
038180*----------------- PREPARATION EDITION -------                    0000000
038190 AFFEC-FEED-PRET.                                                 0000000
038200*-----------------                                                0000000
038210*                                                                 0000000
038220     MOVE  IPPMA2-DEVISE    TO  FEED-DEVISE (IT).                 0000000
038230     MOVE  IPPMA2-2-CAT (IT) TO FEED-CAT    (IT).                 0000000
038240*                                                                 0000000
038250     MOVE ZERO     TO FEED-MONTANT (IT).                          0000000
038260                                                                  0000000
038270     IF  CPT-MONT NUMERIC AND                                     0000000
038280         ( IPPMA2-DEVISE  =  SPACES  OR  'EUR' )                  0000000
038290          MOVE CPT-MONT TO FEED-MONTANT (IT)                      0000000
038300*         PERFORM  CUMUL-MONTANT-GAR VARYING II  FROM 1 BY 1      0000000
038310*                 UNTIL   II  >  4    OR                          0000000
038320*                 (IPPMA2-2-LIEN-GARANTIE (IT II) = SPACES        0000000
038330*                                                  OR    ZERO)    0000000
038340     END-IF.                                                      0000000
038350                                                                  0000000
038360     IF   CPT-DPROEC9 NOT NUMERIC                                 0000000
038370     OR   CPT-DURAM1  NOT NUMERIC                                 0000000
038380     OR   CPT-PERECH  NOT NUMERIC                                 0000000
038390          MOVE 99999999 TO FEED-DATECH (IT)                       0000000
038400     ELSE                                                         0000000
038410          IF (CPT-MODGES  =  '7')                                 0000000
038420              MOVE 99991231 TO FEED-DATECH (IT)                   0000000
038430          ELSE                                                    0000000
038440              PERFORM TRAIT-DATECH.                               0000000
038450                                                                  0000000
038460*CUMUL-MONTANT-GAR.                                               0000000
038470*                                                                 0000000
038480*    IF    IPPMA2-2-NO-ORDRE (IT II) NUMERIC  AND                 0000000
038490*          IPPMA2-2-NO-ORDRE9 (IT II) > ZERO                      0000000
038500*          MOVE  IPPMA2-2-NO-ORDRE9 (IT II) TO JG                 0000000
038510*          if (IPPMA2-2-CODE-GARANTIE(IT II) = '37' or '36'       0000000
038520*                                       or   '40' or '41')        0000000
038530*              Compute W-IPPGAR-MONTANT (JG) =                    0000000
038540*                      W-IPPGAR-MONTANT (JG)    +                 0000000
038550*                         ( CPT-MONT * 1,2 )                      0000000
038560*          Else                                                   0000000
038570*              ADD  CPT-MONT  TO  W-IPPGAR-MONTANT (JG)           0000000
038580*          End-if                                                 0000000
038590*    End-if.                                                      0000000
038600                                                                  0000000
038610*--------------- PREPARATION EDITION -------                      0000000
038620 TRAIT-DATECH.                                                    0000000
038630*---------------                                                  0000000
038640                                                                  0000000
038650     IF  CPT-MODGES    =  '6'                                     0000000
038660         MOVE  W-DAT2-SSAAMMJJ  TO  FEED-DATECH (IT)              0000000
038670     ELSE                                                         0000000
038680         PERFORM  TRAIT-DATECH-S.                                 0000000
038690                                                                  0000000
038700 TRAIT-DATECH-S.                                                  0000000
038710*---------------                                                  0000000
038720                                                                  0000000
038730     MOVE CPT-PERECH TO PER.                                      0000000
038740     IF PER = 2                                                   0000000
038750        MOVE 9 TO PER.                                            0000000
038760     MOVE CPT-DURAM1 TO DURAM1.                                   0000000
038770     IF DURAM1 = ZERO                                             0000000
038780        MOVE 1 TO DURAM1.                                         0000000
038790     COMPUTE NB = (DURAM1 / CPT-PERECH) - 1.                      0000000
038800     MOVE CPT-DPROEC9 TO DPROEC9.                                 0000000
038810     INITIALIZE DATS20                                            0000000
038820     MOVE  'D01'              TO DATS20-I-FONCTION                0000000
038830     MOVE  DPROEC1            TO DATS20-I-DATE1                   0000000
038840     MOVE  'J'                TO DATS20-I-ENTREE-TYPE1            0000000
038850     MOVE  'A'                TO DATS20-I-ENTREE-SENS1            0000000
038860     MOVE  'J'                TO DATS20-I-RETOUR-TYPE1            0000000
038870     MOVE  'A'                TO DATS20-I-RETOUR-SENS1            0000000
038880     MOVE  'O'                TO DATS20-I-RETOUR-SIECLE           0000000
038890                                                                  0000000
038900     IF PER = 9                                                   0000000
038910        MOVE 12  TO WA2-PER                                       0000000
038920      ELSE                                                        0000000
038930        MOVE PER TO WA2-PER                                       0000000
038940     END-IF                                                       0000000
038950     COMPUTE DATS20-I-NBMOIS = WA2-PER *                          0000000
038960                               NB                                 0000000
038970                                                                  0000000
038980     CALL 'ZCALLPGM' USING ZDAT2000 DATS20                        0000000
038990     MOVE DATS20-O-MSG   TO DATFIN.                               0000000
039000     MOVE DATFIN      TO FEED-DATECH (IT).                        0000000
039010                                                                  0000000
039020D    Display '  FEED-DATECH (IT) :' FEED-DATECH (IT) '::'.        0000000
039030                                                                  0000000
039040                                                                  0000000
039050d    DISPLAY 'REF DOSSIER '                                       0000000
039060d    DISPLAY IPPMA2-CAISSE ' ' IPPMA2-RACINE ' ' IPPMA2-DOSS      0000000
039070d                                            ' ' IPPMA2-2-CAT (IT)0000000
039080d    DISPLAY 'CPT-DPROEC ' CPT-DPROEC9                            0000000
039090d    DISPLAY 'DATE FIN   ' DATFIN.                                0000000
039100                                                                  0000000
039110                                                                  0000000
039120 RECHERCHE-TS.                                                    0000000
039130                                                                  0000000
039140     SET   TS-ABS    TO    TRUE                                   0000000
039150     PERFORM  VARYING  I-TS  FROM 1 BY 1                          0000000
039160              UNTIL    I-TS  >  NB-PRET-MAX                       0000000
039170                                OR  TS-TROUVE                     0000000
039180                                                                  0000000
039190              IF  IPPMA2-2-CAT(I-TS) = APPEL-CAT                  0000000
039200D                 DISPLAY  ' I-TS TROUVE ' I-TS                   0000000
039210                  MOVE   I-TS   TO  IT                            0000000
039220                  SET  TS-TROUVE     TO  TRUE                     0000000
039230              END-IF                                              0000000
039240     END-PERFORM                                                  0000000
039250                                                                  0000000
039260     IF  TS-ABS                                                   0000000
039270         MOVE   1      TO  IT                                     0000000
039280     END-IF                                                       0000000
039290     .                                                            0000000
039300                                                                  0000000
039310*             *******************************************         0000000
039320*             *******************************************         0000000
039330*             ***                                     ***         0000000
039340*             ***       E D I T I O N     D E S       ***         0000000
039350*             ***                                     ***         0000000
039360*             ***          D O C U M E N T S          ***         0000000
039370*             ***                                     ***         0000000
039380*             *******************************************         0000000
039390*             *******************************************         0000000
039400                                                                  0000000
039410*------------------------- PREPARATION EDITION -------            0000000
039420 TRAITEMENT-EDT.                                                  0000000
039430*-------------------------                                        0000000
039440                                                                  0000000
039450     SET  LANGUE-FRANCAISE  TO  TRUE                              0000000
039460     IF  IPPMA2-LANGUE-ALLEMANDE  AND NOT AVENANT                 0000000
039470         SET   DOSSIER-GOETHE  to  true                           0000000
039480     END-IF                                                       0000000
039490                                                                  0000000
039500                                                                  0000000
039510     if  not ( ippma2-caisse  = '00150' )                         0000000
039520         PERFORM  TRAITEMENT-EDT-S                                0000000
039530                                                                  0000000
039540         IF  SUITE                                                0000000
039550             IF  IPPMA2-LANGUE-ALLEMANDE  AND NOT AVENANT         0000000
039560                 SET  LANGUE-ALLEMANDE  TO  TRUE                  0000000
039570                 PERFORM  LECTURE-GAR3-INIT                       0000000
039580                 PERFORM  TRAITEMENT-EDT-S                        0000000
039590             END-IF                                               0000000
039600         END-IF                                                   0000000
039610     END-IF                                                       0000000
039620     .                                                            0000000
039630                                                                  0000000
039640*------------------------- PREPARATION EDITION -------            0000000
039650 TRAITEMENT-EDT-S.                                                0000000
039660*-------------------------                                        0000000
039670D    DISPLAY 'TRAITEMENT EDT'.                                    0000000
039680     MOVE ZERO                   TO TEST-1.                       0000000
039690     MOVE ZERO                   TO IND-ANOM.                     0000000
039700     MOVE ZERO                   TO Z-CNP.                        0000000
039710                                                                  0000000
039720* ***         INITIALISATION DE LA ZONE DE TRAVAIL                0000000
039730     PERFORM            INIT-TRAVAIL.                             0000000
039740     Set  Pret-a-lire   to  True                                  0000000
039750*                                                                 0000000
039760*                                                                 0000000
039770* *** LECTURE  IPPCPLG  PRTSAY   ou base pret                     0000000
039780*                                                                 0000000
039790     IF  SUITE                                                    0000000
039800         IF AVENANT                                               0000000
039810            PERFORM RECHERCHE-TS                                  0000000
039820         ELSE                                                     0000000
039830            MOVE      1     TO IT                                 0000000
039840         END-IF                                                   0000000
039850         PERFORM         LECTURE-IPPCPL.                          0000000
039860*                                                                 0000000
039870D    DISPLAY  'IPPMA2 '  IPPMA2.                                  0000000
039880                                                                  0000000
039890                                                                  0000000
039900     IF  ORGS01-FEDE-LAVAL  AND  CONTRAT-GPR                      0000000
039910         NEXT SENTENCE                                            0000000
039920     ELSE                                                         0000000
039930         PERFORM  TRAITEMENT-EDT-S2                               0000000
039940     END-IF                                                       0000000
039950     .                                                            0000000
039960                                                                  0000000
039970 TRAITEMENT-EDT-S2.                                               0000000
039980                                                                  0000000
039990     PERFORM             INIT-TRAVAIL-2.                          0000000
040000     Move  Space        to  TIEVAL1-STA-CM                        0000000
040010     Move  Space        to  TIEVAL2-STA-CM                        0000000
040020*    recherche des emprunteurs  dans tiers  partir des ICBs      0000000
040030*    si avenant                                                   0000000
040040     if suite and avenant                                         0000000
040050        perform rech-titulaires.                                  0000000
040060                                                                  0000000
040070* ***         TRAITEMENT DU TITULAIRE                             0000000
040080     IF SUITE                                                     0000000
040090        IF IPPMA2-EMP-PMO-COMPLEMENT = '1'                        0000000
040100           MOVE ZERO                TO IPPCPL-CAT                 0000000
040110           MOVE 'M'                 TO IPPCPL-CODENR              0000000
040120           PERFORM         LECTURE-IPPCPL-GU.                     0000000
040130                                                                  0000000
040140     IF SUITE                                                     0000000
040150        MOVE ALL SPACE           TO TIEE10                        0000000
040160        MOVE ALL SPACE           TO TIEE10-L0001-ARG              0000000
040170        MOVE IPPMA2-FED          TO TIEE10-L0001-COD-RGP          0000000
040180        if avenant and Titulaires-trouves                         0000000
040190           MOVE YIPX020-TITBQE(1)   TO TIEE10-L0001-BQE           0000000
040200           MOVE YIPX020-TITCAI(1)   TO TIEE10-L0001-CAI           0000000
040210           MOVE YIPX020-TITRAC(1)   TO TIEE10-L0001-RAC           0000000
040220           MOVE YIPX020-TITNOTIT(1) TO TIEE10-L0001-NUM-TTL       0000000
040230d          display 'cas avenant'                                  0000000
040240d          display 'TIEE10-L0001-BQE    =' TIEE10-L0001-BQE       0000000
040250d          display 'TIEE10-L0001-CAI    =' TIEE10-L0001-CAI       0000000
040260d          display 'TIEE10-L0001-RAC    =' TIEE10-L0001-RAC       0000000
040270d          display 'TIEE10-L0001-NUM-TTL=' TIEE10-L0001-NUM-TTL   0000000
040280        else                                                      0000000
040290           MOVE ORGS01-BANQUE       TO TIEE10-L0001-BQE           0000000
040300           MOVE IPPMA2-CAISSE       TO TIEE10-L0001-CAI           0000000
040310           MOVE IPPMA2-RACINE       TO W-RACINE6                  0000000
040320           MOVE W-RACINE9           TO TIEE10-L0001-RAC           0000000
040330           MOVE IPPMA2-EMP-TITUL    TO W-TITUL1                   0000000
040340           MOVE W-TITUL2            TO TIEE10-L0001-NUM-TTL       0000000
040350d          display 'cas autres '                                  0000000
040360d          display 'TIEE10-L0001-BQE    =' TIEE10-L0001-BQE       0000000
040370d          display 'TIEE10-L0001-CAI    =' TIEE10-L0001-CAI       0000000
040380d          display 'TIEE10-L0001-RAC    =' TIEE10-L0001-RAC       0000000
040390d          display 'TIEE10-L0001-NUM-TTL=' TIEE10-L0001-NUM-TTL   0000000
040400        end-if                                                    0000000
040410                                                                  0000000
040420        PERFORM                  LECTURE-CLIENT-TIERS.            0000000
040430                                                                  0000000
040440     IF SUITE                                                     0000000
040450        IF TIEFRE-DONNEES-NON-TROUVEES                            0000000
040460           MOVE 5 TO TEST-1                                       0000000
040470           PERFORM  TRAIT-ANOMALIE                                0000000
040480        ELSE                                                      0000000
040490           MOVE TIES10-L0001-STA-CM (1) TO TIEVAL1-STA-CM         0000000
040500           PERFORM         TRAIT-TITULAIRE.                       0000000
040510                                                                  0000000
040520                                                                  0000000
040530* ***         TRAITEMENT DU COEMPRUNTEUR                          0000000
040540     MOVE  ZERO  TO  NBR-EMPRUNTEURS.                             0000000
040550     IF   SUITE                                                   0000000
040560          IF   (IPPMA2-COEMP-RACINE   numeric  and                0000000
040570                IPPMA2-COEMP-RACINE not = zero and                0000000
040580                not avenant                ) or                   0000000
040590                avenant and YIPX020-TITBQE(2) numeric             0000000
040600                                                                  0000000
040610               PERFORM RECHERCHE-COEMPRUNT                        0000000
040620          ELSE                                                    0000000
040630               MOVE 1 TO NBR-EMPRUNTEURS.                         0000000
040640                                                                  0000000
040650     COMPUTE NBR-DESTINATAIRES  = NBR-EMPRUNTEURS + 1.            0000000
040660     MOVE 'CAI00'         TO POSTE-DEST (I-DEST).                 0000000
040670     ADD 1 TO I-DEST.                                             0000000
040680     MOVE 'EMP01'         TO POSTE-DEST (I-DEST).                 0000000
040690     IF   NBR-EMPRUNTEURS = 2                                     0000000
040700          ADD 1 TO I-DEST                                         0000000
040710          MOVE 'EMP02'    TO POSTE-DEST (I-DEST).                 0000000
040720                                                                  0000000
040730                                                                  0000000
040740* ***   INITIALISATION DU TABLEAU D'AMORTISSEMENT                 0000000
040750     IF SUITE                                                     0000000
040760        MOVE SPACE TO IDPTAM                                      0000000
040770        MOVE IPPMA2-FED       TO TAM-FEDE                         0000000
040780        MOVE IPPMA2-CAISSE    TO TAM-CAISSE                       0000000
040790        MOVE IPPMA2-RACINE    TO TAM-RACINE                       0000000
040800        MOVE IPPMA2-DOSS9     TO TAM-NUMDOSS                      0000000
040810        MOVE IPPPRI-EMP1TNOM  TO TAM-EMP1TNOM.                    0000000
040820                                                                  0000000
040830****  *         OBJET DU DOSSIER                                  0000000
040840     IF SUITE                                                     0000000
040850        if pas-de-ippma2                                          0000000
040860           perform trait-objet-idchab                             0000000
040870           if IDHFRE-DONNEES-NON-TROUVEES                         0000000
040880*             dossier pas dans idchab : on traite de manire IPI  0000000
040890              perform trait-objet                                 0000000
040900           end-if                                                 0000000
040910        else                                                      0000000
040920           PERFORM         TRAIT-OBJET.                           0000000
040930**** TRAITEMENT Origine  DOSSIER                                  0000000
040940     IF SUITE                                                     0000000
040950        PERFORM         TRAIT-ORIGINE.                            0000000
040960                                                                  0000000
040970**** IPI : TRAITEMENT PLAN FINANCEMENT                            0000000
040980     IF   SUITE  AND  (  CONTRAT OR  CONTRAT-GPR  )               0000000
040990          IF   IPPMA2-LABEL-APPLI = 'IPI'                         0000000
041000          AND  IPPMA2-EXIST-PLF   = '1'                           0000000
041010*              SI PLAN DEJA EDITE EN LOCAL : ON N'EDITE PLUS      0000000
041020*                                                  sauf 34 et 14. 0000000
041030*              IF  (IPPMA2-DOZ-EDITE-LOCAL = 'O'                  0000000
041040*               AND NOT (ORGS01-FEDE-LAVAL OR ORGS01-FEDE-CAEN))  0000000
041050*                   MOVE  SPACE  TO  DONNEES-PLF                  0000000
041060*              ELSE                                               0000000
041070                    PERFORM TRAIT-PLAN-FINANCT                    0000000
041080          ELSE MOVE SPACE TO DONNEES-PLF.                         0000000
041090                                                                  0000000
041100     IF  SUITE                                                    0000000
041110     AND  (ORGS01-FEDE-CEE )                                      0000000
041120          PERFORM   ANALYSE-PRET-INDEX                            0000000
041130                       VARYING IP FROM 1 BY 1                     0000000
041140                         UNTIL IP > 4                             0000000
041150                         OR SALARIE = 1                           0000000
041160                         OR IPPMA2-2-TAB-PRET (IP) = SPACES       0000000
041170                         OR IPPMA2-2-CAT    (IP) NOT NUMERIC      0000000
041180                         OR IPPMA2-2-CNAT   (IP) NOT NUMERIC.     0000000
041190                                                                  0000000
041200*                                                                 0000000
041210     IF SUITE                                                     0000000
041220     AND  (ORGS01-FEDE-CEE )                                      0000000
041230          PERFORM   ANALYSE-PRET-INDEX-TR1-2                      0000000
041240                       VARYING IP FROM 1 BY 1                     0000000
041250                         UNTIL IP > 4                             0000000
041260                         OR IPPMA2-2-TAB-PRET (IP) = SPACES       0000000
041270                         OR IPPMA2-2-CAT    (IP) NOT NUMERIC      0000000
041280                         OR IPPMA2-2-CNAT   (IP) NOT NUMERIC.     0000000
041290                                                                  0000000
041300*                                                                 0000000
041310* ***         TRAITEMENT CLAUSE SPECIFIQUE DOSSIER                0000000
041320* *** EDITER LA CLAUSE PRET    IPC COMME UNE CLAUSE DOSSIER       0000000
041330* *** EDITER LA CLAUSE DOSSIER IPP COMME UNE CLAUSE DOSSIER       0000000
041340                                                                  0000000
041350     MOVE  ZERO  TO  ICLAU.                                       0000000
041360     PERFORM  TRAIT-INIT-CLAUSIER.                                0000000
041370d       display 'ippcpl1:' ippcpl                                 0000000
041380                                                                  0000000
041390                                                                  0000000
041400     IF SUITE                                                     0000000
041410        IF IPPMA2-LABEL-APPLI = 'IPC'                             0000000
041420           IF IPPMA2-2-EXIST-CLAUSE-PRT(1) = '1'                  0000000
041430              MOVE IPPMA2-2-CAT(1)  TO IPPCPL-CAT                 0000000
041440              MOVE 'C'              TO IPPCPL-CODENR              0000000
041450              PERFORM      LECTURE-IPPCPL-GU                      0000000
041460           ELSE                                                   0000000
041470              MOVE  SPACE  TO  IPPCPL-CLAUSES-SPECIFIQUES         0000000
041480        ELSE                                                      0000000
041490           IF IPPMA2-EXIST-CLAUSE-DOS   = '1'                     0000000
041500              MOVE ZERO             TO IPPCPL-CAT                 0000000
041510              MOVE 'C'              TO IPPCPL-CODENR              0000000
041520              PERFORM      LECTURE-IPPCPL-GU                      0000000
041530           ELSE                                                   0000000
041540              MOVE  SPACE  TO  IPPCPL-CLAUSES-SPECIFIQUES         0000000
041550           End-if                                                 0000000
041560        End-if                                                    0000000
041570     End-if.                                                      0000000
041580                                                                  0000000
041590d       display 'ippcpl2:' ippcpl                                 0000000
041600d    display 'ippbatch AVANT rajout clauses **'                   0000000
041610d    perform  DISP-CLAUSE-SPECIF                                  0000000
041620                                                                  0000000
041630     IF  SUITE                                                    0000000
041640         IF  ((ORGS01-BANQUE-CIC)                                 0000000
041650         AND  (IPPMA2-OBJET-DOS  =  '190'  OR  '199'))            0000000
041660               MOVE '147'   TO  W-CLAUSE                          0000000
041670               PERFORM  AJOUT-UNE-CLAUSE                          0000000
041680         END-IF                                                   0000000
041690     END-IF                                                       0000000
041700                                                                  0000000
041710d    display 'APPEL-CLE =' APPEL-CLE                              0000000
041720     IF  SUITE                                                    0000000
041730           If (( SAY-COND-SAL-IMMO-TR1  or                        0000000
041740                 SAY-COND-SAL-IMMO-TR2 )                          0000000
041750            or ( Avenant  and (say-cindex  =  '023CN'             0000000
041760                                          or  '373CN')            0000000
041770                   or  cpt-salcm  =  1 ))                         0000000
041780               Perform compter-pret-salarie                       0000000
041790               If  nb-pret-salarie  = zero                        0000000
041800                   MOVE '333'   TO  W-CLAUSE                      0000000
041810               Else                                               0000000
041820                   MOVE '331'   TO  W-CLAUSE                      0000000
041830               End-if                                             0000000
041840d              display 'w-clause 333ou331' w-clause               0000000
041850               PERFORM  AJOUT-UNE-CLAUSE                          0000000
041860           Else                                                   0000000
041870               If  SAY-COND-SAL-CONSO                             0000000
041880                   If  say-cnat  =  '266'                         0000000
041890                       MOVE '340'   TO  W-CLAUSE                  0000000
041900                       PERFORM  AJOUT-UNE-CLAUSE                  0000000
041910                       MOVE '341'   TO  W-CLAUSE                  0000000
041920                       PERFORM  AJOUT-UNE-CLAUSE                  0000000
041930                       MOVE '342'   TO  W-CLAUSE                  0000000
041940                       PERFORM  AJOUT-UNE-CLAUSE                  0000000
041950                   Else                                           0000000
041960                     If (say-cnat  =  '214' or  '292')            0000000
041970                         MOVE '350'   TO  W-CLAUSE                0000000
041980                         PERFORM  AJOUT-UNE-CLAUSE                0000000
041990                         MOVE '351'   TO  W-CLAUSE                0000000
042000                         PERFORM  AJOUT-UNE-CLAUSE                0000000
042010                         MOVE '352'   TO  W-CLAUSE                0000000
042020                         PERFORM  AJOUT-UNE-CLAUSE                0000000
042030                     END-IF                                       0000000
042040                   END-IF                                         0000000
042050*  bloquer *                                                     0000000
042060               Else                                               0000000
042070                 If  (tieval1-sta-sal   or                        0000000
042080                      tieval2-sta-sal )                           0000000
042090                   and                                            0000000
042100                     (orgs01-fede-cee  or                         0000000
042110                      orgs01-banque-cic )                         0000000
042120                     If (say-cnat  =  '266'  )                    0000000
042130                         MOVE '340'   TO  W-CLAUSE                0000000
042140                         PERFORM  AJOUT-UNE-CLAUSE                0000000
042150                         MOVE '342'   TO  W-CLAUSE                0000000
042160                         PERFORM  AJOUT-UNE-CLAUSE                0000000
042170                     Else                                         0000000
042180                       If  say-cnat  =  '214'                     0000000
042190                           MOVE '350'   TO  W-CLAUSE              0000000
042200                           PERFORM  AJOUT-UNE-CLAUSE              0000000
042210                           MOVE '352'   TO  W-CLAUSE              0000000
042220                           PERFORM  AJOUT-UNE-CLAUSE              0000000
042230                       END-IF                                     0000000
042240                     END-IF                                       0000000
042250                 END-IF                                           0000000
042260               END-IF                                             0000000
042270         END-IF                                                   0000000
042280     END-IF.                                                      0000000
042290*  bloquer *                                                     0000000
042300*                                                                 0000000
042310d    display 'clause salarie ' w-clause                           0000000
042320d    display 'IPPCPL  '        IPPCPL                             0000000
042330     IF SUITE  and  ORGS01-BANQUE-CIC                             0000000
042340      if ((IPPMA2-2-CODE-GARANTIE(1 1) = 'A2' or 'A6' or 'K5') or 0000000
042350       (IPPMA2-2-CODE-GARANTIE (1 2) = 'A2' or 'A6' or 'K5') or   0000000
042360       (IPPMA2-2-CODE-GARANTIE (1 3) = 'A2' or 'A6' or 'K5') or   0000000
042370       (IPPMA2-2-CODE-GARANTIE (1 4) = 'A2' or 'A6' or 'K5') or   0000000
042380       (IPPMA2-2-CODE-GARANTIE (2 1) = 'A2' or 'A6' or 'K5') or   0000000
042390       (IPPMA2-2-CODE-GARANTIE (2 2) = 'A2' or 'A6' or 'K5') or   0000000
042400       (IPPMA2-2-CODE-GARANTIE (2 3) = 'A2' or 'A6' or 'K5') or   0000000
042410       (IPPMA2-2-CODE-GARANTIE (2 4) = 'A2' or 'A6' or 'K5') or   0000000
042420       (IPPMA2-2-CODE-GARANTIE (3 1) = 'A2' or 'A6' or 'K5') or   0000000
042430       (IPPMA2-2-CODE-GARANTIE (3 2) = 'A2' or 'A6' or 'K5') or   0000000
042440       (IPPMA2-2-CODE-GARANTIE (3 3) = 'A2' or 'A6' or 'K5') or   0000000
042450       (IPPMA2-2-CODE-GARANTIE (3 4) = 'A2' or 'A6' or 'K5') or   0000000
042460       (IPPMA2-2-CODE-GARANTIE (4 1) = 'A2' or 'A6' or 'K5') or   0000000
042470       (IPPMA2-2-CODE-GARANTIE (4 2) = 'A2' or 'A6' or 'K5') or   0000000
042480       (IPPMA2-2-CODE-GARANTIE (4 3) = 'A2' or 'A6' or 'K5') or   0000000
042490       (IPPMA2-2-CODE-GARANTIE (4 4) = 'A2' or 'A6' or 'K5'))     0000000
042500                     MOVE '052'   TO  W-CLAUSE                    0000000
042510                     PERFORM  AJOUT-UNE-CLAUSE                    0000000
042520      END-IF                                                      0000000
042530     END-IF                                                       0000000
042540     IF SUITE                                                     0000000
042550      if ((IPPMA2-2-CODE-GARANTIE(1 1) = 'UH'   or 'UN' ) or      0000000
042560       (IPPMA2-2-CODE-GARANTIE (1 2) = 'UH'   or 'UN' ) or        0000000
042570       (IPPMA2-2-CODE-GARANTIE (1 3) = 'UH'   or 'UN' ) or        0000000
042580       (IPPMA2-2-CODE-GARANTIE (1 4) = 'UH'   or 'UN' ) or        0000000
042590                                                                  0000000
042600       (IPPMA2-2-CODE-GARANTIE (2 1) = 'UH'   or 'UN' ) or        0000000
042610       (IPPMA2-2-CODE-GARANTIE (2 2) = 'UH'   or 'UN' ) or        0000000
042620       (IPPMA2-2-CODE-GARANTIE (2 3) = 'UH'   or 'UN' ) or        0000000
042630       (IPPMA2-2-CODE-GARANTIE (2 4) = 'UH'   or 'UN' ) or        0000000
042640                                                                  0000000
042650       (IPPMA2-2-CODE-GARANTIE (3 1) = 'UH'   or 'UN' ) or        0000000
042660       (IPPMA2-2-CODE-GARANTIE (3 2) = 'UH'   or 'UN' ) or        0000000
042670       (IPPMA2-2-CODE-GARANTIE (3 3) = 'UH'   or 'UN' ) or        0000000
042680       (IPPMA2-2-CODE-GARANTIE (3 4) = 'UH'   or 'UN' ) or        0000000
042690                                                                  0000000
042700       (IPPMA2-2-CODE-GARANTIE (4 1) = 'UH'   or 'UN' ) or        0000000
042710       (IPPMA2-2-CODE-GARANTIE (4 2) = 'UH'   or 'UN' ) or        0000000
042720       (IPPMA2-2-CODE-GARANTIE (4 3) = 'UH'   or 'UN' ) or        0000000
042730       (IPPMA2-2-CODE-GARANTIE (4 4) = 'UH'   or 'UN' )  )        0000000
042740                     MOVE '274'   TO  W-CLAUSE                    0000000
042750                     PERFORM  AJOUT-UNE-CLAUSE                    0000000
042760      END-IF                                                      0000000
042770     END-IF                                                       0000000
042780                                                                  0000000
042790     IF  SUITE                                                    0000000
042800         if  ((IPPMA2-2-cnat  (1)        = '293'   and            0000000
042810               IPPMA2-CD-SOUS-PROD (1) = '077' )    or            0000000
042820             ( IPPMA2-2-cnat  (2)        = '293'   and            0000000
042830               IPPMA2-CD-SOUS-PROD (2) = '077' )    or            0000000
042840             ( IPPMA2-2-cnat  (3)        = '293'   and            0000000
042850               IPPMA2-CD-SOUS-PROD (3) = '077' )    or            0000000
042860             ( IPPMA2-2-cnat  (4)        = '293'   and            0000000
042870               IPPMA2-CD-SOUS-PROD (4) = '077' ))                 0000000
042880                 MOVE '330'   TO  W-CLAUSE                        0000000
042890                 PERFORM  AJOUT-UNE-CLAUSE                        0000000
042900         END-IF                                                   0000000
042910     END-IF                                                       0000000
042920                                                                  0000000
042930                                                                  0000000
042940     IF  SUITE                                                    0000000
042950         IF  ( ORGS01-BANQUE-CIC )                                0000000
042960             if (((IPPMA2-2-CNAT (1)       = '200' or '218')  and 0000000
042970                   IPPMA2-CD-SOUS-PROD (1) = '017' )    or        0000000
042980                 ((IPPMA2-2-CNAT (2)       = '200' or '218')  and 0000000
042990                   IPPMA2-CD-SOUS-PROD (2) = '017' )    or        0000000
043000                 ((IPPMA2-2-CNAT (3)       = '200' or '218')  and 0000000
043010                   IPPMA2-CD-SOUS-PROD (3) = '017' )    or        0000000
043020                 ((IPPMA2-2-CNAT (4)       = '200' or '218')  and 0000000
043030                   IPPMA2-CD-SOUS-PROD (4) = '017' ))             0000000
043040                     MOVE '099'   TO  W-CLAUSE                    0000000
043050                     PERFORM  AJOUT-UNE-CLAUSE                    0000000
043060             end-if                                               0000000
043070         END-IF                                                   0000000
043080     END-IF                                                       0000000
043090                                                                  0000000
043100D    DISPLAY 'SALARIE-TR1-2 ' SALARIE-TR1-2.                      0000000
043110D    DISPLAY 'CLAUSE  ' IPPCPL-CLAUSES-NO.                        0000000
043120                                                                  0000000
043130     IF  SUITE                                                    0000000
043140         IF  (IPPMA2-CAISSE = '08940' )                           0000000
043150               MOVE '117'   TO  W-CLAUSE                          0000000
043160               PERFORM  AJOUT-UNE-CLAUSE                          0000000
043170         END-IF                                                   0000000
043180     END-IF                                                       0000000
043190                                                                  0000000
043200     IF  SUITE                                                    0000000
043210         if   (IPPMA2-2-CNAT(1) = ('642' OR '644') OR             0000000
043220               IPPMA2-2-CNAT(2) = ('642' OR '644') OR             0000000
043230               IPPMA2-2-CNAT(3) = ('642' OR '644') OR             0000000
043240               IPPMA2-2-CNAT(4) = ('642' OR '644'))               0000000
043250               MOVE '072'   TO  W-CLAUSE                          0000000
043260               PERFORM  AJOUT-UNE-CLAUSE                          0000000
043270         end-if                                                   0000000
043280     END-IF                                                       0000000
043290                                                                  0000000
043300     IF  SUITE                                                    0000000
043310         if   (IPPMA2-2-CNAT(1) = ('643' OR '645') OR             0000000
043320               IPPMA2-2-CNAT(2) = ('643' OR '645') OR             0000000
043330               IPPMA2-2-CNAT(3) = ('643' OR '645') OR             0000000
043340               IPPMA2-2-CNAT(4) = ('643' OR '645'))               0000000
043350               MOVE '073'   TO  W-CLAUSE                          0000000
043360               PERFORM  AJOUT-UNE-CLAUSE                          0000000
043370         end-if                                                   0000000
043380     END-IF                                                       0000000
043390                                                                  0000000
043400     IF  SUITE                                                    0000000
043410         if   (IPPMA2-2-CNAT(1) = ('645' OR '646') OR             0000000
043420               IPPMA2-2-CNAT(2) = ('645' OR '646') OR             0000000
043430               IPPMA2-2-CNAT(3) = ('645' OR '646') OR             0000000
043440               IPPMA2-2-CNAT(4) = ('645' OR '646'))               0000000
043450               MOVE '074'   TO  W-CLAUSE                          0000000
043460               PERFORM  AJOUT-UNE-CLAUSE                          0000000
043470           END-IF                                                 0000000
043480     END-IF                                                       0000000
043490                                                                  0000000
043500     IF  SUITE                                                    0000000
043510         IF   (IPPMA2-2-CNAT(1) > '640' and                       0000000
043520               IPPMA2-2-CNAT(1) < '647' )                         0000000
043530         or   (IPPMA2-2-CNAT(2) > '640' and                       0000000
043540               IPPMA2-2-CNAT(2) < '647' )                         0000000
043550               MOVE '079'   TO  W-CLAUSE                          0000000
043560               PERFORM  AJOUT-UNE-CLAUSE                          0000000
043570           END-IF                                                 0000000
043580     END-IF                                                       0000000
043590                                                                  0000000
043600     IF  SUITE                                                    0000000
043610         if   (IPPMA2-2-CNAT(1) = '300' OR                        0000000
043620               IPPMA2-2-CNAT(2) = '300' OR                        0000000
043630               IPPMA2-2-CNAT(3) = '300' OR                        0000000
043640               IPPMA2-2-CNAT(4) = '300' )                         0000000
043650               MOVE '111'   TO  W-CLAUSE                          0000000
043660               PERFORM  AJOUT-UNE-CLAUSE                          0000000
043670         end-if                                                   0000000
043680     END-IF                                                       0000000
043690                                                                  0000000
043700*  fede 47.                                                       0000000
043710                                                                  0000000
043720     IF  SUITE                                                    0000000
043730         IF   (IPPMA2-CD-SOUS-PROD (1) = '007'  OR                0000000
043740               IPPMA2-CD-SOUS-PROD (2) = '007'  OR                0000000
043750               IPPMA2-CD-SOUS-PROD (3) = '007'  OR                0000000
043760               IPPMA2-CD-SOUS-PROD (4) = '007' )                  0000000
043770                MOVE '115'   TO  W-CLAUSE                         0000000
043780                PERFORM  AJOUT-UNE-CLAUSE                         0000000
043790         END-IF                                                   0000000
043800     END-IF                                                       0000000
043810*  fede 55 et 218                                                 0000000
043820                                                                  0000000
043830*  sup  254  clause dossier  remplace par clause bidon 789        0000000
043840     PERFORM               VARYING IP FROM 1 BY 1                 0000000
043850              UNTIL  IP  >  10                                    0000000
043860         IF  IPPCPL-CLAUSE-NO(IP)  =  '254'                       0000000
043870             MOVE  '789'    TO  IPPCPL-CLAUSE-NO (IP)             0000000
043880             MOVE    11      TO  IP                               0000000
043890         end-if                                                   0000000
043900     END-PERFORM                                                  0000000
043910*  sup  254                                                       0000000
043920                                                                  0000000
043930                                                                  0000000
043940d    display 'ippbatch APRES rajout clauses **'                   0000000
043950d    PERFORM  DISP-CLAUSE-SPECIF                                  0000000
043960                                                                  0000000
043970     IF SUITE                                                     0000000
043980        IF IPPMA2-LABEL-APPLI = 'IPC'                             0000000
043990           IF IPPMA2-2-EXIST-CLAUSE-PRT(1) = '1'                  0000000
044000              MOVE 5 TO ICLAU                                     0000000
044010              PERFORM      TRAIT-CLAUSES                          0000000
044020           ELSE NEXT SENTENCE                                     0000000
044030        ELSE                                                      0000000
044040        IF IPPMA2-EXIST-CLAUSE-DOS  = '1'                         0000000
044050           MOVE 5 TO ICLAU                                        0000000
044060           PERFORM      TRAIT-CLAUSES.                            0000000
044070*                                                                 0000000
044080* *** LECTURE  IPPCPLG  PRTSAY   ou base pret                     0000000
044090*                                                                 0000000
044100*    IF  SUITE                                                    0000000
044110*        IF  IPPMA2-TROUVE                                        0000000
044120*             MOVE      1     TO IT                               0000000
044130*             PERFORM         LECTURE-IPPCPL.                     0000000
044140*                                                                 0000000
044150* ***  CREDIPLAN  -  CREDIT EPARGNE                               0000000
044160     IF SUITE                                                     0000000
044170        IF IPPMA2-LABEL-APPLI = 'IPC'                             0000000
044180           IF (SAY-EPA-MONT9 NUMERIC)                             0000000
044190              IF (SAY-EPA-MONT9 NOT = ZERO)                       0000000
044200              AND (SAY-EPA-BANQUE9 NUMERIC)                       0000000
044210              AND (SAY-EPA-BANQUE9 NOT = ZERO)                    0000000
044220              AND (SAY-EPA-CAISSE9 NUMERIC)                       0000000
044230              AND (SAY-EPA-CAISSE9 NOT = ZERO)                    0000000
044240              AND (SAY-EPA-COMPTE9 NUMERIC)                       0000000
044250              AND (SAY-EPA-COMPTE9 NOT = ZERO)                    0000000
044260D               DISPLAY 'CREDIPLAN CLAUSE 0046 '                  0000000
044270                PERFORM         TRAIT-CLAUSE-EPARGNE.             0000000
044280                                                                  0000000
044290*    IF SUITE                                                     0000000
044300*       IF (SAY-GAR1  =  'K5' OR                                  0000000
044310*           SAY-GAR2  =  'K5' )                                   0000000
044320*           PERFORM         TRAIT-CLAUSE-052.                     0000000
044330                                                                  0000000
044340                                                                  0000000
044350*                                                                 0000000
044360* ***         ANALYSE PRELIMINAIRE DES GARANTIES                  0000000
044370     IF SUITE                                                     0000000
044380        SET  PRET-SANS-HYPO TO  TRUE                              0000000
044390        PERFORM  MISE-TABLE-GAR                                   0000000
044400                VARYING IP FROM 1 BY 1 UNTIL IP > 4               0000000
044410                     OR IPPMA2-2-TAB-PRET (IP) = SPACES           0000000
044420                     OR IPPMA2-2-CAT    (IP) NOT NUMERIC          0000000
044430                     OR IPPMA2-2-CNAT   (IP) NOT NUMERIC          0000000
044440                     OR ARRET.                                    0000000
044450                                                                  0000000
044460D    DISPLAY  'W-TAB-GAR'                                         0000000
044470D    DISPLAY  W-TAB-GAR1 (1)                                      0000000
044480D    DISPLAY  W-TAB-GAR1 (2)                                      0000000
044490D    DISPLAY  W-TAB-GAR1 (3)                                      0000000
044500D    DISPLAY  W-TAB-GAR1 (4)                                      0000000
044510                                                                  0000000
044520     IF SUITE                                                     0000000
044530        PERFORM         ANALYSE-PRET-GAR                          0000000
044540                           VARYING IP FROM 1 BY 1                 0000000
044550                             UNTIL IP > 4                         0000000
044560                             OR IPPMA2-2-TAB-PRET (IP) = SPACES   0000000
044570                             OR IPPMA2-2-CAT    (IP) NOT NUMERIC  0000000
044580                             OR IPPMA2-2-CNAT   (IP) NOT NUMERIC  0000000
044590                             OR ARRET.                            0000000
044600                                                                  0000000
044610d    display 'cau-exist 2 ' cau-exist                             0000000
044620                                                                  0000000
044630* ***         TRAITEMENT DES PRETS                                0000000
044640     IF SUITE                                                     0000000
044650        PERFORM         TRAIT-PRET                                0000000
044660                           VARYING IP FROM 1 BY 1                 0000000
044670                             UNTIL IP > 4                         0000000
044680                             OR IPPMA2-2-TAB-PRET (IP) = SPACES   0000000
044690                             OR IPPMA2-2-CAT    (IP) NOT NUMERIC  0000000
044700                             OR IPPMA2-2-CNAT   (IP) NOT NUMERIC  0000000
044710                             OR ARRET.                            0000000
044720                                                                  0000000
044730     IF  MADELIN-EXIST  =  'O'  AND  NOT  AVENANT                 0000000
044740         IF  NB-PRET-DOSS   >   1                                 0000000
044750             MOVE   IPPPRI-STOCK (1)  TO  IPPPRI                  0000000
044760             MOVE   W-TOTAL-MONT120   TO  IPPPRI-MONT120          0000000
044770             MOVE   IPPPRI            TO  IPPPRI-STOCK (1).       0000000
044780                                                                  0000000
044790     IF  NOT  (AVENANT)                                           0000000
044800        IF  NB-PRET-DOSS   >   1                                  0000000
044810            PERFORM  VARYING  IR  FROM  1  BY  1                  0000000
044820                  UNTIL    IR  >  NB-PRET-DOSS                    0000000
044830                   MOVE   IPPPRI-STOCK (IR)  TO  IPPPRI           0000000
044840                   MOVE  Z-MTOTPRET      TO  IPPPRI-MTOTPRET      0000000
044850d                  DISPLAY  ' WS-MTOTHYP+ ' WS-MTOTHYP            0000000
044860                   MOVE   WS-MTOTHYP        TO  IPPPRI-MTOTHYP    0000000
044870                   MOVE   IPPPRI            TO  IPPPRI-STOCK (IR) 0000000
044880            END-PERFORM                                           0000000
044890        Else                                                      0000000
044900             MOVE  IPPPRI-STOCK (1)   TO  IPPPRI                  0000000
044910             MOVE  Z-MTOTPRET         TO  IPPPRI-MTOTPRET         0000000
044920d            DISPLAY  ' WS-MTOTHYP1 ' WS-MTOTHYP                  0000000
044930             MOVE   WS-MTOTHYP        TO  IPPPRI-MTOTHYP          0000000
044940             MOVE   IPPPRI            TO  IPPPRI-STOCK (1)        0000000
044950        End-if                                                    0000000
044960     End-if                                                       0000000
044970                                                                  0000000
044980     IF  NOT  AVENANT                                             0000000
044990         MOVE   IPPPRI            TO  Z-IPPPRI                    0000000
045000         MOVE   IPPPRI-STOCK (1)  TO  IPPPRI                      0000000
045010         MOVE   WS-DEVMHF         TO  IPPPRI-DEVMHF               0000000
045020*        move    w-taxe           to  ipppri-taxe                 0000000
045030         move    space            to  ipppri-taxe                 0000000
045040         MOVE   IPPPRI            TO  IPPPRI-STOCK (1)            0000000
045050         MOVE   Z-IPPPRI          TO  IPPPRI                      0000000
045060     END-IF.                                                      0000000
045070*                                                                 0000000
045080* Recharger le notaire dans  ipppri (1)                           0000000
045090*                                                                 0000000
045100d    display 'notaire1 ' IPPPRI-STOCK (1) (3843 : 154)            0000000
045110d    display 'notaire2 ' IPPPRI-STOCK (2) (3843 : 154)            0000000
045120     If  not  ( avenant )                                         0000000
045130       if  IPPPRI-STOCK (1) (3843 : 154) = spaces                 0000000
045140         if  IPPPRI-STOCK (2) (3843 : 154)  not  = space          0000000
045150             Move IPPPRI-STOCK (2) (3843 : 154) to                0000000
045160                                IPPPRI-STOCK (1) (3843 : 154)     0000000
045170         Else                                                     0000000
045180          if  IPPPRI-STOCK (3) (3843 : 154)  not  = space         0000000
045190              Move IPPPRI-STOCK (3) (3843 : 154) to               0000000
045200                                 IPPPRI-STOCK (1) (3843 : 154)    0000000
045210          Else                                                    0000000
045220           if  IPPPRI-STOCK (4) (3843 : 154)  not  = space        0000000
045230               Move IPPPRI-STOCK (4) (3843 : 154) to              0000000
045240                                  IPPPRI-STOCK (1) (3843 : 154)   0000000
045250           End-if                                                 0000000
045260          End-if                                                  0000000
045270         End-if                                                   0000000
045280       End-if                                                     0000000
045290     End-if.                                                      0000000
045300* ***         EDITION DES DOCUMENTS                               0000000
045310     IF SUITE                                                     0000000
045320        MOVE 0   TO IND-ANOM                                      0000000
045330        PERFORM TRI-TABDEST VARYING I-DEST FROM 1 BY 1            0000000
045340                              UNTIL I-DEST > 52                   0000000
045350                                 OR POSTE-DEST(I-DEST) = SPACES   0000000
045360        PERFORM TRI-VARTAUX VARYING ICLAU FROM 1 BY 1             0000000
045370                              UNTIL ICLAU  > 10                   0000000
045380D       DISPLAY 'CLAUSIER-AUTRES ap tri = ' CLAUSIER-AUTRES       0000000
045390        PERFORM TRI-AUTRECL VARYING ICLAU FROM 1 BY 1             0000000
045400                              UNTIL ICLAU  > NB-CLA.              0000000
045410                                                                  0000000
045420D       DISPLAY 'CLAUSIER-AUTRES ap tri = ' CLAUSIER-AUTRES       0000000
045430D       DISPLAY 'CLAUSIER-VARTAUX FINAL = ' CLAUSIER-VARTAUX      0000000
045440D       DISPLAY 'CLAUSIER TYPGAR= ' CLAUSIER-TYPGAR               0000000
045450D       DISPLAY 'TABLE DES DESTINATAIRES'                         0000000
045460D       DISPLAY 'POSTE-DEST1  = ' POSTE-DEST(1)                   0000000
045470D       DISPLAY 'POSTE-DEST2  = ' POSTE-DEST(2)                   0000000
045480D       DISPLAY 'POSTE-DEST3  = ' POSTE-DEST(3)                   0000000
045490D       DISPLAY 'POSTE-DEST4  = ' POSTE-DEST(4)                   0000000
045500D       DISPLAY 'POSTE-DEST5  = ' POSTE-DEST(5)                   0000000
045510D       DISPLAY 'POSTE-DEST6  = ' POSTE-DEST(6)                   0000000
045520D       DISPLAY 'POSTE-DEST7  = ' POSTE-DEST(7)                   0000000
045530D       DISPLAY 'POSTE-DEST8  = ' POSTE-DEST(8)                   0000000
045540D       DISPLAY 'POSTE-DEST9  = ' POSTE-DEST(9)                   0000000
045550D       DISPLAY 'POSTE-DEST10 = ' POSTE-DEST(10)                  0000000
045560D       DISPLAY 'POSTE-DEST11 = ' POSTE-DEST(11)                  0000000
045570D       DISPLAY 'POSTE-DEST12 = ' POSTE-DEST(12)                  0000000
045580D       DISPLAY 'POSTE-DEST13 = ' POSTE-DEST(13)                  0000000
045590D       DISPLAY 'POSTE-DEST14 = ' POSTE-DEST(14)                  0000000
045600D       DISPLAY 'POSTE-DEST15 = ' POSTE-DEST(15)                  0000000
045610D       DISPLAY 'POSTE-DEST16 = ' POSTE-DEST(16)                  0000000
045620D       DISPLAY 'POSTE-DEST17 = ' POSTE-DEST(17)                  0000000
045630D       DISPLAY 'POSTE-DEST18 = ' POSTE-DEST(18)                  0000000
045640D       DISPLAY 'POSTE-DEST19 = ' POSTE-DEST(19)                  0000000
045650D       DISPLAY 'POSTE-DEST20 = ' POSTE-DEST(20)                  0000000
045660D       DISPLAY 'IPPPRI IPPBATCH'                                 0000000
045670D       DISPLAY 'IPPPRI-IND360 ' IPPPRI-IND360                    0000000
045680D       DISPLAY 'IPPPRI-DURAMOR1 ' IPPPRI-DURAMOR1-X.             0000000
045690D       DISPLAY 'IPPPRI-DURAMOR2 ' IPPPRI-DURAMOR2-X.             0000000
045700D       DISPLAY 'IPPPRI-JTERME AV IPPB1 ' IPPPRI-JTERME.          0000000
045710D       DISPLAY  IPPPRI.                                          0000000
045720                                                                  0000000
045730     IF  SUITE                                                    0000000
045740         set  88-IPPBATC1-CONT     to  true                       0000000
045750                                                                  0000000
045760         IF  AVENANT  OR CONTRAT-GPR                              0000000
045770             PERFORM CALL-IPPBATC1                                0000000
045780             IF  AVENANT-PTZ                                      0000000
045790               ADD  1  TO  CPT-AVENANT-PTZ                        0000000
045800             Else                                                 0000000
045810               ADD  1  TO  CPT-AVENANT                            0000000
045820             End-if                                               0000000
045830         ELSE                                                     0000000
045840             IF  (IPPMA2-DERN-ACTION-TP  NOT  = 'INS')            0000000
045850             PERFORM CALL-IPPBATC1.                               0000000
045860                                                                  0000000
045870     IF SUITE                                                     0000000
045880        ADD  1 TO CPT-FACT                                        0000000
045890        set DOSSIER-FACTURE to true                               0000000
045900     ELSE                                                         0000000
045910           MOVE '1' TO EDT-OK.                                    0000000
045920                                                                  0000000
045930D    DISPLAY 'FIN-TRAITEMENT EDT'.                                0000000
045940                                                                  0000000
045950 TRAIT-AVENANT-PTZ.                                               0000000
045960* si 'pas-de-ippma2' appel idchab.                                0000000
045970*    if pas-de-ippma2                                             0000000
045980*       Perform lecture-pret-idchab                               0000000
045990*    else                                                         0000000
046000*       Perform  LECTURE-IPPCPL-R                                 0000000
046010**   end-if                                                       0000000
046020                                                                  0000000
046030     If  suite                                                    0000000
046040d        display 'avenant PTZ '                                   0000000
046050         Set  avenant-ptz  to true                                0000000
046060*        If (ippcplr-rcf-new-bar  = '20'  or '40')                0000000
046070         If   CPT-TZBAR-DIFFERE-75                                0000000
046080             move  '0020'  to  ipppri-tzvers                      0000000
046090         Else                                                     0000000
046100*          If (ippcplr-rcf-new-bar  = '19' or '39')               0000000
046110           If  CPT-TZBAR-DIFFERE-50                               0000000
046120               move  '0019'  to  ipppri-tzvers                    0000000
046130           Else                                                   0000000
046140               move  '0001'  to  ipppri-tzvers                    0000000
046150           End-if                                                 0000000
046160         End-if                                                   0000000
046170     End-if                                                       0000000
046180     if  cpt-duram  numeric                                       0000000
046190         if  CPT-TZBAR-DIFFERE-100                                0000000
046200             Compute   w-duree  =  cpt-duram  + z-durfranc        0000000
046210         Else                                                     0000000
046220             Move  cpt-duram  to  w-duree                         0000000
046230         End-if                                                   0000000
046240     Else                                                         0000000
046250         Move  zero  to  w-duree                                  0000000
046260     End-if                                                       0000000
046270     Move  w-duree          to  ipppri-durtotal                   0000000
046280     move  co3-nb    (1)    to  w-duree                           0000000
046290     move  w-duree          to  ipppri-nbterm01                   0000000
046300     move  co3-nb    (2)    to  w-duree                           0000000
046310     move  w-duree          to  ipppri-nbterm02                   0000000
046320                                                                  0000000
046330     move  co3-ter(1)       to  ipppri-mtterm01                   0000000
046340     move  co3-ter(2)       to  ipppri-mtterm02                   0000000
046350     string TAM-DAT OF PRTCO4 (sai-nper) (7:2)  '.'               0000000
046360            TAM-DAT OF PRTCO4 (sai-nper) (5:2)  '.'               0000000
046370            TAM-DAT OF PRTCO4 (sai-nper) (1:4)                    0000000
046380               delimited  by  size      into  ipppri-datej        0000000
046390d             display 'ipppri-nbterm01 ' ipppri-nbterm01          0000000
046400d             display 'ipppri-nbterm02 ' ipppri-nbterm02          0000000
046410d             display 'ipppri-mtterm01 ' ipppri-mtterm01          0000000
046420d             display 'ipppri-mtterm02 ' ipppri-mtterm02          0000000
046430d             display 'ipppri-tzvers   ' ipppri-tzvers            0000000
046440d             display 'ipppri-datej    ' ipppri-datej             0000000
046450     .                                                            0000000
046460                                                                  0000000
046470                                                                  0000000
046480*------------------------ AJOUT D'UNE CLAUSE         -----        0000000
046490                                                                  0000000
046500 AJOUT-UNE-CLAUSE.                                                0000000
046510                                                                  0000000
046520     PERFORM  AJOUT-CLAUSE VARYING IP FROM 1 BY 1                 0000000
046530              UNTIL  IP  >  10.                                   0000000
046540                                                                  0000000
046550 AJOUT-CLAUSE.                                                    0000000
046560                                                                  0000000
046570     IF  IPPCPL-CLAUSE-NO(IP)  =  SPACE                           0000000
046580         MOVE  W-CLAUSE  TO  IPPCPL-CLAUSE-NO (IP)                0000000
046590         MOVE    11      TO  IP                                   0000000
046600         IF  IPPMA2-LABEL-APPLI  =  'IPC'                         0000000
046610             MOVE  1  TO  IPPMA2-2-EXIST-CLAUSE-PRT (1)           0000000
046620           ELSE                                                   0000000
046630             MOVE  1  TO   IPPMA2-EXIST-CLAUSE-DOS                0000000
046640         END-IF                                                   0000000
046650     END-IF                                                       0000000
046660     .                                                            0000000
046670                                                                  0000000
046680*------------------------- INIT ZONE EDITION -------------        0000000
046690 INIT-TRAVAIL.                                                    0000000
046700*-------------------------                                        0000000
046710                                                                  0000000
046720                                                                  0000000
046730     MOVE SPACES               TO ZZ-EMP1DOMI.                    0000000
046740     MOVE SPACES               TO ZZ-EMP1DOMI.                    0000000
046750                                                                  0000000
046760     MOVE SPACES               TO WS-EMP1PROF.                    0000000
046770     MOVE SPACES               TO WS-EMP2PROF.                    0000000
046780     MOVE SPACES               TO WS-CAU1PROF.                    0000000
046790     MOVE SPACES               TO WS-CAU2PROF.                    0000000
046800     MOVE SPACES               TO IPPPRI.                         0000000
046810     MOVE ZERO                 TO IPPPRI-EMPCAPSO-X               0000000
046820                      NB-PRET-DOSS  W-TOTAL-MONT120               0000000
046830                                  IPPPRI-INDINSCR.                0000000
046840     MOVE SPACES               TO IPPEDG.                         0000000
046850     MOVE SPACES               TO IPPEDG-DONNEES.                 0000000
046860**** IPI                                                          0000000
046870     MOVE SPACES               TO IPPRGT.                         0000000
046880     MOVE 'N'                  TO CAUTION-PREVUE.                 0000000
046890     MOVE 'N'                  TO NANTVAL-PREVUE.                 0000000
046900     MOVE 'N'                  TO NANTI67-PREVUE.                 0000000
046910     MOVE 'N'                  TO CREMO65-PREVUE.                 0000000
046920     MOVE 'N'                  TO WARRANT-PREVUE.                 0000000
046930     MOVE 'N'                  TO LETEN00-PREVUE.                 0000000
046940     MOVE 'N'                  TO NANFC00-PREVUE.                 0000000
046950     MOVE 'N'                  TO NANFA00-PREVUE.                 0000000
046960     MOVE 'N'                  TO GRUND-PREVU  L-ALLEMANDE        0000000
046970     MOVE 'NNNN'               TO MADELIN-PREVUE.                 0000000
046980     MOVE 'N'                  TO ASSURANCE-EXTERNE.              0000000
046990     MOVE 'N'                  TO LEBEN-PREVU  TODES-PREVU.       0000000
047000     MOVE ZERO                 TO W-VEHDEPT.                      0000000
047010     MOVE ZERO                 TO W-DEVPRC   W-DEVPRC2.           0000000
047020     MOVE SPACES               TO IDPTAM.                         0000000
047030     MOVE SPACES               TO ZONE1-STOCK                     0000000
047040                                  ZONE2-STOCK                     0000000
047050                                  ZONE3-STOCK                     0000000
047060                                  ZONE4-STOCK                     0000000
047070                                  ZONE5-STOCK                     0000000
047080                                  ZONE6-STOCK.                    0000000
047090**** IPI                                                          0000000
047100     MOVE SPACES               TO DONNEES-PLF.                    0000000
047110     MOVE ZERO                 TO Z-MONTANT(1)  Z-MONTANT(2).     0000000
047120     MOVE ZERO                 TO Z-MONTANT(2)  Z-MONTANT(4).     0000000
047130     MOVE ZERO                 TO Z-TAUDB(1)    Z-TAUDB(2).       0000000
047140     MOVE ZERO                 TO Z-TAUDB(3)    Z-TAUDB(4).       0000000
047150     MOVE ZERO                 TO Z-TERME(1)    Z-TERME(2).       0000000
047160     MOVE ZERO                 TO Z-TERME(3)    Z-TERME(4).       0000000
047170     MOVE ZERO                 TO Z-DURAM(1)    Z-DURAM(2).       0000000
047180     MOVE ZERO                 TO Z-DURAM(3)    Z-DURAM(4).       0000000
047190     MOVE SPACES               TO Z-CODRET(1)   Z-CODRET(2)       0000000
047200                                  Z-CODRET(3)   Z-CODRET(4).      0000000
047210     MOVE SPACES               TO Z-DCMAJ                         0000000
047220                                  Z-CMAJ-TAB                      0000000
047230                                  Z-DOMICIL-TAB.                  0000000
047240     MOVE  ZERO                TO W-ANCIEN-TEG                    0000000
047250                                  W-ANCIEN-TCOM                   0000000
047260                                  W-ANCIEN-TAFR                   0000000
047270                                  W-ANCIEN-TFRH                   0000000
047280                                  W-ANCIEN-TCAS                   0000000
047290                                  W-MTASS                         0000000
047300                                  W-TXASS                         0000000
047310                                  W-MTASS1                        0000000
047320                                  W-TXASS1                        0000000
047330                                                                  0000000
047340     MOVE  ZERO                TO WS-MTOTHYP  WS-DEVMHF           0000000
047350                                  NB-MOIS-FRANCHISE.              0000000
047360     INITIALIZE                W-INDIC-GARX                       0000000
047370     INITIALIZE                W-INDIC-SAYX                       0000000
047380     INITIALIZE                W-INDIC-SAY2X                      0000000
047390     INITIALIZE                W-MTGAR                            0000000
047400     INITIALIZE                W-MTPRET                           0000000
047410     INITIALIZE                W-LSTGAR3HYP                       0000000
047420     move  zero                to  w-taxe  w-say-mtcred           0000000
047430     MOVE  zero                TO  nb-pret-salarie                0000000
047440     MOVE  0                   TO NOTARIE                         0000000
047450     SET NOTAIRE-NON-TROUVE    TO TRUE                            0000000
047460d    display 'W-MTGAR-MONT (1) ' W-MTGAR-MONT (1)                 0000000
047470     .                                                            0000000
047480**                                                                0000000
047490 INIT-TRAVAIL-2.                                                  0000000
047500                                                                  0000000
047510**                                                                0000000
047520                                                                  0000000
047530     MOVE APPEL-FED              TO APPLI-FED.                    0000000
047540                                                                  0000000
047550     Evaluate TRUE                                                0000000
047560       When APPEL-FED  =  '76'                                    0000000
047570* annecy  et idf                                                  0000000
047580       When ORGS01-ASSIMILE-IDF                                   0000000
047590* Fag                                                             0000000
047600       When ORGS01-FEDE-ANTILLES                                  0000000
047610* Fd Bail.                                                      0000000
047620       When ORGS01-banque = '13070'                               0000000
047630         MOVE    '11'            TO APPLI-FED                     0000000
047640                                                                  0000000
047650* bsd                  ORGS01-FEDE-CIC-NO                         0000000
047660       When APPEL-FED = '44'                                      0000000
047670* Lyon                 ORGS01-FEDE-LB                             0000000
047680       When APPEL-FED = '50'                                      0000000
047690* Nantes               ORGS01-FEDE-CIC-O  ORGS01-FEDE-CIC-SO      0000000
047700       When APPEL-FED = '49'                                      0000000
047710       When APPEL-FED = '51'                                      0000000
047720* Cial et Snvb         ORGS01-FEDE-CIC-EST                        0000000
047730       When APPEL-FED = '52'                                      0000000
047740         MOVE    '47'            TO APPLI-FED                     0000000
047750                                                                  0000000
047760* CMO                  ORGS01-FEDE-CMO                            0000000
047770*...PNE - 2012/02/14 - DEB Suite  convergence CMA devenu fd 11  0000000
047780       When APPEL-FED = '13'                                      0000000
047790         MOVE    '13'            TO APPLI-FED                     0000000
047800     End-Evaluate                                                 0000000
047810                                                                  0000000
047820                                                                  0000000
047830* ALLEMAND                                                        0000000
047840     IF   IPPMA2-LABEL-APPLI = 'IPI'                              0000000
047850          IF    LANGUE-ALLEMANDE                                  0000000
047860                 STRING 'AI'               DELIMITED BY SIZE      0000000
047870                        APPLI-FED          DELIMITED BY SIZE      0000000
047880                 INTO  IPPPRI-REFAPPL                             0000000
047890          ELSE                                                    0000000
047900            IF APPEL-FED = '13'                                   0000000
047910              STRING 'PH'               DELIMITED BY SIZE         0000000
047920                     '11'               DELIMITED BY SIZE         0000000
047930              INTO  IPPPRI-REFAPPL                                0000000
047940            Else                                                  0000000
047950                 STRING 'PI'               DELIMITED BY SIZE      0000000
047960                        APPLI-FED          DELIMITED BY SIZE      0000000
047970                 INTO  IPPPRI-REFAPPL                             0000000
047980            End-if                                                0000000
047990          End-if                                                  0000000
048000     ELSE                                                         0000000
048010       IF APPEL-FED = '13'                                        0000000
048020          STRING 'PC'               DELIMITED BY SIZE             0000000
048030                 '11'               DELIMITED BY SIZE             0000000
048040           INTO  IPPPRI-REFAPPL                                   0000000
048050       Else                                                       0000000
048060          STRING 'PP'               DELIMITED BY SIZE             0000000
048070                 APPLI-FED          DELIMITED BY SIZE             0000000
048080           INTO  IPPPRI-REFAPPL                                   0000000
048090       End-if                                                     0000000
048100     End-if.                                                      0000000
048110     set  immo-avec-taxe  to  true                                0000000
048120                                                                  0000000
048130     If  not  ( IPPMA2-LANGUE-ALLEMANDE )                         0000000
048140         If  IPPPRI-REFAPPL  =  'PI11'                            0000000
048150*           and  not  avenant                                     0000000
048160            Move 'II11'  to  IPPPRI-REFAPPL                       0000000
048170            set  immo-sans-taxe  to  true                         0000000
048180         End-if                                                   0000000
048190     End-if                                                       0000000
048200d    display ' IPPPRI-REFAPPL ' IPPPRI-REFAPPL                    0000000
048210     MOVE 'IDP'                TO IPPPRI-REFNMFAM.                0000000
048220     MOVE PGM-REF              TO Z-NUM15.                        0000000
048230     MOVE Z-NUM15              TO IPPPRI-REFDOCED.                0000000
048240     MOVE IPPMA2-RACINE        TO IPPPRI-RACINE.                  0000000
048250                                                                  0000000
048260     PERFORM  PLUS-UN-JOUR-OUVRE.                                 0000000
048270                                                                  0000000
048280     IF   IPPMA2-DATE-EDIT-OFFRE-OK  NUMERIC                      0000000
048290          MOVE  'RE'   TO  IPPPRI-REEDIT                          0000000
048300     ELSE                                                         0000000
048310          MOVE  SPACE  TO  IPPPRI-REEDIT.                         0000000
048320*                                                                 0000000
048330* editer un contrat complet si valins et 613                      0000000
048340* editer un contrat partiel si valtot (F5) et 613.                0000000
048350*                                                                 0000000
048360     IF CTL-R34 = ZERO                                            0000000
048370        IF  (ORGS01-FEDE-CEE AND NOT ORGS01-ASSIMILE-IDF)         0000000
048380          IF  (IPPMA2-ETAT-IMP-TP   = '2'  AND                    0000000
048390               IPPMA2-DERN-ACTION-TP  =  'EDI' )                  0000000
048400               IF  IPPPRI-CNAT1  =  '613'                         0000000
048410                   MOVE  'A13'  TO  IPPPRI-CNAT1.                 0000000
048420                                                                  0000000
048430     MOVE  ZERO          TO  IPPPRI-EIG.                          0000000
048440                                                                  0000000
048450     IF ((IPPMA2-2-CNAT(1) = '282' OR '284' OR '285'              0000000
048460               OR '643' OR '644' OR '645' OR '646')               0000000
048470*PGI - R40738 - 10/06/2011 - DEB                                  0000000
048480        AND ( SIT-ISC-TYPE-TEST OR                                0000000
048490*       AND ( ZISC-IMS  =  'N' OR                                 0000000
048500*PGI - R40738 - 10/06/2011 - FIN                                  0000000
048510             ORGS01-FEDE-LAVAL  OR                                0000000
048520            (IPPMA2-CAISSE = '00160' OR '00851' or '00500')))     0000000
048530       OR                                                         0000000
048540         ((ORGS01-FEDE-CEE AND NOT ORGS01-ASSIMILE-IDF) AND       0000000
048550          (IPPMA2-2-CNAT(1) = '284' ) AND                         0000000
048560           SAY-VTAU    =  2           AND                         0000000
048570           SAY-CINDEX  =  SPACE )                                 0000000
048580              MOVE    1   TO  IPPPRI-EIG                          0000000
048590     ELSE                                                         0000000
048600              MOVE  ZERO  TO  IPPPRI-EIG                          0000000
048610     END-IF.                                                      0000000
048620D    DISPLAY  'IPPPRI-EIG '                                       0000000
048630D    DISPLAY   IPPPRI-EIG.                                        0000000
048640                                                                  0000000
048650     SET   SL-AUTO-KO  TO  TRUE                                   0000000
048660     IF  ORGS01-FEDE-LAVAL AND                                    0000000
048670          (SAY-CNAT       = '266' )                               0000000
048680          IF ( (SAY-DEVISE     = 'EUR' )      AND                 0000000
048690             (SAY-MTCRED  >= W-SCRIVENER-EUR    AND               0000000
048700              SAY-MTCRED  <= W-MAX-266-EUR  ) )                   0000000
048710                   SET   SL-AUTO-OK  TO  TRUE                     0000000
048720          END-IF                                                  0000000
048730     END-IF.                                                      0000000
048740                                                                  0000000
048750     MOVE IPPMA2-DOSS          TO IPPPRI-NUMDOSS.                 0000000
048760     MOVE IPPMA2-DEVISE        TO IPPPRI-DEVLC.                   0000000
048770                                                                  0000000
048780                                                                  0000000
048790     MOVE  IPPMA2-DEVFACT  TO  IPPPRI-DEVFACT.                    0000000
048800*                                                                 0000000
048810D    DISPLAY 'DEVFACT ' IPPPRI-DEVFACT.                           0000000
048820                                                                  0000000
048830     MOVE  ZERO               TO IPPPRI-INDDEV.                   0000000
048840     MOVE  ZERO               TO IPPPRI-DEVCTF.                   0000000
048850                                                                  0000000
048860D    DISPLAY 'IPPMA2-DEVISE = ' IPPMA2-DEVISE                     0000000
048870                                                                  0000000
048880*    IF (IPPMA2-DEVISE   =  'FRF'   OR  SPACE )                   0000000
048890*        MOVE  LIB1-FRF           TO IPPPRI-DEVLL                 0000000
048900     IF (IPPMA2-DEVISE   =  'EUR'   OR  SPACE )                   0000000
048910         MOVE  LIB1-EUR           TO IPPPRI-DEVLL                 0000000
048920         IF   IPPMA2-COUT-DOS NUMERIC                             0000000
048930              MOVE IPPMA2-COUT-DOS9     TO IPPPRI-DEVCTF          0000000
048940         END-IF                                                   0000000
048950     ELSE                                                         0000000
048960         PERFORM  INIT-VAR-DEVISE.                                0000000
048970                                                                  0000000
048980     MOVE '0'                  TO IPPPRI-INDTERME.                0000000
048990     MOVE '1'                  TO IPPPRI-INDPROF.                 0000000
049000     MOVE '0'                  TO IPPPRI-INDCOPIE.                0000000
049010     MOVE '1'                  TO IPPPRI-INDOFFCO.                0000000
049020*                                                                 0000000
049030     MOVE SPACE                TO EDITION-GAGE-ONLY.              0000000
049040**** IPI                                                          0000000
049050     MOVE IPPMA2-LABEL-APPLI   TO LABEL-APPLI.                    0000000
049060     MOVE ZERO                 TO Z-TYPEPC.                       0000000
049070     MOVE ZERO                 TO Z-VARIANTE-PC.                  0000000
049080     MOVE ZERO                 TO Z-DOSS-PC.                      0000000
049090*                                                                 0000000
049100     MOVE SPACE                TO TABLE-DESTINATAIRES.            0000000
049110     MOVE ZERO                 TO CLAUSIER-VARTAUX.               0000000
049120     MOVE ZERO                 TO CLAUSIER-AUTRES.                0000000
049130     MOVE SPACES               TO TAB-TYPGAR.                     0000000
049140     MOVE SPACES               TO TAB-FEEDBACK.                   0000000
049150     MOVE SPACES               TO ZONE-DOCU.                      0000000
049160     MOVE 1    TO I-DEST.                                         0000000
049170     MOVE ZERO TO ICLAU.                                          0000000
049180     MOVE ZERO TO ICLAUV.                                         0000000
049190     MOVE ZERO TO ICLAUA.                                         0000000
049200     MOVE ZERO TO ICLAUT.                                         0000000
049210     MOVE ZERO TO K.                                              0000000
049220     MOVE ZERO                 TO Z-TIMB (1)  Z-COMM (1)          0000000
049230     MOVE ZERO                 TO Z-TIMB (2)  Z-COMM (2)          0000000
049240     MOVE ZERO                 TO Z-TIMB (3)  Z-COMM (3)          0000000
049250     MOVE ZERO                 TO Z-TIMB (4)  Z-COMM (4)          0000000
049260     MOVE ZERO                 TO Z-MTOTPRET.                     0000000
049270     MOVE ZERO                 TO Z-TIMB (1)  Z-COMM (1)          0000000
049280     MOVE ZERO                 TO Z-TIMB (2)  Z-COMM (2)          0000000
049290     MOVE ZERO                 TO Z-TIMB (3)  Z-COMM (3)          0000000
049300     MOVE ZERO                 TO Z-TIMB (4)  Z-COMM (4)          0000000
049310     MOVE ZERO                 TO Z-SUPP-CAPITAL.                 0000000
049320*FG-0190-DURAMOR1: DUREE PARTIE BONIFIEE PRET AGRICOLE            0000000
049330*        DURAMOR2: DUREE PARTIE NON BONIFIEE PRET AGRICOLE        0000000
049340     MOVE ZERO                 TO IPPPRI-DURAMOR1-X               0000000
049350     MOVE ZERO                 TO IPPPRI-DURAMOR2-X               0000000
049360*                                                                 0000000
049370     MOVE ZERO                 TO IPPPRI-RDATECH1                 0000000
049380     MOVE ZERO                 TO IPPPRI-RDATECH2                 0000000
049390     MOVE ZERO                 TO IPPPRI-RDATECH3                 0000000
049400     MOVE ZERO                 TO IPPPRI-RDATECH4                 0000000
049410     MOVE ZERO                 TO IPPPRI-RDATECH5                 0000000
049420     MOVE ZERO                 TO IPPPRI-RMTECH1-X                0000000
049430     MOVE ZERO                 TO IPPPRI-RMTECH2-X                0000000
049440     MOVE ZERO                 TO IPPPRI-RMTECH3-X                0000000
049450     MOVE ZERO                 TO IPPPRI-RMTECH4-X                0000000
049460     MOVE ZERO                 TO IPPPRI-RMTECH5-X                0000000
049470     MOVE ZERO                 TO IPPPRI-NBECHREL                 0000000
049480     MOVE ZERO                 TO IPPPRI-RINTER                   0000000
049490     MOVE ZERO                 TO IPPPRI-INDTZ                    0000000
049500     MOVE ZERO                 TO IPPPRI-TAXE.                    0000000
049510*                                                                 0000000
049520*-------------                                                    0000000
049530*                                                                 0000000
049540     MOVE ZERO                 TO NBR-PRET-ACM.                   0000000
049550     MOVE ZERO                 TO EXIST-INDEX.                    0000000
049560     MOVE  L-SUCCESSIVES       TO IPPPRI-LIBSPECH.                0000000
049570     MOVE ZERO                 TO IPPPRI-INDJUMEL.                0000000
049580                                                                  0000000
049590* avenant                                                         0000000
049600D    DISPLAY 'APPEL-APPLI ' APPEL-APPLI.                          0000000
049610     SET  Y-A-PAS-UNE-254   TO  TRUE                              0000000
049620     IF    AVENANT                                                0000000
049630         MOVE  '1'     TO  IPPPRI-AVENANT                         0000000
049640     ELSE                                                         0000000
049650         MOVE  ZERO    TO  IPPPRI-AVENANT.                        0000000
049660                                                                  0000000
049670*  Lecture prtcondi pour savoir si a la date d'ouverture          0000000
049680*           l'assurance etait dans le teg ou pas.                 0000000
049690     PERFORM  PRTCONDI-5001.                                      0000000
049700                                                                  0000000
049710 PRTCONDI-5001.                                                   0000000
049720                                                                  0000000
049730     INITIALIZE  PRTREG.                                          0000000
049740     MOVE ZERO      TO REG-E-CPROD                                0000000
049750                       REG-E-GESTION                              0000000
049760                       REG-E-BASASS.                              0000000
049770     MOVE '2'                  TO REG-E-TYPE                      0000000
049780     MOVE IPPMA2-FED           TO REG-E-FED                       0000000
049790     MOVE ORGS01-BANQUE        TO REG-E-BANQUE                    0000000
049800     MOVE IPPMA2-CAISSE        TO REG-E-CAISSE                    0000000
049810     CALL 'ZCALLPGM' USING PRTZREGT                               0000000
049820                            PRTREG.                               0000000
049830d    DISPLAY 'PRTZREGT ' REG-S-CODE-RETOUR '*' REG-S-ASSTEG-I     0000000
049840     IF REG-S-OK                                                  0000000
049850        IF REG-S-ASSTEG-TOTALE                                    0000000
049860           SET  TEG-AVEC-ASSUR   TO  TRUE                         0000000
049870        else                                                      0000000
049880           SET  TEG-SANS-ASSUR   TO  TRUE                         0000000
049890        end-iF                                                    0000000
049900     else                                                         0000000
049910d       DISPLAY 'PRTZREGT ' REG-S-CODE-RETOUR '*' REG-S-ASSTEG-I  0000000
049920        SET  TEG-AVEC-ASSUR   TO  TRUE                            0000000
049930        MOVE    ZERO  TO  CTL-R34                                 0000000
049940     end-if.                                                      0000000
049950D    DISPLAY 'TEG-CONSO = ' TEG-CONSO.                            0000000
049960                                                                  0000000
049970     INITIALIZE  PRTREG.                                          0000000
049980     MOVE ZERO      TO REG-E-CPROD                                0000000
049990                       REG-E-GESTION                              0000000
050000                       REG-E-BASASS.                              0000000
050010     MOVE '1'                  TO REG-E-TYPE                      0000000
050020     MOVE IPPMA2-FED           TO REG-E-FED                       0000000
050030     MOVE ORGS01-BANQUE        TO REG-E-BANQUE                    0000000
050040     MOVE IPPMA2-CAISSE        TO REG-E-CAISSE                    0000000
050050     CALL 'ZCALLPGM' USING PRTZREGT                               0000000
050060                            PRTREG.                               0000000
050070d    DISPLAY 'PRTZREGT ' REG-S-CODE-RETOUR '*' REG-S-ASSTEG-I     0000000
050080     IF REG-S-OK                                                  0000000
050090        IF REG-S-ASSTEG-TOTALE                                    0000000
050100           SET  TEG-AVEC-ASS-I   TO  TRUE                         0000000
050110        else                                                      0000000
050120           SET  TEG-SANS-ASS-I   TO  TRUE                         0000000
050130        end-iF                                                    0000000
050140     else                                                         0000000
050150d       DISPLAY 'PRTZREGT ' REG-S-CODE-RETOUR '*' REG-S-ASSTEG-I  0000000
050160        SET  TEG-AVEC-ASS-I   TO  TRUE                            0000000
050170        MOVE    ZERO  TO  CTL-R34                                 0000000
050180     end-if.                                                      0000000
050190D    DISPLAY 'TEG-IMMO = ' TEG-IMMO.                              0000000
050200                                                                  0000000
050210     IF  TEG-SANS-ASSUR                                           0000000
050220         AND      (IPPMA2-LABEL-APPLI = 'IPC')                    0000000
050230         SET  L-TEG-SANS-IPC  TO  TRUE                            0000000
050240     ELSE                                                         0000000
050250         SET  L-TEG-AVEC-IPC  TO  TRUE.                           0000000
050260                                                                  0000000
050270                                                                  0000000
050280 PLUS-UN-JOUR-OUVRE.                                              0000000
050290                                                                  0000000
050300     INITIALIZE  DATS20.                                          0000000
050310                                                                  0000000
050320     SET       DATS20-I-FONCTION-DELAI  TO TRUE.                  0000000
050330                                                                  0000000
050340     Perform  RECH-DATOUV-PTZ                                     0000000
050350     MOVE     CP2B-DATOUV     TO DATS20-I-DATE1                   0000000
050360                                                                  0000000
050370     MOVE     'J'                TO DATS20-I-ENTREE-TYPE1.        0000000
050380     MOVE     'A'                TO DATS20-I-ENTREE-SENS1.        0000000
050390     MOVE     +1                 TO DATS20-I-NBJOURS.             0000000
050400     MOVE     'E'                TO DATS20-I-TYPJOUR.             0000000
050410     MOVE     '1'                TO DATS20-I-TYPCAL.              0000000
050420                                                                  0000000
050430     CALL     'ZCALLPGM'      USING ZDAT2000 DATS20.              0000000
050440                                                                  0000000
050450D    DISPLAY 'DATS20-O-DATE ' DATS20-O-DATE                       0000000
050460                                                                  0000000
050470     IF        DATS20-O-CODRET  = ZERO                            0000000
050480               STRING DATS20-O-DATE (7:2) '/'                     0000000
050490                      DATS20-O-DATE (5:2) '/'                     0000000
050500                      DATS20-O-DATE (1:4) DELIMITED BY SIZE       0000000
050510                                         INTO  IPPPRI-DATEJ       0000000
050520D              DISPLAY 'DATEJ ' IPPPRI-DATEJ                      0000000
050530     else                                                         0000000
050540        DISPLAY 'DATEJ FAUSSE' DATS20-O-CODRET DATS20-O-LIBRET    0000000
050550     END-IF.                                                      0000000
050560                                                                  0000000
050570D    DISPLAY 'DATEJ ' IPPPRI-DATEJ.                               0000000
050580                                                                  0000000
050590 INIT-VAR-DEVISE.                                                 0000000
050600                                                                  0000000
050610     IF  NOT (IPPMA2-DEVISE   =  'EUR')                           0000000
050620         IF  IPPMA2-MTFACT  NUMERIC                               0000000
050630             MOVE IPPMA2-MTFACT9      TO IPPPRI-DEVCTF            0000000
050640         ELSE                                                     0000000
050650             DISPLAY 'ERREUR PRET - MTFACT FAUX ????'             0000000
050660             DISPLAY  IPPMA2-FED  IPPMA2-CAISSE  ' ' IPPMA2-RACINE0000000
050670                  ' ' IPPMA2-DOSS                                 0000000
050680     ELSE                                                         0000000
050690         IF   IPPMA2-COUT-DOS NUMERIC                             0000000
050700              MOVE IPPMA2-COUT-DOS9     TO IPPPRI-DEVCTF          0000000
050710         END-IF                                                   0000000
050720     END-IF                                                       0000000
050730     .                                                            0000000
050740     IF  IPPMA2-DEVISE   =  'EUR'                                 0000000
050750         MOVE  LIB1-EUR           TO IPPPRI-DEVLL                 0000000
050760     ELSE                                                         0000000
050770       IF  IPPMA2-DEVISE   =  'DEM'                               0000000
050780           MOVE  LIB1-DEM           TO IPPPRI-DEVLL               0000000
050790       ELSE                                                       0000000
050800           MOVE  '1'                TO IPPPRI-INDDEV              0000000
050810           IF  IPPMA2-DEVISE   =  'CHF'                           0000000
050820              IF  LANGUE-ALLEMANDE                                0000000
050830               MOVE  LIB1-CHF-AL        TO IPPPRI-DEVLL           0000000
050840              ELSE                                                0000000
050850               MOVE  LIB1-CHF           TO IPPPRI-DEVLL           0000000
050860              END-IF                                              0000000
050870         ELSE                                                     0000000
050880             IF  IPPMA2-DEVISE   =  'USD'                         0000000
050890                 MOVE  LIB1-USD           TO IPPPRI-DEVLL         0000000
050900             ELSE                                                 0000000
050910                 IF  IPPMA2-DEVISE   =  'JPY'                     0000000
050920                     MOVE  LIB1-JPY           TO IPPPRI-DEVLL.    0000000
050930                                                                  0000000
050940D    DISPLAY 'IPPPRI-DEVLL = ' IPPPRI-DEVLL.                      0000000
050950D    DISPLAY 'IPPPRI-DEVLC = ' IPPPRI-DEVLC.                      0000000
050960                                                                  0000000
050970*------------------------- RECHERCHE DU TITULAIRE --------        0000000
050980 TRAIT-TITULAIRE.                                                 0000000
050990*-------------------------                                        0000000
051000                                                                  0000000
051010     IF  LANGUE-ALLEMANDE                                         0000000
051020         MOVE  'O'  TO  L-ALLEMANDE                               0000000
051030     ELSE                                                         0000000
051040         IF  DOSSIER-GOETHE                                       0000000
051050             MOVE  'G'  TO  L-ALLEMANDE                           0000000
051060         ELSE                                                     0000000
051070             MOVE  'N'  TO  L-ALLEMANDE                           0000000
051080         END-IF                                                   0000000
051090     END-IF                                                       0000000
051100                                                                  0000000
051110     MOVE  SPACE               TO WS-EMP1NOM.                     0000000
051120                                                                  0000000
051130d    display ' TIES10-L0001-TYP (1) '                             0000000
051140d    display   TIES10-L0001-TYP (1)                               0000000
051150d    display ' TIES10-L0001-TYP (2) '                             0000000
051160d    display   TIES10-L0001-TYP (2)                               0000000
051170d    display ' TIES10-L0001-TYP (2) '                             0000000
051180d    display   TIES10-L0001-TYP (2)                               0000000
051190                                                                  0000000
051200     IF TIES10-L0001-TYP (1) = '1'                                0000000
051210        MOVE '1'               TO IPPPRI-INDEMPR                  0000000
051220        PERFORM         TRAIT-TIT-PHYSIQUE                        0000000
051230     ELSE                                                         0000000
051240        MOVE '0'               TO IPPPRI-INDEMPR                  0000000
051250        PERFORM         TRAIT-TIT-MORAL.                          0000000
051260                                                                  0000000
051270     MOVE  TIES10-L0001-COD-BUR (1)  TO  IPPPRI-BUREAU.           0000000
051280d    display ' TIES10-L0001-COD-BUR (1) '    IPPPRI-BUREAU.       0000000
051290d    if orgs01-fede-laval                                         0000000
051300d      display ' TIES10-L0001-COD-BUR (1) '    IPPPRI-BUREAU.     0000000
051310*    MOVE  '98'                      TO  IPPPRI-BUREAU.           0000000
051320                                                                  0000000
051330                                                                  0000000
051340*------------------------- TITULAIRE PHYSIQUE ------------        0000000
051350 TRAIT-TIT-PHYSIQUE.                                              0000000
051360*-------------------------                                        0000000
051370     IF  LANGUE-ALLEMANDE                                         0000000
051380         IF   TIES10-L0001-TIT (1)  = 'M  '                       0000000
051390              MOVE AL-MONSIEUR      TO IPPPRI-EMP1TITR            0000000
051400         ELSE                                                     0000000
051410           IF   TIES10-L0001-TIT (1)  = 'MME'                     0000000
051420                MOVE AL-MADAME        TO IPPPRI-EMP1TITR          0000000
051430           ELSE                                                   0000000
051440             IF   TIES10-L0001-TIT (1)  = 'MLE'                   0000000
051450                  MOVE AL-MADEMOISELLE  TO IPPPRI-EMP1TITR        0000000
051460             END-IF                                               0000000
051470           END-IF                                                 0000000
051480         END-IF                                                   0000000
051490     ELSE                                                         0000000
051500         IF   TIES10-L0001-TIT (1)  = 'M  '                       0000000
051510              MOVE T-MONSIEUR      TO IPPPRI-EMP1TITR             0000000
051520         ELSE                                                     0000000
051530           IF   TIES10-L0001-TIT (1)  = 'MME'                     0000000
051540                MOVE T-MADAME        TO IPPPRI-EMP1TITR           0000000
051550           ELSE                                                   0000000
051560             IF   TIES10-L0001-TIT (1)  = 'MLE'                   0000000
051570                  MOVE T-MADEMOISELLE  TO IPPPRI-EMP1TITR         0000000
051580             END-IF                                               0000000
051590           END-IF                                                 0000000
051600         END-IF                                                   0000000
051610     END-IF.                                                      0000000
051620                                                                  0000000
051630* ** IPI                                                          0000000
051640     MOVE ZERO            TO SALARIE                              0000000
051650     MOVE ZERO            TO IPPPRI-SALARIE.                      0000000
051660                                                                  0000000
051670d    display  IPPMA2-CAISSE ' '                                   0000000
051680d             IPPMA2-RACINE ' '                                   0000000
051690d             IPPMA2-DOSS   ' codesal = ' TIES10-L0001-STA-CM(1)  0000000
051700                                                                  0000000
051710     .                                                            0000000
051720D    DISPLAY 'SALARIE ' IPPPRI-SALARIE.                           0000000
051730*                                                                 0000000
051740     MOVE TIES10-L0001-PRN (1)     TO IPPPRI-EMP1PRNM.            0000000
051750     MOVE TIES10-L0001-NOM-USG (1) TO IPPPRI-EMP1NOM              0000000
051760                                      WS-EMP1NOM.                 0000000
051770     MOVE TIES10-L0001-SEX (1)     TO W-SEXE.                     0000000
051780                                                                  0000000
051790     IF   TIES10-L0001-SEX (1) = 'M'                              0000000
051800          MOVE T-NE            TO IPPPRI-EMP1NAIS-NE              0000000
051810          MOVE T-DOMICILIE     TO IPPPRI-EMP1DOMI.                0000000
051820     IF   TIES10-L0001-SEX (1) = 'F'                              0000000
051830          MOVE T-NEE           TO IPPPRI-EMP1NAIS-NE              0000000
051840          MOVE TIES10-L0001-NJF (1) TO IPPPRI-EMP1NMJF            0000000
051850          MOVE T-DOMICILIEE    TO IPPPRI-EMP1DOMI.                0000000
051860*                                                                 0000000
051870     IF  LANGUE-ALLEMANDE                                         0000000
051880         MOVE  SPACE  TO  IPPPRI-EMP1ORIG                         0000000
051890         IF   TIES10-L0001-NJF (1)  NOT  =  SPACE                 0000000
051900              STRING ' - '                                        0000000
051910                  TIES10-L0001-NJF (1)  DELIMITED BY '  '         0000000
051920                  ' '                                             0000000
051930                  AL-NE                 DELIMITED BY SIZE         0000000
051940                  INTO  IPPPRI-EMP1ORIG                           0000000
051950         ELSE                                                     0000000
051960              STRING  ' '                                         0000000
051970                  AL-NE                 DELIMITED BY SIZE         0000000
051980                  INTO  IPPPRI-EMP1ORIG                           0000000
051990         END-IF                                                   0000000
052000         MOVE AL-DOMICILIE  TO IPPPRI-EMP1DOMI                    0000000
052010     END-IF.                                                      0000000
052020*                                                                 0000000
052030     MOVE TIES10-L0001-SIT-FAM (1)       TO W-SITFAM.             0000000
052040     IF TIES10-L0001-SIT-FAM (1) = 'C'                            0000000
052050           MOVE T-CELIBATAIRE TO IPPPRI-EMP1SITF.                 0000000
052060     IF TIES10-L0001-SIT-FAM (1) = 'M'                            0000000
052070        IF TIES10-L0001-SEX  (1) = 'M'                            0000000
052080           MOVE T-MARIE       TO IPPPRI-EMP1SITF                  0000000
052090        ELSE                                                      0000000
052100           MOVE T-MARIEE      TO IPPPRI-EMP1SITF.                 0000000
052110     IF TIES10-L0001-SIT-FAM (1) = 'V'                            0000000
052120        IF TIES10-L0001-SEX  (1) = 'M'                            0000000
052130           MOVE T-VEUF        TO IPPPRI-EMP1SITF                  0000000
052140        ELSE                                                      0000000
052150           MOVE T-VEUVE       TO IPPPRI-EMP1SITF.                 0000000
052160     IF TIES10-L0001-SIT-FAM (1) = 'D'                            0000000
052170        IF TIES10-L0001-SEX  (1) = 'M'                            0000000
052180           MOVE T-DIVORCE      TO IPPPRI-EMP1SITF                 0000000
052190        ELSE                                                      0000000
052200           MOVE T-DIVORCEE     TO IPPPRI-EMP1SITF.                0000000
052210                                                                  0000000
052220     IF  not LANGUE-ALLEMANDE                                     0000000
052230         MOVE T-LE                 TO IPPPRI-EMP1NAIS-LE          0000000
052240     END-IF                                                       0000000
052250                                                                  0000000
052260     IF   TIES10-L0001-DAT-NAI (1) = SPACE                        0000000
052270          MOVE SPACE           TO IPPPRI-EMP1NAIS-LE              0000000
052280          MOVE SPACE           TO IPPPRI-EMP1NAIS                 0000000
052290     ELSE                                                         0000000
052300*         FORMATAGE DATE AAAA-MM-JJ -> JJ-MM-AAAA                 0000000
052310          MOVE TIES10-L0001-DAT-NAI (1) TO AAAA-MM-JJ             0000000
052320          MOVE CORRESPONDING AAAA-MM-JJ TO JJ-MM-AAAA             0000000
052330          MOVE JJ-MM-AAAA               TO IPPPRI-EMP1NAIS.       0000000
052340*                                                                 0000000
052350     IF   IPPPRI-EMP1NMJF = SPACE                                 0000000
052360     AND  IPPPRI-EMP1NAIS = SPACE                                 0000000
052370          MOVE SPACE           TO IPPPRI-EMP1NAIS-NE.             0000000
052380*                                                                 0000000
052390     MOVE SPACE             TO WADR-ADRESSE.                      0000000
052400     MOVE SPACE             TO W-ADRESSE                          0000000
052410                               W-ADRLIG-ACHEMIN.                  0000000
052420     MOVE SPACES            TO WADR-BANQUE.                       0000000
052430                                                                  0000000
052440     if avenant and Titulaires-trouves                            0000000
052450        MOVE YIPX020-TITCAI(1)     TO WADR-CAISSE                 0000000
052460        MOVE YIPX020-TITRAC(1)     TO WADR-RACINE9                0000000
052470        MOVE YIPX020-TITNOTIT(1)(2:1) tO WADR-TITUL               0000000
052480     else                                                         0000000
052490        MOVE IPPMA2-CAISSE         TO WADR-CAISSE                 0000000
052500        MOVE IPPMA2-RACINE         TO WADR-RACINE6                0000000
052510        MOVE IPPMA2-EMP-TITUL      TO WADR-TITUL                  0000000
052520     end-if                                                       0000000
052530                                                                  0000000
052540d    display 'WADR-CAISSE =' WADR-CAISSE                          0000000
052550d    display 'WADR-RACINE6=' WADR-RACINE6                         0000000
052560d    display 'WADR-TITUL  =' WADR-TITUL                           0000000
052570                                                                  0000000
052580     MOVE  ZERO  TO   TOP-ADRESSE-CAU.                            0000000
052590     PERFORM RECHERCHE-ADRESSE.                                   0000000
052600     MOVE WADR-RUE         TO IPPPRI-EMP1ADR1                     0000000
052610                              ZZ-EMP1ADR1.                        0000000
052620     MOVE WADR-LOC         TO IPPPRI-EMP1ADR2                     0000000
052630                              ZZ-EMP1ADR2.                        0000000
052640D    DISPLAY 'CLIRAD-ADRADR-QUALITE' CLIRAD-ADRADR-QUALITE.       0000000
052650D    DISPLAY 'CLIRAD-ADRADR-INSEE  ' CLIRAD-ADRADR-INSEE.         0000000
052660     IF NOT CLIRAD-ADR-ETRANGER                                   0000000
052670*       ADRESSE EN FRANCE                                         0000000
052680         MOVE W-ADRLIG-CDPOST  TO IPPPRI-EMP1ADRC                 0000000
052690                                  ZZ-EMP1ADRC                     0000000
052700         MOVE W-ADRLIG-BUDIS   TO IPPPRI-EMP1LOC                  0000000
052710                                  ZZ-EMP1LOC                      0000000
052720     ELSE                                                         0000000
052730*       ADRESSE A L'ETRANGER                                      0000000
052740         PERFORM FORMAT-ACHEMIN                                   0000000
052750         MOVE TAB-ADRC         TO IPPPRI-EMP1ADRC                 0000000
052760                                  ZZ-EMP1ADRC                     0000000
052770         MOVE TAB-ADRLOC       TO IPPPRI-EMP1LOC                  0000000
052780                                  ZZ-EMP1LOC.                     0000000
052790d    display 'sbo16032006 TAB-ADRLOC       =' TAB-ADRLOC .        0000000
052800                                                                  0000000
052810                                                                  0000000
052820D    DISPLAY 'ipppri-adr1 = ' IPPPRI-EMP1ADR1 '**' ZZ-EMP1ADR1.   0000000
052830D    DISPLAY 'ipppri-adr2 = ' IPPPRI-EMP1ADR2 '**' ZZ-EMP1ADR2    0000000
052840D    DISPLAY 'ipppri-adrc = ' IPPPRI-EMP1ADRC '**' ZZ-EMP1ADRC.   0000000
052850D    DISPLAY 'ipppri-loc  = ' IPPPRI-EMP1LOC  '**' ZZ-EMP1LOC.    0000000
052860                                                                  0000000
052870*                                                                 0000000
052880     IF   IPPPRI-EMP1ADR = SPACE                                  0000000
052890          MOVE SPACE            TO IPPPRI-EMP1DOMI.               0000000
052900*                                                                 0000000
052910     IF   TIES10-L0001-DPT-NAI (1) NUMERIC                        0000000
052920          MOVE '(  )'           TO IPPPRI-EMP1LIEU                0000000
052930          MOVE TIES10-L0001-DPT-NAI (1) TO IPPPRI-EMP1LIEU-DEP    0000000
052940          MOVE TIES10-L0001-CMU-NAI-NOM (1)                       0000000
052950                                        TO IPPPRI-EMP1LIEU-LIEU   0000000
052960     ELSE                                                         0000000
052970          MOVE SPACE                    TO IPPPRI-EMP1LIEU        0000000
052980          MOVE TIES10-L0001-CMU-NAI-NOM (1)                       0000000
052990                                        TO IPPPRI-EMP1LIEU-LIEU.  0000000
053000                                                                  0000000
053010     MOVE TIES10-L0001-COD-PCS-LIB(1)  TO WS-EMP1PROF.            0000000
053020                                                                  0000000
053030                                                                  0000000
053040 FORMAT-ACHEMIN.                                                  0000000
053050                                                                  0000000
053060* STOCKER LE CODE PAYS ET LE CODE POSTAL DANS ADRC                0000000
053070     PERFORM FORMAT-ACH1                                          0000000
053080             VARYING I FROM 1 BY 1                                0000000
053090             UNTIL W-ADRLIG-TABACH (I) = SPACE                    0000000
053100                OR I > 32.                                        0000000
053110                                                                  0000000
053120* STOCKER LA LOCALITE DANS ADRLOC                                 0000000
053130     MOVE ZERO TO J.                                              0000000
053140     PERFORM FORMAT-ACH2 UNTIL I = 32.                            0000000
053150                                                                  0000000
053160 FORMAT-ACH1.                                                     0000000
053170     MOVE W-ADRLIG-TABACH (I) TO W-ADRC (I).                      0000000
053180                                                                  0000000
053190 FORMAT-ACH2.                                                     0000000
053200         ADD 1 TO I.                                              0000000
053210         ADD 1 TO J.                                              0000000
053220         MOVE W-ADRLIG-TABACH (I) TO W-ADRLOC (J).                0000000
053230                                                                  0000000
053240*------------------------- TITULAIRE MORAL --------------         0000000
053250 TRAIT-TIT-MORAL.                                                 0000000
053260*-------------------------                                        0000000
053270                                                                  0000000
053280**** IPI                                                          0000000
053290     MOVE ZERO            TO SALARIE.                             0000000
053300     MOVE ZERO            TO IPPPRI-SALARIE.                      0000000
053310        PERFORM LECTURE-FORMJUR2                                  0000000
053320        perform RECH-NO-TIERS-PMO                                 0000000
053330        PERFORM LECTURE-REPRESENTANT-LEGAL                        0000000
053340        perform RECH-NOM-REPRESENTANT-LEGAL                       0000000
053350        MOVE TIES10-L0004-RSO       (1)    TO IPPPRI-EMPRAISO     0000000
053360        MOVE W-NOM-TIERS-RLP               TO IPPPRI-EMPNMREP     0000000
053370        MOVE TIES10-L0001-RSO       (1)    TO IPPPRI-EMPRAISO     0000000
053380                                                                  0000000
053390     IF   TIES10-L0001-CAP-SOC (1) NUMERIC                        0000000
053400          IF TIES10-L0001-CAP-SOC (1) NOT = ZERO                  0000000
053410            MOVE TIES10-L0001-CAP-SOC (1) TO IPPPRI-EMPCAPSO      0000000
053420            IF   TIES10-L0001-CAP-SOC-DEV(1) = SPACE              0000000
053430              MOVE 'EUR'                       TO IPPPRI-DEVCAP   0000000
053440            ELSE                                                  0000000
053450              MOVE TIES10-L0001-CAP-SOC-DEV(1) TO IPPPRI-DEVCAP   0000000
053460          ELSE                                                    0000000
053470             MOVE SPACE                    TO IPPPRI-DEVCAP       0000000
053480             MOVE ZERO                     TO IPPPRI-EMPCAPSO-X   0000000
053490     ELSE                                                         0000000
053500          MOVE SPACE                       TO IPPPRI-DEVCAP       0000000
053510          MOVE ZERO                        TO IPPPRI-EMPCAPSO-X.  0000000
053520                                                                  0000000
053530D    DISPLAY 'IPPPRI-DEVCAP = ' IPPPRI-DEVCAP                     0000000
053540                                                                  0000000
053550*    RECHERCHE ADRESSE                                            0000000
053560                                                                  0000000
053570     MOVE SPACE             TO WADR-ADRESSE.                      0000000
053580     MOVE SPACE             TO W-ADRESSE W-ADRLIG-ACHEMIN.        0000000
053590     MOVE SPACES            TO WADR-BANQUE.                       0000000
053600     MOVE IPPMA2-CAISSE     TO WADR-CAISSE.                       0000000
053610     MOVE IPPMA2-RACINE     TO WADR-RACINE6.                      0000000
053620     MOVE IPPMA2-EMP-TITUL  TO WADR-TITUL.                        0000000
053630                                                                  0000000
053640     MOVE  ZERO  TO   TOP-ADRESSE-CAU.                            0000000
053650     PERFORM RECHERCHE-ADRESSE.                                   0000000
053660     MOVE WADR-RUE         TO IPPPRI-EMP1ADR1                     0000000
053670                              ZZ-EMP1ADR1.                        0000000
053680     MOVE WADR-LOC         TO IPPPRI-EMP1ADR2                     0000000
053690                              ZZ-EMP1ADR2.                        0000000
053700     IF NOT CLIRAD-ADR-ETRANGER                                   0000000
053710         MOVE W-ADRLIG-CDPOST  TO IPPPRI-EMP1ADRC                 0000000
053720                                  ZZ-EMP1ADRC                     0000000
053730         MOVE W-ADRLIG-BUDIS   TO IPPPRI-EMP1LOC                  0000000
053740                                  ZZ-EMP1LOC                      0000000
053750     ELSE                                                         0000000
053760         PERFORM FORMAT-ACHEMIN                                   0000000
053770         MOVE TAB-ADRC         TO IPPPRI-EMP1ADRC                 0000000
053780                                  ZZ-EMP1ADRC                     0000000
053790         MOVE TAB-ADRLOC       TO IPPPRI-EMP1LOC                  0000000
053800                                  ZZ-EMP1LOC.                     0000000
053810                                                                  0000000
053820                                                                  0000000
053830D    DISPLAY 'WADR-RUE = ' WADR-RUE.                              0000000
053840D    DISPLAY 'WADR-LOC = ' WADR-LOC.                              0000000
053850D    DISPLAY 'W-ADRLIG-CDPOST = ' W-ADRLIG-CDPOST.                0000000
053860D    DISPLAY 'W-ADRLIG-BUDIS  = ' W-ADRLIG-BUDIS.                 0000000
053870                                                                  0000000
053880*                                                                 0000000
053890     IF   IPPPRI-EMP1ADR = SPACE                                  0000000
053900          MOVE SPACE            TO IPPPRI-EMP1DOMI.               0000000
053910                                                                  0000000
053920     MOVE TIES10-L0001-COD-PCS-LIB(1) TO WS-EMP1PROF.             0000000
053930                                                                  0000000
053940*------------------------- TITULAIRE MORAL COMPLEMENT ---         0000000
053950 TRAIT-TIT-MORAL-CPL.                                             0000000
053960*-------------------------                                        0000000
053970     MOVE IPPCPL-PMO-RAISOC     TO IPPPRI-EMPRAISO.               0000000
053980     MOVE IPPCPL-PMO-TYPINS     TO Z-TYPINS.                      0000000
053990     MOVE Z-INDINSCR            TO IPPPRI-INDINSCR.               0000000
054000     MOVE IPPCPL-PMO-TYPLIEU    TO IPPPRI-EMPINSTY.               0000000
054010     MOVE IPPCPL-PMO-LIEUINS    TO IPPPRI-EMPINSLI.               0000000
054020     MOVE IPPCPL-PMO-NUMINS     TO IPPPRI-EMPINSNU.               0000000
054030     MOVE IPPCPL-PMO-NOMREP     TO IPPPRI-EMPNMREP.               0000000
054040     MOVE IPPCPL-PMO-FORJUR     TO FORMJURI-CODE.                 0000000
054050     MOVE SPACES                TO FORMJURI-PARMS.                0000000
054060     CALL  'ZCALLPGM'    USING FORMJURI                           0000000
054070                                  FORMJURI-CODE                   0000000
054080                                  FORMJURI-PARMS.                 0000000
054090                                                                  0000000
054100d    display 'FORMJURI-LIBELLE =' FORMJURI-LIBELLE                0000000
054110                                                                  0000000
054120     IF   FORMJURI-PARMS NOT = SPACES                             0000000
054130          MOVE FORMJURI-LIBELLE TO IPPPRI-EMPFORMJU.              0000000
054140                                                                  0000000
054150*-------------------------                                        0000000
054160 LECTURE-FORMJUR2.                                                0000000
054170*-------------------------                                        0000000
054180     MOVE SPACES                TO FORMJUR2-PARMS.                0000000
054190     CALL  'ZCALLPGM'    USING FORMJUR2                           0000000
054200                                TIES10-L0001-FRM-JUR(1)           0000000
054210                                FORMJUR2-PARMS.                   0000000
054220                                                                  0000000
054230d    display 'FORMJUR2-LIBELLE =' FORMJUR2-LIBELLE                0000000
054240                                                                  0000000
054250     IF   FORMJUR2-PARMS NOT = SPACES                             0000000
054260          MOVE FORMJUR2-LIBELLE TO IPPPRI-EMPFORMJU.              0000000
054270                                                                  0000000
054280*------------------------- RECHERCHE COEMPRUNTEUR -------         0000000
054290 RECHERCHE-COEMPRUNT.                                             0000000
054300*-------------------------                                        0000000
054310                                                                  0000000
054320     MOVE ALL SPACE                TO TIEE10.                     0000000
054330     MOVE ALL SPACE                TO TIEE10-L0001-ARG.           0000000
054340     IF IPPMA2-COEMP-FED = SPACE                                  0000000
054350        MOVE IPPMA2-FED            TO TIEE10-L0001-COD-RGP        0000000
054360     ELSE                                                         0000000
054370        MOVE IPPMA2-COEMP-FED      TO TIEE10-L0001-COD-RGP.       0000000
054380                                                                  0000000
054390     if avenant and Titulaires-trouves and                        0000000
054400        YIPX020-TITBQE(2) not = spaces                            0000000
054410        MOVE YIPX020-TITBQE(2)     TO TIEE10-L0001-BQE            0000000
054420        MOVE YIPX020-TITCAI(2)     TO TIEE10-L0001-CAI            0000000
054430        MOVE YIPX020-TITRAC(2)     TO TIEE10-L0001-RAC            0000000
054440        MOVE YIPX020-TITNOTIT(2)   TO TIEE10-L0001-NUM-TTL        0000000
054450     else                                                         0000000
054460        IF IPPMA2-COEMP-NCAIS = SPACE                             0000000
054470           MOVE IPPMA2-CAISSE      TO TIEE10-L0001-CAI            0000000
054480                                                                  0000000
054490           INITIALIZE ORGENT                                      0000000
054500           MOVE IPPMA2-CAISSE      TO  ORGENT-NUM-GUICHETX        0000000
054510                                                                  0000000
054520           PERFORM TRAIT-BANQUE-G                                 0000000
054530           MOVE ORGS01G-BANQUE     TO TIEE10-L0001-BQE            0000000
054540        ELSE                                                      0000000
054550           MOVE IPPMA2-COEMP-NCAIS TO TIEE10-L0001-CAI            0000000
054560                                                                  0000000
054570           INITIALIZE ORGENT                                      0000000
054580           MOVE IPPMA2-COEMP-NCAIS TO  ORGENT-NUM-GUICHETX        0000000
054590                                                                  0000000
054600           PERFORM TRAIT-BANQUE-G                                 0000000
054610           MOVE ORGS01G-BANQUE     TO TIEE10-L0001-BQE            0000000
054620        End-if                                                    0000000
054630                                                                  0000000
054640        MOVE IPPMA2-COEMP-RACINE   TO W-RACINE6                   0000000
054650        MOVE W-RACINE9             TO TIEE10-L0001-RAC            0000000
054660        MOVE IPPMA2-COEMP-TITUL    TO W-TITUL1                    0000000
054670        MOVE W-TITUL2              TO TIEE10-L0001-NUM-TTL        0000000
054680     end-if                                                       0000000
054690                                                                  0000000
054700* sbo20071210 cas dephasage ICB  tiers/IPPMA2                     0000000
054710     if avenant and Titulaires-trouves and                        0000000
054720        YIPX020-TITBQE(2) = spaces                                0000000
054730        string  'ICB co-tit absente '                             0000000
054740        TIEE10-L0001-CAI ' ' TIEE10-L0001-RAC ' '                 0000000
054750                             TIEE10-L0001-NUM-TTL                 0000000
054760                ' mais edit quand meme'                          0000000
054770        delimited size            into ligne-a                    0000000
054780d       display ligne-a                                           0000000
054790        perform ECRITURE-ANOMALIE                                 0000000
054800        move spaces            to ligne-a                         0000000
054810        string  ' sur dossier='                                   0000000
054820                IPPMA2-FED ' '                                    0000000
054830                IPPMA2-CAISSE ' '                                 0000000
054840                IPPMA2-RACINE ' '                                 0000000
054850                IPPMA2-DOSS9                                      0000000
054860        delimited size   into ligne-a                             0000000
054870        perform ECRITURE-ANOMALIE                                 0000000
054880     end-if                                                       0000000
054890                                                                  0000000
054900     PERFORM      LECTURE-CLIENT-TIERS.                           0000000
054910     IF SUITE                                                     0000000
054920       IF TIEFRE-DONNEES-NON-TROUVEES                             0000000
054930          MOVE 6       TO TEST-1                                  0000000
054940          PERFORM      TRAIT-ANOMALIE                             0000000
054950       ELSE                                                       0000000
054960          PERFORM      TRAIT-COEMPRUNT.                           0000000
054970                                                                  0000000
054980                                                                  0000000
054990*------------------------- RECHERCHE COEMPRUNTEUR -------         0000000
055000 TRAIT-COEMPRUNT.                                                 0000000
055010*-------------------------                                        0000000
055020                                                                  0000000
055030     MOVE TIES10-L0001-STA-CM (1) TO TIEVAL2-STA-CM               0000000
055040     MOVE '2'               TO IPPPRI-INDEMPR.                    0000000
055050                                                                  0000000
055060     IF LANGUE-ALLEMANDE                                          0000000
055070         MOVE AL-ET                TO IPPPRI-EMPLIAIS             0000000
055080     ELSE                                                         0000000
055090         MOVE T-ET                 TO IPPPRI-EMPLIAIS.            0000000
055100                                                                  0000000
055110     IF  LANGUE-ALLEMANDE                                         0000000
055120         IF   TIES10-L0001-TIT (1)  = 'M  '                       0000000
055130              MOVE AL-MONSIEUR      TO IPPPRI-EMP2TITR            0000000
055140         ELSE                                                     0000000
055150           IF   TIES10-L0001-TIT (1)  = 'MME'                     0000000
055160                MOVE AL-MADAME        TO IPPPRI-EMP2TITR          0000000
055170           ELSE                                                   0000000
055180             IF   TIES10-L0001-TIT (1)  = 'MLE'                   0000000
055190                  MOVE AL-MADEMOISELLE  TO IPPPRI-EMP2TITR        0000000
055200             END-IF                                               0000000
055210           END-IF                                                 0000000
055220         END-IF                                                   0000000
055230     ELSE                                                         0000000
055240         IF   TIES10-L0001-TIT (1)  = 'M  '                       0000000
055250              MOVE T-MONSIEUR      TO IPPPRI-EMP2TITR             0000000
055260         ELSE                                                     0000000
055270           IF   TIES10-L0001-TIT (1)  = 'MME'                     0000000
055280                MOVE T-MADAME        TO IPPPRI-EMP2TITR           0000000
055290           ELSE                                                   0000000
055300             IF   TIES10-L0001-TIT (1)  = 'MLE'                   0000000
055310                  MOVE T-MADEMOISELLE  TO IPPPRI-EMP2TITR         0000000
055320             END-IF                                               0000000
055330           END-IF                                                 0000000
055340         END-IF                                                   0000000
055350     END-IF.                                                      0000000
055360                                                                  0000000
055370*                                                                 0000000
055380     MOVE TIES10-L0001-PRN     (1) TO IPPPRI-EMP2PRNM.            0000000
055390     MOVE TIES10-L0001-NOM-USG (1) TO IPPPRI-EMP2NOM.             0000000
055400*                                                                 0000000
055410     IF   TIES10-L0001-SEX (1)  = 'M'                             0000000
055420          MOVE T-NE            TO IPPPRI-EMP2NAIS-NE              0000000
055430          MOVE T-DOMICILIE     TO IPPPRI-EMP2DOMI.                0000000
055440     IF   TIES10-L0001-SEX (1)  = 'F'                             0000000
055450          MOVE T-NEE           TO IPPPRI-EMP2NAIS-NE              0000000
055460          MOVE TIES10-L0001-NJF (1)  TO IPPPRI-EMP2NMJF           0000000
055470          MOVE T-DOMICILIEE    TO IPPPRI-EMP2DOMI.                0000000
055480*                                                                 0000000
055490     IF  LANGUE-ALLEMANDE                                         0000000
055500         MOVE  SPACE    TO  IPPPRI-EMP2ORIG                       0000000
055510         IF     TIES10-L0001-NJF (1)  NOT  =  SPACE               0000000
055520             STRING ' - '                                         0000000
055530                    TIES10-L0001-NJF (1)  DELIMITED BY '  '       0000000
055540               ' '  AL-NE                 DELIMITED BY SIZE       0000000
055550                    INTO  IPPPRI-EMP2ORIG                         0000000
055560         ELSE                                                     0000000
055570             STRING ' '                                           0000000
055580                    AL-NE                 DELIMITED BY SIZE       0000000
055590                    INTO  IPPPRI-EMP2ORIG                         0000000
055600         END-IF                                                   0000000
055610         MOVE AL-DOMICILIE  TO IPPPRI-EMP2DOMI                    0000000
055620     END-IF.                                                      0000000
055630                                                                  0000000
055640     IF TIES10-L0001-SIT-FAM (1) = 'C'                            0000000
055650           MOVE T-CELIBATAIRE TO IPPPRI-EMP2SITF.                 0000000
055660     IF TIES10-L0001-SIT-FAM (1) = 'M'                            0000000
055670        IF TIES10-L0001-SEX  (1) = 'M'                            0000000
055680           MOVE T-MARIE       TO IPPPRI-EMP2SITF                  0000000
055690        ELSE                                                      0000000
055700           MOVE T-MARIEE      TO IPPPRI-EMP2SITF.                 0000000
055710     IF TIES10-L0001-SIT-FAM (1) = 'V'                            0000000
055720        IF TIES10-L0001-SEX  (1) = 'M'                            0000000
055730           MOVE T-VEUF        TO IPPPRI-EMP2SITF                  0000000
055740        ELSE                                                      0000000
055750           MOVE T-VEUVE       TO IPPPRI-EMP2SITF.                 0000000
055760     IF TIES10-L0001-SIT-FAM (1) = 'D'                            0000000
055770        IF TIES10-L0001-SEX  (1) = 'M'                            0000000
055780           MOVE T-DIVORCE     TO IPPPRI-EMP2SITF                  0000000
055790        ELSE                                                      0000000
055800           MOVE T-DIVORCEE    TO IPPPRI-EMP2SITF.                 0000000
055810*                                                                 0000000
055820     IF  not  LANGUE-ALLEMANDE                                    0000000
055830         MOVE T-LE                 TO IPPPRI-EMP2NAIS-LE          0000000
055840     END-IF                                                       0000000
055850                                                                  0000000
055860     IF   TIES10-L0001-DAT-NAI (1) = SPACE                        0000000
055870          MOVE SPACE           TO IPPPRI-EMP2NAIS-LE              0000000
055880          MOVE SPACE           TO IPPPRI-EMP2NAIS                 0000000
055890     ELSE                                                         0000000
055900*         FORMATAGE DATE AAAA-MM-JJ -> JJ-MM-AAAA                 0000000
055910          MOVE TIES10-L0001-DAT-NAI (1) TO AAAA-MM-JJ             0000000
055920          MOVE CORRESPONDING AAAA-MM-JJ TO JJ-MM-AAAA             0000000
055930          MOVE JJ-MM-AAAA               TO IPPPRI-EMP2NAIS.       0000000
055940                                                                  0000000
055950     IF   IPPPRI-EMP2NMJF = SPACE                                 0000000
055960     AND  IPPPRI-EMP2NAIS = SPACE                                 0000000
055970          MOVE SPACE           TO IPPPRI-EMP2NAIS-NE.             0000000
055980*  verrue laco pour nom > 19 caractres                           0000000
055990     IF   IPPMA2-CAISSE = '36179'   AND                           0000000
056000         TIES10-L0001-NJF (1) (20:1)  not  =  space               0000000
056010         IF   TIES10-L0001-SEX (1)  = 'M'                         0000000
056020             MOVE  SPACE    TO  IPPPRI-EMP2ORIG                   0000000
056030             STRING ' '                                           0000000
056040                    T-NE ' '                                      0000000
056050                    TIES10-L0001-NJF (1)  DELIMITED BY '  '       0000000
056060                                                                  0000000
056070                    INTO  IPPPRI-EMP2ORIG                         0000000
056080         Else                                                     0000000
056090          IF   TIES10-L0001-SEX (1)  = 'F'                        0000000
056100              MOVE  SPACE    TO  IPPPRI-EMP2ORIG                  0000000
056110              STRING ' '                                          0000000
056120                     T-NEE ' '                                    0000000
056130                     TIES10-L0001-NJF (1)  DELIMITED BY '  '      0000000
056140                                                                  0000000
056150                     INTO  IPPPRI-EMP2ORIG                        0000000
056160          END-IF                                                  0000000
056170        END-IF                                                    0000000
056180     END-IF.                                                      0000000
056190*                                                                 0000000
056200     MOVE SPACE             TO WADR-ADRESSE.                      0000000
056210     MOVE SPACE             TO W-ADRESSE W-ADRLIG-ACHEMIN.        0000000
056220     MOVE SPACES            TO WADR-BANQUE.                       0000000
056230                                                                  0000000
056240     if avenant and Titulaires-trouves  and                       0000000
056250        YIPX020-TITCAI(2) not = spaces                            0000000
056260        MOVE YIPX020-TITCAI(2)     TO WADR-CAISSE                 0000000
056270        MOVE YIPX020-TITRAC(2)     TO WADR-RACINE9                0000000
056280        MOVE YIPX020-TITNOTIT(2)   TO WADR-TITUL                  0000000
056290     else                                                         0000000
056300        IF IPPMA2-COEMP-NCAIS = SPACE                             0000000
056310           MOVE IPPMA2-CAISSE      TO WADR-CAISSE                 0000000
056320        ELSE                                                      0000000
056330           MOVE IPPMA2-COEMP-NCAIS TO WADR-CAISSE                 0000000
056340        end-if                                                    0000000
056350        MOVE IPPMA2-COEMP-RACINE   TO WADR-RACINE6                0000000
056360        MOVE IPPMA2-COEMP-TITUL    TO WADR-TITUL                  0000000
056370     end-if                                                       0000000
056380                                                                  0000000
056390     MOVE  ZERO  TO   TOP-ADRESSE-CAU.                            0000000
056400     PERFORM RECHERCHE-ADRESSE.                                   0000000
056410     MOVE WADR-RUE         TO IPPPRI-EMP2ADR1.                    0000000
056420     MOVE WADR-LOC         TO IPPPRI-EMP2ADR2.                    0000000
056430     IF NOT CLIRAD-ADR-ETRANGER                                   0000000
056440         MOVE W-ADRLIG-CDPOST  TO IPPPRI-EMP2ADRC                 0000000
056450         MOVE W-ADRLIG-BUDIS   TO IPPPRI-EMP2LOC                  0000000
056460     ELSE                                                         0000000
056470         PERFORM FORMAT-ACHEMIN                                   0000000
056480         MOVE TAB-ADRC         TO IPPPRI-EMP2ADRC                 0000000
056490         MOVE TAB-ADRLOC       TO IPPPRI-EMP2LOC.                 0000000
056500                                                                  0000000
056510*                                                                 0000000
056520     IF   IPPPRI-EMP2ADR = SPACE                                  0000000
056530          MOVE SPACE           TO IPPPRI-EMP2DOMI.                0000000
056540*                                                                 0000000
056550     IF   TIES10-L0001-DPT-NAI (1) NUMERIC                        0000000
056560          MOVE '(  )'                   TO IPPPRI-EMP2LIEU        0000000
056570          MOVE TIES10-L0001-DPT-NAI (1) TO IPPPRI-EMP2LIEU-DEP    0000000
056580          MOVE TIES10-L0001-CMU-NAI-NOM (1)                       0000000
056590                                        TO IPPPRI-EMP2LIEU-LIEU   0000000
056600     ELSE                                                         0000000
056610          MOVE SPACE                    TO IPPPRI-EMP2LIEU        0000000
056620          MOVE TIES10-L0001-CMU-NAI-NOM (1)                       0000000
056630                                        TO IPPPRI-EMP2LIEU-LIEU.  0000000
056640*                                                                 0000000
056650*    MOVE  IPPPRI-EMP1ADR      TO  ZZ-EMP1ADR                     0000000
056660*    MOVE  IPPPRI-EMP1DOMI     TO  ZZ-EMP1DOMI                    0000000
056670                                                                  0000000
056680     IF   IPPPRI-EMP1NOM =  IPPPRI-EMP2NOM                        0000000
056690     AND  IPPPRI-EMP1ADR =  IPPPRI-EMP2ADR                        0000000
056700     AND (TIES10-L0001-SIT-FAM (1)    = 'M' OR 'E')               0000000
056710     AND (W-SITFAM       = 'M' OR 'E')                            0000000
056720     AND  TIES10-L0001-SEX (1)  NOT   =  W-SEXE                   0000000
056730          MOVE 1 TO NBR-EMPRUNTEURS                               0000000
056740          MOVE SPACE TO IPPPRI-EMP1ADR                            0000000
056750          IF  LANGUE-ALLEMANDE                                    0000000
056760              MOVE AL-DOMICILIE      TO IPPPRI-EMP2DOMI           0000000
056770          ELSE                                                    0000000
056780              MOVE  T-DOMICILIES     TO IPPPRI-EMP2DOMI           0000000
056790          END-IF                                                  0000000
056800          MOVE SPACE            TO IPPPRI-EMP1DOMI                0000000
056810     ELSE                                                         0000000
056820          MOVE 2 TO NBR-EMPRUNTEURS.                              0000000
056830                                                                  0000000
056840     MOVE TIES10-L0001-COD-PCS-LIB(1) TO WS-EMP2PROF.             0000000
056850                                                                  0000000
056860*-----------------         Origine          -------------         0000000
056870 TRAIT-ORIGINE.                                                   0000000
056880*-------------------------                                        0000000
056890**   MOVE 'DELATTRE ROGER ' TO  CAI-NOM-VALIDEUR                  0000000
056900*    MOVE 'EID CICDK100   ' TO  CAI-NOM-UAG                       0000000
056910*    MOVE '03.88.37.64.02 ' TO  CAI-UAG-TEL                       0000000
056920**   MOVE '03.88.37.12.34 ' TO  CAI-UAG-FAX.                      0000000
056930                                                                  0000000
056940d    display 'routage ' appel-rout                                0000000
056950                                                                  0000000
056960* 28/10/10 P NEDELEC : Rubis 32459 Convergence CMLACO             0000000
056970     IF   ORGS01-ASSIMILE-LACO                                    0000000
056980* Libelle pour de doc. LSAV0000  cai-nom-valideur                 0000000
056990         PERFORM  RECHERCHE-SAV                                   0000000
057000* Libelle pour routage des enttes de contrat                     0000000
057010         PERFORM  RECHERCHE-LIB-SAV                               0000000
057020         If  APPEL-CAI  =  '36601'                                0000000
057030             PERFORM  RECHERCHE-BUREAU                            0000000
057040         END-IF                                                   0000000
057050     END-IF                                                       0000000
057060                                                                  0000000
057070d    display 'routage rde ' appel-routage                         0000000
057080     IF  ORGS01-ASSIMILE-IDF                                      0000000
057090         IF   APPEL-ROUTAGE (1:1)  =  'C'                         0000000
057100              PERFORM  RECHERCHE-LIB-BUREAU                       0000000
057110         ELSE                                                     0000000
057120              MOVE  SPACE   TO   CAI-NOM-UAG                      0000000
057130         END-IF                                                   0000000
057140     END-IF                                                       0000000
057150                                                                  0000000
057160     PERFORM   RECHERCHE-DERN-VALIDE                              0000000
057170               VARYING  IA  FROM  10  BY -1                       0000000
057180               UNTIL  IA   =  1   OR                              0000000
057190               IPPPRI-ORIGINE NOT = SPACE.                        0000000
057200                                                                  0000000
057210     IF  ORGS01-FEDE-LAVAL                                        0000000
057220        IF  IPPMA2-LABEL-APPLI = 'IPI'                            0000000
057230         EVALUATE  IPPMA2-IDE-OSCAR                               0000000
057240             WHEN  'C0393QF' MOVE 'ESPL72-1' TO IPPPRI-ORIGINE    0000000
057250             WHEN  'C0393BL' MOVE 'ESPL72-1' TO IPPPRI-ORIGINE    0000000
057260             WHEN  'C0393JS' MOVE 'ESPL72-2' TO IPPPRI-ORIGINE    0000000
057270             WHEN  'C0380LE' MOVE 'ESPL50  ' TO IPPPRI-ORIGINE    0000000
057280             WHEN  'C0381BJ' MOVE 'ESPL53  ' TO IPPPRI-ORIGINE    0000000
057290             WHEN  'C0381GR' MOVE 'ESPL53  ' TO IPPPRI-ORIGINE    0000000
057300             WHEN  'C0381LJ' MOVE 'ESPL53  ' TO IPPPRI-ORIGINE    0000000
057310         END-EVALUATE                                             0000000
057320         MOVE  IPPMA2-IDE-OSCAR (6:2) TO IPPPRI-ORIGINE2          0000000
057330        ELSE                                                      0000000
057340        IF  IPPMA2-LABEL-APPLI = 'IPP'                            0000000
057350            EVALUATE  IPPMA2-IDE-OSCAR                            0000000
057360               WHEN  'C4811CX'                                    0000000
057370                 MOVE 'PRESC72'               TO IPPPRI-ORIGINE   0000000
057380                 MOVE  IPPMA2-IDE-OSCAR (6:2) TO IPPPRI-ORIGINE2  0000000
057390        END-IF                                                    0000000
057400     END-IF.                                                      0000000
057410                                                                  0000000
057420                                                                  0000000
057430 RECHERCHE-SAV.                                                   0000000
057440*                                                                 0000000
057450     INITIALIZE  ORGENT                                           0000000
057460                 ORGS04                                           0000000
057470     set ORGENT-TYPE-LISTE to true                                0000000
057480     set ORGENT-RADICAL-RGPT-GUICHET to true                      0000000
057490     STRING ORGS01-BANQUE                                         0000000
057500            IPPMA2-CAISSE                                         0000000
057510               DELIMITED BY SIZE INTO     ORGENT-NOM-RGPT         0000000
057520                                                                  0000000
057530     set ORGENT-RADICAL-RESULTAT-SAV to true                      0000000
057540*   renseigner ORGENT-MODE-TRAITEMENT                             0000000
057550     set ORGENT-FCT-INFO-STANDARD to true                         0000000
057560     set ORGENT-tp                to true                         0000000
057570                                                                  0000000
057580     CALL  'ZCALLPGM'  USING  ZORGFBC                             0000000
057590                              ORGENT                              0000000
057600                              ORGS04                              0000000
057610                                                                  0000000
057620d    display 'orgs04'  orgs04                                     0000000
057630                                                                  0000000
057640     IF not ( ORGS04-CODE-RETOUR =  zero  or '99')                0000000
057650         DISPLAY  'ZORGFBC  CODE RETOUR  : '  ORGS04-CODE-RETOUR  0000000
057660         DISPLAY  'LIBELLE ERR ORGS04  : ' ORGS04-CR-LIBELLE      0000000
057670     else                                                         0000000
057680d       display 'ORGS04-RGU-LIBEL-COUR    ' ORGS04-RGU-LIBEL-COUR 0000000
057690d       DISPLAY 'ORGS04-RGU-LIBEL-STD     ' ORGS04-RGU-LIBEL-STD  0000000
057700         move     ORGS04-RGU-LIBEL-COUR(18:)                      0000000
057710                                       TO CAI-NOM-VALIDEUR        0000000
057720     END-IF                                                       0000000
057730     .                                                            0000000
057740                                                                  0000000
057750*---------------                                                  0000000
057760                                                                  0000000
057770 RECHERCHE-LIB-SAV.                                               0000000
057780                                                                  0000000
057790     MOVE   APPEL-FED        TO  IPXROU-FEDE                      0000000
057800     MOVE   ORGS01-BANQUE    TO  IPXROU-BANQUE                    0000000
057810     MOVE   APPEL-CAI        TO  IPXROU-CAISSE                    0000000
057820     MOVE   APPEL-USER50     TO  IPXROU-USER                      0000000
057830                                                                  0000000
057840     SET    IPXROU-FOURNIR-LIB-SERV   TO  TRUE.                   0000000
057850                                                                  0000000
057860     MOVE APPEL-ROUT            TO  IPXROU-FAL-ROUTAGE            0000000
057870                                                                  0000000
057880     CALL 'ZCALLPGM'  USING  IPXZROUT                             0000000
057890                             IPXROU                               0000000
057900                             PCBSPI                               0000000
057910                                                                  0000000
057920     IF  IPXROU-RC  =  SPACE                                      0000000
057930         MOVE  IPXROU-1-LIBELLE1  TO  CAI-NOM-UAG                 0000000
057940         MOVE  IPXROU-1-NOFAX     TO  CAI-UAG-FAX                 0000000
057950         MOVE  IPXROU-1-NOTEL     TO  CAI-UAG-TEL                 0000000
057960         MOVE  IPXROU-1-UAG-ADR1  TO  CAI-SAV-ADR1                0000000
057970         MOVE  IPXROU-1-UAG-ADR2  TO  CAI-SAV-ADR2                0000000
057980         MOVE  IPXROU-1-UAG-ADR3  TO  CAI-SAV-ADR3                0000000
057990D        DISPLAY 'IPXROU-1-LIBELLE1 '    CAI-NOM-UAG              0000000
058000D        DISPLAY 'IPXROU-1-NOFAX    '    CAI-UAG-FAX              0000000
058010D        DISPLAY 'IPXROU-1-NOTEL    '    CAI-UAG-TEL              0000000
058020D        DISPLAY 'CAI-SAV-ADR11'    CAI-SAV-ADR1                  0000000
058030D        DISPLAY 'CAI-SAV-ADR21'    CAI-SAV-ADR2                  0000000
058040D        DISPLAY 'CAI-SAV-ADR31'    CAI-SAV-ADR3                  0000000
058050     ELSE                                                         0000000
058060         MOVE  SPACE              TO  CAI-NOM-UAG                 0000000
058070     END-IF.                                                      0000000
058080                                                                  0000000
058090 RECHERCHE-DERN-VALIDE.                                           0000000
058100                                                                  0000000
058110     IF  NOT  (IPPMA2-INTORIG (IA) = SPACE OR LOW-VALUE )         0000000
058120         MOVE  IPPMA2-INTORIG (IA) TO IPPPRI-ORIGINE.             0000000
058130                                                                  0000000
058140                                                                  0000000
058150*------------------------- OBJET DU DOSSIER -------------         0000000
058160 TRAIT-OBJET.                                                     0000000
058170*-------------------------                                        0000000
058180                                                                  0000000
058190     IF   IPPMA2-COUT-DOS NUMERIC                                 0000000
058200          MOVE IPPMA2-COUT-DOS9           TO IPPPRI-TOTINVES.     0000000
058210**** IPI                                                          0000000
058220     MOVE '0'                        TO IPPPRI-INDOBJDO.          0000000
058230                                                                  0000000
058240     IF IPPMA2-LABEL-APPLI = 'IPI'                                0000000
058250        IF   IPPMA2-OBJET-IMM  NOT = SPACES                       0000000
058260          IF IPPMA2-OBJET-DOS  =  '190'                           0000000
058270             IF  AVENANT                                          0000000
058280                 MOVE  '3'   TO  IPPPRI-PRTSUB                    0000000
058290             ELSE                                                 0000000
058300                 MOVE  '1'   TO  IPPPRI-PRTSUB                    0000000
058310             END-IF                                               0000000
058320                                                                  0000000
058330          ELSE                                                    0000000
058340             IF  AVENANT                                          0000000
058350                 MOVE  '2'   TO  IPPPRI-PRTSUB                    0000000
058360             ELSE                                                 0000000
058370                 MOVE  '0'   TO  IPPPRI-PRTSUB                    0000000
058380             END-IF                                               0000000
058390          END-IF                                                  0000000
058400          IF LANGUE-ALLEMANDE                                     0000000
058410             IF IPPMA2-EXIST-OB3 = '1'                            0000000
058420                PERFORM  LECTURE-IPPCPL-O                         0000000
058430                IF IPPCPLO-OBJ-LIBOBJ-ALL NOT = SPACES            0000000
058440                   MOVE IPPCPLO-OBJ-LIBOBJ-ALL TO IPPPRI-OBJET    0000000
058450                   MOVE '1'                    TO IPPPRI-INDOBJDO 0000000
058460                END-IF                                            0000000
058470             END-IF                                               0000000
058480          ELSE                                                    0000000
058490             MOVE '1'                        TO IPPPRI-INDOBJDO   0000000
058500             MOVE IPPMA2-OBJET-IMM-LIBOBJ    TO IPPPRI-OBJET      0000000
058510          END-IF                                                  0000000
058520          STRING IPPMA2-OBJET-IMM-ADRCPL DELIMITED BY SIZE        0000000
058530                 ' '                     DELIMITED BY SIZE        0000000
058540                 IPPMA2-OBJET-IMM-ADRRUE DELIMITED BY SIZE        0000000
058550                 ' '                     DELIMITED BY SIZE        0000000
058560                 IPPMA2-OBJET-IMM-ADRCP  DELIMITED BY SIZE        0000000
058570                 ' '                     DELIMITED BY SIZE        0000000
058580                 IPPMA2-OBJET-IMM-ADRBUR DELIMITED BY SIZE        0000000
058590            INTO IPPPRI-OBJETADR                                  0000000
058600        ELSE MOVE '0'                        TO IPPPRI-INDOBJDO   0000000
058610     ELSE                                                         0000000
058620        IF IPPMA2-LABEL-APPLI = 'IPC'  and                        0000000
058630           IPPMA2-OBJET-AUT-LIBDOS1        NOT = SPACES           0000000
058640           MOVE '1'                        TO IPPPRI-INDOBJDO     0000000
058650           MOVE IPPMA2-OBJET-AUT           TO IPPPRI-OBJET        0000000
058660        ELSE                                                      0000000
058670          IF IPPMA2-LABEL-APPLI = 'IPP'  and                      0000000
058680             IPPMA2-OBJET-PROF NOT = SPACES                       0000000
058690               MOVE '1'                        TO IPPPRI-INDOBJDO 0000000
058700               MOVE IPPMA2-OBJET-PROF-SOMMAIRE TO IPPPRI-OBJET.   0000000
058710                                                                  0000000
058720D    DISPLAY ' OBJETADR = ' IPPPRI-OBJETADR.                      0000000
058730                                                                  0000000
058740     IF  IPPMA2-LABEL-APPLI = 'IPI'  AND                          0000000
058750         ORGS01-FEDE-CICP                                         0000000
058760         IF (IPPMA2-DEVISE = 'EUR' AND                            0000000
058770             IPPMA2-COUT-DOS9  >  152500  )                       0000000
058780             MOVE  1  TO  IPPPRI-PRTSUB                           0000000
058790         END-IF                                                   0000000
058800      END-IF.                                                     0000000
058810D     DISPLAY  'IPPPRI-PRTSUB = ' IPPPRI-PRTSUB.                  0000000
058820                                                                  0000000
058830**** IPI :  ECHERCHE DU COMPLEMENT OBJET                          0000000
058840     MOVE ZERO TO IPPPRI-INDOCCUP.                                0000000
058850     IF  IPPMA2-LABEL-APPLI = 'IPI'                               0000000
058860     AND IPPMA2-EXIST-OBJ = '1'                                   0000000
058870     AND IPPMA2-EXIST-OB2 = '1'                                   0000000
058880         MOVE ZERO             TO IPPCPL-CAT                      0000000
058890         MOVE 'O'              TO IPPCPL-CODENR                   0000000
058900         PERFORM LECTURE-IPPCPL-GU                                0000000
058910         IF SUITE                                                 0000000
058920d           display 'zone        :' ippcpl-obj-cd-zrob            0000000
058930d           display 'Majoration  :' ippcpl-obj-majo-majptz        0000000
058940d           display 'Dpartement :' ippma2-objet-imm-coddep       0000000
058950d           display 'Neuf/Ancien :' ippcpl-obj-gal-type           0000000
058960            move ippcpl-obj-cd-zrob     To W-ZonRob               0000000
058970            move ippcpl-obj-majo-MajPtz To W-MajPtz               0000000
058980            move ippcpl-obj-gal-Type    To W-Type                 0000000
058990*  pour les baremes a partir du 15/01/09                          0000000
059000            If   ippcpl-obj-gal-Type   = 'N' and                  0000000
059010                (ippcpl-obj-cd-derog = '1' or '2' )               0000000
059020                 move  'O'  To W-MajPtz                           0000000
059030            End-if                                                0000000
059040                                                                  0000000
059050         END-IF                                                   0000000
059060         IF SUITE                                                 0000000
059070            IF  IPPCPL-OBJ-GAL-DEST = 'P '                        0000000
059080                MOVE 1 TO IPPPRI-INDOCCUP                         0000000
059090            ELSE                                                  0000000
059100            IF  IPPCPL-OBJ-GAL-DEST = 'L '                        0000000
059110                MOVE 2 TO IPPPRI-INDOCCUP                         0000000
059120            ELSE                                                  0000000
059130            IF  IPPCPL-OBJ-GAL-DEST = 'F '                        0000000
059140                MOVE 3 TO IPPPRI-INDOCCUP                         0000000
059150            ELSE                                                  0000000
059160            IF  IPPCPL-OBJ-GAL-DEST = 'M '                        0000000
059170                MOVE 4 TO IPPPRI-INDOCCUP                         0000000
059180            ELSE                                                  0000000
059190            IF  IPPCPL-OBJ-GAL-DEST = 'S '                        0000000
059200                MOVE 5 TO IPPPRI-INDOCCUP.                        0000000
059210                                                                  0000000
059220 TRAIT-OBJET-IDCHAB.                                              0000000
059230*-------------------------                                        0000000
059240                                                                  0000000
059250     move space                      to W-OBJET                   0000000
059260                                        IPPPRI-OBJET              0000000
059270                                        IPPPRI-OBJETADR           0000000
059280     IF IPPMA2-COUT-DOS NUMERIC                                   0000000
059290        MOVE IPPMA2-COUT-DOS9        TO IPPPRI-TOTINVES           0000000
059300     end-if                                                       0000000
059310                                                                  0000000
059320d    display 'IPPMA2-LABEL-APPLI :' IPPMA2-LABEL-APPLI            0000000
059330d    display 'IPPMA2-OBJET-IMM   :' IPPMA2-OBJET-IMM              0000000
059340d    display 'IPPMA2-OBJET-DOS   :' IPPMA2-OBJET-DOS              0000000
059350d    display 'IPPMA2-OBJET-AUT-LIBDOS1 :' IPPMA2-OBJET-AUT-LIBDOS10000000
059360     MOVE '2'                        TO IPPPRI-PRTSUB             0000000
059370     MOVE '1'                        TO IPPPRI-INDOBJDO           0000000
059380*-- recherche des donnes objet dans idchab                       0000000
059390     Perform APPEL-IDHGAPEL                                       0000000
059400     If not IDHFRE-DONNEES-NON-TROUVEES                           0000000
059410        Inspect IDHESG-S-LG022-OBJNAT replacing all '.' by space  0000000
059420                                                                  0000000
059430d       display 'IDHESG-S-LG022-OBJNAT :' IDHESG-S-LG022-OBJNAT   0000000
059440d       display 'IDHESG-S-LG022-OBJADR-1:' IDHESG-S-LG022-OBJADR-10000000
059450d       display 'IDHESG-S-LG022-OBJADR-2:' IDHESG-S-LG022-OBJADR-20000000
059460d       display 'IDHESG-S-LG022-OBJADR-3:' IDHESG-S-LG022-OBJADR-30000000
059470d       display 'IDHESG-S-LG022-OBJADR-4:' IDHESG-S-LG022-OBJADR-40000000
059480                                                                  0000000
059490        MOVE 240 TO IDPSEPVA-LNG                                  0000000
059500        MOVE 80 TO IDPSEPVA-POS                                   0000000
059510        MOVE 3 TO IDPSEPVA-NBR                                    0000000
059520        MOVE ZERO TO IDPSEPVA-RET                                 0000000
059530        MOVE SPACES TO IPPPRI-OBJET                               0000000
059540                                                                  0000000
059550        CALL 'ZCALLPGM' USING IDPSEPVA                            0000000
059560                              IDHESG-S-LG022-OBJNAT               0000000
059570                              IDPSEPVA-LNG                        0000000
059580                              W-OBJET                             0000000
059590                              IDPSEPVA-POS                        0000000
059600                              IDPSEPVA-NBR                        0000000
059610                              IDPSEPVA-RET                        0000000
059620                                                                  0000000
059630        STRING W-OBJET 'sis ' DELIMITED BY SIZE                   0000000
059640               into IPPPRI-OBJET                                  0000000
059650                                                                  0000000
059660        STRING IDHESG-S-LG022-OBJADR-1 DELIMITED BY SIZE          0000000
059670               ' '                  DELIMITED BY SIZE             0000000
059680               IDHESG-S-LG022-OBJADR-2 DELIMITED BY SIZE          0000000
059690               ' '                  DELIMITED BY SIZE             0000000
059700               IDHESG-S-LG022-OBJADR-3 DELIMITED BY SIZE          0000000
059710               ' '                  DELIMITED BY SIZE             0000000
059720               IDHESG-S-LG022-OBJADR-4 DELIMITED BY SIZE          0000000
059730               INTO IPPPRI-OBJETADR                               0000000
059740                                                                  0000000
059750D       DISPLAY ' OBJETADR = ' IPPPRI-OBJETADR                    0000000
059760                                                                  0000000
059770D       DISPLAY 'IPPPRI-PRTSUB = ' IPPPRI-PRTSUB                  0000000
059780                                                                  0000000
059790d       display 'IPPPRI-OBJET1   :' IPPPRI-OBJET1                 0000000
059800d       display 'IPPPRI-OBJET2   :' IPPPRI-OBJET2                 0000000
059810d       display 'IPPPRI-OBJET3   :' IPPPRI-OBJET3                 0000000
059820d       display 'IPPPRI-OBJET    :' IPPPRI-OBJET                  0000000
059830     end-if                                                       0000000
059840     .                                                            0000000
059850                                                                  0000000
059860 APPEL-IDHGAPEL.                                                  0000000
059870*---------------                                                  0000000
059880                                                                  0000000
059890     initialize  IDHESG  IDHFAL  IDHFRE                           0000000
059900*    RIB du pret                                                  0000000
059910     String ORGS01-BANQUE                                         0000000
059920            APPEL-CAI                                             0000000
059930            '000'  APPEL-RAC                                      0000000
059940            APPEL-CAT                                             0000000
059950          delimited by size    into IDHESG-E-LG022-RIB            0000000
059960     Set IDHFAL-IDHGAPEL-LG022  to true                           0000000
059970     Set IDHFAL-EME-MOD-TD-IMS  to true                           0000000
059980     Move ORGS01-BANQUE         to IDHFAL-UTI-EXT-BQE             0000000
059990     Move APPEL-CAI             to IDHFAL-UTI-EXT-CAI             0000000
060000     Call 'ZCALLPGM' USING IDHGAPEL                               0000000
060010                           IDHFAL                                 0000000
060020                           IDHFRE                                 0000000
060030                           IDHESG                                 0000000
060040                           PCBSPI                                 0000000
060050                           omitted                                0000000
060060                           IOPCB                                  0000000
060070                           W-ALTPCB                               0000000
060080                           ADRCLI                                 0000000
060090                           ADRDES                                 0000000
060100                           ADRADR                                 0000000
060110                                                                  0000000
060120     if IDHFRE-DONNEES-NON-TROUVEES                               0000000
060130        continue                                                  0000000
060140     else                                                         0000000
060150        if not IDHFRE-TRT-CORRECT                                 0000000
060160           display 'erreur IDHGAPEL :' IDHFRE-MSG-MET-MSG         0000000
060170           MOVE 65 TO TEST-1                                      0000000
060180           PERFORM TRAIT-ANOMALIE                                 0000000
060190           MOVE ZERO TO CTL-R34                                   0000000
060200        end-if                                                    0000000
060210     end-if                                                       0000000
060220     .                                                            0000000
060230                                                                  0000000
060240*------------------------- PLAN-FINANCEMENT -------------         0000000
060250 TRAIT-PLAN-FINANCT.                                              0000000
060260*-------------------------                                        0000000
060270                                                                  0000000
060280     MOVE ZERO TO PLF-PLANNBPR9.                                  0000000
060290     MOVE ZERO TO PLF-PLANTCRE9.                                  0000000
060300     MOVE ZERO TO PLF-PLANPERS9.                                  0000000
060310     MOVE ZERO TO PLF-PLANTMOY9.                                  0000000
060320     PERFORM TRAIT-PLAN-FINANCT-INIT                              0000000
060330     VARYING K FROM 1 BY 1                                        0000000
060340      UNTIL  K GREATER THAN 7.                                    0000000
060350                                                                  0000000
060360     MOVE ZERO             TO IPPCPL-CAT.                         0000000
060370     MOVE 'P'              TO IPPCPL-CODENR.                      0000000
060380     PERFORM LECTURE-IPPCPL-GU.                                   0000000
060390     IF   SUITE                                                   0000000
060400          MOVE  ZERO  TO  K1                                      0000000
060410          PERFORM TRAIT-PLAN-FINANCT-OK                           0000000
060420               VARYING K FROM 1 BY 1                              0000000
060430                UNTIL  K GREATER THAN 7                           0000000
060440                   OR  IPPCPL-PLF-TYPPRT(K) = SPACE               0000000
060450          PERFORM TRAIT-PLAN-FINANCT-FIN                          0000000
060460          IF   PLF-PLANNBPR GREATER THAN ZERO                     0000000
060470          AND  IPPCPL-PLF-TOTMONT9 NUMERIC                        0000000
060480               PERFORM TRAIT-PLAN-FINANCT-POUR                    0000000
060490               VARYING K FROM 1 BY 1                              0000000
060500                UNTIL  K GREATER THAN 7.                          0000000
060510                                                                  0000000
060520 TRAIT-PLAN-FINANCT-INIT.                                         0000000
060530                                                                  0000000
060540     MOVE SPACE TO PLF-PLANLIB(K).                                0000000
060550     MOVE ZERO  TO PLF-PLANMONT9(K).                              0000000
060560     MOVE ZERO  TO PLF-PLANPOUR9(K).                              0000000
060570                                                                  0000000
060580 TRAIT-PLAN-FINANCT-OK.                                           0000000
060590                                                                  0000000
060600*                                                                 0000000
060610     MOVE IPPCPL-PLF-TYPPRT (K) TO TYPPRT.                        0000000
060620                                                                  0000000
060630     IF  NOT (TYPPRT  = 'TAUX ZERO PAL:2')                        0000000
060640       ADD 1 TO PLF-PLANNBPR9                                     0000000
060650       ADD  1  TO  K1                                             0000000
060660       EVALUATE  TYPPRT12                                         0000000
060670            WHEN        'PO'                                      0000000
060680*                                                                 0000000
060690             IF LANGUE-ALLEMANDE                                  0000000
060700                MOVE  'KONVENTIONELLER REALKREDIT'                0000000
060710                                            TO PLF-PLANLIB(K1)    0000000
060720             ELSE                                                 0000000
060730               IF TYPPRT (5 :14) = SPACES                         0000000
060740                  MOVE 'IMMOBILIER ORDINAIRE' TO PLF-PLANLIB(K1)  0000000
060750               ELSE                                               0000000
060760                  STRING 'IMMOBILIER ' TYPPRT (5 :14)             0000000
060770                          DELIMITED BY SIZE INTO PLF-PLANLIB(K1)  0000000
060780               END-IF                                             0000000
060790            END-IF                                                0000000
060800*                                                                 0000000
060810            WHEN        'PC'                                      0000000
060820              MOVE 'CONVENTIONNE        ' TO PLF-PLANLIB(K1)      0000000
060830            WHEN  OTHER                                           0000000
060840               MOVE IPPCPL-PLF-TYPPRT(K) TO PLF-PLANLIB(K1)       0000000
060850       END-EVALUATE                                               0000000
060860                                                                  0000000
060870       IF   IPPCPL-PLF-MTCRED9(K) NUMERIC                         0000000
060880            MOVE IPPCPL-PLF-MTCRED9(K) TO PLF-PLANMONT9(K1)       0000000
060890            COMPUTE PLF-PLANTCRE9 = PLF-PLANTCRE9                 0000000
060900                                 + IPPCPL-PLF-MTCRED9(K)          0000000
060910       END-IF                                                     0000000
060920     END-IF.                                                      0000000
060930                                                                  0000000
060940 TRAIT-PLAN-FINANCT-POUR.                                         0000000
060950                                                                  0000000
060960     if  PLF-PLANTCRE9  >  zero                                   0000000
060970         COMPUTE PLF-PLANPOUR9(K) ROUNDED                         0000000
060980              = ( PLF-PLANMONT9(K) * 100 / PLF-PLANTCRE9 ).       0000000
060990                                                                  0000000
061000 TRAIT-PLAN-FINANCT-FIN.                                          0000000
061010                                                                  0000000
061020     IF   IPPCPL-PLF-MTAPP9 NUMERIC                               0000000
061030          MOVE IPPCPL-PLF-MTAPP9      TO PLF-PLANPERS9.           0000000
061040     COMPUTE PLF-PLANTMOY9 = PLF-PLANTCRE9 + PLF-PLANPERS9.       0000000
061050     MOVE PLF-PLANTCRE9               TO IPPPRI-PLANTCRE.         0000000
061060     MOVE PLF-PLANPERS9               TO IPPPRI-PLANPERS.         0000000
061070     MOVE PLF-PLANTMOY9               TO IPPPRI-PLANTMOY.         0000000
061080*                                                                 0000000
061090*------------------------- GARANTIE NOTARIEE -------              0000000
061100 TRAIT-NOTARIE.                                                   0000000
061110*-------------------------                                        0000000
061120                                                                  0000000
061130d    display 'sbo13062006 entree ds traite-notarie'               0000000
061140D    DISPLAY  'GAR32C ' GAR32C-pins (1)                           0000000
061150D    DISPLAY  'gar32c-ins-typ-liu (1)=' gar32c-ins-typ-liu (1)    0000000
061160D    DISPLAY  'IPPPRI-INDHYPSP       =' IPPPRI-INDHYPSP           0000000
061170                                                                  0000000
061180     MOVE 0                          TO NOTARIE                   0000000
061190     MOVE '0'                        TO IPPPRI-INDNOT             0000000
061200     MOVE '2'                        TO IPPPRI-INDHYPSP           0000000
061210                                                                  0000000
061220     IF   AVENANT                                                 0000000
061230          MOVE  '3'          TO  IPPPRI-INDHYPSP                  0000000
061240     ELSE                                                         0000000
061250          PERFORM     TRAIT-NOTARIE-SUITE.                        0000000
061260                                                                  0000000
061270 TRAIT-NOTARIE-SUITE.                                             0000000
061280* sbo25072007  : Pour forcer un notaire saisie par intermdiare   0000000
061290*                garweb.                                          0000000
061300*    if (APPEL-CAI= '08000' and                                   0000000
061310*        APPEL-RAC = '205561' and                                 0000000
061320*        APPEL-DOS = '003')                                       0000000
061330*       move 'SCP BOCQUENET ET KLEBER '                           0000000
061340*                                  to gar32c-ins-adr-lg1 (1)      0000000
061350*       move 'ROUSSEL'             to gar32c-ins-adr-lg2 (1)      0000000
061360*       move 'NOTAIRES ASSOCIES'   to gar32c-ins-adr-lg3 (1)      0000000
061370*       MOVE '14 RUE DE LA PREFECTURE' to gar32c-ins-adr-lg4 (1)  0000000
061380*       MOVE '25000'               to GAR32C-INS-ADR-LG6 (1)(1:6) 0000000
061390*       MOVE 'BESANCON'           to GAR32C-INS-ADR-LG6 (1)(7:26) 0000000
061400*       MOVE '1'                  to gar32c-ins-typ-liu (1)       0000000
061410*    end-if                                                       0000000
061420     if  gar32c-pins (1)  not  =  space                           0000000
061430         if  gar32c-ins-typ-liu (1)  =  '1'                       0000000
061440             MOVE  1    TO   NOTARIE                              0000000
061450             MOVE 'O'   TO   NOTAIRE-PREVUE                       0000000
061460         End-if                                                   0000000
061470     End-if                                                       0000000
061480                                                                  0000000
061490     IF SUITE                                                     0000000
061500        PERFORM   TRAIT-NOTARIE-LOOP                              0000000
061510                        VARYING IG FROM 1 BY 1 UNTIL IG > 4       0000000
061520                          AFTER   JG FROM 1 BY 1 UNTIL JG > 4     0000000
061530                             OR   NOTARIE  = 1.                   0000000
061540                                                                  0000000
061550     IF SUITE AND NOTARIE  = 1                                    0000000
061560        MOVE '1' TO IPPPRI-INDHYPSP                               0000000
061570            PERFORM TRAIT-NOTAIRE-GAR3                            0000000
061580     End-if.                                                      0000000
061590                                                                  0000000
061600                                                                  0000000
061610 TRAIT-NOTARIE-LOOP.                                              0000000
061620*-------------------------                                        0000000
061630     IF (IPPMA2-2-CODE-GARANTIE (IG JG) = '10' OR '11' OR '12'    0000000
061640           OR '13' OR '14' OR '15' OR '16' OR '17' OR '18'        0000000
061650           OR 'AZ' OR 'QA' or 'QB' or 'QC')                       0000000
061660        MOVE 1                       TO NOTARIE.                  0000000
061670                                                                  0000000
061680                                                                  0000000
061690                                                                  0000000
061700 TRAIT-NOTAIRE-GAR3.                                              0000000
061710*------------------                                               0000000
061720                                                                  0000000
061730D    DISPLAY  'GAR32C ' GAR32C-pins (1)                           0000000
061740d    display ' IPPPRI-NOTCPOST       =' IPPPRI-NOTCPOST           0000000
061750d    display ' gar32c-ins-typ-liu (1)='gar32c-ins-typ-liu (1)     0000000
061760d    display ' GAR32C-INS-ADR-LG6 (1)='GAR32C-INS-ADR-LG6 (1)     0000000
061770                                                                  0000000
061780                                                                  0000000
061790     if IPPPRI-NOTCPOST  = spaces and                             0000000
061800        gar32c-ins-typ-liu (1)  =  '1' and                        0000000
061810        GAR32C-INS-ADR-LG6 (1)(1:5) not = spaces                  0000000
061820        IF NOT  ( gar32c-ins-adr-lg6(1)(1:1))  =  'D'             0000000
061830           MOVE '1'                     TO  IPPPRI-INDHYPSP       0000000
061840           MOVE '1'                     TO  IPPPRI-INDNOT         0000000
061850           ADD   1                      TO  I-DEST                0000000
061860           ADD   1                      TO  NBR-DESTINATAIRES     0000000
061870           MOVE 'NOT00'                 TO  POSTE-DEST (I-DEST)   0000000
061880        END-IF                                                    0000000
061890        MOVE gar32c-ins-adr-lg1 (1)     TO IPPPRI-NOTTNOM         0000000
061900        MOVE gar32c-ins-adr-lg2 (1)     TO IPPPRI-NOTTNOM(33:18)  0000000
061910        MOVE gar32c-ins-adr-lg3 (1)     TO IPPPRI-NOTADR1         0000000
061920        MOVE gar32c-ins-adr-lg4 (1)     TO IPPPRI-NOTADR2         0000000
061930        MOVE GAR32C-INS-ADR-LG6 (1)     TO IPPPRI-NOTCPOST        0000000
061940        MOVE gar32c-ins-adr-lg6 (1) (7:26) TO IPPPRI-NOTLOC       0000000
061950                                                                  0000000
061960* fin nv pave                                                     0000000
061970                                                                  0000000
061980        IF ( gar32c-ins-adr-lg6(1)(1:1))  =  'D'                  0000000
061990           MOVE '2'               TO IPPPRI-INDHYPSP              0000000
062000           MOVE SPACE             TO IPPPRI-NOTTITR               0000000
062010        End-if                                                    0000000
062020d       display ' sbo0307 affectation notaire trouve'             0000000
062030d       display ' sbo0307 IPPPRI-INDHYPSP =' IPPPRI-INDHYPSP      0000000
062040        SET NOTAIRE-TROUVE         TO TRUE                        0000000
062050     End-if                                                       0000000
062060d    display 'IPPPRI-NOTTNOM ' IPPPRI-NOTTNOM                     0000000
062070d    display 'IPPPRI-NOTADR1 ' IPPPRI-NOTADR1                     0000000
062080d    display 'IPPPRI-NOTADR2 ' IPPPRI-NOTADR2                     0000000
062090d    display 'IPPPRI-NOTADRC ' IPPPRI-NOTADRC                     0000000
062100d    display 'IPPPRI-NOTLOC  ' IPPPRI-NOTLOC                      0000000
062110     .                                                            0000000
062120                                                                  0000000
062130                                                                  0000000
062140*-----------------   ANALYSE PRELIMINAIRE DES GARANTIES---        0000000
062150 ANALYSE-PRET-GAR.                                                0000000
062160*-----------------                                                0000000
062170* origine  IPPMA2 ( pour notaire)                                 0000000
062180     IF SUITE                                                     0000000
062190        PERFORM ANALYSE-PRET-GAR-OK                               0000000
062200                VARYING IT FROM 1 BY 1 UNTIL IT > 4               0000000
062210                     OR IPPMA2-2-TAB-PRET (IP) = SPACES           0000000
062220                     OR IPPMA2-2-CAT    (IP) NOT NUMERIC          0000000
062230                     OR IPPMA2-2-CNAT   (IP) NOT NUMERIC.         0000000
062240                                                                  0000000
062250* origine  IPPMA2 + gar                                           0000000
062260     IF SUITE                                                     0000000
062270        PERFORM ANALYSE-PRET-GAR-MAD                              0000000
062280                VARYING IT FROM 1 BY 1 UNTIL IT > NBGAR-PRET      0000000
062290                     OR IPPMA2-2-TAB-PRET (IP) = SPACES           0000000
062300                     OR IPPMA2-2-CAT    (IP) NOT NUMERIC          0000000
062310                     OR IPPMA2-2-CNAT   (IP) NOT NUMERIC.         0000000
062320                                                                  0000000
062330     IF SUITE                                                     0000000
062340        MOVE 'N'  TO GENDARME-EXIST                               0000000
062350        PERFORM ANALYSE-PRET-GAR-09                               0000000
062360                VARYING IT FROM 1 BY 1 UNTIL IT > NBGAR-PRET      0000000
062370                     OR IPPMA2-2-TAB-PRET (IP) = SPACES           0000000
062380                     OR IPPMA2-2-CAT    (IP) NOT NUMERIC          0000000
062390                     OR IPPMA2-2-CNAT   (IP) NOT NUMERIC.         0000000
062400                                                                  0000000
062410                                                                  0000000
062420 ANALYSE-PRET-GAR-OK.                                             0000000
062430                                                                  0000000
062440     IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
062450     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
062460          IF  (IPPMA2-2-CODE-GARANTIE (IP IT)                     0000000
062470               = '10' OR '11' OR '12' OR '13' OR '14' OR '16'     0000000
062480                      OR '17' OR '18' OR '19' OR '03'             0000000
062490                      OR 'QB' OR 'QC'                             0000000
062500                      OR 'AZ' OR 'QA' )                           0000000
062510               MOVE 'N' TO AUCUNE-HYP-EXIST.                      0000000
062520                                                                  0000000
062530     IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
062540     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
062550*msc-GAR3-05/2005 - correction erreur vue  la compil             0000000
062560*         IF  (IPPMA2-2-CODE-GARANTIE (IP IT) = '014' or          0000000
062570* 28/10/10 P NEDELEC : Rubis 32459 Convergence CMLACO             0000000
062580          IF  (IPPMA2-2-CODE-GARANTIE (IP IT) = '14' or           0000000
062590                 '10' OR '11' OR '12' OR '18' OR '16' or '17'     0000000
062600                      OR 'AZ' OR 'QA' or 'QB' or 'QC' or '13')    0000000
062610               MOVE 'O' TO HYP-EXIST.                             0000000
062620                                                                  0000000
062630     IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
062640     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
062650          IF   IPPMA2-2-CODE-GARANTIE (IP IT)                     0000000
062660               = '19'                                             0000000
062670               MOVE 'O' TO GAR-19-PREVUE.                         0000000
062680                                                                  0000000
062690     IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
062700     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
062710          IF   IPPMA2-2-CODE-GARANTIE (IP IT)                     0000000
062720               = '10' or '11' or '12' or '16' or '17'             0000000
062730               MOVE 'O' TO GAR-10-PREVUE.                         0000000
062740                                                                  0000000
062750     IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
062760     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
062770          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = '14'              0000000
062780               MOVE 'O' TO PPD-EXIST                              0000000
062790               MOVE 'O' TO GAR-14-PREVUE.                         0000000
062800                                                                  0000000
062810     IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
062820     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
062830          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = '50'              0000000
062840               MOVE 'O' TO GAR-50-PREVUE.                         0000000
062850                                                                  0000000
062860     IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
062870     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
062880          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = '51'              0000000
062890               MOVE 'O' TO GAR-51-PREVUE.                         0000000
062900                                                                  0000000
062910d    display 'IPPMA2-2-CODE-GARANTIE ( ' IP IT ' ) = '            0000000
062920d             IPPMA2-2-CODE-GARANTIE (IP IT)                      0000000
062930d    display 'IPPMA2-2-NO-ORDRE      ( ' IP IT ' ) = '            0000000
062940d             IPPMA2-2-NO-ORDRE      (IP IT)                      0000000
062950     IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
062960     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
062970          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = 'E7'              0000000
062980               MOVE IP  TO GAR-E7-PRET                            0000000
062990               MOVE IT  TO GAR-E7-GAR                             0000000
063000               MOVE 'O' TO GAR-E7-PREVUE.                         0000000
063010D    DISPLAY 'GAR-E7-PREVUE = ' GAR-E7-PREVUE                     0000000
063020                                                                  0000000
063030     IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063040     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063050          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = 'E8'              0000000
063060               MOVE IP  TO GAR-E8-PRET                            0000000
063070               MOVE IT  TO GAR-E8-GAR                             0000000
063080               MOVE 'O' TO GAR-E8-PREVUE.                         0000000
063090                                                                  0000000
063100                                                                  0000000
063110     IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063120     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063130          IF  (IPPMA2-2-CODE-GARANTIE (IP IT) = '13'              0000000
063140               OR 'AZ' OR 'QA' or 'QB' or 'QC' )                  0000000
063150               MOVE 'O' TO CAU-HYP-EXIST.                         0000000
063160                                                                  0000000
063170     IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063180     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063190          IF  (IPPMA2-2-CODE-GARANTIE (IP IT) = '40' or '41'      0000000
063200                or 'HY'  or 'E2' or 'E3' or 'E4' or '36'          0000000
063210                or 'EF')                                          0000000
063220               MOVE 'O' TO CAU-EXIST.                             0000000
063230                                                                  0000000
063240D    DISPLAY 'CAU-EXIST ' CAU-EXIST                               0000000
063250                                                                  0000000
063260                                                                  0000000
063270*    IF   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063280*    AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063290                                                                  0000000
063300     if   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063310     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063320          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = '42'              0000000
063330               MOVE 'O' TO GAR-42-PREVUE                          0000000
063340               MOVE 'O' TO 42-EXIST.                              0000000
063350*                                                                 0000000
063360     if   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063370     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063380          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = 'AL' or 'EL'      0000000
063390               MOVE 'O' TO GAR-AL-PREVUE.                         0000000
063400*                                                                 0000000
063410*                                                                 0000000
063420     if   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063430     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063440          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = 'E4'              0000000
063450               MOVE 'O' TO GAR-E4-PREVUE.                         0000000
063460*                                                                 0000000
063470     if   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063480     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063490          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = 'E5'              0000000
063500               MOVE 'O' TO GAR-E5-PREVUE.                         0000000
063510*                                                                 0000000
063520     if   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063530     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063540          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = 'EA'              0000000
063550               MOVE 'O' TO GAR-EA-PREVUE.                         0000000
063560*                                                                 0000000
063570     if   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063580     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063590          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = 'EB'  or 'SZ'     0000000
063600               MOVE 'O' TO GAR-EB-PREVUE.                         0000000
063610*                                                                 0000000
063620     if   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063630     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063640          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = 'EC'  or 'T1'     0000000
063650               MOVE 'O' TO GAR-EC-PREVUE.                         0000000
063660*                                                                 0000000
063670     if   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063680     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063690          IF   IPPMA2-2-CODE-GARANTIE (IP IT) = 'EE'              0000000
063700               MOVE 'O' TO GAR-EE-PREVUE.                         0000000
063710*                                                                 0000000
063720     if   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063730     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063740          IF  (IPPMA2-2-CODE-GARANTIE(IP IT) = 'EN' )             0000000
063750               MOVE 'O' TO GAR-EN-PREVUE.                         0000000
063760*                                                                 0000000
063770     if   IPPMA2-2-CODE-GARANTIE (IP IT) NOT = SPACES             0000000
063780     AND  IPPMA2-2-NO-ORDRE    (IP IT) NUMERIC                    0000000
063790          IF  (IPPMA2-2-CODE-GARANTIE(IP IT) =  'SX')             0000000
063800               MOVE 'O' TO GAR-SX-PREVUE.                         0000000
063810*                                                                 0000000
063820*    IF   orgs01-assimile-cmm                                     0000000
063830*    AND  (IPPMA2-LABEL-APPLI = 'IPI' OR  'IPC')                  0000000
063840*         MOVE  1   TO  GAR-MARSEILLE                             0000000
063850*    ELSE MOVE ZERO TO  GAR-MARSEILLE.                            0000000
063860                                                                  0000000
063870 ANALYSE-PRET-GAR-MAD.                                            0000000
063880                                                                  0000000
063890* LOI MADELIN                                                     0000000
063900     IF ( (ORGS01-FEDE-CEE   OR                                   0000000
063910            ORGS01-FEDE-LAVAL  OR                                 0000000
063920             ORGS01-FEDE-ANTILLES )                               0000000
063930         AND  IPPMA2-LABEL-APPLI = 'IPP'                          0000000
063940         AND  TIES10-L0001-TYP (1)  =  '1'                        0000000
063950            AND   WP-NO-ORDRE      (IP IT) NUMERIC                0000000
063960            AND  (WP-CODE-GARANTIE (IP IT) =                      0000000
063970                    '13' OR '16' OR '17' OR '19' OR '36' OR       0000000
063980                    '37' OR '40' OR '41' OR '51' OR '52' OR       0000000
063990                    '59' OR '65' OR '66' OR '67' OR '98') )       0000000
064000               MOVE  'O'  TO  MADELIN-EXIST                       0000000
064010               MOVE  'O'  TO  MADELIN-PREVUE (IP:1).              0000000
064020                                                                  0000000
064030     IF      ((ORGS01-FEDE-CEE )                                  0000000
064040         AND   IPPMA2-LABEL-APPLI = 'IPP'                         0000000
064050         AND  (IPPMA2-COEMP-RACINE  NUMERIC  AND                  0000000
064060                 (IPPMA2-COEMP-RACINE  not  =   ZERO) ))          0000000
064070               MOVE  'O'  TO  MADELIN-EXIST                       0000000
064080               MOVE  'O'  TO  MADELIN-PREVUE (IP:1).              0000000
064090                                                                  0000000
064100D    DISPLAY 'CODE MADELIN ' MADELIN-EXIST.                       0000000
064110                                                                  0000000
064120 ANALYSE-PRET-GAR-09.                                             0000000
064130                                                                  0000000
064140* gar gendarme                                                    0000000
064150*                                                                 0000000
064160     IF  IPPMA2-LABEL-APPLI  =  'IPI'                             0000000
064170         IF  (WP-CODE-GARANTIE (IP IT) NOT = SPACES               0000000
064180         AND  WP-NO-ORDRE      (IP IT) NUMERIC)                   0000000
064190              IF  (WP-CODE-GARANTIE (IP IT) = '09')               0000000
064200                   MOVE  'O'  TO  GENDARME-EXIST.                 0000000
064210D    DISPLAY 'CODE GENDARME ' GENDARME-EXIST.                     0000000
064220                                                                  0000000
064230*------------------------- ANALYSE PRELIMINAIRE DES INDEX SALAR-  0000000
064240 ANALYSE-PRET-INDEX.                                              0000000
064250*-------------------------                                        0000000
064260*                                                                 0000000
064270     MOVE  SAY-CINDEX         TO  W-CINDEX                        0000000
064280                                                                  0000000
064290     If (index-cee-tr1  or index-cee-tr1-pc  or                   0000000
064300         index-cee-tr2  or index-cee-tr2-pc  or                   0000000
064310         index-f33-tr1  or                                        0000000
064320         index-f33-tr2 )                                          0000000
064330      or                                                          0000000
064340       ( SAY-COND-SAL-IMMO-TR1  or                                0000000
064350         SAY-COND-SAL-IMMO-TR2  or                                0000000
064360         SAY-COND-SAL-CONSO )                                     0000000
064370         MOVE 1 TO SALARIE                                        0000000
064380         MOVE 1 TO IPPPRI-SALARIE.                                0000000
064390                                                                  0000000
064400*                                                                 0000000
064410*------------------------- ANALYSE PRELIMINAIRE DES INDEX SALAR-  0000000
064420 ANALYSE-PRET-INDEX-TR1-2.                                        0000000
064430*-------------------------                                        0000000
064440*RDE-04.97-SALARIES-TR1 ET TR2 + PC                               0000000
064450*    SI T1 SEULE ---> 1                                           0000000
064460*    SI T2 SEULE ---> 2                                           0000000
064470*    si T1 + T2  ---> 3                                           0000000
064480*                                                                 0000000
064490     MOVE  SAY-CINDEX         TO  W-CINDEX                        0000000
064500                                                                  0000000
064510                                                                  0000000
064520     If  index-cee-tr1  or                                        0000000
064530         index-f33-tr1                                            0000000
064540         MOVE 1 TO SALARIE-TR1-2.                                 0000000
064550                                                                  0000000
064560                                                                  0000000
064570     If  index-cee-tr2  or                                        0000000
064580         index-f33-tr2                                            0000000
064590         ADD  2 TO SALARIE-TR1-2.                                 0000000
064600                                                                  0000000
064610*------------------------- TRAITEMENT D'UN PRET D'UN DOSSIER ---  0000000
064620*------------------------- TRAITEMENT D'UN PRET D'UN DOSSIER ---  0000000
064630*------------------------- TRAITEMENT D'UN PRET D'UN DOSSIER ---  0000000
064640*------------------------- TRAITEMENT D'UN PRET D'UN DOSSIER ---  0000000
064650*------------------------- TRAITEMENT D'UN PRET D'UN DOSSIER ---  0000000
064660*------------------------- TRAITEMENT D'UN PRET D'UN DOSSIER ---  0000000
064670                                                                  0000000
064680                                                                  0000000
064690                                                                  0000000
064700 TRAIT-PRET.                                                      0000000
064710*-------------------------                                        0000000
064720d       display '=========TRAIT-PRET======= IP='  IP              0000000
064730d       display 'ippcpl :' ippcpl                                 0000000
064740d       display 'SAY-MTCRED =' SAY-MTCRED                         0000000
064750     IF  AVENANT                                                  0000000
064760         IF  IPPMA2-2-CAT (IP)  NUMERIC  AND                      0000000
064770             APPEL-CAT  =  IPPMA2-2-CAT (IP)                      0000000
064780             PERFORM  TRAIT-PRET-S                                0000000
064790         END-IF                                                   0000000
064800     ELSE                                                         0000000
064810             PERFORM  TRAIT-PRET-S.                               0000000
064820                                                                  0000000
064830 TRAIT-PRET-S.                                                    0000000
064840                                                                  0000000
064850     MOVE SPACE TO PRTCOA.                                        0000000
064860     MOVE SPACE TO IPPPRI-ZONES-PRET.                             0000000
064870     MOVE SPACE TO Z-TYPCRED.                                     0000000
064880     MOVE SPACE TO Z-TYPPRET.                                     0000000
064890                                                                  0000000
064900*                                                                 0000000
064910     MOVE ZERO                 TO IPPPRI-RDATECH1.                0000000
064920     MOVE ZERO                 TO IPPPRI-RDATECH2.                0000000
064930     MOVE ZERO                 TO IPPPRI-RDATECH3.                0000000
064940     MOVE ZERO                 TO IPPPRI-RDATECH4.                0000000
064950     MOVE ZERO                 TO IPPPRI-RDATECH5.                0000000
064960     MOVE ZERO                 TO IPPPRI-RMTECH1-X.               0000000
064970     MOVE ZERO                 TO IPPPRI-RMTECH2-X.               0000000
064980     MOVE ZERO                 TO IPPPRI-RMTECH3-X.               0000000
064990     MOVE ZERO                 TO IPPPRI-RMTECH4-X.               0000000
065000     MOVE ZERO                 TO IPPPRI-RMTECH5-X.               0000000
065010     MOVE ZERO                 TO IPPPRI-NBECHREL.                0000000
065020     MOVE ZERO                 TO IPPPRI-RINTER.                  0000000
065030     MOVE ZERO                 TO IPPPRI-IND360.                  0000000
065040     .                                                            0000000
065050d       display 'ippcpl :' ippcpl                                 0000000
065060*                                                                 0000000
065070*-------------                                                    0000000
065080*                                                                 0000000
065090                                                                  0000000
065100     MOVE ZERO   TO NBR-PERIOD.                                   0000000
065110     MOVE ZERO   TO EXIST-INDEX.                                  0000000
065120     MOVE SPACES TO IPPRGT.                                       0000000
065130     MOVE SPACES TO Z-INDGARTI.                                   0000000
065140     MOVE  IP    TO IND-ANOM.                                     0000000
065150     move  zero  to EXIST-PRTSAYG                                 0000000
065160                                                                  0000000
065170                                                                  0000000
065180*             COMPLEMENT GDP (IMAGE BORDEREAU)                    0000000
065190*             ================================                    0000000
065200*                                                                 0000000
065210                                                                  0000000
065220     IF  SUITE                                                    0000000
065230         IF IPPMA2-2-EXIST-PRT(IP) = '1'  AND  CONTRAT            0000000
065240             MOVE IPPMA2-2-CAT9(IP) TO IPPCPL-CAT                 0000000
065250             MOVE 'G'              TO IPPCPL-CODENR               0000000
065260             PERFORM LECTURE-IPPCPL-GU                            0000000
065270             IF  SUITE                                            0000000
065280                 MOVE IPPCPL-PRTSAY TO PRTSAY                     0000000
065290d                display    'PRTSAY= ' PRTSAY                     0000000
065300                 PERFORM  RECH-DATOUV-SAY                         0000000
065310                 PERFORM  AN-2000                                 0000000
065320                 PERFORM  rectif-parsoc-17                        0000000
065330                 PERFORM  TRAITEMENT-FRAIS-TIMBRE                 0000000
065340                 MOVE  ZZ-FRAIS-TIMB  TO  Z-TIMB (IP)             0000000
065350             END-IF                                               0000000
065360         ELSE                                                     0000000
065370             IF  IPPMA2-ETAT-TRAITE-TR = '2'  OR                  0000000
065380                         (AVENANT OR  CONTRAT-GPR)                0000000
065390                 MOVE  IP  TO  IY                                 0000000
065400                 PERFORM  LECTURE-BASE-PRET                       0000000
065410                 PERFORM  TRAITEMENT-FRAIS-TIMBRE                 0000000
065420                 MOVE  ZZ-FRAIS-TIMB  TO  Z-TIMB (IP)             0000000
065430              END-IF                                              0000000
065440         END-IF                                                   0000000
065450     END-IF.                                                      0000000
065460                                                                  0000000
065470     IF  SUITE                                                    0000000
065480         perform  PLUS-UN-JOUR-OUVRE                              0000000
065490     End-if                                                       0000000
065500                                                                  0000000
065510*  RECTIF DU MODE DE GESTION                                      0000000
065520*  DISSOCIER LE MODE DE GESTION DU CODE PRODUIT.                  0000000
065530                                                                  0000000
065540     IF  SUITE                                                    0000000
065550         IF  SAY-MGES   =  '6'                                    0000000
065560             IF  IPPMA2-LABEL-APPLI = 'IPI'                       0000000
065570                 MOVE  'IMMO-DV'  TO  Z-TYPCRED                   0000000
065580             ELSE                                                 0000000
065590                 IF  IPPMA2-LABEL-APPLI = 'IPP'                   0000000
065600                     MOVE  'PROF-DV'  TO  Z-TYPCRED               0000000
065610                 ELSE                                             0000000
065620                     IF  IPPMA2-LABEL-APPLI = 'IPC'               0000000
065630                         MOVE  'CONS-DV'  TO  Z-TYPCRED.          0000000
065640                                                                  0000000
065650     IF   SUITE                                                   0000000
065660          MOVE IPPMA2-2-CAT9 (IP) TO IPPPRI-TYPSERIE              0000000
065670          MOVE IPPMA2-2-CAT9 (IP) TO TAM-TYPSERIE                 0000000
065680          MOVE 'PO'               TO TAM-TYPPRET                  0000000
065690                                                                  0000000
065700*msc-GAR3-05/2005 - correction erreur vue  la compil             0000000
065710*         IF   IPPPRI-CNAT1  NOT  =  'A613'                       0000000
065720          IF   IPPPRI-CNAT1  NOT  =  'A13'                        0000000
065730               MOVE IPPMA2-2-CNAT (IP)    TO IPPPRI-CNAT1         0000000
065740          END-IF                                                  0000000
065750     END-IF.                                                      0000000
065760                                                                  0000000
065770                                                                  0000000
065780     IF   SUITE                                                   0000000
065790          IF   IPPMA2-LABEL-APPLI  =  'IPC'                       0000000
065800               MOVE ZERO             TO  IPPPRI-INDPROF.          0000000
065810                                                                  0000000
065820D    DISPLAY 'IPPMA2-2-CNAT (' IP ') : ' IPPMA2-2-CNAT (IP).      0000000
065830D    DISPLAY 'IPPPRI-TYPSERIE(' IP ') : ' IPPPRI-TYPSERIE         0000000
065840                                                                  0000000
065850D    DISPLAY      'Z-TYPCRED     '  Z-TYPCRED.                    0000000
065860D    DISPLAY      'IPPMA2-2-MODGES ' IPPMA2-2-MODGES (IP).        0000000
065870*                                                                 0000000
065880*    IF  CONTRAT  or avenant                                      0000000
065890         MOVE  SAY-CINDEX      TO  W-CINDEX                       0000000
065900         Evaluate  w-cindex                                       0000000
065910             when    '245ZV'                                      0000000
065920             when    '245ZX'                                      0000000
065930               if  orgs01-fede-arras                              0000000
065940                  MOVE  '1702'  TO  IPPPRI-TYPINDEX               0000000
065950               Else                                               0000000
065960                  MOVE  '1457'  TO  IPPPRI-TYPINDEX               0000000
065970               End-if                                             0000000
065980             when    '245ZI'                                      0000000
065990                  MOVE  '1591'  TO  IPPPRI-TYPINDEX               0000000
066000             when    '245ZJ'                                      0000000
066010                  MOVE  '1592'  TO  IPPPRI-TYPINDEX               0000000
066020             when    '245ZK'                                      0000000
066030                  MOVE  '1593'  TO  IPPPRI-TYPINDEX               0000000
066040             when    '354ZL'                                      0000000
066050                  MOVE  '1594'  TO  IPPPRI-TYPINDEX               0000000
066060             when    '245ZO'                                      0000000
066070                  MOVE  '1601'  TO  IPPPRI-TYPINDEX               0000000
066080         END-EVALUATE                                             0000000
066090*    END-IF.                                                      0000000
066100     .                                                            0000000
066110D    DISPLAY  'IPPPRI-TYPINDEX = ' IPPPRI-TYPINDEX.               0000000
066120*--------------                                                   0000000
066130*                                                                 0000000
066140     move  zero  to  IPPPRI-GOETHE.                               0000000
066150     IF  IPPMA2-LANGUE-ALLEMANDE                                  0000000
066160         AND  NOT   AVENANT                                       0000000
066170         IF  IPPMA2-DEVISE  =  'EUR'                              0000000
066180             MOVE   '1'   TO  IPPPRI-GOETHE                       0000000
066190             ELSE                                                 0000000
066200               IF  IPPMA2-DEVISE  =  'DEM'                        0000000
066210                   MOVE   '2'   TO  IPPPRI-GOETHE                 0000000
066220               ELSE                                               0000000
066230                   MOVE   '3'   TO  IPPPRI-GOETHE                 0000000
066240               END-IF                                             0000000
066250         END-IF                                                   0000000
066260     END-IF.                                                      0000000
066270                                                                  0000000
066280D    DISPLAY 'GOETHE ' IPPPRI-GOETHE.                             0000000
066290d       display 'ippcpl :' ippcpl                                 0000000
066300                                                                  0000000
066310     MOVE  ZERO TO  IPPPRI-REMBA.                                 0000000
066320     IF   CONTRAT OR CONTRAT-GPR                                  0000000
066330          IF  (IPPPRI-INDDEV  =  ZERO  OR  SPACE)                 0000000
066340               IF  (IPPPRI-GOETHE  =  ZERO OR SPACE )             0000000
066350                    MOVE  '1'  TO  IPPPRI-REMBA.                  0000000
066360     IF   SUITE                                                   0000000
066370     AND  IPPMA2-LABEL-APPLI = 'IPI'                              0000000
066380          MOVE '2'              TO IPPPRI-INDPROF.                0000000
066390                                                                  0000000
066400*                                                                 0000000
066410*               OBJET DU PRET                                     0000000
066420*               =============                                     0000000
066430     MOVE '0'                           TO IPPPRI-INDOBJPR.       0000000
066440     IF  SUITE                                                    0000000
066450         AND NOT (IPPMA2-2-OBJET-PRT (IP) = SPACE OR ZERO)        0000000
066460         PERFORM  LECTURE-IPPCPL-B                                0000000
066470         IF  EXIST-OBJET-PRT  =  1                                0000000
066480             AND  NOT (IPPCPLB-OBP-LIBEL(IP) = SPACE)             0000000
066490           MOVE '1'                           TO IPPPRI-INDOBJPR  0000000
066500           MOVE IPPCPLB-OBP-LIBEL (IP)        TO IPPPRI-OBJETPRT. 0000000
066510                                                                  0000000
066520*                                                                 0000000
066530*             TRAITEMENT CLAUSE SPECIFIQUE PRET                   0000000
066540*             =================================                   0000000
066550     IF SUITE                                                     0000000
066560        IF IPPMA2-LABEL-APPLI = 'IPC'                             0000000
066570           NEXT SENTENCE                                          0000000
066580        ELSE                                                      0000000
066590d       display 'IPPMA2-2-EXIST-CLAUSE-PRT(IP) ' ip ' '           0000000
066600d                IPPMA2-2-EXIST-CLAUSE-PRT(IP)                    0000000
066610        IF IPPMA2-2-EXIST-CLAUSE-PRT(IP) = '1'                    0000000
066620           MOVE IPPMA2-2-CAT9(IP) TO IPPCPL-CAT                   0000000
066630           MOVE 'C'              TO IPPCPL-CODENR                 0000000
066640****       LECTURE COMPLEMENT CLAUSES PRET                        0000000
066650           PERFORM LECTURE-IPPCPL-GU.                             0000000
066660*                                                                 0000000
066670     IF SUITE                                                     0000000
066680        IF IPPMA2-LABEL-APPLI = 'IPC'                             0000000
066690           NEXT SENTENCE                                          0000000
066700        ELSE                                                      0000000
066710        IF IPPMA2-2-EXIST-CLAUSE-PRT(IP) = '1'                    0000000
066720           MOVE IP TO ICLAU                                       0000000
066730           set  Y-A-PAS-UNE-254   to  true                        0000000
066740           PERFORM TRAIT-CLAUSES.                                 0000000
066750                                                                  0000000
066760     IF  SUITE                                                    0000000
066770         IF ((ORGS01-BANQUE = '10278' OR '15969' OR '13070' ) AND 0000000
066780             ( IPPMA2-LABEL-APPLI = 'IPC' OR 'IPP'))              0000000
066790               MOVE  IP  TO  ICLAU2                               0000000
066800               PERFORM TRAIT-CLAUSES-RTA                          0000000
066810         END-IF                                                   0000000
066820     END-IF.                                                      0000000
066830* clause 124 si ipp / ipi avec prescripteur.                      0000000
066840     IF  SUITE                                                    0000000
066850         IF (( ORGS01-FEDE-CEE )  and                             0000000
066860             ( IPPMA2-LABEL-APPLI = 'IPI' OR 'IPP'))              0000000
066870               if  SAY-PRESCRI  not  =  space                     0000000
066880                   MOVE  IP  TO  ICLAU2                           0000000
066890                   PERFORM TRAIT-CLAUSE-124                       0000000
066900               END-IF                                             0000000
066910         END-IF                                                   0000000
066920     END-IF.                                                      0000000
066930*                                                                 0000000
066940*  254  modul'agri                                                0000000
066950     IF  ORGS01-FEDE-CEE                                          0000000
066960         IF  Y-A-PAS-UNE-254                                      0000000
066970             IF (  SAY-CNAT = '600' OR '610' OR '612' )  AND      0000000
066980                (  SAY-DURAM  NUMERIC  AND                        0000000
066990                   SAY-DURAM  > 47  AND  < 181 )    and           0000000
067000                (  SAY-MTCRE   NUMERIC  AND                       0000000
067010                   SAY-MTCRED   >  7999 )                         0000000
067020                   MOVE  IP  TO  ICLAU2                           0000000
067030                   PERFORM  TRAIT-CLAUSE-254                      0000000
067040D                  display  'ajout 254 '                          0000000
067050             END-IF                                               0000000
067060         END-IF                                                   0000000
067070     END-IF.                                                      0000000
067080                                                                  0000000
067090     IF  ORGS01-banque-cic                                        0000000
067100         IF    SAY-gas1 = zero and                                0000000
067110               SAY-gas3 = zero                                    0000000
067120               MOVE  IP  TO  ICLAU2                               0000000
067130               PERFORM  TRAIT-CLAUSE-053                          0000000
067140         END-IF                                                   0000000
067150     END-IF.                                                      0000000
067160                                                                  0000000
067170     IF  ORGS01-FEDE-LAVAL                                        0000000
067180         IF (  SAY-CNAT = '284' OR '285' )  AND                   0000000
067190               SAY-VTER  =  '1'                                   0000000
067200               MOVE  IP  TO  ICLAU2                               0000000
067210               PERFORM  TRAIT-CLAUSE-255                          0000000
067220D              display 'ajout 255 '                               0000000
067230         END-IF                                                   0000000
067240     Else                                                         0000000
067250         IF ( SAY-CNAT = '600' OR '610' )                         0000000
067260              MOVE  IP  TO  ICLAU2                                0000000
067270              PERFORM  TRAIT-CLAUSE-078                           0000000
067280         End-if                                                   0000000
067290     END-IF.                                                      0000000
067300*             COMPLEMENT GDP (IMAGE BORDEREAU)     avant          0000000
067310     IF   SUITE                                                   0000000
067320          PERFORM  APPEL-IPXZPROD                                 0000000
067330     END-IF.                                                      0000000
067340                                                                  0000000
067350     IF ( ipxpro-eco-ptz )                                        0000000
067360          if  say-dur  numeric                                    0000000
067370              MOVE  IP  TO  ICLAU2                                0000000
067380              PERFORM  TRAIT-CLAUSE-322-323                       0000000
067390         End-if                                                   0000000
067400     End-if                                                       0000000
067410                                                                  0000000
067420*  indic index                                                    0000000
067430                                                                  0000000
067440     IF   SUITE                                                   0000000
067450          IF   NOT ( SAY-CINDEX = SPACE OR ZERO OR 'SUP  ')       0000000
067460               MOVE 1                TO EXIST-INDEX.              0000000
067470                                                                  0000000
067480D    DISPLAY  'EXIST-INDEX = ' EXIST-INDEX.                       0000000
067490                                                                  0000000
067500*             VOIR SI PRET EXISTE DEJA SUR BASE PRETS             0000000
067510*             =======================================             0000000
067520*                                                                 0000000
067530**** RAJOUT 13/08/91 POUR SIAGI                                   0000000
067540     IF SUITE                                                     0000000
067550        IF IPPMA2-2-EXIST-PRT(IP) = '1'                           0000000
067560        OR  IPPMA2-ETAT-TRAITE-TR = '2'                           0000000
067570           PERFORM LECTURE-PRTIDC-EDT.                            0000000
067580d       display 'ippcpl :' ippcpl                                 0000000
067590*                                                                 0000000
067600     IF SUITE                                                     0000000
067610           MOVE  SAY-GAS1  TO  Z-ASVI-1 (IP)                      0000000
067620           MOVE  SAY-GAS3  TO  Z-ASVI-2 (IP)                      0000000
067630           PERFORM TRAIT-PRET-BORDEREAU.                          0000000
067640*                                                                 0000000
067650     If  APXTRE-ENCOURS                                           0000000
067660         MOVE  '1'            TO  MOD-ASS-DOS (IP)                0000000
067670     Else                                                         0000000
067680         MOVE  Zero           TO  MOD-ASS-DOS (IP)                0000000
067690     End-if                                                       0000000
067700D    DISPLAY 'IP           '  IP                                  0000000
067710     .                                                            0000000
067720                                                                  0000000
067730 RECTIF-PARSOC-17.                                                0000000
067740*                                                                 0000000
067750     If  orgs01-fede-arras                                        0000000
067760         IF   EXIST-PRTSAYG   =  1                                0000000
067770              if  CPT-PARSOC  numeric  and                        0000000
067780                  CPT-PARSOC  >  Zero                             0000000
067790                  move  cpt-parsoc  to  say-parsoc                0000000
067800              End-if                                              0000000
067810         End-if                                                   0000000
067820     End-if.                                                      0000000
067830                                                                  0000000
067840*-------------                                                    0000000
067850 TRAIT-MODULCONSO.                                                0000000
067860*-------------                                                    0000000
067870*                                                                 0000000
067880     MOVE  SPACE       TO   W-MOIS1  W-MOIS2.                     0000000
067890     MOVE  SAY-MDCONSO TO   IPPPRI-MDCONSO.                       0000000
067900                                                                  0000000
067910     IF  (SAY-SPECH1  NOT =  ZERO AND SPACE )                     0000000
067920         IF   (SAY-SPECH2  NOT =  ZERO AND SPACE )                0000000
067930              MOVE  SAY-SPECH1            TO  WS-SPECH1X          0000000
067940              MOVE  SAY-SPECH2            TO  WS-SPECH2X          0000000
067950              STRING L-SUCCESSIVES '(' L-SAUF                     0000000
067960                     T-MOIS(WS-SPECH1) L-ET T-MOIS(WS-SPECH2) ')' 0000000
067970                  DELIMITED BY SIZE INTO IPPPRI-LIBSPECH          0000000
067980         ELSE                                                     0000000
067990              MOVE  SAY-SPECH1            TO  WS-SPECH1X          0000000
068000              STRING L-SUCCESSIVES '(' L-SAUF                     0000000
068010                     T-MOIS(WS-SPECH1) ')'                        0000000
068020                  DELIMITED BY SIZE INTO IPPPRI-LIBSPECH.         0000000
068030                                                                  0000000
068040D    DISPLAY  'MDCONSO  = '   IPPPRI-MDCONSO.                     0000000
068050D    DISPLAY  'LIBSPECH = '   IPPPRI-LIBSPECH.                    0000000
068060*                                                                 0000000
068070*-------------                                                    0000000
068080 TRAIT-TZ-291.                                                    0000000
068090*-------------                                                    0000000
068100*                                                                 0000000
068110D    DISPLAY 'SA2-TZDBAR '  SA2-TZDBAR.                           0000000
068120*    MOVE  '20000321' TO SA2-TZDBAR                               0000000
068130     IF    SA2-TZDBAR  NOT  =  SPACE                              0000000
068140           PERFORM  TRAIT-TZ-291-2                                0000000
068150     ELSE                                                         0000000
068160           MOVE  49  TO  TEST-1                                   0000000
068170           PERFORM   TRAIT-ANOMALIE.                              0000000
068180                                                                  0000000
068190*                                                                 0000000
068200 TRAIT-TZ-291-2.                                                  0000000
068210*                                                                 0000000
068220     Move 'IPPBATCH'        To CTL-PGM-E                          0000000
068230*    Move PRTLNK-TRAIT      To CTL-TRAIT                          0000000
068240*    MOVE  'I'             TO CTL-TRAIT                           0000000
068250*  livrer avec 'T' sur feu vert de R LEMETTAIS                   0000000
068260     MOVE  'T'             TO CTL-TRAIT                           0000000
068270     MOVE   SA2-TZDBAR (1 :4 ) TO  W-AAAAX.                       0000000
068280     COMPUTE   W-AAAA  =  W-AAAA  -  2.                           0000000
068290*    MOVE      W-AAAA    TO  IPPPRI-TZAREF.                       0000000
068300     MOVE  SA2-TZDBAR   TO  ZPRTBARM-I-DATEF.                     0000000
068310     MOVE  SAY-TZTBAR   TO  ZPRTBARM-I-TYPE.                      0000000
068320     MOVE  SAY-TZBAR9   TO  ZPRTBARM-I-BAREME.                    0000000
068330     MOVE  SPACE        TO  ZPRTBARM-I-DURDIF.                    0000000
068340     IF IPXPRO-PTZ-PLUS                                           0000000
068350        if  ( say-specif-ptz  =  '2'  or  '3' )                   0000000
068360            MOVE 'D'  TO ZPRTBARM-I-ZONE                          0000000
068370        Else                                                      0000000
068380            MOVE 'A'  TO ZPRTBARM-I-ZONE                          0000000
068390        End-if                                                    0000000
068400     ELSE                                                         0000000
068410        IF    SAY-CNAT = '304'                                    0000000
068420              MOVE '1'     TO  ZPRTBARM-I-ZONE                    0000000
068430        ELSE                                                      0000000
068440              MOVE SPACE   TO  ZPRTBARM-I-ZONE                    0000000
068450        END-IF                                                    0000000
068460     END-IF.                                                      0000000
068470                                                                  0000000
068480*    CHB20101117 NPTZ+ produit B 29172                            0000000
068490     IF IPXPRO-NPTZ-PLUS                                          0000000
068500        MOVE SPACE   TO  ZPRTBARM-I-ZONE                          0000000
068510     End-if.                                                      0000000
068520                                                                  0000000
068530     CALL 'ZCALLPGM' USING ZPRTBARM                               0000000
068540                           CTL                                    0000000
068550                           ZPRTBARM-I                             0000000
068560                           ZPRTBARM-O                             0000000
068570                           PCBSPI.                                0000000
068580                                                                  0000000
068590     IF   CTL-R34   =  ZERO                                       0000000
068600          IF IPXPRO-PTZ-PLUS                                      0000000
068610             PERFORM  TRAIT-TZ-291-3-PLUS                         0000000
068620          ELSE                                                    0000000
068630             PERFORM  TRAIT-TZ-291-3                              0000000
068640          END-IF                                                  0000000
068650     ELSE                                                         0000000
068660           display 'ZPRTBARM-I= ' ZPRTBARM-I                      0000000
068670           DISPLAY 'CTL       = ' CTL                             0000000
068680           MOVE  50  TO  TEST-1                                   0000000
068690           PERFORM   TRAIT-ANOMALIE                               0000000
068700           MOVE ZERO   TO  CTL-R34.                               0000000
068710*                                                                 0000000
068720 TRAIT-TZ-291-3.                                                  0000000
068730*                                                                 0000000
068740     MOVE  SAY-MTCRED    TO  IPPPRI-TZMON.                        0000000
068750     COMPUTE WS-BONIF = (SAY-MTCRED * ZPRTBARM-O-BONIF)           0000000
068760                                          /  100000.              0000000
068770     MOVE  WS-BONIF  TO  IPPPRI-TZINT.                            0000000
068780*                                                                 0000000
068790*    chercher la date d'ouverture                                 0000000
068800     PERFORM LECTURE-PRTIDC-3.                                    0000000
068810                                                                  0000000
068820     IF  EXIST-PRTCPT  =  1   and ctl-r34  = zero                 0000000
068830         PERFORM TRAIT-TZ-291-4                                   0000000
068840     else                                                         0000000
068850*        move '20000321' to cp2-datouv.                           0000000
068860D        DISPLAY  'ctl '  ctl                                     0000000
068870         MOVE  49  TO  TEST-1                                     0000000
068880         PERFORM   TRAIT-ANOMALIE.                                0000000
068890                                                                  0000000
068900 TRAIT-TZ-291-3-PLUS.                                             0000000
068910*                                                                 0000000
068920     MOVE  SAY-MTCRED    TO  IPPPRI-TZMON.                        0000000
068930     COMPUTE WS-BONIF = (SAY-MTCRED * ZPRTBARM-O-BONIF)           0000000
068940                                          /  100000.              0000000
068950*    coefficient provisoire....                                   0000000
068960*    compute WS-BONIF = WS-BONIF * 1,0812                         0000000
068970     MOVE  WS-BONIF  TO  IPPPRI-TZINT.                            0000000
068980*                                                                 0000000
068990*    chercher la date d'ouverture                                 0000000
069000     PERFORM LECTURE-PRTIDC-3.                                    0000000
069010                                                                  0000000
069020     IF  EXIST-PRTCPT  =  1  and ctl-r34  = zero                  0000000
069030         PERFORM TRAIT-TZ-291-4                                   0000000
069040     else                                                         0000000
069050*        move '20000321' to cp2-datouv.                           0000000
069060D        DISPLAY  'ctl '  ctl                                     0000000
069070         MOVE  49  TO  TEST-1                                     0000000
069080         PERFORM   TRAIT-ANOMALIE.                                0000000
069090                                                                  0000000
069100                                                                  0000000
069110 TRAIT-TZ-291-4.                                                  0000000
069120                                                                  0000000
069130*  info supplmentaire de 11/96.                                  0000000
069140*    MOVE SPACE  TO  IPPPRI-TZP1                                  0000000
069150*    MOVE SPACE  TO  IPPPRI-TZP2                                  0000000
069160*    MOVE SPACE  TO  IPPPRI-TZP3.                                 0000000
069170     IF  SAY-RDUR   NOT   =  '1'                                  0000000
069180         MOVE  ZERO  TO  IPPPRI-TZCODL                            0000000
069190     ELSE                                                         0000000
069200         IF (ZPRTBARM-O-COEFF  NOT = ZERO )                       0000000
069210            MOVE   2    TO  IPPPRI-TZCODL                         0000000
069220            PERFORM  FORMAT-LET040                                0000000
069230         ELSE                                                     0000000
069240            MOVE   1    TO  IPPPRI-TZCODL.                        0000000
069250            PERFORM  FORMAT-LET041.                               0000000
069260                                                                  0000000
069270* TZTRIM SERT A DETERMINER L'AVIS SGFGAS A EDITER AVEC LE CONTRAT 0000000
069280*    SUIVANT DATE D'OUVERTURE                                     0000000
069290*                                                                 0000000
069300                                                                  0000000
069310*pourtest!!!!!!!!!!!!!!!!!!!                                      0000000
069320*    MOVE 20020110 TO CP2-DATOUV                                  0000000
069330*pourtest!!!!!!!!!!!!!!!!!!!                                      0000000
069340                                                                  0000000
069350D    DISPLAY  'CP2-DATOUV ' CP2-DATOUV.                           0000000
069360     IF (IPXPRO-PTZ-PLUS )                                        0000000
069370      IF  CP2-DATOUV   <  20060201                                0000000
069380          move  '071'  to  ipppri-tztrim                          0000000
069390      Else                                                        0000000
069400        IF  CP2-DATOUV   <  20070101                              0000000
069410            move  '072'  to  ipppri-tztrim                        0000000
069420            move  '46  ' to  ipppri-tzvers                        0000000
069430        Else                                                      0000000
069440            If CP2-DATOUV   <  20070401                           0000000
069450               move  '073'  to  ipppri-tztrim                     0000000
069460               move  '47  ' to  ipppri-tzvers                     0000000
069470            Else                                                  0000000
069480             If CP2-DATOUV   <  20070701                          0000000
069490                perform determine-SGFGAS                          0000000
069500                move  '48  ' to  ipppri-tzvers                    0000000
069510             Else                                                 0000000
069520              If CP2-DATOUV   <  20071001                         0000000
069530                 perform determine-SGFGAS                         0000000
069540                 move  '49  ' to  ipppri-tzvers                   0000000
069550              Else                                                0000000
069560               If CP2-DATOUV   <  20080101                        0000000
069570                  perform determine-SGFGAS                        0000000
069580                  move  '50  ' to  ipppri-tzvers                  0000000
069590               Else                                               0000000
069600                If CP2-DATOUV   <  20080401                       0000000
069610                   perform determine-SGFGAS                       0000000
069620                   move  '51  ' to  ipppri-tzvers                 0000000
069630                Else                                              0000000
069640                 If CP2-DATOUV   <  20080701                      0000000
069650                    perform determine-SGFGAS                      0000000
069660                    move  '52  ' to  ipppri-tzvers                0000000
069670                 Else                                             0000000
069680                  If CP2-DATOUV   <  20081001                     0000000
069690                     perform determine-SGFGAS                     0000000
069700                     move  '53  ' to  ipppri-tzvers               0000000
069710                  Else                                            0000000
069720                   If CP2-DATOUV   <  20090101                    0000000
069730                      perform determine-SGFGAS                    0000000
069740                      move  '54  ' to  ipppri-tzvers              0000000
069750                   Else                                           0000000
069760                    If CP2-DATOUV   <  20090115                   0000000
069770                      perform determine-SGFGAS                    0000000
069780                      move  '55  ' to  ipppri-tzvers              0000000
069790                    Else                                          0000000
069800                     If CP2-DATOUV   <  20090401                  0000000
069810                       perform determine-SGFGAS                   0000000
069820                       move  '56  ' to  ipppri-tzvers             0000000
069830                     Else                                         0000000
069840                      If CP2-DATOUV   <  20090701                 0000000
069850                        perform determine-SGFGAS                  0000000
069860                        move  '57  ' to  ipppri-tzvers            0000000
069870                      Else                                        0000000
069880                       If CP2-DATOUV   <  20091001                0000000
069890                         perform determine-SGFGAS                 0000000
069900                         move  '58  ' to  ipppri-tzvers           0000000
069910                       Else                                       0000000
069920                        If CP2-DATOUV   <  20100101               0000000
069930                          perform determine-SGFGAS                0000000
069940                          move  '59  ' to  ipppri-tzvers          0000000
069950                        End-If                                    0000000
069960                       End-If                                     0000000
069970                      End-If                                      0000000
069980                     End-If                                       0000000
069990                    End-If                                        0000000
070000                   End-If                                         0000000
070010                  End-If                                          0000000
070020                 End-If                                           0000000
070030                End-If                                            0000000
070040               End-If                                             0000000
070050              End-if                                              0000000
070060             End-If                                               0000000
070070            End-If                                                0000000
070080           End-if                                                 0000000
070090         End-if                                                   0000000
070100     End-if.                                                      0000000
070110                                                                  0000000
070120D    DISPLAY 'IPPPRI-TZVERS  = ' IPPPRI-TZVERS                    0000000
070130D    DISPLAY 'IPPPRI-TZTRIM  = ' IPPPRI-TZTRIM                    0000000
070140                                                                  0000000
070150     If  ipxpro-ptz-plus                                          0000000
070160       EVALUATE  IPPPRI-TZVERS                                    0000000
070170        WHEN  '41  '                                              0000000
070180         move  'du 01/02/2005 au 31/03/2005'  to  ipppri-libas1   0000000
070190        WHEN  '42  '                                              0000000
070200         MOVE  'du 01/04/2005 au 30/06/2005'  TO  IPPPRI-LIBAS1   0000000
070210        WHEN  '43  '                                              0000000
070220         MOVE  'du 01/07/2005 au 30/09/2005'  TO  IPPPRI-LIBAS1   0000000
070230        WHEN  '44  '                                              0000000
070240         MOVE  'du 01/10/2005 au 31/12/2005'  TO  IPPPRI-LIBAS1   0000000
070250        WHEN  '45  '                                              0000000
070260         MOVE  'du 01/01/2006 au 31/03/2006'  TO  IPPPRI-LIBAS1   0000000
070270        WHEN  '46  '                                              0000000
070280         MOVE  'du 01/04/2006 au 31/12/2006'  TO  IPPPRI-LIBAS1   0000000
070290        WHEN  '47  '                                              0000000
070300         MOVE  'du 01/01/2007 au 31/03/2007'  TO  IPPPRI-LIBAS1   0000000
070310        WHEN  '48  '                                              0000000
070320         MOVE  'du 01/04/2007 au 30/06/2007'  TO  IPPPRI-LIBAS1   0000000
070330        WHEN  '49  '                                              0000000
070340         MOVE  'du 01/07/2007 au 30/09/2007'  TO  IPPPRI-LIBAS1   0000000
070350        WHEN  '50  '                                              0000000
070360         MOVE  'du 01/10/2007 au 31/12/2007'  TO  IPPPRI-LIBAS1   0000000
070370        WHEN  '51  '                                              0000000
070380         MOVE  'du 01/01/2008 au 31/03/2008'  TO  IPPPRI-LIBAS1   0000000
070390        WHEN  '52  '                                              0000000
070400         MOVE  'du 01/04/2008 au 30/06/2008'  TO  IPPPRI-LIBAS1   0000000
070410        WHEN  '53  '                                              0000000
070420         MOVE  'du 01/07/2008 au 30/09/2008'  TO  IPPPRI-LIBAS1   0000000
070430        WHEN  '54  '                                              0000000
070440         MOVE  'du 01/10/2008 au 31/12/2008'  TO  IPPPRI-LIBAS1   0000000
070450        WHEN  '55  '                                              0000000
070460         MOVE  'du 01/01/2009 au 14/01/2009'  TO  IPPPRI-LIBAS1   0000000
070470        WHEN  '56  '                                              0000000
070480         MOVE  'du 15/01/2009 au 31/03/2009'  TO  IPPPRI-LIBAS1   0000000
070490        WHEN  '57  '                                              0000000
070500         MOVE  'du 01/04/2009 au 30/06/2009'  TO  IPPPRI-LIBAS1   0000000
070510        WHEN  '58  '                                              0000000
070520         MOVE  'du 01/07/2009 au 30/09/2009'  TO  IPPPRI-LIBAS1   0000000
070530        WHEN  '59  '                                              0000000
070540         MOVE  'du 01/10/2009 au 31/12/2009'  TO  IPPPRI-LIBAS1   0000000
070550       END-EVALUATE                                               0000000
070560     End-if                                                       0000000
070570                                                                  0000000
070580D    DISPLAY 'IPPPRI-LIBAS1 = ' IPPPRI-LIBAS1                     0000000
070590     .                                                            0000000
070600                                                                  0000000
070610 DETERMINE-SGFGAS.                                                0000000
070620*-----------------                                                0000000
070630                                                                  0000000
070640d    display 'zone        :' W-ZonRob                             0000000
070650d    display 'Majoration  :' w-MajPtz                             0000000
070660d    display 'Dpartement :' ippma2-objet-imm-coddep              0000000
070670d    display 'Neuf/Ancien :' W-Type                               0000000
070680d    display 'Code Objet  :' Ippma2-Objet-Dos                     0000000
070690d    display 'EXIST-PRTSAYG :' EXIST-PRTSAYG                      0000000
070700D    DISPLAY 'SAY-SPECIF-PTZ :' SAY-SPECIF-PTZ                    0000000
070710*-- on est dans les DOM ou pas ?                                  0000000
070720     If ippma2-objet-imm-coddep = '97'                            0000000
070730        Set W-Dom-Oui      To True                                0000000
070740     Else                                                         0000000
070750        Set W-Dom-Non      To True                                0000000
070760     End-If                                                       0000000
070770*-- on est dans du neuf ou dans de l'ancien ?                     0000000
070780     If W-Type = 'N' or Ippma2-Objet-Dos = '154'                  0000000
070790        Set W-TypNeu       to True                                0000000
070800     Else                                                         0000000
070810        Set W-TypAnc       to True                                0000000
070820     End-If                                                       0000000
070830                                                                  0000000
070840*--On dtermine la RS dans DIDO  imprimer                        0000000
070850     Evaluate W-ZonRob also w-MajPtz also True     also True      0000000
070860        When  'A'      also 'N'      Also W-TypNeu also W-Dom-Non 0000000
070870            Move '800'   To ipppri-tztrim                         0000000
070880        When  'A'      also 'N'      Also W-TypAnc Also W-Dom-Non 0000000
070890            Move '810'   To ipppri-tztrim                         0000000
070900*       When  'B'      also 'N'      Also W-TypNeu Also W-Dom-Non 0000000
070910*           Move '801'   To ipppri-tztrim                         0000000
070920*       When  'B'      also 'N'      Also W-TypAnc Also W-Dom-Non 0000000
070930*           Move '811'   To ipppri-tztrim                         0000000
070940        When  'C'      also 'N'      Also W-TypNeu Also W-Dom-Non 0000000
070950            Move '802'   To ipppri-tztrim                         0000000
070960        When  'C'      also 'N'      Also W-TypAnc Also W-Dom-Non 0000000
070970            Move '812'   To ipppri-tztrim                         0000000
070980        When  'A'      also 'O'      Also W-TypNeu Also W-Dom-Non 0000000
070990            Move '804'   To ipppri-tztrim                         0000000
071000*       When  'B'      also 'O'      Also W-TypNeu Also W-Dom-Non 0000000
071010        When  'C'      also 'O'      Also W-TypNeu Also W-Dom-Non 0000000
071020            Move '805'   To ipppri-tztrim                         0000000
071030*       When  'B'      also 'N'      Also W-TypNeu Also W-Dom-Oui 0000000
071040*           Move '803'   To ipppri-tztrim                         0000000
071050*       When  'B'      also 'N'      Also W-TypAnc Also W-Dom-Oui 0000000
071060*           Move '813'   To ipppri-tztrim                         0000000
071070*       When  'B'      also 'O'      Also W-TypNeu Also W-Dom-Oui 0000000
071080*           Move '806'   To ipppri-tztrim                         0000000
071090     End-Evaluate                                                 0000000
071100*-- Pour la zone B, il faut distinguer les DOM qui diffrencient  0000000
071110*-- les RFR < 60% du plafond et ceux entre 60 et 100% du plafond  0000000
071120*-- pour la mtropole on ne fait pas cette distinction            0000000
071130*-- Say-specif-ptz = '2' ==> DOM + Revenus < 60% du plafond       0000000
071140*-- Say-specif-ptz = '3' ==> 2 + MAJORATION                       0000000
071150     if W-ZonRob= 'B'                                             0000000
071160        If w-MajPtz = 'N'                                         0000000
071170           If Say-specif-ptz = '2'                                0000000
071180*--DOM et RFR < 60% du plafond : on est ds le cadre des exceptions0000000
071190              If W-TypNeu                                         0000000
071200                 Move '803'   To ipppri-tztrim                    0000000
071210              Else                                                0000000
071220                 Move '813'   To ipppri-tztrim                    0000000
071230              End-If                                              0000000
071240           Else                                                   0000000
071250*-- Soit :                                                        0000000
071260*--DOM et RFR > 60% du plafond : on est hors exceptions           0000000
071270*--mtropole (on ne regarde pas o se situent les revenus)        0000000
071280              If W-TypNeu                                         0000000
071290                 Move '801'   To ipppri-tztrim                    0000000
071300              Else                                                0000000
071310                 Move '811'   To ipppri-tztrim                    0000000
071320              End-If                                              0000000
071330           End-If                                                 0000000
071340        Else                                                      0000000
071350           If Say-specif-ptz = '3'                                0000000
071360              If W-TypNeu                                         0000000
071370                 Move '806'   To ipppri-tztrim                    0000000
071380              End-If                                              0000000
071390           Else                                                   0000000
071400*  sbo09082007 mis en cmt du test suivant                         0000000
071410*             If Say-specif-ptz = space                           0000000
071420                 If W-TypNeu                                      0000000
071430                    Move '805' To ipppri-tztrim                   0000000
071440                 End-If                                           0000000
071450*             End-If                                              0000000
071460           End-If                                                 0000000
071470        End-If                                                    0000000
071480     end-if.                                                      0000000
071490                                                                  0000000
071500     if  say-tzdbar9 >  09014                                     0000000
071510         move '9' to  ipppri-tztrim (1:1)                         0000000
071520         if  ipppri-tztrim  =  '905'  and                         0000000
071530             W-ZonRob   =  'C'                                    0000000
071540             Move '955'  to  ipppri-tztrim                        0000000
071550         End-if                                                   0000000
071560     End-if                                                       0000000
071570                                                                  0000000
071580d    display 'document selectionn :' ipppri-tztrim               0000000
071590     .                                                            0000000
071600                                                                  0000000
071610 FORMAT-LET041.                                                   0000000
071620                                                                  0000000
071630*   sans differ                                                  0000000
071640      MOVE  ZPRTBARM-O-DUREE  TO  W-DUREE                         0000000
071650      PERFORM  CALCUL-AN-MOIS                                     0000000
071660*     IF  W-MOIS  =  ZERO                                         0000000
071670*         STRING  W-ANZ ' ans' DELIMITED BY SIZE INTO             0000000
071680*                                               IPPPRI-TZP1       0000000
071690*     ELSE                                                        0000000
071700*         STRING  W-ANZ ' ans ET ' W-MOISZ ' mois'                0000000
071710*                       DELIMITED BY SIZE  INTO   IPPPRI-TZP1.    0000000
071720                                                                  0000000
071730      MOVE  SAY-DURAM     TO  W-DUREE                             0000000
071740      PERFORM  CALCUL-AN-MOIS                                     0000000
071750*     IF  W-MOIS  =  ZERO                                         0000000
071760*         STRING  W-ANZ ' ans' DELIMITED BY SIZE INTO             0000000
071770*                                               IPPPRI-TZP2       0000000
071780*     ELSE                                                        0000000
071790*         STRING  W-ANZ ' ans ET ' W-MOISZ ' mois'                0000000
071800*                       DELIMITED BY SIZE INTO  IPPPRI-TZP2.      0000000
071810      .                                                           0000000
071820 FORMAT-LET040.                                                   0000000
071830                                                                  0000000
071840*  avec  differ                                                  0000000
071850D     DISPLAY   'ZPRTBARM-O-DURDIF ' ZPRTBARM-O-DURDIF.           0000000
071860      IF  SAY-TZBAR-DIFFERE-100                                   0000000
071870          PERFORM  CALCUL-DUREE-PAL1                              0000000
071880      ELSE                                                        0000000
071890          MOVE  SAY-PALIER (1)  TO  W-DUREE.                      0000000
071900                                                                  0000000
071910      PERFORM  CALCUL-AN-MOIS                                     0000000
071920*     IF  W-MOIS  =  ZERO                                         0000000
071930*         STRING  W-ANZ ' ans' DELIMITED BY SIZE INTO             0000000
071940*                                               IPPPRI-TZP3       0000000
071950*     ELSE                                                        0000000
071960*         STRING  W-ANZ ' ans ET ' W-MOISZ ' mois'                0000000
071970*                       DELIMITED BY SIZE  INTO  IPPPRI-TZP3.     0000000
071980*                       DISPLAY 'TZP3 '  IPPPRI-TZP3.             0000000
071990                                                                  0000000
072000     MOVE  SPACE        TO  ZPRTBARM-I-TYPE.                      0000000
072010                                                                  0000000
072020     MOVE  'T'             TO CTL-TRAIT                           0000000
072030*    MOVE  'I'             TO CTL-TRAIT                           0000000
072040*  livrer avec 'T' sur feu vert de R LEMETTAIS                   0000000
072050     CALL 'ZCALLPGM' USING ZPRTBARM                               0000000
072060                           CTL                                    0000000
072070                           ZPRTBARM-I                             0000000
072080                           ZPRTBARM-O                             0000000
072090                           PCBSPI.                                0000000
072100     If  ctl-r34  not =  zero                                     0000000
072110D          DISPLAY   'ctl ' ctl                                   0000000
072120           MOVE  64  TO  TEST-1                                   0000000
072130           PERFORM   TRAIT-ANOMALIE                               0000000
072140      Else                                                        0000000
072150D       DISPLAY   'ZPRTBARM-O-DURDIF2 ' ZPRTBARM-O-DURDIF.        0000000
072160        MOVE  ZPRTBARM-O-DURDIF TO  W-DUREE.                      0000000
072170        PERFORM  CALCUL-AN-MOIS                                   0000000
072180                                                                  0000000
072190        MOVE   ZPRTBARM-O-DUREE   TO  W-DUREE.                    0000000
072200        MOVE   W-DUREE            TO  W-MOISZ.                    0000000
072210                                                                  0000000
072220 CALCUL-DUREE-PAL1.                                               0000000
072230*-------------                                                    0000000
072240*                                                                 0000000
072250                                                                  0000000
072260D    DISPLAY 'SAY-DATDEC9 '  SAY-DATDEC9.                         0000000
072270D    DISPLAY 'SA2-DATDEC  '  SA2-DATDEC.                          0000000
072280     MOVE     ZERO           TO W-DURDIF-PTZ     W-DUREE          0000000
072290     IF      SA2-DATDEC      NOT  =  SPACE                        0000000
072300          MOVE SA2-DATDEC       TO ZPRTNBMO-D1                    0000000
072310     ELSE                                                         0000000
072320          PERFORM  CDATE-FIN-MOIS.                                0000000
072330                                                                  0000000
072340     MOVE SA2-DATEC           TO  WW-SSAAMMJJ                     0000000
072350D    DISPLAY 'W-SSAAMMJJ  '  WW-SSAAMMJJ.                         0000000
072360     INITIALIZE DATS20                                            0000000
072370     MOVE  'D01'         TO DATS20-I-FONCTION                     0000000
072380     MOVE  WW-SSAAMMJJ   TO DATS20-I-DATE1                        0000000
072390     MOVE  'J'           TO DATS20-I-ENTREE-TYPE1                 0000000
072400     MOVE  'A'           TO DATS20-I-ENTREE-SENS1                 0000000
072410     MOVE  'J'           TO DATS20-I-RETOUR-TYPE1                 0000000
072420     MOVE  'A'           TO DATS20-I-RETOUR-SENS1                 0000000
072430     MOVE  'O'           TO DATS20-I-RETOUR-SIECLE                0000000
072440     MOVE  -1            TO DATS20-I-NBMOIS                       0000000
072450     CALL 'ZCALLPGM' USING ZDAT2000 DATS20                        0000000
072460     MOVE DATS20-O-MSG   TO ZPRTNBMO-D2.                          0000000
072470D    DISPLAY 'ZPRTNBMO-D2 ' ZPRTNBMO-D2.                          0000000
072480                                                                  0000000
072490     IF ZPRTNBMO-D1  <  ZPRTNBMO-D2                               0000000
072500        INITIALIZE DATS20                                         0000000
072510        MOVE ZPRTNBMO-D1   TO DATS20-I-DATE1                      0000000
072520        MOVE ZPRTNBMO-D2   TO DATS20-I-DATE2                      0000000
072530        MOVE 'E01'         TO DATS20-I-FONCTION                   0000000
072540        MOVE 'J'           TO DATS20-I-ENTREE-TYPE1               0000000
072550        MOVE 'A'           TO DATS20-I-ENTREE-SENS1               0000000
072560        MOVE 'J'           TO DATS20-I-ENTREE-TYPE2               0000000
072570        MOVE 'A'           TO DATS20-I-ENTREE-SENS2               0000000
072580        MOVE 'M'           TO DATS20-I-TYPINFO                    0000000
072590        CALL 'ZCALLPGM' USING ZDAT2000                            0000000
072600                              DATS20                              0000000
072610        IF   DATS20-O-PAS-ERREUR                                  0000000
072620             MOVE DATS20-O-NBMOIS-9 TO W-DURDIF-PTZ W-DUREE       0000000
072630             IF   DATS20-O-NBJOURS-9 NOT = ZERO                   0000000
072640                  ADD    1 TO W-DURDIF-PTZ W-DUREE                0000000
072650             END-IF                                               0000000
072660        ELSE                                                      0000000
072670             DISPLAY 'ERREUR DATE ECHEANCE 0% '                   0000000
072680        END-IF                                                    0000000
072690     END-IF.                                                      0000000
072700                                                                  0000000
072710                                                                  0000000
072720 CDATE-FIN-MOIS.                                                  0000000
072730                                                                  0000000
072740     INITIALIZE DATS20                                            0000000
072750     SET       DATS20-I-FONCTION-TRANSFO TO TRUE                  0000000
072760                                                                  0000000
072770     IF  EXIST-PRTCPT  =  1                                       0000000
072780D        DISPLAY 'CP2-DATOUV  '  CP2-DATOUV                       0000000
072790         MOVE CP2-DATOUV         TO DATS20-I-DATE1                0000000
072800     ELSE                                                         0000000
072810D        DISPLAY 'DATE JOUR   '  W-DATE                           0000000
072820         MOVE W-DATE             TO DATS20-I-DATE1                0000000
072830     END-IF                                                       0000000
072840                                                                  0000000
072850     MOVE     'J'                TO DATS20-I-ENTREE-TYPE1         0000000
072860     MOVE     'A'                TO DATS20-I-ENTREE-SENS1         0000000
072870     MOVE     'J'                TO DATS20-I-RETOUR-TYPE1         0000000
072880     MOVE     'A'                TO DATS20-I-RETOUR-SENS1         0000000
072890     MOVE     'FM'               TO DATS20-I-OPTCAL1              0000000
072900     CALL     'ZCALLPGM'      USING ZDAT2000 DATS20               0000000
072910     MOVE      DATS20-O-R5       TO ZPRTNBMO-D1.                  0000000
072920                                                                  0000000
072930 TSFO-AAQQQ-SSAAMMJJ.                                             0000000
072940*--------------------                                             0000000
072950                                                                  0000000
072960     MOVE '39 ??00'            TO ZDATE-PARMS.                    0000000
072970*AN  CALL 'ZCALLPGM' USING ZDATE                                  0000000
072980*AN                        ZDATE-PARMS                            0000000
072990*AN                        ZDATE-INPUT                            0000000
073000*AN                        ZDATE-OUTPUT                           0000000
073010     IF ZDATE-INPUT NOT = ZERO                                    0000000
073020        MOVE ZDATE-PARMS           TO   CV-ZDATE-PARAM-GROUPE     0000000
073030        MOVE ZDATE-INPUT           TO   CV-ZDATE-DATE1            0000000
073040        MOVE ZDATE-OUTPUT          TO   CV-ZDATE-DATE2            0000000
073050        MOVE  'O'                  TO   ZDAT2000-GESTION-SIECLE   0000000
073060        PERFORM ZDAT2-ZDAT2000                                    0000000
073070        MOVE CV-ZDATE-PARAM-GROUPE TO   ZDATE-PARMS               0000000
073080        MOVE CV-ZDATE-DATE2        TO   ZDATE-OUTPUT              0000000
073090     ELSE                                                         0000000
073100        MOVE ZEROES                TO   ZDATE-OUTPUT              0000000
073110     END-IF.                                                      0000000
073120                                                                  0000000
073130     IF   ZDATE-RETOUR  NOT = ZERO                                0000000
073140          MOVE ZERO         TO ZDATE-OUTPUT.                      0000000
073150                                                                  0000000
073160 CALCUL-AN-MOIS.                                                  0000000
073170                                                                  0000000
073180     IF  W-DUREE  NUMERIC                                         0000000
073190       DIVIDE  W-DUREE  BY 12  GIVING  W-AN9 REMAINDER W-MOIS9    0000000
073200       MOVE   W-AN9     TO  W-ANZ                                 0000000
073210       MOVE   W-MOIS9   TO  W-MOISZ                               0000000
073220     ELSE   DISPLAY 'DUREE MERDIQUE '.                            0000000
073230*                                                                 0000000
073240*                                                                 0000000
073250*                                                                 0000000
073260*-------------                                                    0000000
073270 TRAIT-FRAIS.                                                     0000000
073280*-------------                                                    0000000
073290*                                                                 0000000
073300     MOVE  ZERO         TO  WS-TOTFRAIS.                          0000000
073310                                                                  0000000
073320     IF  SAY-MTCOM  NUMERIC                                       0000000
073330         MOVE  SAY-MTCOM9   TO  WS-TOTFRAIS                       0000000
073340     END-IF                                                       0000000
073350     IF  CONTRAT                                                  0000000
073360         IF  SAY-FRAUT NUMERIC                                    0000000
073370             ADD   SAY-FRAUT9   TO  WS-TOTFRAIS                   0000000
073380         END-IF                                                   0000000
073390         IF  SAY-FRHYP NUMERIC                                    0000000
073400             ADD   SAY-FRHYP9   TO  WS-TOTFRAIS                   0000000
073410         END-IF                                                   0000000
073420     END-IF                                                       0000000
073430     .                                                            0000000
073440*-------------                                                    0000000
073450 TRAIT-360J.                                                      0000000
073460*-------------                                                    0000000
073470*                                                                 0000000
073480     MOVE  ZERO         TO  WS-TFRAIS.                            0000000
073490     MOVE   '1'         TO  IPPPRI-IND360.                        0000000
073500     IF  SAY-MTCOM  NUMERIC                                       0000000
073510         MOVE  SAY-MTCOM9   TO  WS-TFRAIS                         0000000
073520     END-IF                                                       0000000
073530     IF  CONTRAT                                                  0000000
073540         IF  SAY-FRAUT NUMERIC                                    0000000
073550             ADD   SAY-FRAUT9   TO  WS-TFRAIS                     0000000
073560         END-IF                                                   0000000
073570         IF  SAY-FRHYP NUMERIC                                    0000000
073580             ADD   SAY-FRHYP9   TO  WS-TFRAIS                     0000000
073590         END-IF                                                   0000000
073600     END-IF                                                       0000000
073610     .                                                            0000000
073620     MOVE  WS-TFRAIS       TO  IPPPRI-MT1360.                     0000000
073630     MOVE  IPXCAL-O-TOT-ASS-OBL                                   0000000
073640                           TO  IPPPRI-MT2360.                     0000000
073650D    DISPLAY  'MT1360 = '   IPPPRI-MT1360.                        0000000
073660D    DISPLAY  'MT2360 = '   IPPPRI-MT2360.                        0000000
073670D    DISPLAY  'IND360 = '   IPPPRI-IND360.                        0000000
073680*                                                                 0000000
073690*                                                                 0000000
073700*-------------                                                    0000000
073710 TRAIT-DIVERS.                                                    0000000
073720*-------------                                                    0000000
073730                                                                  0000000
073740D    DISPLAY '-------------------------'.                         0000000
073750D    DISPLAY 'TRAIT-DIVERS'.                                      0000000
073760*                                                                 0000000
073770D    DISPLAY 'SA2-DATECH1           : ' SA2-DATECH1.              0000000
073780D    DISPLAY 'SA2-DATECH2           : ' SA2-DATECH2.              0000000
073790D    DISPLAY 'SA2-DATECH3           : ' SA2-DATECH3.              0000000
073800D    DISPLAY 'SA2-DATECH4           : ' SA2-DATECH4.              0000000
073810D    DISPLAY 'SA2-DATECH5           : ' SA2-DATECH5.              0000000
073820D    DISPLAY '-----'.                                             0000000
073830D    DISPLAY 'SAY-MONTECH1          : ' SAY-MONTECH1.             0000000
073840D    DISPLAY 'SAY-MONTECH2          : ' SAY-MONTECH2.             0000000
073850D    DISPLAY 'SAY-MONTECH3          : ' SAY-MONTECH3.             0000000
073860D    DISPLAY 'SAY-MONTECH4          : ' SAY-MONTECH4.             0000000
073870D    DISPLAY 'SAY-MONTECH5          : ' SAY-MONTECH5.             0000000
073880*                                                                 0000000
073890     MOVE ZERO TO NBECHREL.                                       0000000
073900*                                                                 0000000
073910     IF   SA2-DATECH1 NOT = SPACES                                0000000
073920      AND SA2-DATECH1 NOT = ZEROES                                0000000
073930          MOVE SA2-DATECH1 TO W-DAT2-SSAAMMJJ                     0000000
073940          PERFORM CALCUL-DATE-DIVERS                              0000000
073950          MOVE W-DATE-10   TO IPPPRI-RDATECH1                     0000000
073960          ADD 1            TO NBECHREL.                           0000000
073970*                                                                 0000000
073980     IF   SA2-DATECH2 NOT = SPACES                                0000000
073990      AND SA2-DATECH2 NOT = ZEROES                                0000000
074000          MOVE SA2-DATECH2 TO W-DAT2-SSAAMMJJ                     0000000
074010          PERFORM CALCUL-DATE-DIVERS                              0000000
074020          MOVE W-DATE-10   TO IPPPRI-RDATECH2                     0000000
074030          ADD 1            TO NBECHREL.                           0000000
074040*                                                                 0000000
074050     IF   SA2-DATECH3 NOT = SPACES                                0000000
074060      AND SA2-DATECH3 NOT = ZEROES                                0000000
074070          MOVE SA2-DATECH3 TO W-DAT2-SSAAMMJJ                     0000000
074080          PERFORM CALCUL-DATE-DIVERS                              0000000
074090          MOVE W-DATE-10   TO IPPPRI-RDATECH3                     0000000
074100          ADD 1            TO NBECHREL.                           0000000
074110*                                                                 0000000
074120     IF   SA2-DATECH4 NOT = SPACES                                0000000
074130      AND SA2-DATECH4 NOT = ZEROES                                0000000
074140          MOVE SA2-DATECH4 TO W-DAT2-SSAAMMJJ                     0000000
074150          PERFORM CALCUL-DATE-DIVERS                              0000000
074160          MOVE W-DATE-10   TO IPPPRI-RDATECH4                     0000000
074170          ADD 1            TO NBECHREL.                           0000000
074180*                                                                 0000000
074190     IF   SA2-DATECH5 NOT = SPACES                                0000000
074200      AND SA2-DATECH5 NOT = ZEROES                                0000000
074210          MOVE SA2-DATECH5 TO W-DAT2-SSAAMMJJ                     0000000
074220          PERFORM CALCUL-DATE-DIVERS                              0000000
074230          MOVE W-DATE-10   TO IPPPRI-RDATECH5                     0000000
074240          ADD 1            TO NBECHREL.                           0000000
074250*                                                                 0000000
074260     MOVE NBECHREL TO IPPPRI-NBECHREL.                            0000000
074270*                                                                 0000000
074280*---------                                                        0000000
074290*                                                                 0000000
074300     IF   SAY-MONTECH1 NUMERIC                                    0000000
074310          MOVE SAY-ECH1    TO IPPPRI-RMTECH1.                     0000000
074320*                                                                 0000000
074330     IF   SAY-MONTECH2 NUMERIC                                    0000000
074340          MOVE SAY-ECH2    TO IPPPRI-RMTECH2.                     0000000
074350*                                                                 0000000
074360     IF   SAY-MONTECH3 NUMERIC                                    0000000
074370          MOVE SAY-ECH3    TO IPPPRI-RMTECH3.                     0000000
074380*                                                                 0000000
074390     IF   SAY-MONTECH4 NUMERIC                                    0000000
074400          MOVE SAY-ECH4    TO IPPPRI-RMTECH4.                     0000000
074410*                                                                 0000000
074420     IF   SAY-MONTECH5 NUMERIC                                    0000000
074430          MOVE SAY-ECH5    TO IPPPRI-RMTECH5.                     0000000
074440*                                                                 0000000
074450     IF   SAY-PERDEGS  NUMERIC                                    0000000
074460          MOVE SAY-PERDEGS TO IPPPRI-RINTER                       0000000
074470     ELSE MOVE '1'         TO IPPPRI-RINTER.                      0000000
074480*                                                                 0000000
074490D    DISPLAY '-------------------------'.                         0000000
074500D    DISPLAY 'RMTECH1  : ' IPPPRI-RMTECH1.                        0000000
074510D    DISPLAY 'RMTECH2  : ' IPPPRI-RMTECH2.                        0000000
074520D    DISPLAY 'RMTECH3  : ' IPPPRI-RMTECH3.                        0000000
074530D    DISPLAY 'RMTECH4  : ' IPPPRI-RMTECH4.                        0000000
074540D    DISPLAY 'RMTECH5  : ' IPPPRI-RMTECH5.                        0000000
074550D    DISPLAY '-----'.                                             0000000
074560D    DISPLAY 'RDATECH1 : ' IPPPRI-RDATECH1.                       0000000
074570D    DISPLAY 'RDATECH2 : ' IPPPRI-RDATECH2.                       0000000
074580D    DISPLAY 'RDATECH3 : ' IPPPRI-RDATECH3.                       0000000
074590D    DISPLAY 'RDATECH4 : ' IPPPRI-RDATECH4.                       0000000
074600D    DISPLAY 'RDATECH5 : ' IPPPRI-RDATECH5.                       0000000
074610D    DISPLAY '-----'.                                             0000000
074620D    DISPLAY 'RINTER   : ' IPPPRI-RINTER.                         0000000
074630D    DISPLAY '-----'.                                             0000000
074640D    DISPLAY 'NBECHREL : ' IPPPRI-NBECHREL.                       0000000
074650*                                                                 0000000
074660*-------                                                          0000000
074670*                                                                 0000000
074680 CALCUL-DATE-DIVERS.                                              0000000
074690*                                                                 0000000
074700D    DISPLAY '-----'.                                             0000000
074710D    DISPLAY 'CALCUL-DAT-DIVERS'.                                 0000000
074720D    DISPLAY 'W-DAT2-SSAAMMJJ ' W-DAT2-SSAAMMJJ.                  0000000
074730*                                                                 0000000
074740     MOVE SPACE     TO W-DATE-10.                                 0000000
074750     STRING  W-DAT2-JJ '.'                                        0000000
074760             W-DAT2-MM '.'                                        0000000
074770             W-DAT2-SS                                            0000000
074780             W-DAT2-AA2   DELIMITED  BY  SIZE  INTO W-DATE-10.    0000000
074790*                                                                 0000000
074800D    DISPLAY 'W-DATE-10 : ' W-DATE-10.                            0000000
074810*                                                                 0000000
074820                                                                  0000000
074830**** RAJOUT 13/08/91 POUR SIAGI                                   0000000
074840*-------------------------                                        0000000
074850 LECTURE-PRTIDC-EDT.                                              0000000
074860*-------------------------                                        0000000
074870     If  Pret-a-lire                                              0000000
074880         Perform  LECTURE-PRTIDC-EDT-S                            0000000
074890     End-if                                                       0000000
074900     .                                                            0000000
074910*-------------------------                                        0000000
074920 LECTURE-PRTIDC-EDT-S.                                            0000000
074930*-------------------------                                        0000000
074940                                                                  0000000
074950     MOVE ZERO            TO CTL-RETOUR.                          0000000
074960     MOVE ZERO            TO DATOUV-SSAAMMJJ.                     0000000
074970     MOVE SPACE           TO IPPMSGX.                             0000000
074980     MOVE IPPMA2-FED      TO IPPMSGX-FED.                         0000000
074990     MOVE ORGS01-BANQUE   TO IPPMSGX-BANQUE.                      0000000
075000     MOVE IPPMA2-CAISSE   TO IPPMSGX-CAISSE.                      0000000
075010     MOVE IPPMA2-RACINE   TO IPPMSGX-RACINE.                      0000000
075020     MOVE IPPMA2-DOSS     TO IPPMSGX-DOSS.                        0000000
075030     MOVE IPPMA2-2-CAT (IP) TO IPPMSGX-CAT.                       0000000
075040     MOVE '0'             TO EXIST-PRTIDC                         0000000
075050                             EXIST-PRTDOS                         0000000
075060                             EXIST-PRTCPT.                        0000000
075070                                                                  0000000
075080     CALL 'ZCALLPGM' USING   IPPRBPR2                             0000000
075090                             IPPMSGX                              0000000
075100                             EXIST-PRTIDC                         0000000
075110                             EXIST-PRTDOS                         0000000
075120                             EXIST-PRTCPT                         0000000
075130                             PRTIDC                               0000000
075140                             PRTDOS                               0000000
075150                             PRTCPT                               0000000
075160                             CTL                                  0000000
075170                             PCBPRT.                              0000000
075180                                                                  0000000
075190D    DISPLAY 'IPPRBPR2 LECTURE-PRTIDC-EDT'.                       0000000
075200D    DISPLAY 'IPPRBPR2 IPPMSGX      = ' IPPMSGX.                  0000000
075210D    DISPLAY 'IPPRBPR2 EXIST-PRTIDC = ' EXIST-PRTIDC.             0000000
075220D    DISPLAY 'IPPRBPR2 EXIST-PRTDOS = ' EXIST-PRTDOS.             0000000
075230D    DISPLAY 'IPPRBPR2 EXIST-PRTCPT = ' EXIST-PRTCPT.             0000000
075240D    DISPLAY 'IPPRBPR2 PRTIDC       = ' PRTIDC.                   0000000
075250D    DISPLAY 'IPPRBPR2 PRTDOS       = ' PRTDOS.                   0000000
075260D    DISPLAY 'IPPRBPR2 PRTCPT       = ' PRTCPT.                   0000000
075270D    DISPLAY 'IPPRBPR2 CPT-DATOUV   = ' CPT-DATOUV                0000000
075280D    DISPLAY 'IPPRBPR2 CTL          = ' CTL.                      0000000
075290                                                                  0000000
075300     IF   CTL-R34 = ZERO                                          0000000
075310          IF   EXIST-PRTIDC = '1'                                 0000000
075320          AND  EXIST-PRTDOS = '1'                                 0000000
075330          AND  EXIST-PRTCPT = '1'                                 0000000
075340          CALL  'ZCALLPGM'  USING ZPRTZDA1                        0000000
075350                                   PRTCPT                         0000000
075360                                   PRTCP2                         0000000
075370               IF   CP2-DATOUV NUMERIC                            0000000
075380               AND  CP2-DATOUV GREATER THAN ZERO                  0000000
075390                    MOVE CP2-DATOUV TO  DATOUV-SSAAMMJJ           0000000
075400               ELSE NEXT SENTENCE                                 0000000
075410          ELSE NEXT SENTENCE                                      0000000
075420     Else                                                         0000000
075430D         DISPLAY 'IPPRBPR2 CTL          = ' CTL                  0000000
075440          MOVE ZERO  TO CTL-RETOUR                                0000000
075450          MOVE SPACE TO CTL-LIBELLE.                              0000000
075460                                                                  0000000
075470*-------------------------                                        0000000
075480 TRAIT-PRET-TYPE-X.                                               0000000
075490*-------------------------                                        0000000
075500                                                                  0000000
075510                                                                  0000000
075520     IF  SUITE   AND                                              0000000
075530         IPPMA2-LABEL-APPLI = 'IPI'                               0000000
075540         IF  LANGUE-ALLEMANDE                                     0000000
075550             if  IPPMA2-2-CNAT(IP) = '293'                        0000000
075560                 MOVE  'DARLEHEN "MODULIMMO"'                     0000000
075570                                         TO IPPPRI-TITPRET1       0000000
075580             else                                                 0000000
075590                 MOVE  'EINFACHES IMMOBILIENDARLEHEN'             0000000
075600*                MOVE  'KONVENTIONELLER REALKREDIT'               0000000
075610                                         TO IPPPRI-TITPRET1       0000000
075620         ELSE                                                     0000000
075630             MOVE  IPPPRD-LIBELLE    TO IPPPRI-TITPRET1.          0000000
075640*                                                                 0000000
075650     IF  AVENANT  and                                             0000000
075660         IPPMA2-LABEL-APPLI = 'IPI'                               0000000
075670         MOVE    SPACE       TO    W-LIB1                         0000000
075680         if   LANGUE-ALLEMANDE                                    0000000
075690              STRING  IPPPRI-TITPRET1   DELIMITED BY '  '         0000000
075700                    ' verndert'                                  0000000
075710                    DELIMITED BY SIZE  INTO  W-LIB1               0000000
075720         else                                                     0000000
075730              STRING  IPPPRI-TITPRET1   DELIMITED BY '  '         0000000
075740                    ' MODIFIE'                                    0000000
075750                    DELIMITED BY SIZE  INTO  W-LIB1               0000000
075760         END-IF                                                   0000000
075770D        DISPLAY  'W-LIB1 '  W-LIB1                               0000000
075780         MOVE  W-LIB1   TO  IPPPRI-TITPRET1                       0000000
075790     END-IF.                                                      0000000
075800                                                                  0000000
075810                                                                  0000000
075820*------------------------- CLAUSES SPECIFIQUES -----------        0000000
075830 TRAIT-INIT-CLAUSIER.                                             0000000
075840*-------------------------                                        0000000
075850     MOVE ZERO                     TO CLAUSES-STOCK  (1).         0000000
075860     MOVE ZERO                     TO CLAUSES-STOCK  (2).         0000000
075870     MOVE ZERO                     TO CLAUSES-STOCK  (3).         0000000
075880     MOVE ZERO                     TO CLAUSES-STOCK  (4).         0000000
075890     MOVE ZERO                     TO CLAUSES-STOCK  (5).         0000000
075900                                                                  0000000
075910                                                                  0000000
075920                                                                  0000000
075930 TRAIT-CLAUSE-052.                                                0000000
075940*-----------------                                                0000000
075950     MOVE  52  TO  WS-CLAUSE.                                     0000000
075960D    DISPLAY 'WS-CLAUSE ' WS-CLAUSE.                              0000000
075970*                                                                 0000000
075980     PERFORM    VARYING I-POS FROM 1 BY 1                         0000000
075990             UNTIL NUMCLAUP-STOCK (5 I-POS) = ZERO                0000000
076000             OR I-POS  >  10                                      0000000
076010             MOVE  I-POS  TO  I-POS2                              0000000
076020     END-PERFORM                                                  0000000
076030     .                                                            0000000
076040     IF  I-POS  NOT  > 10                                         0000000
076050         MOVE '1'                 TO INDCLAUP-STOCK (5)           0000000
076060         MOVE   WS-CLAUSE         TO NUMCLAUP-STOCK (5 I-POS).    0000000
076070                                                                  0000000
076080                                                                  0000000
076090                                                                  0000000
076100 TRAIT-CLAUSE-EPARGNE.                                            0000000
076110*-------------------------                                        0000000
076120                                                                  0000000
076130     PERFORM  TRAIT-CLAUSE-EPARGNE-S                              0000000
076140     .                                                            0000000
076150 TRAIT-CLAUSE-EPARGNE-S.                                          0000000
076160*-------------------------                                        0000000
076170     IF  SAY-CINDEX        = '07527' OR                           0000000
076180                SALARIE    =    1    OR                           0000000
076190         IPPPRI-SALARIE    =    1                                 0000000
076200         MOVE  47  TO  WS-CLAUSE                                  0000000
076210     ELSE                                                         0000000
076220         MOVE  46  TO  WS-CLAUSE.                                 0000000
076230D    DISPLAY 'WS-CLAUSE ' WS-CLAUSE.                              0000000
076240*                                                                 0000000
076250     PERFORM    VARYING I-POS FROM 1 BY 1                         0000000
076260             UNTIL NUMCLAUP-STOCK (5 I-POS) = ZERO                0000000
076270             OR I-POS  >  10                                      0000000
076280             MOVE  I-POS  TO  I-POS2                              0000000
076290     END-PERFORM                                                  0000000
076300     .                                                            0000000
076310     IF  I-POS  NOT  > 10                                         0000000
076320           MOVE   '1'               TO INDCLAUP-STOCK (5)         0000000
076330           MOVE   WS-CLAUSE         TO NUMCLAUP-STOCK (5 I-POS).  0000000
076340                                                                  0000000
076350                                                                  0000000
076360 TRAIT-CLAUSE-254.                                                0000000
076370*-------------------------                                        0000000
076380                                                                  0000000
076390     set Y-A-PAS-UNE-254 to true                                  0000000
076400*                                                                 0000000
076410     PERFORM    VARYING I-POS FROM 1 BY 1                         0000000
076420             UNTIL NUMCLAUP-STOCK (ICLAU2 I-POS) = ZERO           0000000
076430             OR I-POS  >  10                                      0000000
076440             IF  NUMCLAUP-STOCK (ICLAU2 I-POS) =  254             0000000
076450                 MOVE  ZERO TO  NUMCLAUP-STOCK (ICLAU2 I-POS)     0000000
076460                 SET  Y-A-UNE-254  TO  TRUE                       0000000
076470             END-IF                                               0000000
076480     END-PERFORM                                                  0000000
076490                                                                  0000000
076500     IF  I-POS  NOT  > 10                                         0000000
076510         if     Y-A-PAS-UNE-254                                   0000000
076520           MOVE   '1'          TO INDCLAUP-STOCK (ICLAU2)         0000000
076530           MOVE   254          TO NUMCLAUP-STOCK (ICLAU2 I-POS)   0000000
076540         END-IF                                                   0000000
076550     END-IF                                                       0000000
076560     .                                                            0000000
076570                                                                  0000000
076580 TRAIT-CLAUSE-255.                                                0000000
076590*-------------------------                                        0000000
076600                                                                  0000000
076610*                                                                 0000000
076620     PERFORM    VARYING I-POS FROM 1 BY 1                         0000000
076630             UNTIL NUMCLAUP-STOCK (ICLAU2 I-POS) = ZERO           0000000
076640             OR I-POS  >  10                                      0000000
076650     END-PERFORM                                                  0000000
076660                                                                  0000000
076670     IF  I-POS  NOT  > 10                                         0000000
076680         MOVE   '1'          TO INDCLAUP-STOCK (ICLAU2)           0000000
076690         MOVE   255          TO NUMCLAUP-STOCK (ICLAU2 I-POS)     0000000
076700     END-IF                                                       0000000
076710     .                                                            0000000
076720                                                                  0000000
076730                                                                  0000000
076740 TRAIT-CLAUSE-053.                                                0000000
076750*-------------------------                                        0000000
076760                                                                  0000000
076770*                                                                 0000000
076780     PERFORM    VARYING I-POS FROM 1 BY 1                         0000000
076790             UNTIL NUMCLAUP-STOCK (ICLAU2 I-POS) = ZERO           0000000
076800             OR I-POS  >  10                                      0000000
076810     END-PERFORM                                                  0000000
076820                                                                  0000000
076830     IF  I-POS  NOT  > 10                                         0000000
076840         MOVE   '1'          TO INDCLAUP-STOCK (ICLAU2)           0000000
076850         MOVE   053          TO NUMCLAUP-STOCK (ICLAU2 I-POS)     0000000
076860     END-IF                                                       0000000
076870     .                                                            0000000
076880                                                                  0000000
076890 TRAIT-CLAUSE-322-323.                                            0000000
076900*-------------------------                                        0000000
076910                                                                  0000000
076920*                                                                 0000000
076930     PERFORM    VARYING I-POS FROM 1 BY 1                         0000000
076940             UNTIL NUMCLAUP-STOCK (ICLAU2 I-POS) = ZERO           0000000
076950             OR I-POS  >  10                                      0000000
076960     END-PERFORM                                                  0000000
076970                                                                  0000000
076980     IF  I-POS  NOT  > 10                                         0000000
076990         MOVE   '1'          TO INDCLAUP-STOCK (ICLAU2)           0000000
077000         If  say-duram  >  120                                    0000000
077010           MOVE   323          TO NUMCLAUP-STOCK (ICLAU2 I-POS)   0000000
077020         Else                                                     0000000
077030           MOVE   322          TO NUMCLAUP-STOCK (ICLAU2 I-POS)   0000000
077040         END-IF                                                   0000000
077050     END-IF                                                       0000000
077060     .                                                            0000000
077070                                                                  0000000
077080                                                                  0000000
077090 TRAIT-CLAUSE-078.                                                0000000
077100*-------------------------                                        0000000
077110                                                                  0000000
077120*                                                                 0000000
077130     PERFORM    VARYING I-POS FROM 1 BY 1                         0000000
077140             UNTIL NUMCLAUP-STOCK (ICLAU2 I-POS) = ZERO           0000000
077150             OR I-POS  >  10                                      0000000
077160     END-PERFORM                                                  0000000
077170                                                                  0000000
077180     IF  I-POS  NOT  > 10                                         0000000
077190         MOVE   '1'          TO INDCLAUP-STOCK (ICLAU2)           0000000
077200         MOVE   078          TO NUMCLAUP-STOCK (ICLAU2 I-POS)     0000000
077210     END-IF                                                       0000000
077220     .                                                            0000000
077230                                                                  0000000
077240 TRAIT-CLAUSE-124.                                                0000000
077250*-------------------------                                        0000000
077260                                                                  0000000
077270*                                                                 0000000
077280     PERFORM    VARYING I-POS FROM 1 BY 1                         0000000
077290             UNTIL NUMCLAUP-STOCK (ICLAU2 I-POS) = ZERO           0000000
077300             OR I-POS  >  10                                      0000000
077310     END-PERFORM                                                  0000000
077320                                                                  0000000
077330     IF  I-POS  NOT  > 10                                         0000000
077340         MOVE   '1'          TO INDCLAUP-STOCK (ICLAU2)           0000000
077350         MOVE   124          TO NUMCLAUP-STOCK (ICLAU2 I-POS)     0000000
077360     END-IF                                                       0000000
077370     .                                                            0000000
077380                                                                  0000000
077390 TRAIT-CLAUSE-257.                                                0000000
077400*-------------------------                                        0000000
077410                                                                  0000000
077420*                                                                 0000000
077430     PERFORM    VARYING I-POS FROM 1 BY 1                         0000000
077440             UNTIL NUMCLAUP-STOCK (ICLAU2 I-POS) = ZERO           0000000
077450             OR I-POS  >  10                                      0000000
077460     END-PERFORM                                                  0000000
077470                                                                  0000000
077480     IF  I-POS  NOT  > 10                                         0000000
077490         MOVE   '1'          TO INDCLAUP-STOCK (ICLAU2)           0000000
077500         MOVE   257          TO NUMCLAUP-STOCK (ICLAU2 I-POS)     0000000
077510     END-IF                                                       0000000
077520     .                                                            0000000
077530                                                                  0000000
077540*--------------                                                   0000000
077550 TRAIT-CLAUSES.                                                   0000000
077560*--------------                                                   0000000
077570                                                                  0000000
077580     PERFORM AFFECT-NO-CLAUSE VARYING IT FROM 1 BY 1              0000000
077590             UNTIL IT > 10.                                       0000000
077600                                                                  0000000
077610     IF IPPCPL-CLAUSE-LS = '1'                                    0000000
077620     OR IPPCPL-CLAUSE-TITRE NOT = SPACE                           0000000
077630     OR IPPCPL-CLAUSE-TEXTES NOT = SPACE                          0000000
077640        MOVE '1'                   TO INDCLAUS-STOCK (ICLAU)      0000000
077650        MOVE 9999                  TO NUMCLAUS-STOCK (ICLAU)      0000000
077660        MOVE IPPCPL-CLAUSE-TITRE   TO CLAUSTLT-STOCK (ICLAU)      0000000
077670        MOVE IPPCPL-CLAUSE-TEXTES  TO CLAUS-STOCK    (ICLAU).     0000000
077680                                                                  0000000
077690D    DISPLAY  'BANQUE             '  ORGS01-BANQUE                0000000
077700D    DISPLAY  'IPPMA2-LABEL-APPLI '  IPPMA2-LABEL-APPLI.          0000000
077710                                                                  0000000
077720                                                                  0000000
077730 TRAIT-CLAUSES-RTA.                                               0000000
077740*-----------------                                                0000000
077750D    DISPLAY ' ZONE4-STOCK AVANT ' ZONE4-STOCK                    0000000
077760     IF  IPPMA2-LABEL-APPLI  =  'IPP'                             0000000
077770         MOVE  IPPMA2-2-CNAT (IP) TO W-CNAT-RTA                   0000000
077780         IF  COND-CNAT-RTA                                        0000000
077790             PERFORM   TRAIT-CLAUSE-257                           0000000
077800         END-IF                                                   0000000
077810     END-IF                                                       0000000
077820     .                                                            0000000
077830D    DISPLAY ' ZONE4-STOCK APRES ' ZONE4-STOCK.                   0000000
077840                                                                  0000000
077850                                                                  0000000
077860                                                                  0000000
077870 AFFECT-NO-CLAUSE.                                                0000000
077880*-----------------                                                0000000
077890                                                                  0000000
077900d    display 'IPPCPL-CLAUSE-NO ' IPPCPL-CLAUSE-NO (IT)            0000000
077910     IF IPPCPL-CLAUSE-NO (IT) NOT = SPACE                         0000000
077920        IF IPPCPL-CLAUSE-NO (IT)  =  '254'                        0000000
077930            AND ( ORGS01-FEDE-CEE )                               0000000
077940d          display ' trouve une 254 '                             0000000
077950           SET Y-A-UNE-254    TO  TRUE                            0000000
077960        else                                                      0000000
077970           MOVE '1'                   TO INDCLAUP-STOCK (ICLAU)   0000000
077980           MOVE IPPCPL-CLAUSE-NO (IT) TO Z-NUMCLAUP               0000000
077990           MOVE Z-NUMCLAUP          TO NUMCLAUP-STOCK (ICLAU IT)  0000000
078000     ELSE                                                         0000000
078010           MOVE ZERO  TO  Z-NUMCLAUP  NUMCLAUP-STOCK (ICLAU IT).  0000000
078020                                                                  0000000
078030*    IF  orgs01-assimile-cmm                                      0000000
078040*            IF Z-NUMCLAUP  =  50                                 0000000
078050*               MOVE  1  TO  IPPPRI-SALARIE                       0000000
078060*               MOVE  1  TO  SALARIE-MARSEILLE.                   0000000
078070     IF  ORGS01-ASSIMILE-IDF                                      0000000
078080             IF (Z-NUMCLAUP  =  73 or 273)                        0000000
078090                MOVE  9  TO  IPPPRI-IND7319.                      0000000
078100     IF  (ORGS01-FEDE-CEE AND NOT ORGS01-ASSIMILE-IDF)            0000000
078110         IF  Z-NUMCLAUP  =  110                                   0000000
078120             MOVE  'O' TO  TODES-PREVU                            0000000
078130         End-if                                                   0000000
078140         IF  Z-NUMCLAUP  =  109                                   0000000
078150             MOVE  'O' TO  LEBEN-PREVU                            0000000
078160         END-IF                                                   0000000
078170     END-IF.                                                      0000000
078180                                                                  0000000
078190D    DISPLAY  'IND7319 ' IPPPRI-IND7319.                          0000000
078200*------------------------- COMPLEMENT IMAGE BORDEREAU par pret    0000000
078210 TRAIT-PRET-BORDEREAU.                                            0000000
078220*-------------------------                                        0000000
078230                                                                  0000000
078240     IF SUITE                                                     0000000
078250        PERFORM CNTRL-NUMERICITE.                                 0000000
078260                                                                  0000000
078270     IF  SUITE                                                    0000000
078280        IF  AVENANT                                               0000000
078290            PERFORM  FRAIS-D-AVENANT                              0000000
078300        END-IF                                                    0000000
078310     END-IF                                                       0000000
078320                                                                  0000000
078330     PERFORM TRAIT-PRET-TITRE.                                    0000000
078340                                                                  0000000
078350                                                                  0000000
078360d       display 'ippcpl :' ippcpl                                 0000000
078370     IF SUITE                                                     0000000
078380        PERFORM TRAIT-PAIEMENT.                                   0000000
078390                                                                  0000000
078400     IF SUITE                                                     0000000
078410        PERFORM TRAIT-RAZ.                                        0000000
078420                                                                  0000000
078430     IF SUITE                                                     0000000
078440        PERFORM TRAIT-TABAMORT.                                   0000000
078450                                                                  0000000
078460     IF SUITE                                                     0000000
078470        PERFORM TRAIT-DUREES.                                     0000000
078480                                                                  0000000
078490     IF SUITE                                                     0000000
078500        PERFORM TRAIT-CAPITAL-LETTRE.                             0000000
078510                                                                  0000000
078520     IF SUITE                                                     0000000
078530        PERFORM TRAIT-TAUX-LETTRE.                                0000000
078540                                                                  0000000
078550**** IPI                                                          0000000
078560     IF SUITE                                                     0000000
078570        IF   IPPMA2-LABEL-APPLI = 'IPI'                           0000000
078580             PERFORM TRAIT-PAIEMENT-IPI.                          0000000
078590                                                                  0000000
078600D    DISPLAY 'IPPPRI-JTERME'  IPPPRI-JTERME.                      0000000
078610                                                                  0000000
078620* TRAIT DUREE                                                     0000000
078630     Evaluate TRUE                                                0000000
078640       When NOT SUITE                                             0000000
078650         Continue                                                 0000000
078660                                                                  0000000
078670       When IPPMA2-LABEL-APPLI = 'IPI'                            0000000
078680       When Orgs01-Fede-Cmo                                       0000000
078690         PERFORM  TRAIT-PALIERS-IMMO                              0000000
078700                                                                  0000000
078710       When Other                                                 0000000
078720         PERFORM  TRAIT-PALIERS                                   0000000
078730     End-Evaluate                                                 0000000
078740                                                                  0000000
078750     IF SUITE                                                     0000000
078760        PERFORM TRAIT-PRET-TAUX.                                  0000000
078770                                                                  0000000
078780     IF SUITE                                                     0000000
078790        PERFORM TRAIT-MONTANTS.                                   0000000
078800*                                                                 0000000
078810                                                                  0000000
078820     IF SUITE                                                     0000000
078830        PERFORM TRAIT-FRAIS.                                      0000000
078840*                                                                 0000000
078850* 360 JOURS IPP OU IPI                                            0000000
078860     IF SUITE                                                     0000000
078870        IF  SAY-CALINT  =  '2'                                    0000000
078880            PERFORM    TRAIT-360J                                 0000000
078890        ELSE                                                      0000000
078900            IF   IPPMA2-LABEL-APPLI = 'IPC'                       0000000
078910                 IF  TEG-SANS-ASSUR                               0000000
078920                     MOVE  2  TO  IPPPRI-IND360.                  0000000
078930*                                                                 0000000
078940     IF  SUITE                                                    0000000
078950         IF   IPPMA2-LABEL-APPLI = 'IPC'                          0000000
078960          AND (SAY-MDCONSO = '1')                                 0000000
078970              PERFORM TRAIT-MODULCONSO.                           0000000
078980*                                                                 0000000
078990                                                                  0000000
079000     IF SUITE                                                     0000000
079010        PERFORM TRAIT-PREM-ECHEANCE.                              0000000
079020                                                                  0000000
079030     IF SUITE                                                     0000000
079040        PERFORM TRAIT-DATE-DEBLOCAGE.                             0000000
079050                                                                  0000000
079060**** IPI                                                          0000000
079070     IF SUITE                                                     0000000
079080*       IF   IPPMA2-LABEL-APPLI = 'IPI'                           0000000
079090             PERFORM TRAIT-DATE-ACCORD.                           0000000
079100                                                                  0000000
079110*  INDORD = 1 SI PC OU SALARIE (POUR COPIE EXECUTOIRE)            0000000
079120     IF  IPPPRI-SALARIE  =  '1'  OR                               0000000
079130                SALARIE  =  '1'                                   0000000
079140         MOVE  '1'  TO  IPPPRI-INDORD                             0000000
079150     ELSE                                                         0000000
079160         MOVE  ZERO TO  IPPPRI-INDORD.                            0000000
079170*                                                                 0000000
079180*  INDPEN = 1 SI AUTRE QUE LYON OU CNAT = 291                     0000000
079190*  POUR LYON   PAS DE PENALITES DE REMBOURSEMENT                  0000000
079200*  POUR LE 291 PAS DE PENALITES DE REMBOURSEMENT                  0000000
079210*                                                                 0000000
079220     IF  IPPPRI-EIG  =  ZERO                                      0000000
079230         IF  (IPPMA2-2-CNAT (IP) = '291' OR '304' or '302')       0000000
079240             OR  ORGS01-ASSIMILE-LYON                             0000000
079250             MOVE  ZERO TO  IPPPRI-INDPEN                         0000000
079260         ELSE                                                     0000000
079270             MOVE  '1'  TO  IPPPRI-INDPEN.                        0000000
079280*                                                                 0000000
079290*  POUR LE 291 PAS D INTERETS                                     0000000
079300*                                                                 0000000
079310     MOVE  ZERO  TO  IPPPRI-INDFRA.                               0000000
079320     IF  IPPPRI-INDDIFF   NOT  =  '1'                             0000000
079330         IF  IPPPRI-DURFRANC  NOT  =  ZERO                        0000000
079340             IF  (IPPMA2-2-CNAT (IP) = '291' OR '304' OR '302' )  0000000
079350                  MOVE  '2'  TO  IPPPRI-INDFRA                    0000000
079360             ELSE                                                 0000000
079370                  MOVE  '1'  TO  IPPPRI-INDFRA.                   0000000
079380                                                                  0000000
079390     IF IPXPRO-PPL   or  ipxpro-pl92                              0000000
079400                     or  ipxpro-pl-annecy                         0000000
079410        MOVE ZERO TO IPPPRI-INDFRA                                0000000
079420     END-IF                                                       0000000
079430                                                                  0000000
079440*   taxe  / Timbre                                                0000000
079450*    if  w-taxe  not  =  zero                                     0000000
079460*        If  SAY-NB-TIMBRES  numeric  and                         0000000
079470*            SAY-NB-TIMBRE9  >   zero                             0000000
079480*            MOVE   'T'         to  ipppri-taxe  w-taxe           0000000
079490*        Else                                                     0000000
079500*            MOVE  say-tax-typ  to  ipppri-taxe  w-taxe           0000000
079510*        End-if                                                   0000000
079520*    End-if                                                       0000000
079530                                                                  0000000
079540D    DISPLAY   'IPPPRI-INDFRA '  IPPPRI-INDFRA.                   0000000
079550D    DISPLAY   'IPPPRI-DURFRAN'  IPPPRI-DURFRANC.                 0000000
079560*                                                                 0000000
079570     MOVE  ZERO  TO  IPPPRI-INDDIF2.                              0000000
079580     IF  IPPPRI-INDDIFF   NOT  =  '1'                             0000000
079590         IF  IPPPRI-MODEGEST  NOT  =  '6'                         0000000
079600             IF  IPPMA2-2-CNAT (IP) = '291' OR '304'              0000000
079610                 MOVE  '2'  TO  IPPPRI-INDDIF2                    0000000
079620             ELSE                                                 0000000
079630                 MOVE  '1'  TO  IPPPRI-INDDIF2.                   0000000
079640                                                                  0000000
079650     IF  AVENANT                                                  0000000
079660         MOVE  '3'  TO  IPPPRI-INDDIF2.                           0000000
079670                                                                  0000000
079680D    DISPLAY   'IPPPRI-INDDIF2 '  IPPPRI-INDDIF2.                 0000000
079690*                                                                 0000000
079700* PRET A TAUX ZERO CNAT = 291 /  304  / 302 ville de paris  / PPL 0000000
079710                                                                  0000000
079720     Move '0'          To    IPPPRI-INDTZ                         0000000
079730     IF  SAY-CNAT  =  '291' OR '304'                              0000000
079740         MOVE  '1'     TO    IPPPRI-INDTZ                         0000000
079750         MOVE  'O'     TO    PTZ-PREVU                            0000000
079760         IF  SAY-CNAT  =   '304'                                  0000000
079770             MOVE  '15'    TO  IPPPRI-TZANCIEN                    0000000
079780             MOVE  '2'     TO  IPPPRI-TZDOS                       0000000
079790         ELSE                                                     0000000
079800             MOVE  '20'    TO  IPPPRI-TZANCIEN                    0000000
079810             MOVE  '1'     TO  IPPPRI-TZDOS                       0000000
079820         END-IF                                                   0000000
079830         PERFORM    TRAIT-TZ-291                                  0000000
079840     END-IF.                                                      0000000
079850                                                                  0000000
079860* PC  laval  / CEE                                                0000000
079870                                                                  0000000
079880     IF (ORGS01-FEDE-LAVAL     or                                 0000000
079890         ORGS01-FEDE-CEE       or                                 0000000
079900         ORGS01-FEDE-ANTILLES )                                   0000000
079910       And                                                        0000000
079920        (SAY-CNAT  =  '264' )                                     0000000
079930         MOVE  'O'     TO  PTZ-PREVU.                             0000000
079940                                                                  0000000
079950     IF  ORGS01-FEDE-LAVAL                                        0000000
079960         if  PTZ-PREVU  =  'O'                                    0000000
079970             MOVE  '1'   TO  IPPPRI-PCTZ                          0000000
079980         ELSE                                                     0000000
079990             MOVE ZERO   TO  IPPPRI-PCTZ                          0000000
080000     ELSE                                                         0000000
080010         MOVE ZERO   TO  IPPPRI-PCTZ                              0000000
080020     END-IF.                                                      0000000
080030                                                                  0000000
080040* 0% Ville de Paris.                                              0000000
080050                                                                  0000000
080060     IF  SAY-CNAT  =  '302'                                       0000000
080070         MOVE  '2'     TO  IPPPRI-INDTZ                           0000000
080080     END-IF                                                       0000000
080090                                                                  0000000
080100* 0% Pl92                                                         0000000
080110                                                                  0000000
080120     IF  IPXPRO-PL92                                              0000000
080130         MOVE  '3'     TO  IPPPRI-INDTZ                           0000000
080140         MOVE   ip     TO  PL92-PREVU9                            0000000
080150     END-IF                                                       0000000
080160                                                                  0000000
080170* 0% Annecy                                                       0000000
080180                                                                  0000000
080190     IF  IPXPRO-PL-ANNECY                                         0000000
080200         MOVE  '4'     TO  IPPPRI-INDTZ                           0000000
080210     END-IF                                                       0000000
080220                                                                  0000000
080230* 0% Nantes                                                       0000000
080240                                                                  0000000
080250     IF  IPXPRO-PL44                                              0000000
080260         MOVE  '5'     TO  IPPPRI-INDTZ                           0000000
080270     END-IF                                                       0000000
080280                                                                  0000000
080290* 0% Caen                                                         0000000
080300                                                                  0000000
080310     IF  IPXPRO-PTZ-CAEN                                          0000000
080320         MOVE  '6'     TO  IPPPRI-INDTZ                           0000000
080330     END-IF                                                       0000000
080340                                                                  0000000
080350* 0% Orleans                                                      0000000
080360                                                                  0000000
080370     IF  IPXPRO-PTZ-ORLEANS                                       0000000
080380         MOVE  '7'     TO  IPPPRI-INDTZ                           0000000
080390     END-IF                                                       0000000
080400                                                                  0000000
080410* 0% PPL                                                          0000000
080420                                                                  0000000
080430     IF  IPXPRO-PPL                                               0000000
080440         MOVE   ip     TO  PPL-PREVU9                             0000000
080450     END-IF                                                       0000000
080460                                                                  0000000
080470* PCAS                                                            0000000
080480     If  (SAY-CNAT  =  '264' )                                    0000000
080490         MOVE  'O'     TO  PAS-PREVU                              0000000
080500     End-if                                                       0000000
080510                                                                  0000000
080520D    DISPLAY 'IPPPRI-INDTZ  '                                     0000000
080530D    DISPLAY  IPPPRI-INDTZ.                                       0000000
080540*                                                                 0000000
080550*             TRAITEMENT DES  GARANTIES  DU PRET                  0000000
080560*             ==================================                  0000000
080570d    display 'ip              ' IP                                0000000
080580d    display 'W-TAB-GAR1 (IP) ' W-TAB-GAR1  (IP)                  0000000
080590                                                                  0000000
080600     move Space                      to GAR32C                    0000000
080610*    IF SUITE and not avenant                                     0000000
080620     IF SUITE                                                     0000000
080630        MOVE 1 TO  W-IT                                           0000000
080640        PERFORM TRAIT-PRET-GARANTIE-IPX                           0000000
080650                VARYING IT FROM 1 BY 1 UNTIL IT >  NBGAR-PRET     0000000
080660                     OR IPPMA2-2-TAB-PRET (IP) = SPACES           0000000
080670                     OR IPPMA2-2-CAT    (IP) NOT NUMERIC          0000000
080680                     OR IPPMA2-2-CNAT   (IP) NOT NUMERIC          0000000
080690                     OR W-TAB-GAR1      (IP)  =  SPACES           0000000
080700                     OR ARRET.                                    0000000
080710                                                                  0000000
080720     IF SUITE                                                     0000000
080730*   Ne faire qu'une fois.                                         0000000
080740*      Sinon on a autant de copies 'NOT' que de prts.            0000000
080750        IF  IP  =  1    or avenant or                             0000000
080760            (NOTAIRE-NON-TROUVE)                                  0000000
080770            PERFORM         TRAIT-NOTARIE.                        0000000
080780                                                                  0000000
080790* ***         LOI  MADELIN                                        0000000
080800     IF  SUITE                                                    0000000
080810        IF  MADELIN-EXIST  = 'O'                                  0000000
080820            MOVE  W-TOTAL-MONT120 TO  IPPPRI-MONT120.             0000000
080830                                                                  0000000
080840* ***         gar  09 ou la 1ere garantie du pret                 0000000
080850* ***                                        en x(3).             0000000
080860     IF  SUITE                                                    0000000
080870        IF  GENDARME-EXIST  = 'O'                                 0000000
080880            MOVE  '009'    TO  IPPPRI-VARGAR                      0000000
080890        ELSE                                                      0000000
080900            STRING '0' WP-CODE-GARANTIE(IP 1)                     0000000
080910               DELIMITED BY SIZE INTO  IPPPRI-VARGAR.             0000000
080920                                                                  0000000
080930D    DISPLAY 'IPPPRI-VARGAR = ' IPPPRI-VARGAR.                    0000000
080940                                                                  0000000
080950     IF SUITE                                                     0000000
080960        PERFORM TRAIT-INDICATEURS                                 0000000
080970     End-if                                                       0000000
080980                                                                  0000000
080990     IF  SUITE                                                    0000000
081000         IF  AVENANT  and                                         0000000
081010             SAY-CNAT  =  '291'                                   0000000
081020             PERFORM TRAIT-AVENANT-PTZ                            0000000
081030         End-if                                                   0000000
081040     End-if                                                       0000000
081050                                                                  0000000
081060     IF SUITE                                                     0000000
081070*       WRITE EFMVT FROM IPPPRI                                   0000000
081080*       ADD  1      TO CPT-FMVT                                   0000000
081090d       DISPLAY 'IPPPRI ( ' IP ' '  IPPPRI                        0000000
081100        inspect IPPPRI replacing all x'00' by x'40'               0000000
081110d       DISPLAY 'IPPPRI ( ' IP ' '  IPPPRI                        0000000
081120        MOVE IPPPRI TO IPPPRI-STOCK (IP).                         0000000
081130                                                                  0000000
081140     MOVE      IP   TO NB-PRET-DOSS.                              0000000
081150                                                                  0000000
081160 FRAIS-D-AVENANT.                                                 0000000
081170                                                                  0000000
081180     INITIALIZE  PRTBSP                                           0000000
081190                                                                  0000000
081200     MOVE  '4'               TO BSP-P-CODENR                      0000000
081210     MOVE  SAY-FED           TO BSP-P-FED                         0000000
081220     MOVE  SAY-BANQ          TO BSP-P-BANQUE                      0000000
081230     MOVE  SAY-NCAIS         TO BSP-P-CAISSE                      0000000
081240     MOVE  ZERO              TO BSP-P-COMPTE                      0000000
081250     MOVE  SAY-RACINE        TO BSP-P-RACINE                      0000000
081260     MOVE  SAY-CAT           TO BSP-P-TYPSER                      0000000
081270     MOVE  'AAAAAAAAAAAAAAA' TO BSP-P-DH                          0000000
081280     MOVE  'ZZ'              TO BSP-ORIG                          0000000
081290     MOVE  'AV'              TO BSP-TYPE                          0000000
081300     MOVE  'PR'              TO BSP-CODOP                         0000000
081310     MOVE  'BB'              TO BSP-NUMORD                        0000000
081320     MOVE  'CCC'             TO BSP-FILLER-3                      0000000
081330     MOVE  '4'               TO ZMVPXSPR-TYPE                     0000000
081340     MOVE  BSP-CLE           TO ZMVPXSPR-ENRCLE                   0000000
081350     MOVE  ZERO              TO ZMVPXSPR-CODRET                   0000000
081360                                                                  0000000
081370     CALL  'ZCALLPGM'   USING ZMVPXSPR  PARAM-ZMVPXSPR            0000000
081380                                         PRTBSP                   0000000
081390                                         PCBMSP.                  0000000
081400                                                                  0000000
081410D    DISPLAY  'PARAM-ZMVPXSPR ' PARAM-ZMVPXSPR.                   0000000
081420D    DISPLAY  'BSP-CLE        ' BSP-CLE.                          0000000
081430                                                                  0000000
081440     IF   ZMVPXSPR-CODRET NOT  =  ZERO                            0000000
081450          MOVE   ZERO        TO  SAY-MTCOM                        0000000
081460     ELSE                                                         0000000
081470          MOVE   BSP-SUITE   TO  PRTSAYZ                          0000000
081480          If  orgs01-fede-cee                                     0000000
081490*       and ( say-ncais   = '02408' or '02409' or '07013' or      0000000
081500*                           '07390' or '08000' or '02415')        0000000
081510              Perform  Trait-top-avenant                          0000000
081520          End-if                                                  0000000
081530          if  sayz-mtcom  numeric                                 0000000
081540              MOVE   SAYZ-MTCOM  TO  SAY-MTCOM                    0000000
081550          Else                                                    0000000
081560              MOVE   Zero        TO  SAY-MTCOM9                   0000000
081570          END-IF                                                  0000000
081580     END-IF.                                                      0000000
081590                                                                  0000000
081600     If  orgs01-fede-cee                                          0000000
081610         Move space  to  sayz-cindex                              0000000
081620         Perform  Trait-top-avenant                               0000000
081630     End-if                                                       0000000
081640d    display ' say-mtcom spr ' say-mtcom                          0000000
081650     .                                                            0000000
081660                                                                  0000000
081670 Trait-top-avenant.                                               0000000
081680                                                                  0000000
081690*  Comparaison de sayz ( ancienne situation de prt )  et         0000000
081700*                 say  ( Nouvelle situation )                     0000000
081710                                                                  0000000
081720     Set pas-modif-index  to  true                                0000000
081730                                                                  0000000
081740D    DISPLAY 'AAM - Trait-top-avenant'                            0000000
081750D    DISPLAY 'AAM - say-cindex = ' say-cindex                     0000000
081760D    DISPLAY 'AAM - sayz-cindex= ' sayz-cindex                    0000000
081770     If  not  ( say-cindex  =  sayz-cindex )                      0000000
081780         Perform  rech-index-renego                               0000000
081790     End-if                                                       0000000
081800     If  modif-index                                              0000000
081810d        Display 'modif-index = oui'                              0000000
081820         Move  '1'  to  ipppri-renego                             0000000
081830     End-if                                                       0000000
081840     .                                                            0000000
081850                                                                  0000000
081860 Rech-index-renego.                                               0000000
081870                                                                  0000000
081880D    DISPLAY 'AAM - Rech-index-renego'                            0000000
081890D    DISPLAY 'AAM - say-cindex = ' say-cindex                     0000000
081900D    DISPLAY 'AAM - ORGS01-FEDERATION-ASSIMIL ='                  0000000
081910D    ORGS01-FEDERATION-ASSIMIL                                    0000000
081920     Move  Space   to  w-clause-ren                               0000000
081930     If  say-cindex  =  '188CM'                                   0000000
081940          If  orgs01-assimile-idf                                 0000000
081950              Move  '1699'  to  w-clause-ren                      0000000
081960          Else                                                    0000000
081970            If  orgs01-assimile-cmsmb                             0000000
081980                Move  '1700'  to  w-clause-ren                    0000000
081990            Else                                                  0000000
082000              If  orgs01-assimile-lyon                            0000000
082010                  Move  '1701'  to  w-clause-ren                  0000000
082020              Else                                                0000000
082030                  Move  '1698'  to  w-clause-ren                  0000000
082040              End-if                                              0000000
082050            End-if                                                0000000
082060          End-if                                                  0000000
082070     Else                                                         0000000
082080                                                                  0000000
082090*...D-AA-13/10/2010                                               0000000
082100       IF  say-cindex  =  '199CM'                                 0000000
082110           IF  orgs01-assimile-cmsmb                              0000000
082120               Move  '1700'  to  w-clause-ren                     0000000
082130           END-IF                                                 0000000
082140       ELSE                                                       0000000
082150*...F-AA-13/10/2010                                               0000000
082160d    display 'say-cindex  ' say-cindex                            0000000
082170d    display 'sayz-cindex ' sayz-cindex                           0000000
082180                                                                  0000000
082190         if  say-cindex  not  =  space                            0000000
082200             if  say-cindex  not  =  sayz-cindex                  0000000
082210                 Perform  varying   i-ren  from  1  by 1          0000000
082220                            until  i-ren  >  30                   0000000
082230                      or    modif-index                           0000000
082240                   if  say-cindex  =  w-ren-idx (i-ren)           0000000
082250                     Set     modif-index  to  true                0000000
082260                     If  cpt-duram1  <=  w-ren-cl-duree (i-ren)   0000000
082270                        Move  w-ren-cl-plus(i-ren) to w-clause-ren0000000
082280                     Else                                         0000000
082290                         Move  w-ren-cl (i-ren)  to  w-clause-ren 0000000
082300                     End-if                                       0000000
082310                   End-if                                         0000000
082320                End-perform                                       0000000
082330             End-if                                               0000000
082340         End-if                                                   0000000
082350*...D-AA-13/10/2010                                               0000000
082360       END-IF                                                     0000000
082370*...F-AA-13/10/2010                                               0000000
082380     End-if.                                                      0000000
082390                                                                  0000000
082400d    display 'clause renego '   w-clause-ren                      0000000
082410     .                                                            0000000
082420                                                                  0000000
082430* Rechercher la derniere garantie pret                            0000000
082440*-------------------------                                        0000000
082450 MISE-TABLE-GAR.                                                  0000000
082460*-------------------------                                        0000000
082470*                                                                 0000000
082480     PERFORM  APPEL-IPXM0003                                      0000000
082490     .                                                            0000000
082500                                                                  0000000
082510                                                                  0000000
082520                                                                  0000000
082530*-------------------------                                        0000000
082540 TRAIT-PRET-TITRE.                                                0000000
082550*-------------------------                                        0000000
082560*                                                                 0000000
082570     IF   Z-TYPCRED = 'IMMO-DV' OR 'PROF-DV' OR 'CONS-DV'         0000000
082580        IF   SAY-MGESS NOT NUMERIC                                0000000
082590             MOVE 1                          TO Z-MODEGEST        0000000
082600        ELSE                                                      0000000
082610             MOVE SAY-MGESS                  TO Z-MODEGEST        0000000
082620     ELSE                                                         0000000
082630        IF   SAY-MGES NOT NUMERIC                                 0000000
082640             MOVE 1                          TO Z-MODEGEST        0000000
082650        ELSE MOVE SAY-MGES                   TO Z-MODEGEST.       0000000
082660                                                                  0000000
082670***                                                               0000000
082680     MOVE ZERO                             TO IPPPRI-MODEGEST.    0000000
082690     MOVE ZERO                             TO IPPPRI-TYPEPRET.    0000000
082700     MOVE ZERO                             TO IPPPRI-TYPEPC.      0000000
082710     MOVE SPACE                            TO IPPPRI-NUMBAREM.    0000000
082720     MOVE SPACE                            TO IPPPRI-SEPBAREM.    0000000
082730     MOVE SPACE                            TO IPPPRI-RESBAREM.    0000000
082740*                                                                 0000000
082750*                                                                 0000000
082760     MOVE ZERO                             TO IPPPRI-VALINDEX-X.  0000000
082770     MOVE ZERO                             TO IPPPRI-VALINDE5-X.  0000000
082780     MOVE ZERO                             TO IPPPRI-DATINDEX.    0000000
082790*                                                                 0000000
082800     MOVE 'TAUX VARIABLE  '                TO IPPPRI-TITPRET2.    0000000
082810     MOVE ZERO                             TO IPPPRI-VARTAUX.     0000000
082820                                                                  0000000
082830     IF SAY-VTAU = '1'                                            0000000
082840        MOVE 1                             TO IPPPRI-VARTAUX      0000000
082850        MOVE 'TAUX FIXE      '             TO IPPPRI-TITPRET2.    0000000
082860                                                                  0000000
082870     If say-vter  = '1'                                           0000000
082880        Move  '1'   to ipppri-vter                                0000000
082890     Else                                                         0000000
082900        Move  zero  to ipppri-vter                                0000000
082910     End-if                                                       0000000
082920                                                                  0000000
082930**** IPI                                                          0000000
082940     MOVE SPACE TO Z-TYPINDEX.                                    0000000
082950     IF  (Z-TYPPRET = 'PO' OR 'EL')                               0000000
082960          MOVE ZERO TO Z-TYPEPC                                   0000000
082970          MOVE ZERO TO Z-VARIANTE-PC                              0000000
082980          MOVE ZERO TO Z-DOSS-PC.                                 0000000
082990     IF   Z-TYPPRET = 'PC'                                        0000000
083000          MOVE ZERO TO Z-TYPEPC                                   0000000
083010          MOVE ZERO TO Z-VARIANTE-PC                              0000000
083020          MOVE 1    TO Z-DOSS-PC.                                 0000000
083030                                                                  0000000
083040*    13.08.92 POUR RECONNAITRE LES PC EN DEHORS DE TYPEPC         0000000
083050     IF   Z-TYPPRET = 'PO'                                        0000000
083060          MOVE '1' TO IPPPRI-TYPEPRET                             0000000
083070     ELSE                                                         0000000
083080     IF   Z-TYPPRET = 'PC'                                        0000000
083090          MOVE '2' TO IPPPRI-TYPEPRET                             0000000
083100     ELSE                                                         0000000
083110     IF   Z-TYPPRET = 'EL'                                        0000000
083120          MOVE '3' TO IPPPRI-TYPEPRET.                            0000000
083130                                                                  0000000
083140     MOVE  ZERO  TO  INDIC-TAUX-BECM.                             0000000
083150                                                                  0000000
083160     IF  (SAY-VTAU = '2' OR '3' OR '4')                           0000000
083170          IF     EXIST-INDEX = 1                                  0000000
083180            OR ((CAI-CAIREGIM = 3 OR 4 OR 5)                      0000000
083190             AND  IPPPRI-EIG  NOT  =  1                           0000000
083200             AND IPPMA2-LABEL-APPLI NOT = 'IPI')                  0000000
083210                                                                  0000000
083220                 PERFORM   AFFECT-VARTAUX-34                      0000000
083230                 IF ( INDIC-TAUX-BECM  =  1    OR                 0000000
083240                      SAY-CINDEX(1:3)  = '188'    )               0000000
083250                    MOVE 'TAUX VARIABLE  '  TO IPPPRI-TITPRET2    0000000
083260                 ELSE                                             0000000
083270                  If  orgs01-banque-cic                           0000000
083280                    if ( SAY-TX-MINI-IND    NUMERIC   and         0000000
083290                         SAY-TX-MINI-IND    NOT  =  ZERO)         0000000
083300                      or                                          0000000
083310                       (SAY-TX-MAXI-IND    NUMERIC   AND          0000000
083320                        SAY-TX-MAXI-IND    >  ZERO   and          0000000
083330                        SAY-TX-MAXI-IND    <  50)                 0000000
083340                                                                  0000000
083350                     MOVE 'TAUX VARIABLE CAPE ' TO IPPPRI-TITPRET20000000
083360                    else                                          0000000
083370                     MOVE 'TAUX VARIABLE      ' TO IPPPRI-TITPRET20000000
083380                    End-if                                        0000000
083390                  Else                                            0000000
083400                    MOVE 'TAUX INDEXE    '  TO IPPPRI-TITPRET2    0000000
083410          Else                                                    0000000
083420            MOVE 'TAUX REVISABLE '   TO IPPPRI-TITPRET2           0000000
083430            MOVE      2              TO IPPPRI-VARTAUX            0000000
083440         END-IF                                                   0000000
083450     END-IF.                                                      0000000
083460                                                                  0000000
083470D    DISPLAY  'VARTAUX ' IPPPRI-VARTAUX.                          0000000
083480*                                                                 0000000
083490     MOVE  SAY-CINDEX         TO  W-CINDEX                        0000000
083500                                                                  0000000
083510                                                                  0000000
083520                                                                  0000000
083530d    display 'APPEL-CLE =' APPEL-CLE                              0000000
083540                                                                  0000000
083550d    display 'SAY-CD-COND-SAL =' SAY-CD-COND-SAL                  0000000
083560     If avenant  and                                              0000000
083570        (( say-cindex  =  '023CN' or '373CN')                     0000000
083580           or   cpt-salcm  =  1 )                                 0000000
083590        Move  '2'  to  IPPPRI-INDPRSAL                            0000000
083600     Else                                                         0000000
083610                                                                  0000000
083620       IF (ORGS01-FEDE-CEE  or                                    0000000
083630           ORGS01-BANQUE-CIC)                                     0000000
083640          and  nb-pret-salarie  not  =  zero                      0000000
083650           If  SAY-COND-SAL-IMMO-TR1                              0000000
083660               if  say-vtau  =  '1'                               0000000
083670                 MOVE '6' TO IPPPRI-INDPRSAL                      0000000
083680               Else                                               0000000
083690                 If say-cnat  =  '264'  or  '265'                 0000000
083700                   MOVE '3' TO IPPPRI-INDPRSAL                    0000000
083710                 Else                                             0000000
083720                   MOVE '7' TO IPPPRI-INDPRSAL                    0000000
083730                 End-if                                           0000000
083740               End-if                                             0000000
083750           Else                                                   0000000
083760               If  SAY-COND-SAL-IMMO-TR2                          0000000
083770                   if  say-vtau  =  '1'                           0000000
083780                       MOVE '8' TO IPPPRI-INDPRSAL                0000000
083790                   Else                                           0000000
083800                       If say-cnat  =  '264'  or  '265'           0000000
083810                         MOVE '4' TO IPPPRI-INDPRSAL              0000000
083820                       Else                                       0000000
083830                         MOVE '9' TO IPPPRI-INDPRSAL              0000000
083840                       End-if                                     0000000
083850                   End-if                                         0000000
083860               Else                                               0000000
083870                   If  SAY-COND-SAL-CONSO                         0000000
083880                       MOVE '5' TO IPPPRI-INDPRSAL                0000000
083890                   End-if                                         0000000
083900               End-if                                             0000000
083910          End-if                                                  0000000
083920       End-if                                                     0000000
083930     End-if.                                                      0000000
083940d    display 'IPPPRI-INDPRSAL =' IPPPRI-INDPRSAL                  0000000
083950                                                                  0000000
083960     IF  ( ORGS01-FEDE-CEE AND NOT ORGS01-ASSIMILE-IDF)           0000000
083970        If    index-cee-ancien    or                              0000000
083980              index-cee-conso     or                              0000000
083990              index-cee-tr1       or                              0000000
084000              index-cee-tr1-pc    or                              0000000
084010              index-cee-tr2       or                              0000000
084020              index-cee-tr2-pc    or                              0000000
084030              index-cee-ex        or                              0000000
084040              index-f33-conso     or                              0000000
084050              index-f33-tr1       or                              0000000
084060              index-f33-tr2                                       0000000
084070              MOVE '1' TO IPPPRI-INDPRSAL.                        0000000
084080*                                                                 0000000
084090       IF  LANGUE-ALLEMANDE                                       0000000
084100           IF  IPPPRI-TITPRET2  =  'TAUX FIXE'                    0000000
084110               MOVE 'FESTEN '   TO IPPPRI-TITPRET2                0000000
084120           ELSE                                                   0000000
084130           IF  IPPPRI-TITPRET2  =  'TAUX VARIABLE'                0000000
084140           OR  IPPPRI-TITPRET2  =  'TAUX REVISABLE'               0000000
084150               MOVE 'VERNDERLICHEN '  TO IPPPRI-TITPRET2         0000000
084160           ELSE                                                   0000000
084170           IF  IPPPRI-TITPRET2  =  'TAUX INDEXE'                  0000000
084180               MOVE 'INDEXGEBUNDENEN ' TO IPPPRI-TITPRET2         0000000
084190           .                                                      0000000
084200*                                                                 0000000
084210       IF   IPPMA2-LABEL-APPLI = 'IPI'                            0000000
084220            IF  EDIT-INDEX                                        0000000
084230                PERFORM CLAUSES-VARTAUX-IPI-T                     0000000
084240            ELSE                                                  0000000
084250                PERFORM CLAUSES-VARTAUX-IMMO                      0000000
084260       ELSE                                                       0000000
084270            IF  EDIT-INDEX                                        0000000
084280                PERFORM CLAUSES-VARTAUX-IPP-T                     0000000
084290            ELSE                                                  0000000
084300                PERFORM CLAUSES-VARTAUX-PROF.                     0000000
084310*                                                                 0000000
084320*                                                                 0000000
084330     IF   IPPMA2-LABEL-APPLI = 'IPI'                              0000000
084340          PERFORM CLAUSES-AUTRES-IMMO                             0000000
084350     ELSE                                                         0000000
084360          PERFORM CLAUSES-AUTRES-PROF.                            0000000
084370*                                                                 0000000
084380     PERFORM  CLAUSES-REMBOURSEMENT.                              0000000
084390                                                                  0000000
084400                                                                  0000000
084410     PERFORM  CLAUSES-AUTRES-PRESCRIP.                            0000000
084420                                                                  0000000
084430                                                                  0000000
084440*                                                                 0000000
084450     IF ORGS01-FEDE-CEE                                           0000000
084460       OR ORGS01-FEDE-LAVAL                                       0000000
084470       OR  ORGS01-FEDE-CICP                                       0000000
084480       OR  ORGS01-FEDE-ARRAS                                      0000000
084490       OR  ORGS01-FEDE-CMO                                        0000000
084500*--        ORGS01-FEDE-CMA                                        0000000
084510                                                                  0000000
084520          IF  IPPMA2-LABEL-APPLI = 'IPI'                          0000000
084530              PERFORM TITPRET123-IMMO-11                          0000000
084540          ELSE                                                    0000000
084550              PERFORM TITPRET3-PROF-11                            0000000
084560     ELSE                                                         0000000
084570          IF  IPPMA2-LABEL-APPLI = 'IPI'                          0000000
084580              PERFORM TITPRET123-IMMO                             0000000
084590          ELSE                                                    0000000
084600              PERFORM TITPRET3-PROF.                              0000000
084610****                                                              0000000
084620     MOVE SAY-DCMAJ            TO Z-DCMAJ.                        0000000
084630     MOVE SAY-CMAJ             TO Z-CMAJ (IP).                    0000000
084640     MOVE SAY-DOMICIL          TO Z-DOMICIL(IP).                  0000000
084650                                                                  0000000
084660*------------------                                               0000000
084670 AFFECT-VARTAUX-34.                                               0000000
084680*------------------                                               0000000
084690* Chatel2    rien                                                 0000000
084700     IF (SAY-CINDEX(1:3)  = '188'  or  '023')                     0000000
084710         MOVE      5              TO IPPPRI-VARTAUX               0000000
084720     ELSE                                                         0000000
084730         IF  SAY-VTAU  =  '4'                                     0000000
084740             MOVE  4    TO  IPPPRI-VARTAUX                        0000000
084750         ELSE                                                     0000000
084760             MOVE  3    TO  IPPPRI-VARTAUX.                       0000000
084770*                                                                 0000000
084780*--------------                                                   0000000
084790 TITPRET3-PROF.                                                   0000000
084800*--------------                                                   0000000
084810     IF Z-MODEGEST = 1                                            0000000
084820        MOVE 'REMBOURSEMENT DEGRESSIF '  TO IPPPRI-TITPRET3       0000000
084830        MOVE 1 TO IPPPRI-MODEGEST                                 0000000
084840     ELSE                                                         0000000
084850     IF Z-MODEGEST = 2                                            0000000
084860        MOVE 'REMBOURSEMENT CONSTANT  '  TO IPPPRI-TITPRET3       0000000
084870        MOVE 2 TO IPPPRI-MODEGEST                                 0000000
084880     ELSE                                                         0000000
084890     IF Z-MODEGEST = 4                                            0000000
084900        MOVE 'REMBOURSEMENT PROGRESSIF ' TO IPPPRI-TITPRET3       0000000
084910        MOVE 4 TO IPPPRI-MODEGEST                                 0000000
084920     ELSE                                                         0000000
084930     IF Z-MODEGEST = 6                                            0000000
084940        MOVE 'REMBOURSEMENT DIVERS ' TO IPPPRI-TITPRET3           0000000
084950        MOVE 6 TO IPPPRI-MODEGEST.                                0000000
084960*---------------                                                  0000000
084970 TITPRET123-IMMO.                                                 0000000
084980*                                                                 0000000
084990     IF   Z-TYPPRET = 'EL'                                        0000000
085000          PERFORM TITPRET123-IMMO-EL                              0000000
085010     ELSE PERFORM TITPRET123-IMMO-PO.                             0000000
085020                                                                  0000000
085030*------------------                                               0000000
085040 TITPRET123-IMMO-PO.                                              0000000
085050*------------------                                               0000000
085060****                                                              0000000
085070     IF   Z-MODEGEST  =  1                                        0000000
085080          PERFORM TITPRET123-IMMO-1                               0000000
085090     ELSE                                                         0000000
085100     IF   Z-MODEGEST  =  2                                        0000000
085110          MOVE 'REMBOURSEMENT CONSTANT  '  TO IPPPRI-TITPRET3     0000000
085120          MOVE 2 TO IPPPRI-MODEGEST                               0000000
085130     ELSE                                                         0000000
085140     IF   Z-MODEGEST  =  4                                        0000000
085150          MOVE 'REMBOURSEMENT PROGRESSIF ' TO IPPPRI-TITPRET3     0000000
085160          MOVE 4 TO IPPPRI-MODEGEST                               0000000
085170     ELSE                                                         0000000
085180     IF Z-MODEGEST = 6                                            0000000
085190        MOVE 'REMBOURSEMENT DIVERS '        TO IPPPRI-TITPRET3    0000000
085200        MOVE 6 TO IPPPRI-MODEGEST.                                0000000
085210                                                                  0000000
085220*------------------                                               0000000
085230 TITPRET123-IMMO-1.                                               0000000
085240*------------------                                               0000000
085250                                                                  0000000
085260     MOVE 1 TO IPPPRI-MODEGEST.                                   0000000
085270                                                                  0000000
085280     IF   SAY-TAUD   NUMERIC                                      0000000
085290          AND  SAY-TAUDB  =  ZERO                                 0000000
085300          MOVE 2 TO IPPPRI-MODEGEST                               0000000
085310          MOVE 'REMBOURSEMENT CONSTANT  '  TO IPPPRI-TITPRET3     0000000
085320     ELSE                                                         0000000
085330          MOVE 'REMBOURSEMENT DEGRESSIF '  TO IPPPRI-TITPRET3.    0000000
085340*------------------                                               0000000
085350 TITPRET123-IMMO-1-11.                                            0000000
085360*------------------                                               0000000
085370                                                                  0000000
085380     MOVE 1 TO IPPPRI-MODEGEST.                                   0000000
085390                                                                  0000000
085400     IF   SAY-TAUD   NUMERIC                                      0000000
085410          AND  SAY-TAUDB  =  ZERO                                 0000000
085420          MOVE 2 TO IPPPRI-MODEGEST                               0000000
085430          MOVE 'CONSTANT  '  TO IPPPRI-TITPRET3                   0000000
085440     ELSE                                                         0000000
085450          MOVE 'DEGRESSIF '  TO IPPPRI-TITPRET3.                  0000000
085460*------------------                                               0000000
085470 TITPRET123-IMMO-EL.                                              0000000
085480*------------------                                               0000000
085490                                                                  0000000
085500     MOVE 'TAUX FIXE  '                 TO IPPPRI-TITPRET2.       0000000
085510     MOVE 'REMBOURSEMENT CONSTANT  '  TO IPPPRI-TITPRET3.         0000000
085520     MOVE 2 TO IPPPRI-MODEGEST.                                   0000000
085530                                                                  0000000
085540*                                                                 0000000
085550*--------------                                                   0000000
085560 TITPRET3-PROF-11.                                                0000000
085570*--------------                                                   0000000
085580     IF Z-MODEGEST = 1                                            0000000
085590        MOVE 'REMBOURSEMENT DEGRESSIF '  TO IPPPRI-TITPRET3       0000000
085600        MOVE 1 TO IPPPRI-MODEGEST                                 0000000
085610     ELSE                                                         0000000
085620     IF Z-MODEGEST = 2                                            0000000
085630        MOVE 'REMBOURSEMENT CONSTANT  '  TO IPPPRI-TITPRET3       0000000
085640        MOVE 2 TO IPPPRI-MODEGEST                                 0000000
085650     ELSE                                                         0000000
085660     IF Z-MODEGEST = 4                                            0000000
085670        IF  SAY-MODGES-NEW  =  '1'                                0000000
085680            MOVE 2  TO IPPPRI-MODEGEST                            0000000
085690            MOVE 'CONSTANT,  paliers '  TO IPPPRI-TITPRET3       0000000
085700        ELSE                                                      0000000
085710            MOVE 'PROGRESSIF ' TO IPPPRI-TITPRET3                 0000000
085720        END-IF                                                    0000000
085730        MOVE 4 TO IPPPRI-MODEGEST                                 0000000
085740     ELSE                                                         0000000
085750     IF Z-MODEGEST = 6                                            0000000
085760        MOVE 'REMBOURSEMENT DIVERS '      TO IPPPRI-TITPRET3      0000000
085770        MOVE 6 TO IPPPRI-MODEGEST.                                0000000
085780*---------------                                                  0000000
085790 TITPRET123-IMMO-11.                                              0000000
085800*                                                                 0000000
085810     IF   Z-TYPPRET = 'EL'                                        0000000
085820          PERFORM TITPRET123-IMMO-EL                              0000000
085830     ELSE PERFORM TITPRET123-IMMO-PO-11.                          0000000
085840                                                                  0000000
085850*------------------                                               0000000
085860 TITPRET123-IMMO-PO-11.                                           0000000
085870*------------------                                               0000000
085880****                                                              0000000
085890     IF   Z-MODEGEST  =  1                                        0000000
085900          PERFORM TITPRET123-IMMO-1-11                            0000000
085910     ELSE                                                         0000000
085920     IF   Z-MODEGEST  =  2                                        0000000
085930          MOVE 'CONSTANT  '  TO IPPPRI-TITPRET3                   0000000
085940          MOVE 2 TO IPPPRI-MODEGEST                               0000000
085950     ELSE                                                         0000000
085960     IF  Z-MODEGEST  =  4                                         0000000
085970        IF  SAY-MODGES-NEW  =  '1'                                0000000
085980          MOVE 'CONSTANT,  paliers '  TO IPPPRI-TITPRET3         0000000
085990        ELSE                                                      0000000
086000          MOVE 'PROGRESSIFS ' TO IPPPRI-TITPRET3                  0000000
086010        END-IF                                                    0000000
086020        MOVE 4 TO IPPPRI-MODEGEST                                 0000000
086030     ELSE                                                         0000000
086040     IF Z-MODEGEST = 6                                            0000000
086050        MOVE 'DIVERS '        TO IPPPRI-TITPRET3                  0000000
086060        MOVE 6 TO IPPPRI-MODEGEST.                                0000000
086070                                                                  0000000
086080     IF  LANGUE-ALLEMANDE                                         0000000
086090         IF  IPPPRI-TITPRET3  =  'CONSTANT   '                    0000000
086100             MOVE 'gleichen Raten '   TO IPPPRI-TITPRET3          0000000
086110         ELSE                                                     0000000
086120         IF  IPPPRI-TITPRET3  =  'DEGRESSIF'                      0000000
086130             MOVE 'degressiven Raten' TO IPPPRI-TITPRET3          0000000
086140         ELSE                                                     0000000
086150         IF  IPPPRI-TITPRET3  =  'DIVERS'                         0000000
086160             MOVE 'sonstigen Raten '  TO IPPPRI-TITPRET3          0000000
086170         ELSE                                                     0000000
086180         IF  IPPPRI-TITPRET3  =  'PROGESSIF'                      0000000
086190             MOVE 'progessiven Raten' TO IPPPRI-TITPRET3          0000000
086200         ELSE                                                     0000000
086210         IF  IPPPRI-TITPRET3  =  'CONSTANT,  paliers '           0000000
086220             MOVE 'gleichbleibenden Raten'  TO IPPPRI-TITPRET3.   0000000
086230                                                                  0000000
086240*------------------                                               0000000
086250 CLAUSES-VARTAUX-IMMO.                                            0000000
086260*--------------------                                             0000000
086270D    DISPLAY 'CLAUSES-VARTAUX DEBUT'.                             0000000
086280D    DISPLAY '-IP          = ' IP.                                0000000
086290D    DISPLAY '-CLAUSIER-VARTAUX DEBUT = ' CLAUSIER-VARTAUX.       0000000
086300     MOVE ZERO TO W-VARTAUX.                                      0000000
086310*                                                                 0000000
086320**** IPI : CLAUSE VARIABILITE DU TAUX                             0000000
086330* -- 05/92 PC-265 ----- 04/93  PC-FGAS ------                     0000000
086340                                                                  0000000
086350     IF  (Z-TYPPRET = 'PO'                                        0000000
086360          OR (Z-TYPPRET = 'PC' ))                                 0000000
086370             AND  (IPPPRI-VARTAUX = 2 )                           0000000
086380             AND  ICLAUV LESS THAN 10                             0000000
086390          IF   (ORGS01-FEDE-CEE )                                 0000000
086400               IF  ORGS01-CAISSE                                  0000000
086410                   ADD  1    TO ICLAUV                            0000000
086420                   MOVE IP   TO D-VARTAUX-PRET (ICLAUV)           0000000
086430                   MOVE 0100 TO D-VARTAUX (ICLAUV)                0000000
086440               ELSE                                               0000000
086450                  IF  ORGS01-BANQUE-BECM                          0000000
086460                      ADD  1    TO ICLAUV                         0000000
086470                      MOVE IP   TO D-VARTAUX-PRET (ICLAUV)        0000000
086480                      MOVE 0200 TO D-VARTAUX (ICLAUV)             0000000
086490                  Else                                            0000000
086500                      ADD  1    TO ICLAUV                         0000000
086510                      MOVE IP   TO D-VARTAUX-PRET (ICLAUV)        0000000
086520                      MOVE 0100 TO D-VARTAUX (ICLAUV).            0000000
086530*                                                                 0000000
086540                                                                  0000000
086550     IF    ORGS01-FEDE-CEE     and                                0000000
086560           IPPPRI-VARTAUX = 5  and                                0000000
086570           IPXPRO-OPTION-TX-FIXE                                  0000000
086580           ADD  1      TO  ICLAUV                                 0000000
086590           MOVE IP     TO  D-VARTAUX-PRET (ICLAUV)                0000000
086600           MOVE 1482   TO  D-VARTAUX (ICLAUV)                     0000000
086610     End-if.                                                      0000000
086620*                                                                 0000000
086630***> IPI : INDEXATION                                             0000000
086640*                                                                 0000000
086650     IF  (IPPPRI-VARTAUX  =  3  OR  4  or  5)                     0000000
086660          PERFORM PROCESSUS-INDEXATION-IMMO.                      0000000
086670                                                                  0000000
086680     IF   W-VARTAUX NOT = ZERO                                    0000000
086690     AND  ICLAUV LESS THAN 10                                     0000000
086700          ADD 1 TO ICLAUV                                         0000000
086710          MOVE IP   TO D-VARTAUX-PRET (ICLAUV)                    0000000
086720          MOVE W-VARTAUX TO D-VARTAUX (ICLAUV).                   0000000
086730                                                                  0000000
086740*    IF (orgs01-assimile-cmm                                      0000000
086750*    AND (SAY-VTAU   NOT =  '1' )                                 0000000
086760*    AND  ICLAUV LESS THAN 10 )                                   0000000
086770*         ADD  1    TO ICLAUV                                     0000000
086780*         MOVE IP   TO D-VARTAUX-PRET (ICLAUV)                    0000000
086790*         MOVE 0700 TO D-VARTAUX (ICLAUV).                        0000000
086800*                                                                 0000000
086810                                                                  0000000
086820*--  FORCAGE CLAUSE INDEX salarie mettre descrip. index t2        0000000
086830*--                                         si t1 seul.           0000000
086840     IF  ((ORGS01-FEDE-CEE AND NOT ORGS01-ASSIMILE-IDF)  or       0000000
086850           ORGS01-FEDE-ANTILLES )                                 0000000
086860      and  index-cee-tr1                                          0000000
086870      AND  ICLAUV LESS THAN 10                                    0000000
086880        IF  SALARIE-TR1-2  = 1                                    0000000
086890          ADD 1 TO ICLAUV                                         0000000
086900          MOVE IP   TO D-VARTAUX-PRET (ICLAUV)                    0000000
086910             IF ORGS01-FEDE-ANTILLES                              0000000
086920                MOVE  1153 TO D-VARTAUX (ICLAUV)                  0000000
086930             ELSE                                                 0000000
086940               IF  not ( ORGS01-ASSIMILE-CMSMB )                  0000000
086950                   MOVE  1733 TO D-VARTAUX (ICLAUV).              0000000
086960                                                                  0000000
086970                                                                  0000000
086980D    DISPLAY 'CLAUSES-VARTAUX FIN'.                               0000000
086990D    DISPLAY '-IP          = ' IP.                                0000000
087000D    DISPLAY '-CLAUSIER-VARTAUX FIN   = ' CLAUSIER-VARTAUX.       0000000
087010*                                                                 0000000
087020*--------------------                                             0000000
087030 CLAUSES-VARTAUX-IPP-T.                                           0000000
087040*--------------------                                             0000000
087050*                                                                 0000000
087060     MOVE  '*NOMINDEX'      TO IPPPRI-NOMINDEX.                   0000000
087070     MOVE  1451 TO D-VARTAUX (1).                                 0000000
087080     MOVE  1452 TO D-VARTAUX (2).                                 0000000
087090     MOVE  1453 TO D-VARTAUX (3).                                 0000000
087100     MOVE  1454 TO D-VARTAUX (4).                                 0000000
087110**   MOVE  1269 TO D-VARTAUX (5).                                 0000000
087120*    MOVE  1218 TO D-VARTAUX (6).                                 0000000
087130*    MOVE  1219 TO D-VARTAUX (7).                                 0000000
087140*    MOVE  1263 TO D-VARTAUX (8).                                 0000000
087150**   MOVE  1013 TO D-VARTAUX (9).                                 0000000
087160                                                                  0000000
087170*--------------------                                             0000000
087180 CLAUSES-VARTAUX-IPI-T.                                           0000000
087190*--------------------                                             0000000
087200*                                                                 0000000
087210     MOVE  1287 TO D-VARTAUX (1).                                 0000000
087220     MOVE  1288 TO D-VARTAUX (2).                                 0000000
087230     MOVE  1289 TO D-VARTAUX (3).                                 0000000
087240     MOVE  1290 TO D-VARTAUX (4).                                 0000000
087250*    MOVE  1158 TO D-VARTAUX (5).                                 0000000
087260                                                                  0000000
087270*--------------------                                             0000000
087280 CLAUSES-VARTAUX-PROF.                                            0000000
087290*--------------------                                             0000000
087300     IF   ICLAUV LESS THAN 10                                     0000000
087310          PERFORM CLAUSES-VARTAUX-PROF-OK.                        0000000
087320*-----------------------                                          0000000
087330 CLAUSES-VARTAUX-PROF-OK.                                         0000000
087340*-----------------------                                          0000000
087350     MOVE ZERO TO W-VARTAUX.                                      0000000
087360     IF   IPPMA2-2-CNAT9 (IP) = 220                               0000000
087370          ADD 1 TO ICLAUV                                         0000000
087380          MOVE IP   TO D-VARTAUX-PRET (ICLAUV)                    0000000
087390          MOVE 0100          TO D-VARTAUX (ICLAUV)                0000000
087400     ELSE                                                         0000000
087410     IF   IPPMA2-2-CNAT9 (IP) = 221 OR = 222 OR = 366             0000000
087420          ADD 1 TO ICLAUV                                         0000000
087430          MOVE IP   TO D-VARTAUX-PRET (ICLAUV)                    0000000
087440          MOVE 0200          TO D-VARTAUX (ICLAUV)                0000000
087450     ELSE                                                         0000000
087460     IF   IPPMA2-2-CNAT9 (IP) = 360 OR = 361                      0000000
087470          ADD 1 TO ICLAUV                                         0000000
087480          MOVE IP   TO D-VARTAUX-PRET (ICLAUV)                    0000000
087490          MOVE 0300          TO D-VARTAUX (ICLAUV)                0000000
087500     ELSE                                                         0000000
087510*FG-0190-PROVISOIREMENT MODIFIE POUR TEST AGRICULTURE             0000000
087520*                                                                 0000000
087530                                                                  0000000
087540     IF   (IPPMA2-2-CNAT9 (IP) > 600 AND < 610) OR                0000000
087550          (IPPMA2-2-CNAT (IP) = '620' OR '621')                   0000000
087560                                                                  0000000
087570          ADD 1 TO ICLAUV                                         0000000
087580          MOVE IP   TO D-VARTAUX-PRET (ICLAUV)                    0000000
087590          MOVE 0400          TO D-VARTAUX (ICLAUV)                0000000
087600     ELSE                                                         0000000
087610*                                                                 0000000
087620     IF   IPPPRI-VARTAUX = 1                                      0000000
087630          IF  ORGS01-FEDE-CAEN                                    0000000
087640               ADD 1 TO ICLAUV                                    0000000
087650               MOVE IP   TO D-VARTAUX-PRET (ICLAUV)               0000000
087660               MOVE 0500       TO D-VARTAUX (ICLAUV)              0000000
087670          ELSE NEXT SENTENCE                                      0000000
087680     ELSE                                                         0000000
087690     IF   IPPPRI-VARTAUX = 2                                      0000000
087700          IF  ORGS01-FEDE-CAEN                                    0000000
087710               ADD 1 TO ICLAUV                                    0000000
087720               MOVE IP   TO D-VARTAUX-PRET (ICLAUV)               0000000
087730               MOVE 0600       TO D-VARTAUX (ICLAUV)              0000000
087740          ELSE ADD 1 TO ICLAUV                                    0000000
087750               MOVE IP   TO D-VARTAUX-PRET (ICLAUV)               0000000
087760               MOVE 0500       TO D-VARTAUX (ICLAUV)              0000000
087770     ELSE                                                         0000000
087780     IF  (IPPPRI-VARTAUX =  3  OR  4  OR  5 )                     0000000
087790          PERFORM PROCESSUS-INDEXATION-PROF.                      0000000
087800D    DISPLAY 'W-VARTAUX ' W-VARTAUX.                              0000000
087810     IF W-VARTAUX NOT = ZERO                                      0000000
087820        ADD 1 TO ICLAUV                                           0000000
087830        MOVE IP   TO D-VARTAUX-PRET (ICLAUV)                      0000000
087840        MOVE W-VARTAUX         TO D-VARTAUX (ICLAUV).             0000000
087850*                                                                 0000000
087860*                                                                 0000000
087870D    DISPLAY ' CLAUSIER-VARTAUX ' CLAUSIER-VARTAUX.               0000000
087880*------------------                                               0000000
087890 CLAUSES-AUTRES-IMMO.                                             0000000
087900*------------------                                               0000000
087910D    DISPLAY 'CLAUSES-AUTRES DEBUT'.                              0000000
087920D    DISPLAY '-IP          = ' IP.                                0000000
087930D    DISPLAY '-CLAUSIER-AUTRES  DEBUT = ' CLAUSIER-AUTRES.        0000000
087940D    DISPLAY 'ICLAUA  '  ICLAUA.                                  0000000
087950D    DISPLAY 'TYPPRET '  Z-TYPPRET.                               0000000
087960                                                                  0000000
087970D    IF  AVENANT                                                  0000000
087980D        DISPLAY  APPEL-CLE ' ' APPEL-CAT                         0000000
087990D        DISPLAY ' VTAU   '  SAY-VTAU                             0000000
088000D        DISPLAY ' INDEX  '  SAY-CINDEX.                          0000000
088010                                                                  0000000
088020     IF   Z-TYPPRET = 'PC'                                        0000000
088030     AND  ICLAUA LESS THAN NB-CLA                                 0000000
088040          ADD 1 TO ICLAUA                                         0000000
088050          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
088060          IF   IPPMA2-CD-SOUS-PROD (IP) = '020'                   0000000
088070               MOVE 4102 TO D-AUTRES (ICLAUA)                     0000000
088080          Else                                                    0000000
088090               MOVE 4100 TO D-AUTRES (ICLAUA)                     0000000
088100          End-if                                                  0000000
088110                                                                  0000000
088120          IF   SAY-VTAU   =  '1'                                  0000000
088130               ADD  1  TO  ICLAUA                                 0000000
088140               MOVE IP   TO D-AUTRES-PRET (ICLAUA)                0000000
088150               IF   IPPMA2-CD-SOUS-PROD (IP) = '020'              0000000
088160                    MOVE 4103 TO D-AUTRES (ICLAUA)                0000000
088170               Else                                               0000000
088180                    MOVE 4101 TO D-AUTRES (ICLAUA)                0000000
088190               End-if                                             0000000
088200          ELSE                                                    0000000
088210               IF   Z-MODEGEST = 2                                0000000
088220                    ADD 1 TO ICLAUA                               0000000
088230                    MOVE IP   TO D-AUTRES-PRET (ICLAUA)           0000000
088240                    MOVE 4110 TO D-AUTRES (ICLAUA).               0000000
088250*sup           ELSE                                               0000000
088260* le 23/05/05  IF   Z-MODEGEST = 4                                0000000
088270*                   ADD 1 TO ICLAUA                               0000000
088280*                   MOVE IP   TO D-AUTRES-PRET (ICLAUA)           0000000
088290*                   MOVE 4120 TO D-AUTRES (ICLAUA).               0000000
088300D    DISPLAY  'CLAUSIER-AUTRES ' CLAUSIER-AUTRES.                 0000000
088310**** CONDITIONS PROPRES AUX EL                                    0000000
088320     IF   Z-TYPPRET = 'EL'                                        0000000
088330     AND  ICLAUA LESS THAN NB-CLA                                 0000000
088340          ADD 1 TO ICLAUA                                         0000000
088350          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
088360          MOVE 4200          TO D-AUTRES (ICLAUA).                0000000
088370**** ENGAGEMENT D'OCCUPATION EL (INDOCCUP = 1 A 5)                0000000
088380**** SUSPENDU : CA SORT POUT TOUT TYPE DE PRET                    0000000
088390**** SAUF LES TERRAINS/FINANCEMENTS DIVERS                        0000000
088400**** IF   Z-TYPPRET = 'EL'                                        0000000
088410     IF   IPPMA2-OBJET-DOS GREATER THAN '109'                     0000000
088420     AND  IPPMA2-OBJET-DOS LESS    THAN '160'                     0000000
088430     AND  ICLAUA LESS THAN NB-CLA                                 0000000
088440          IF   IPPPRI-INDOCCUP = 1                                0000000
088450               ADD 1 TO ICLAUA                                    0000000
088460               MOVE IP   TO D-AUTRES-PRET (ICLAUA)                0000000
088470               MOVE 4210          TO D-AUTRES (ICLAUA)            0000000
088480          ELSE                                                    0000000
088490          IF   IPPPRI-INDOCCUP = 2                                0000000
088500               ADD 1 TO ICLAUA                                    0000000
088510               MOVE IP   TO D-AUTRES-PRET (ICLAUA)                0000000
088520               MOVE 4220          TO D-AUTRES (ICLAUA)            0000000
088530          ELSE                                                    0000000
088540          IF   IPPPRI-INDOCCUP = 3                                0000000
088550               ADD 1 TO ICLAUA                                    0000000
088560               MOVE IP   TO D-AUTRES-PRET (ICLAUA)                0000000
088570               MOVE 4230          TO D-AUTRES (ICLAUA)            0000000
088580          ELSE                                                    0000000
088590          IF   IPPPRI-INDOCCUP = 4                                0000000
088600               ADD 1 TO ICLAUA                                    0000000
088610               MOVE IP   TO D-AUTRES-PRET (ICLAUA)                0000000
088620               MOVE 4240          TO D-AUTRES (ICLAUA)            0000000
088630          ELSE                                                    0000000
088640          IF   IPPPRI-INDOCCUP = 5                                0000000
088650               ADD 1 TO ICLAUA                                    0000000
088660               MOVE IP   TO D-AUTRES-PRET (ICLAUA)                0000000
088670               MOVE 4250          TO D-AUTRES (ICLAUA).           0000000
088680*                                                                 0000000
088690*    07.92-SALARIES-CEE                                           0000000
088700**** IPI : CLAUSE VARIABLE SALARIE BFCM ---> CEE                  0000000
088710*                                                                 0000000
088720     IF   (ORGS01-FEDE-CEE  or                                    0000000
088730           ORGS01-FEDE-ANTILLES )                                 0000000
088740                                                                  0000000
088750        If (index-cee-tr1  or                                     0000000
088760            index-cee-tr2  or                                     0000000
088770            index-f33-tr1  or                                     0000000
088780            index-f33-tr2)                                        0000000
088790        AND  ICLAUA    <      NB-CLA                              0000000
088800               ADD  1    TO ICLAUA                                0000000
088810               MOVE IP   TO D-AUTRES-PRET (ICLAUA)                0000000
088820               IF ORGS01-FEDE-ANTILLES                            0000000
088830                  MOVE 4552 TO D-AUTRES  (ICLAUA)                 0000000
088840               ELSE                                               0000000
088850                 IF ORGS01-assimile-idf                           0000000
088860                    MOVE 4410 TO D-AUTRES  (ICLAUA)               0000000
088870                 Else                                             0000000
088880                    MOVE 4400 TO D-AUTRES  (ICLAUA)               0000000
088890                 END-IF                                           0000000
088900               END-IF                                             0000000
088910               if  index-cee-tr1  or                              0000000
088920                   index-f33-tr1                                  0000000
088930                   ADD  1    TO ICLAUA                            0000000
088940                   MOVE IP   TO D-AUTRES-PRET (ICLAUA)            0000000
088950                   MOVE 4500 TO D-AUTRES  (ICLAUA).               0000000
088960                                                                  0000000
088970                                                                  0000000
088980     IF   (ORGS01-FEDE-CEE )                                      0000000
088990       AND ( index-cee-tr1-pc  or   index-cee-tr2-pc  )           0000000
089000       AND  ICLAUA   <  NB-CLA                                    0000000
089010          ADD  1    TO ICLAUA                                     0000000
089020          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
089030          if  orgs01-assimile-idf                                 0000000
089040              MOVE 4460 TO D-AUTRES  (ICLAUA)                     0000000
089050          Else                                                    0000000
089060              MOVE 4451 TO D-AUTRES  (ICLAUA)                     0000000
089070              If  index-cee-tr1-pc                                0000000
089080                    AND  ICLAUA   <  NB-CLA                       0000000
089090                ADD  1    TO ICLAUA                               0000000
089100                MOVE IP   TO D-AUTRES-PRET (ICLAUA)               0000000
089110                MOVE 4551 TO D-AUTRES  (ICLAUA)                   0000000
089120              End-if                                              0000000
089130          End-if                                                  0000000
089140     End-if.                                                      0000000
089150                                                                  0000000
089160*--  SALAR-210694 FEDE 21--                                       0000000
089170D    DISPLAY 'IP            = ' IP.                               0000000
089180D    DISPLAY 'IPPMA2-FED    = ' IPPMA2-FED.                       0000000
089190D    DISPLAY '     w-CINDEX = '      W-CINDEX                     0000000
089200D    DISPLAY 'ICLAUA        = ' ICLAUA.                           0000000
089210*    IF   orgs01-assimile-cmm                                     0000000
089220*         IF  ( W-CINDEX      = '15014'                           0000000
089230*            OR  SALARIE-MARSEILLE  =  1 )                        0000000
089240*            IF  ICLAUA LESS THAN NB-CLA                          0000000
089250*                ADD  1    TO ICLAUA                              0000000
089260*                MOVE IP   TO D-AUTRES-PRET (ICLAUA)              0000000
089270**               MOVE 4500 TO D-AUTRES  (ICLAUA).                 0000000
089280*--  IMMO MARSEILLE                                               0000000
089290*    IF (orgs01-assimile-cmm)                                     0000000
089300*     and IPPMA2-2-CNAT (IP) = '200' AND                          0000000
089310*         ICLAUA LESS THAN NB-CLA                                 0000000
089320*         ADD  1    TO ICLAUA                                     0000000
089330*         MOVE 4600 TO D-AUTRES  (ICLAUA).                        0000000
089340                                                                  0000000
089350*    IF ( orgs01-assimile-cmm ) and                               0000000
089360*         SAY-VTER    =  1           AND                          0000000
089370*         ICLAUA LESS THAN NB-CLA                                 0000000
089380*         ADD  1    TO ICLAUA                                     0000000
089390*         MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
089400*         MOVE 4440 TO D-AUTRES  (ICLAUA).                        0000000
089410                                                                  0000000
089420*--  MODULIMMO                                                    0000000
089430                                                                  0000000
089440     IF  (IPPMA2-2-CNAT (IP) = '293' )                            0000000
089450* Sup le 31/03/2008 demande de M. Gambet.                         0000000
089460*        and  not  (IPPMA2-CD-SOUS-PROD (IP)  =  '077') )         0000000
089470     AND  ICLAUA LESS THAN NB-CLA                                 0000000
089480          ADD  1    TO ICLAUA                                     0000000
089490          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
089500          MOVE 4050 TO D-AUTRES  (ICLAUA).                        0000000
089510                                                                  0000000
089520*--  PASA Ville Amiens                                            0000000
089530                                                                  0000000
089540     If (IPPMA2-2-CNAT (IP) = '200'  and                          0000000
089550         IPPMA2-CD-SOUS-PROD (IP)  =  '080')                      0000000
089560         if  ICLAUA LESS THAN NB-CLA                              0000000
089570             ADD  1    TO ICLAUA                                  0000000
089580             MOVE IP   TO D-AUTRES-PRET (ICLAUA)                  0000000
089590             MOVE 4080 TO D-AUTRES  (ICLAUA).                     0000000
089600                                                                  0000000
089610*--  Mixte                                                        0000000
089620                                                                  0000000
089630     IF   IPXPRO-CREDIT-MIXTE                                     0000000
089640     AND  ICLAUA LESS THAN NB-CLA                                 0000000
089650          ADD  1    TO ICLAUA                                     0000000
089660          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
089670          MOVE 4049 TO D-AUTRES  (ICLAUA).                        0000000
089680                                                                  0000000
089690*--  psah lille                                                   0000000
089700                                                                  0000000
089710     IF  ORGS01-FEDE-ARRAS  AND                                   0000000
089720         IPPMA2-2-CNAT (IP) = '300'                               0000000
089730         if  ICLAUA LESS THAN NB-CLA                              0000000
089740             ADD  1    TO ICLAUA                                  0000000
089750             MOVE IP   TO D-AUTRES-PRET (ICLAUA)                  0000000
089760             MOVE 4902 TO D-AUTRES  (ICLAUA).                     0000000
089770                                                                  0000000
089780*--  psla laval  307 00                                           0000000
089790* sbo31102007 la sort deja avec l'index 152DB                     0000000
089800*                                                                 0000000
089810*    IF  ORGS01-FEDE-LAVAL  AND                                   0000000
089820*       (IPPMA2-2-CNAT (IP) = '307'  and                          0000000
089830*        IPPMA2-CD-SOUS-PROD (IP)  =  zero)                       0000000
089840*        if  ICLAUA LESS THAN NB-CLA                              0000000
089850*            ADD  1    TO ICLAUA                                  0000000
089860*            MOVE IP   TO D-AUTRES-PRET (ICLAUA)                  0000000
089870*            MOVE 1656 TO D-AUTRES  (ICLAUA).                     0000000
089880                                                                  0000000
089890*--  psla laval  265 60  264 61                                   0000000
089900                                                                  0000000
089910     IF  ORGS01-FEDE-LAVAL                                        0000000
089920         If ((IPPMA2-2-CNAT (IP) = '265'  and                     0000000
089930              IPPMA2-CD-SOUS-PROD (IP)  =  '060')  or             0000000
089940             (IPPMA2-2-CNAT (IP) = '264'  and                     0000000
089950              IPPMA2-CD-SOUS-PROD (IP)  =  '061'))                0000000
089960              if  ICLAUA LESS THAN NB-CLA                         0000000
089970                  ADD  1    TO ICLAUA                             0000000
089980                  MOVE IP   TO D-AUTRES-PRET (ICLAUA)             0000000
089990                  MOVE 1657 TO D-AUTRES  (ICLAUA).                0000000
090000                                                                  0000000
090010d    display 'IPPMA2-GARANTIE ' IPPMA2-2-CODE-GARANTIE (IP 1)     0000000
090020     IF (( IPPMA2-2-CODE-GARANTIE (IP 1) = '30' OR '31')          0000000
090030           OR ( IPPMA2-2-CODE-GARANTIE (IP 2) = '30' OR '31'))    0000000
090040              IF   ICLAUA LESS THAN NB-CLA                        0000000
090050d                  display '4000'                                 0000000
090060                   ADD  1    TO ICLAUA                            0000000
090070                   MOVE IP   TO D-AUTRES-PRET (ICLAUA)            0000000
090080                   MOVE 4000 TO D-AUTRES  (ICLAUA).               0000000
090090                                                                  0000000
090100*  ACM Caution                                                    0000000
090110                                                                  0000000
090120     IF  ORGS01-FEDE-CICP                                         0000000
090130         if (( IPPMA2-2-CODE-GARANTIE (IP 1) = '42' )             0000000
090140               OR ( IPPMA2-2-CODE-GARANTIE (IP 2) = '42' ))       0000000
090150                  IF   ICLAUA LESS THAN NB-CLA                    0000000
090160                       ADD  1    TO ICLAUA                        0000000
090170                       MOVE IP   TO D-AUTRES-PRET (ICLAUA)        0000000
090180                       MOVE 4901 TO D-AUTRES  (ICLAUA).           0000000
090190                                                                  0000000
090200     IF ( ORGS01-FEDE-CEE  or  ORGS01-FEDE-ANTILLES )             0000000
090210       if ((IPPMA2-2-CODE-GARANTIE(IP 1) =                        0000000
090220                          'GL' or 'GM' or 'GN' or 'GP' or 'GQ' )  0000000
090230        or (IPPMA2-2-CODE-GARANTIE(IP 2) =                        0000000
090240                          'GL' or 'GM' or 'GN' or 'GP' or 'GQ' )  0000000
090250        or (IPPMA2-2-CODE-GARANTIE(IP 3) =                        0000000
090260                          'GL' or 'GM' or 'GN' or 'GP' or 'GQ' )  0000000
090270        or (IPPMA2-2-CODE-GARANTIE(IP 4) =                        0000000
090280                          'GL' or 'GM' or 'GN' or 'GP' or 'GQ' )) 0000000
090290                  IF   ICLAUA LESS THAN NB-CLA                    0000000
090300                       ADD  1    TO ICLAUA                        0000000
090310                       MOVE IP   TO D-AUTRES-PRET (ICLAUA)        0000000
090320                       MOVE 4001 TO D-AUTRES  (ICLAUA).           0000000
090330                                                                  0000000
090340     IF  ORGS01-FEDE-CEE  or  ORGS01-FEDE-ANTILLES                0000000
090350         if (( IPPMA2-2-CODE-GARANTIE (IP 1) = 'A1' )             0000000
090360               OR ( IPPMA2-2-CODE-GARANTIE (IP 2) = 'A1' )        0000000
090370               OR ( IPPMA2-2-CODE-GARANTIE (IP 3) = 'A1' )        0000000
090380               OR ( IPPMA2-2-CODE-GARANTIE (IP 4) = 'A1' ))       0000000
090390                  IF   ICLAUA LESS THAN NB-CLA                    0000000
090400                       ADD  1    TO ICLAUA                        0000000
090410                       MOVE IP   TO D-AUTRES-PRET (ICLAUA)        0000000
090420                       If ippma2-devise  =  'EUR'                 0000000
090430                         MOVE 3960 TO D-AUTRES  (ICLAUA)          0000000
090440                       Else                                       0000000
090450                         MOVE 3970 TO D-AUTRES  (ICLAUA).         0000000
090460* Caution Mutaris En plus de 274  on sort la clausp 4992          0000000
090470     if (( IPPMA2-2-CODE-GARANTIE (IP 1) = 'UH' or 'UN')          0000000
090480           OR ( IPPMA2-2-CODE-GARANTIE (IP 2) = 'UH' or 'UN')     0000000
090490           OR ( IPPMA2-2-CODE-GARANTIE (IP 3) = 'UH' or 'UN')     0000000
090500           OR ( IPPMA2-2-CODE-GARANTIE (IP 4) = 'UH' or 'UN'))    0000000
090510           IF   ICLAUA LESS THAN NB-CLA                           0000000
090520                ADD  1    TO ICLAUA                               0000000
090530                MOVE IP   TO D-AUTRES-PRET (ICLAUA)               0000000
090540d               display 'sbo06062007 4992 position'              0000000
090550                MOVE 4992 TO D-AUTRES  (ICLAUA).                  0000000
090560                                                                  0000000
090570*--  PRET A TAUX ZERO CNAT = 291                                  0000000
090580     IF   IPPMA2-2-CNAT (IP) = '291'                              0000000
090590     AND  ICLAUA LESS THAN NB-CLA                                 0000000
090600          ADD  1    TO ICLAUA                                     0000000
090610          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
090620          MOVE 4800 TO D-AUTRES  (ICLAUA).                        0000000
090630                                                                  0000000
090640*--  PRET pcas  clause 4850 ( scurisation )                      0000000
090650d    display 'exist-prtcpt ' exist-prtcpt                         0000000
090660d    display 'cp2-datouv   ' cp2-datouv                           0000000
090670                                                                  0000000
090680     IF   IPPMA2-2-CNAT (IP) = '264'                              0000000
090690     AND  ICLAUA LESS THAN NB-CLA                                 0000000
090700          IF   EXIST-PRTCPT  =  1   AND                           0000000
090710               CP2-DATOUV  <  '20040101'                          0000000
090720               ADD  1    TO ICLAUA                                0000000
090730               MOVE IP   TO D-AUTRES-PRET (ICLAUA)                0000000
090740               MOVE 4850 TO D-AUTRES  (ICLAUA)                    0000000
090750          End-if                                                  0000000
090760     End-if.                                                      0000000
090770                                                                  0000000
090780*--  PRET A TAUX ZERO CNAT = 304                                  0000000
090790     IF   IPPMA2-2-CNAT (IP) = '304'                              0000000
090800     AND  ICLAUA LESS THAN NB-CLA                                 0000000
090810          ADD  1    TO ICLAUA                                     0000000
090820          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
090830          MOVE 4801 TO D-AUTRES  (ICLAUA).                        0000000
090840                                                                  0000000
090850*--  prets evolutifs                                              0000000
090860                                                                  0000000
090870     IF   IPPMA2-CD-SOUS-PROD (IP) = '026'  AND                   0000000
090880          ICLAUA LESS THAN NB-CLA                                 0000000
090890          ADD  1    TO ICLAUA                                     0000000
090900          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
090910d         display   '4802'                                        0000000
090920          MOVE 4802 TO D-AUTRES  (ICLAUA).                        0000000
090930                                                                  0000000
090940*--  prets paris logement  PPL                                    0000000
090950                                                                  0000000
090960     IF   IPXPRO-PPL     AND                                      0000000
090970          ICLAUA LESS THAN NB-CLA                                 0000000
090980          ADD  1    TO ICLAUA                                     0000000
090990          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
091000d         display   '4804'                                        0000000
091010          MOVE 4804 TO D-AUTRES  (ICLAUA).                        0000000
091020*--  prets Eco-PTZ                                                0000000
091030                                                                  0000000
091040     IF   IPXPRO-Eco-ptz AND                                      0000000
091050          ICLAUA LESS THAN NB-CLA                                 0000000
091060          ADD  1    TO ICLAUA                                     0000000
091070          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
091080d         display   '4809'                                        0000000
091090          MOVE 4809 TO D-AUTRES  (ICLAUA).                        0000000
091100                                                                  0000000
091110*--  prets paris logement  92                                     0000000
091120                                                                  0000000
091130     IF   IPXPRO-PL92  and                                        0000000
091140          ICLAUA LESS THAN NB-CLA                                 0000000
091150          ADD  1    TO ICLAUA                                     0000000
091160          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
091170d         display   '4805'                                        0000000
091180          MOVE 4805 TO D-AUTRES  (ICLAUA).                        0000000
091190                                                                  0000000
091200*--  prets o% CAEN                                                0000000
091210                                                                  0000000
091220     IF   IPXPRO-ptz-caen  and                                    0000000
091230          ICLAUA LESS THAN NB-CLA                                 0000000
091240          ADD  1    TO ICLAUA                                     0000000
091250          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
091260d         display   '4014'                                        0000000
091270          MOVE 4014 TO D-AUTRES  (ICLAUA).                        0000000
091280                                                                  0000000
091290                                                                  0000000
091300*--  prets o% Orlans                                             0000000
091310                                                                  0000000
091320     IF   IPXPRO-ptz-orleans  and                                 0000000
091330          ICLAUA LESS THAN NB-CLA                                 0000000
091340          ADD  1    TO ICLAUA                                     0000000
091350          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
091360d         display   '4045'                                        0000000
091370          MOVE 4045 TO D-AUTRES  (ICLAUA).                        0000000
091380                                                                  0000000
091390*--  prets o% Nantes                                              0000000
091400                                                                  0000000
091410     IF   IPXPRO-PL44  and                                        0000000
091420          ICLAUA LESS THAN NB-CLA                                 0000000
091430          ADD  1    TO ICLAUA                                     0000000
091440          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
091450d         display   '4962'                                        0000000
091460          MOVE 4962 TO D-AUTRES  (ICLAUA).                        0000000
091470                                                                  0000000
091480*--  PC 264 ET LILLE                                              0000000
091490     IF ((IPPMA2-2-CNAT (IP) = '264'                              0000000
091500      AND  ORGS01-FEDE-ARRAS)                                     0000000
091510*--  PC 264 ou 265 et caen                                        0000000
091520     OR ((IPPMA2-2-CNAT (IP) = '264' OR '265')                    0000000
091530      AND  ORGS01-FEDE-CAEN))                                     0000000
091540      IF  ICLAUA LESS THAN NB-CLA                                 0000000
091550          ADD  1    TO ICLAUA                                     0000000
091560          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
091570          MOVE 4060 TO D-AUTRES  (ICLAUA).                        0000000
091580                                                                  0000000
091590*--  PRETS EXPERIMENTAUX                                          0000000
091600     IF   IPPMA2-2-CNAT (IP) = '290'                              0000000
091610     AND  ICLAUA LESS THAN NB-CLA                                 0000000
091620          ADD  1    TO ICLAUA                                     0000000
091630          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
091640          MOVE 4750 TO D-AUTRES  (ICLAUA).                        0000000
091650                                                                  0000000
091660*--  PRETS EN  DEVISES  out                                       0000000
091670*                                                                 0000000
091680*    INITIALIZE EUREXP.                                           0000000
091690*    MOVE SAY-DEVISE TO EUREXP-DEVISE-ENT.                        0000000
091700*                                                                 0000000
091710*    CALL 'ZCALLPGF' USING ZEUREXP                                0000000
091720*                          UNDELETE                               0000000
091730*                          EUREXP.                                0000000
091740*                                                                 0000000
091750*    IF  not  EXP-OK                                              0000000
091760     IF  SAY-DEVISE not = 'EUR'                                   0000000
091770         IF  ICLAUA LESS THAN NB-CLA                              0000000
091780             ADD  1    TO ICLAUA                                  0000000
091790             MOVE IP   TO D-AUTRES-PRET (ICLAUA)                  0000000
091800             MOVE 4700 TO D-AUTRES  (ICLAUA).                     0000000
091810                                                                  0000000
091820*--  FONDS D'HABITAT LOCATIF RURAL - HAUTE SAONE                  0000000
091830     IF   (IPPMA2-2-CNAT (IP) = '200' OR '265' OR '293' )         0000000
091840          MOVE SAY-LSPRT  TO W-LSBONIF                            0000000
091850D         DISPLAY 'SAY-RACINE =' SAY-RACINE                       0000000
091860D         DISPLAY 'SAY-LSPRT =' SAY-LSPRT                         0000000
091870          IF   W-BONIF-OK1                                        0000000
091880           AND ICLAUA LESS THAN NB-CLA                            0000000
091890               ADD  1    TO ICLAUA                                0000000
091900               MOVE IP   TO D-AUTRES-PRET (ICLAUA)                0000000
091910               MOVE 4600 TO D-AUTRES  (ICLAUA)                    0000000
091920          ELSE                                                    0000000
091930          IF   W-BONIF-OK2                                        0000000
091940           AND ICLAUA LESS THAN NB-CLA                            0000000
091950               ADD  1    TO ICLAUA                                0000000
091960               MOVE IP   TO D-AUTRES-PRET (ICLAUA)                0000000
091970               MOVE 4650 TO D-AUTRES  (ICLAUA).                   0000000
091980                                                                  0000000
091990                                                                  0000000
092000*--  CIC                                                          0000000
092010                                                                  0000000
092020     IF  ORGS01-BANQUE-CIC                                        0000000
092030*        if  IPXPRO-CIC-NV-GAMME                                  0000000
092040*                                                   IMMODULIS     0000000
092050            IF  ipxpro-cic-20000  or ipxpro-cic-30705             0000000
092060                                  or ipxpro-cic-29377             0000000
092070                IF  ICLAUA LESS THAN NB-CLA                       0000000
092080                    ADD  1    TO ICLAUA                           0000000
092090                    MOVE IP   TO D-AUTRES-PRET (ICLAUA)           0000000
092100d                   display 'clause 20000 4923'                   0000000
092110                    MOVE 4923 TO D-AUTRES  (ICLAUA)               0000000
092120                End-if                                            0000000
092130            Else                                                  0000000
092140*                                                   PPH   20030   0000000
092150             IF  ipxpro-cic-20030                                 0000000
092160                 IF  ICLAUA LESS THAN NB-CLA                      0000000
092170                     ADD  1    TO ICLAUA                          0000000
092180                     MOVE IP   TO D-AUTRES-PRET (ICLAUA)          0000000
092190                     MOVE 4922 TO D-AUTRES  (ICLAUA)              0000000
092200                 End-if                                           0000000
092210             Else                                                 0000000
092220*                                                   PPH+  20032   0000000
092230             IF  say-cnat  =  '200'  and                          0000000
092240                 say-cd-sous-prod  =  '032'                       0000000
092250                 IF  ICLAUA LESS THAN NB-CLA                      0000000
092260                     ADD  1    TO ICLAUA                          0000000
092270                     MOVE IP   TO D-AUTRES-PRET (ICLAUA)          0000000
092280                     MOVE 4939 TO D-AUTRES  (ICLAUA)              0000000
092290                 End-if                                           0000000
092300             Else                                                 0000000
092310*                                                   IMMO LIBERTE  0000000
092320              IF  ipxpro-cic-20017                                0000000
092330                  IF  ICLAUA LESS THAN NB-CLA                     0000000
092340                      ADD  1    TO ICLAUA                         0000000
092350                      MOVE IP   TO D-AUTRES-PRET (ICLAUA)         0000000
092360                      if  say-vter  =  '1'                        0000000
092370                          MOVE 4924 TO D-AUTRES  (ICLAUA)         0000000
092380                      Else                                        0000000
092390                          MOVE 4929 TO D-AUTRES  (ICLAUA)         0000000
092400                      End-if                                      0000000
092410                      ADD  1    TO ICLAUA                         0000000
092420                      MOVE IP   TO D-AUTRES-PRET (ICLAUA)         0000000
092430                      MOVE 4923 TO D-AUTRES  (ICLAUA)             0000000
092440                  End-if                                          0000000
092450              Else                                                0000000
092460*                                                   IMMINVEST     0000000
092470               IF  ipxpro-cic-20038                               0000000
092480                   IF  ICLAUA LESS THAN NB-CLA                    0000000
092490                       ADD  1    TO ICLAUA                        0000000
092500                       MOVE IP   TO D-AUTRES-PRET (ICLAUA)        0000000
092510                       MOVE 4925 TO D-AUTRES  (ICLAUA)            0000000
092520                       ADD  1    TO ICLAUA                        0000000
092530                       MOVE IP   TO D-AUTRES-PRET (ICLAUA)        0000000
092540                       MOVE 4928 TO D-AUTRES  (ICLAUA)            0000000
092550                   End-if                                         0000000
092560                                                                  0000000
092570               Else                                               0000000
092580*                                                   IMMO SERENITE 0000000
092590                IF  ipxpro-cic-20094                              0000000
092600                    IF  ICLAUA LESS THAN NB-CLA                   0000000
092610                        ADD  1    TO ICLAUA                       0000000
092620                        MOVE IP   TO D-AUTRES-PRET (ICLAUA)       0000000
092630                         if  say-vter  =  '1'                     0000000
092640                             MOVE 4926 TO D-AUTRES  (ICLAUA)      0000000
092650                         Else                                     0000000
092660                             MOVE 4931 TO D-AUTRES  (ICLAUA)      0000000
092670                         End-if                                   0000000
092680                    End-if                                        0000000
092690                 Else                                             0000000
092700*                                                   IMMO SECURITE 0000000
092710                 IF  ipxpro-cic-20016                             0000000
092720                     IF  ICLAUA LESS THAN NB-CLA                  0000000
092730                         ADD  1    TO ICLAUA                      0000000
092740                         MOVE IP   TO D-AUTRES-PRET (ICLAUA)      0000000
092750                         if  say-vter  =  '1'                     0000000
092760                             MOVE 4927 TO D-AUTRES  (ICLAUA)      0000000
092770                         Else                                     0000000
092780                             MOVE 4930 TO D-AUTRES  (ICLAUA)      0000000
092790                         End-if                                   0000000
092800                     End-if                                       0000000
092810                 Else                                             0000000
092820*                                                  relais / infine0000000
092830                  if (IPPMA2-2-cnat  (ip)    = '218'  and         0000000
092840                      IPPMA2-CD-SOUS-PROD (ip) = '017' )          0000000
092850                      IF  ICLAUA LESS THAN NB-CLA                 0000000
092860                          ADD  1    TO ICLAUA                     0000000
092870                          MOVE IP   TO D-AUTRES-PRET (ICLAUA)     0000000
092880                          MOVE 4928 TO D-AUTRES  (ICLAUA)         0000000
092890                      End-if                                      0000000
092900                  Else                                            0000000
092910*  Ancien produit ..................                              0000000
092920*  pret  1re habitation  20030                                   0000000
092930         IF  ipxpro-1habitation                                   0000000
092940             IF  ICLAUA LESS THAN NB-CLA                          0000000
092950                 ADD  1    TO ICLAUA                              0000000
092960                 MOVE IP   TO D-AUTRES-PRET (ICLAUA)              0000000
092970                 MOVE 4072 TO D-AUTRES  (ICLAUA)                  0000000
092980             END-IF                                               0000000
092990         ELSE                                                     0000000
093000*  pret  immocap          20031                                   0000000
093010         IF  ipxpro-immocap                                       0000000
093020             IF  ICLAUA LESS THAN NB-CLA                          0000000
093030                 ADD  1    TO ICLAUA                              0000000
093040                 MOVE IP   TO D-AUTRES-PRET (ICLAUA)              0000000
093050                 MOVE 4070 TO D-AUTRES  (ICLAUA)                  0000000
093060             END-IF                                               0000000
093070         ELSE                                                     0000000
093080*  pret  relaismatic      20032  +  21832                         0000000
093090*        IF  ipxpro-immorelaismatic                               0000000
093100*            IF  ICLAUA LESS THAN NB-CLA                          0000000
093110*                ADD  1    TO ICLAUA                              0000000
093120*                MOVE IP   TO D-AUTRES-PRET (ICLAUA)              0000000
093130*                MOVE 4074 TO D-AUTRES  (ICLAUA)                  0000000
093140*            END-IF                                               0000000
093150*        ELSE                                                     0000000
093160*  pret  immovar          20029                                   0000000
093170         IF  ipxpro-immovar                                       0000000
093180             IF  ICLAUA LESS THAN NB-CLA                          0000000
093190                 ADD  1    TO ICLAUA                              0000000
093200                 MOVE IP   TO D-AUTRES-PRET (ICLAUA)              0000000
093210                 MOVE 4071 TO D-AUTRES  (ICLAUA)                  0000000
093220             END-IF                                               0000000
093230         ELSE                                                     0000000
093240*  pret  invest.  37                                              0000000
093250         IF  IPXPRO-INVESTIS-37                                   0000000
093260             IF  ICLAUA LESS THAN NB-CLA                          0000000
093270                 ADD  1    TO ICLAUA                              0000000
093280                 MOVE IP   TO D-AUTRES-PRET (ICLAUA)              0000000
093290                 MOVE 4075 TO D-AUTRES  (ICLAUA)                  0000000
093300             END-IF                                               0000000
093310         ELSE                                                     0000000
093320*  pret  invest.  38                                              0000000
093330         IF  IPXPRO-INVESTIS-38                                   0000000
093340             IF  ICLAUA LESS THAN NB-CLA                          0000000
093350                 ADD  1    TO ICLAUA                              0000000
093360                 MOVE IP   TO D-AUTRES-PRET (ICLAUA)              0000000
093370                 MOVE 4076 TO D-AUTRES  (ICLAUA)                  0000000
093380             END-IF                                               0000000
093390         ELSE                                                     0000000
093400*  pret  invest.  39                                              0000000
093410         IF  IPXPRO-INVESTIS-39                                   0000000
093420             IF  ICLAUA LESS THAN NB-CLA                          0000000
093430                 ADD  1    TO ICLAUA                              0000000
093440                 MOVE IP   TO D-AUTRES-PRET (ICLAUA)              0000000
093450                 MOVE 4077 TO D-AUTRES  (ICLAUA)                  0000000
093460             END-IF                                               0000000
093470         END-IF                                                   0000000
093480     END-IF.                                                      0000000
093490*                                                                 0000000
093500* sbo15112007  ajout pour 29377                                   0000000
093510*                                                                 0000000
093520     IF ipxpro-cic-29377                                          0000000
093530        IF ICLAUA LESS THAN NB-CLA                                0000000
093540            ADD            1    TO ICLAUA                         0000000
093550            MOVE IP             TO D-AUTRES-PRET (ICLAUA)         0000000
093560            if            say-vter  =  '1'                        0000000
093570                MOVE 4940 TO D-AUTRES            (ICLAUA)         0000000
093580            Else                                                  0000000
093590                MOVE 4941 TO D-AUTRES            (ICLAUA)         0000000
093600            End-if                                                0000000
093610        End-if                                                    0000000
093620     end-if                                                       0000000
093630                                                                  0000000
093640     IF  IPXPRO-CIC-REVENTE                                       0000000
093650         IF  ICLAUA LESS THAN NB-CLA                              0000000
093660             ADD  1    TO ICLAUA                                  0000000
093670             MOVE IP   TO D-AUTRES-PRET (ICLAUA)                  0000000
093680             MOVE 4934 TO D-AUTRES  (ICLAUA)                      0000000
093690         End-if                                                   0000000
093700                                                                  0000000
093710         IF  ipxpro-cic-30716                                     0000000
093720             IF  ICLAUA LESS THAN NB-CLA                          0000000
093730                 ADD  1    TO ICLAUA                              0000000
093740                 MOVE IP   TO D-AUTRES-PRET (ICLAUA)              0000000
093750                 if  say-vter  =  '1'                             0000000
093760                     MOVE 4938 TO D-AUTRES  (ICLAUA)              0000000
093770                 Else                                             0000000
093780                     MOVE 4937 TO D-AUTRES  (ICLAUA)              0000000
093790                 End-if                                           0000000
093800                                                                  0000000
093810             Else                                                 0000000
093820                IF  ipxpro-cic-30794                              0000000
093830                    IF  ICLAUA LESS THAN NB-CLA                   0000000
093840                        ADD  1    TO ICLAUA                       0000000
093850                        MOVE IP   TO D-AUTRES-PRET (ICLAUA)       0000000
093860                         if  say-vter  =  '1'                     0000000
093870                             MOVE 4936 TO D-AUTRES  (ICLAUA)      0000000
093880                         Else                                     0000000
093890                             MOVE 4935 TO D-AUTRES  (ICLAUA)      0000000
093900                         End-if                                   0000000
093910                End-if                                            0000000
093920             End-if                                               0000000
093930         End-if                                                   0000000
093940     End-if.                                                      0000000
093950                                                                  0000000
093960*  pret  bonifie meteo - france                                   0000000
093970                                                                  0000000
093980     IF  SAY-CD-SOUS-PROD  =  '027'                               0000000
093990         MOVE 'O'      TO  METEO-PREVU                            0000000
094000         IF  ICLAUA LESS THAN NB-CLA                              0000000
094010             ADD  1    TO  ICLAUA                                 0000000
094020             MOVE IP   TO D-AUTRES-PRET (ICLAUA)                  0000000
094030             MOVE 4950 TO  D-AUTRES  (ICLAUA)                     0000000
094040         END-IF                                                   0000000
094050     END-IF.                                                      0000000
094060*                                                                 0000000
094070*                                                                 0000000
094080*  CM Logigaz                                                     0000000
094090                                                                  0000000
094100     IF  (IPXPRO-LOGISGAZ )                                       0000000
094110         IF  ICLAUA LESS THAN NB-CLA                              0000000
094120             ADD  1    TO  ICLAUA                                 0000000
094130             MOVE IP   TO D-AUTRES-PRET (ICLAUA)                  0000000
094140             MOVE 4803 TO  D-AUTRES  (ICLAUA)                     0000000
094150         END-IF                                                   0000000
094160     END-IF.                                                      0000000
094170*                                                                 0000000
094180                                                                  0000000
094190D    DISPLAY 'CLAUSES-AUTRES IPI FIN  '.                          0000000
094200D    DISPLAY '-IP          = ' IP.                                0000000
094210D    DISPLAY '-CLAUSIER-AUTRES  FIN   = ' CLAUSIER-AUTRES.        0000000
094220*------------------                                               0000000
094230 CLAUSES-AUTRES-PROF.                                             0000000
094240*------------------                                               0000000
094250*    MOVE SAY-LSPRT TO W-LSAGRICOLE.                              0000000
094260*FG-0190-PROVISOIREMENT MODIFIE POUR TEST AGRICULTURE             0000000
094270     IF   (IPPMA2-2-CNAT9 (IP) > 600 AND < 610) OR                0000000
094280          (IPPMA2-2-CNAT (IP) = '620' OR '621')                   0000000
094290     AND   ICLAUA LESS THAN NB-CLA                                0000000
094300          ADD 1 TO ICLAUA                                         0000000
094310          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
094320          MOVE 6100          TO D-AUTRES (ICLAUA).                0000000
094330**** 16/04/91                                                     0000000
094340**** RAJOUT CLAUSE SI CODE PRODUIT 608/609                        0000000
094350     IF   (IPPMA2-2-CNAT9 (IP) = 608 OR 609)                      0000000
094360     AND   ICLAUA LESS THAN NB-CLA                                0000000
094370          ADD 1 TO ICLAUA                                         0000000
094380          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
094390          MOVE 6200          TO D-AUTRES (ICLAUA).                0000000
094400*                                                                 0000000
094410**** 09/04/99                                                     0000000
094420**** RAJOUT CLAUSE SI CODE PRODUIT 373                            0000000
094430     IF   (IPPMA2-2-CNAT9 (IP) = 373 )                            0000000
094440       AND   ICLAUA LESS THAN NB-CLA                              0000000
094450          ADD 1 TO ICLAUA                                         0000000
094460          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
094470          MOVE 6500          TO D-AUTRES (ICLAUA).                0000000
094480*                                                                 0000000
094490*         -SALARIES-CEE                                           0000000
094500**** IPI : CLAUSE VARIABLE SALARIE CEE - CONSOMMATION             0000000
094510     IF   (ORGS01-FEDE-CEE AND NOT ORGS01-ASSIMILE-IDF)           0000000
094520       AND  ( W-CINDEX   = '07527' OR '06114' OR '06214'          0000000
094530                                   OR '46114' )                   0000000
094540       AND  ICLAUA LESS THAN NB-CLA                               0000000
094550          ADD  1    TO ICLAUA                                     0000000
094560          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
094570          MOVE 6300 TO D-AUTRES  (ICLAUA).                        0000000
094580                                                                  0000000
094590*--  PRETS EN  DEVISES                                            0000000
094600*    IF   NOT  ( IPPMA2-DEVISE   =  'FRF'  OR 'EUR')              0000000
094610     IF   NOT  ( IPPMA2-DEVISE   =  'EUR')                        0000000
094620          IF  ICLAUA LESS THAN NB-CLA                             0000000
094630              ADD  1    TO ICLAUA                                 0000000
094640              MOVE IP   TO D-AUTRES-PRET (ICLAUA)                 0000000
094650              MOVE 6400 TO D-AUTRES  (ICLAUA).                    0000000
094660*                                                                 0000000
094670*--  PROF MARSEILLE VTER                                          0000000
094680                                                                  0000000
094690*    IF (orgs01-assimile-cmm) and                                 0000000
094700*         SAY-VTER    =  1           AND                          0000000
094710*         ICLAUA LESS THAN NB-CLA                                 0000000
094720*         ADD  1    TO ICLAUA                                     0000000
094730*         MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
094740*         MOVE 4440 TO D-AUTRES  (ICLAUA).                        0000000
094750                                                                  0000000
094760* modulagri                                                       0000000
094770     IF ( IPPMA2-2-CNAT9 (IP) = 600 OR  610  OR  612 )            0000000
094780       AND ( APPEL-FED = '17'                                     0000000
094790        OR ( ORGS01-ASSIMILE-IDF AND W-CINDEX  =  SPACE ))        0000000
094800                                                                  0000000
094810          ADD 1 TO ICLAUA                                         0000000
094820          MOVE IP   TO D-AUTRES-PRET (ICLAUA)                     0000000
094830D         DISPLAY     ' 0417 OK '                                 0000000
094840          MOVE 0417          TO D-AUTRES (ICLAUA).                0000000
094850*                                                                 0000000
094860     IF ( IPXPRO-BONIF-EDF )                                      0000000
094870        ADD  1   TO  ICLAUA                                       0000000
094880        MOVE IP   TO D-AUTRES-PRET (ICLAUA)                       0000000
094890        MOVE 6550          TO D-AUTRES (ICLAUA)                   0000000
094900     END-IF                                                       0000000
094910     .                                                            0000000
094920                                                                  0000000
094930     if  (SAY-CNAT          =  '214'  AND                         0000000
094940             SAY-CD-SOUS-PROD  =  '095' )                         0000000
094950             IF  ICLAUA LESS THAN NB-CLA                          0000000
094960               ADD  1    TO ICLAUA                                0000000
094970               MOVE IP   TO D-AUTRES-PRET (ICLAUA)                0000000
094980               if  ipxpro-cic-nv-gamme-c                          0000000
094990                   MOVE 4949 TO D-AUTRES  (ICLAUA)                0000000
095000               Else                                               0000000
095010                   MOVE 4918 TO D-AUTRES  (ICLAUA)                0000000
095020               END-IF                                             0000000
095030             END-IF                                               0000000
095040     END-IF.                                                      0000000
095050                                                                  0000000
095060     IF  ORGS01-FEDE-CEE  or  ORGS01-FEDE-ANTILLES                0000000
095070         if ((IPPMA2-2-CODE-GARANTIE(IP 1)  =  'A1' )             0000000
095080               OR ( IPPMA2-2-CODE-GARANTIE (IP 2) = 'A1' )        0000000
095090               OR ( IPPMA2-2-CODE-GARANTIE (IP 3) = 'A1' )        0000000
095100               OR ( IPPMA2-2-CODE-GARANTIE (IP 4) = 'A1' ))       0000000
095110                  IF   ICLAUA LESS THAN NB-CLA                    0000000
095120                       ADD  1    TO ICLAUA                        0000000
095130                       MOVE IP   TO D-AUTRES-PRET (ICLAUA)        0000000
095140                       If ippma2-devise  =  'EUR'                 0000000
095150                         MOVE 3960 TO D-AUTRES  (ICLAUA)          0000000
095160                       Else                                       0000000
095170                         MOVE 3970 TO D-AUTRES  (ICLAUA).         0000000
095180                                                                  0000000
095190                                                                  0000000
095200D    DISPLAY 'CLAUSES-AUTRES IPP FIN  '.                          0000000
095210D    DISPLAY '-IP          = ' IP.                                0000000
095220D    DISPLAY '-CLAUSIER-AUTRES  FIN   = ' CLAUSIER-AUTRES.        0000000
095230*                                                                 0000000
095240*----------------------                                           0000000
095250 CLAUSES-REMBOURSEMENT.                                           0000000
095260*----------------------                                           0000000
095270                                                                  0000000
095280*                                                                 0000000
095290d    display 'SAY-COD-INDEM-RA ' SAY-COD-INDEM-RA                 0000000
095300     ADD  1    TO  ICLAUA                                         0000000
095310     MOVE IP   TO D-AUTRES-PRET (ICLAUA)                          0000000
095320                                                                  0000000
095330     IF ((ORGS01-BANQUE = '10278' OR '15969' OR '13070' ) AND     0000000
095340           ( IPPMA2-LABEL-APPLI = 'IPC' OR 'IPP'))                0000000
095350             MOVE  SAY-CNAT         to   W-CNAT-RTA               0000000
095360             IF  NOT  COND-CNAT-RTA                               0000000
095370               String '5008'           delimited by size          0000000
095380                                    INTO D-AUTRES (ICLAUA)        0000000
095390             End-if                                               0000000
095400     Else                                                         0000000
095410         If (SAY-COD-INDEM-RA  =  zero   or                       0000000
095420             SAY-COD-INDEM-RA  not  numeric )                     0000000
095430               String '5000'           delimited by size          0000000
095440                                    INTO D-AUTRES (ICLAUA)        0000000
095450         Else                                                     0000000
095460             String '50'  SAY-COD-INDEM-RA delimited by size      0000000
095470                                        INTO D-AUTRES (ICLAUA)    0000000
095480         End-if                                                   0000000
095490     End-if.                                                      0000000
095500                                                                  0000000
095510d    display 'd-autres ' d-autres (iclaua).                       0000000
095520                                                                  0000000
095530                                                                  0000000
095540*-------------------------                                        0000000
095550 PROCESSUS-INDEXATION-IMMO.                                       0000000
095560*-------------------------                                        0000000
095570     IF   NOT (SAY-CINDEX = SPACE OR ZERO OR 'SUP  ')             0000000
095580          PERFORM PROCESSUS-INDEXATION-NEW.                       0000000
095590                                                                  0000000
095600D    DISPLAY 'IPPPRI-NOMINDEX   = '  IPPPRI-NOMINDEX.             0000000
095610D    DISPLAY 'IPPPRI-DATINDEX   = '  IPPPRI-DATINDEX.             0000000
095620D    DISPLAY 'IPPPRI-VALINDEX-X = '  IPPPRI-VALINDEX-X.           0000000
095630D    DISPLAY 'IPPPRI-VALINDE5-X = '  IPPPRI-VALINDE5-X.           0000000
095640                                                                  0000000
095650*-------------------------                                        0000000
095660 PROCESSUS-INDEXATION-PROF.                                       0000000
095670*-------------------------                                        0000000
095680*    PERFORM TRAIT-INDEXATION-PAR-DEFAUT.                         0000000
095690     IF   NOT (SAY-CINDEX = SPACE OR ZERO OR 'SUP  ')             0000000
095700          PERFORM PROCESSUS-INDEXATION-NEW.                       0000000
095710                                                                  0000000
095720*------------------------                                         0000000
095730 PROCESSUS-INDEXATION-NEW.                                        0000000
095740*------------------------                                         0000000
095750D    DISPLAY  'IPPBATCH, LECTURE TABLE PRTINDXX '                 0000000
095760     MOVE  SPACE        TO GESPAR-PRTINDXX                        0000000
095770                           PRTINDXX                               0000000
095780     IF  ORGS01-BANQUE-BECM                                       0000000
095790       MOVE  'PRTIND00' TO W-ZPAVAL-L1003-COD-TAB                 0000000
095800     ELSE                                                         0000000
095810       IF  ORGS01-ASSIMILE-IDF                                    0000000
095820         MOVE  'PRTIND19' TO W-ZPAVAL-L1003-COD-TAB               0000000
095830      ELSE                                                        0000000
095840        IF  ORGS01-ASSIMILE-CMMA                                  0000000
095850          MOVE  'PRTIND22' TO W-ZPAVAL-L1003-COD-TAB              0000000
095860       ELSE                                                       0000000
095870         IF  ORGS01-ASSIMILE-CMSMB                                0000000
095880           MOVE  'PRTIND33' TO W-ZPAVAL-L1003-COD-TAB             0000000
095890         ELSE                                                     0000000
095900           STRING                                                 0000000
095910             'PRTIND'  IPPMA2-FED  DELIMITED BY SIZE              0000000
095920             INTO  W-ZPAVAL-L1003-COD-TAB                         0000000
095930         END-IF                                                   0000000
095940       END-IF                                                     0000000
095950     END-IF                                                       0000000
095960     IF  SAY-CINDEX  =  '24595'  AND  ORGS01-ASSIMILE-CMSMB       0000000
095970       MOVE  'PRTIND11' TO W-ZPAVAL-L1003-COD-TAB                 0000000
095980     END-IF                                                       0000000
095990     MOVE  SAY-CINDEX TO W-ZPAVAL-L1003-CLE-POS-TAB               0000000
096000     IF  W-ZPAVAL-L1003-CLE-POS-TAB(1:3)  =  '002' OR '003'       0000000
096010       MOVE  '245' TO W-ZPAVAL-L1003-CLE-POS-TAB(1:3)             0000000
096020     END-IF                                                       0000000
096030     PERFORM  INIT-ZPARAPEL-L1003                                 0000000
096040     MOVE  W-ZPAVAL-L1003-COD-TAB TO ZPAVAL-L1003-COD-TAB         0000000
096050     MOVE  W-ZPAVAL-L1003-CLE-POS-TAB TO ZPAVAL-L1003-CLE-POS-TAB 0000000
096060     PERFORM  APPEL-ZPARAPEL-L1003                                0000000
096070                                                                  0000000
096080     IF  NOT PARFRE-TRT-CORRECT                                   0000000
096090       DISPLAY 'PBM SUR POSTE GESPAR INDEX '                      0000000
096100         ZPAVAL-L1003-COD-TAB                                     0000000
096110         ' /  RETOUR-CODE = ' PARFRE-COD-RET-PRIMAIRE             0000000
096120     ELSE                                                         0000000
096130**** ATTENTION IL Y A LA BCMI QUI SAISIT EN IPP SANS CONTRAT      0000000
096140**** ET LES CLAUSES NE SONT PAS DEFINIES DANS DIDO                0000000
096150**** ==> POUR OVERRIDER ON A MIS NUMINDEX A 1999 DANS PRTIND19    0000000
096160**** ==> POUR OVERRIDER ON A MIS NUMINDEX A 9999 DANS PRTINDFF    0000000
096170*       POUR NE PAS UTILISER LES INDEX DANS UNE AUTRE FAMILLE.    0000000
096180       MOVE  ZPAVRE-L1003-ZON-VAR-PO        TO GESPAR-PRTINDXX    0000000
096190       MOVE  ZPAVAL-L1003-CLE-POS-TAB       TO PRTINDXX-CLE       0000000
096200       MOVE  GESPAR-PRTINDXX-DEBEFF         TO PRTINDXX-DEBEFF    0000000
096210       MOVE  GESPAR-PRTINDXX-FINEFF         TO PRTINDXX-FINEFF    0000000
096220       MOVE  GESPAR-PRTINDXX-NUMINDEX-IPP   TO                    0000000
096230         PRTINDXX-NUMINDEX-IPP                                    0000000
096240       MOVE  GESPAR-PRTINDXX-NOMINDEX15-IPX TO                    0000000
096250         PRTINDXX-NOMINDEX15-IPX                                  0000000
096260       MOVE  GESPAR-PRTINDXX-NUMINDEX-IPI   TO                    0000000
096270         PRTINDXX-NUMINDEX-IPI                                    0000000
096280       MOVE  GESPAR-PRTINDXX-NUMINDEX-IPC   TO                    0000000
096290         PRTINDXX-NUMINDEX-IPC                                    0000000
096300D      DISPLAY  'TABLE PRTINDXX'                                  0000000
096310D      DISPLAY  ' PRTINDXX-CLE            : ' PRTINDXX-CLE        0000000
096320D      DISPLAY  ' PRTINDXX-DEBEFF         : ' PRTINDXX-DEBEFF     0000000
096330D      DISPLAY  ' PRTINDXX-FINEFF         : ' PRTINDXX-FINEFF     0000000
096340D      DISPLAY  ' PRTINDXX-NUMINDEX-IPP   : '                     0000000
096350d        PRTINDXX-NUMINDEX-IPP                                    0000000
096360D      DISPLAY  ' PRTINDXX-NOMINDEX15-IPX : '                     0000000
096370d        PRTINDXX-NOMINDEX15-IPX                                  0000000
096380D      DISPLAY  ' PRTINDXX-NUMINDEX-IPI   : '                     0000000
096390d        PRTINDXX-NUMINDEX-IPI                                    0000000
096400D      DISPLAY  ' PRTINDXX-NUMINDEX-IPC   : '                     0000000
096410d        PRTINDXX-NUMINDEX-IPC                                    0000000
096420                                                                  0000000
096430       IF (IPPMA2-LABEL-APPLI  =  'IPI'                           0000000
096440*         AND   SPI-CODTAB   =  'PRTIND11')                       0000000
096450          AND   ZPAVAL-L1003-COD-TAB  =  'PRTIND11')              0000000
096460         IF   (PRTINDXX-NUMINDEX-IPI NUMERIC                      0000000
096470              AND  NOT COND-PRTIND-IPI)                           0000000
096480                  MOVE PRTINDXX-NUMINDEX-IPI   TO W-VARTAUX       0000000
096490                  PERFORM AFFECT-ZONES-INDEX                      0000000
096500         ELSE  NEXT SENTENCE                                      0000000
096510       ELSE                                                       0000000
096520         IF (IPPMA2-LABEL-APPLI  =  'IPC' AND                     0000000
096530            (ORGS01-FEDE-CEE AND NOT ORGS01-ASSIMILE-IDF))        0000000
096540           IF   (PRTINDXX-NUMINDEX-IPC NUMERIC                    0000000
096550                AND  NOT COND-PRTIND-IPC)                         0000000
096560                    MOVE PRTINDXX-NUMINDEX-IPC   TO W-VARTAUX     0000000
096570                    PERFORM AFFECT-ZONES-INDEX                    0000000
096580           ELSE  NEXT SENTENCE                                    0000000
096590         ELSE                                                     0000000
096600*  IPP FEDE 11 OU (IPX ET AUTRE FEDE)                             0000000
096610           IF   (PRTINDXX-NUMINDEX-IPP NUMERIC                    0000000
096620                AND  NOT COND-PRTIND-IPP)                         0000000
096630                    MOVE PRTINDXX-NUMINDEX-IPP   TO W-VARTAUX     0000000
096640                    PERFORM AFFECT-ZONES-INDEX.                   0000000
096650                                                                  0000000
096660*-------------------                                              0000000
096670 AFFECT-ZONES-INDEX.                                              0000000
096680*-------------------                                              0000000
096690                                                                  0000000
096700     IF  ORGS01-FEDE-CEE                                          0000000
096710         Perform  index-cee                                       0000000
096720     End-if                                                       0000000
096730                                                                  0000000
096740     IF  ORGS01-FEDE-ARRAS                                        0000000
096750         IF  SAY-VTER  =  '1'                                     0000000
096760             IF (W-VARTAUX   =  '1448' )                          0000000
096770                 MOVE  '1615'  TO  W-VARTAUX                      0000000
096780             Else                                                 0000000
096790               IF (W-VARTAUX   =  '1384' )                        0000000
096800                   MOVE  '1616'  TO  W-VARTAUX                    0000000
096810               Else                                               0000000
096820                 IF (W-VARTAUX   =  '1478' )                      0000000
096830                     MOVE  '1617'  TO  W-VARTAUX                  0000000
096840                 Else                                             0000000
096850*    index  245ZV                                                 0000000
096860                   IF (W-VARTAUX   =  '1702' )                    0000000
096870                       MOVE  '1703'  TO  W-VARTAUX                0000000
096880                   END-IF                                         0000000
096890                 END-IF                                           0000000
096900               END-IF                                             0000000
096910             END-IF                                               0000000
096920         END-IF                                                   0000000
096930     END-IF.                                                      0000000
096940                                                                  0000000
096950                                                                  0000000
096960D    DISPLAY  'W-VARTAUX  '  W-VARTAUX.                           0000000
096970                                                                  0000000
096980     IF (ORGS01-FEDE-CEE )                                        0000000
096990         IF  IPXPRO-BUTOIR-5ANS                                   0000000
097000D        DISPLAY  'IPXPRO-BUTOIR-5ANS '                           0000000
097010             IF (W-VARTAUX   =  '1289' )                          0000000
097020                 MOVE  '1487'  TO  W-VARTAUX                      0000000
097030             Else                                                 0000000
097040               IF (W-VARTAUX   =  '1290' )                        0000000
097050                   MOVE  '1488'  TO  W-VARTAUX                    0000000
097060                                                                  0000000
097070               Else                                               0000000
097080                 IF (W-VARTAUX   =  '1451' )                      0000000
097090                     MOVE  '1493'  TO  W-VARTAUX                  0000000
097100                                                                  0000000
097110                 Else                                             0000000
097120                   IF (W-VARTAUX   =  '1452' )                    0000000
097130                       MOVE  '1494'  TO  W-VARTAUX                0000000
097140                                                                  0000000
097150                   Else                                           0000000
097160                     IF (W-VARTAUX   =  '1453' )                  0000000
097170                         MOVE  '1491'  TO  W-VARTAUX              0000000
097180                                                                  0000000
097190                     Else                                         0000000
097200                       IF (W-VARTAUX   =  '1454' )                0000000
097210                           MOVE  '1492'  TO  W-VARTAUX            0000000
097220                       END-IF                                     0000000
097230                     END-IF                                       0000000
097240                   END-IF                                         0000000
097250                 END-IF                                           0000000
097260               END-IF                                             0000000
097270             END-IF                                               0000000
097280         END-IF                                                   0000000
097290     END-IF.                                                      0000000
097300                                                                  0000000
097310D    DISPLAY  'W-VARTAUX  '  W-VARTAUX.                           0000000
097320                                                                  0000000
097330     IF ( ORGS01-FEDE-CEE AND NOT ORGS01-ASSIMILE-IDF)            0000000
097340              and SAY-DEVISE     =  'CHF'                         0000000
097350         IF  SAY-CINDEX (1 : 3)  =  '290'                         0000000
097360             MOVE 'LIBOR 3 MOIS ' TO  PRTINDXX-NOMINDEX15-IPX     0000000
097370         ELSE                                                     0000000
097380           IF SAY-CINDEX (1 : 3)  =  '280'                        0000000
097390              MOVE 'LIBOR 1 MOIS ' TO  PRTINDXX-NOMINDEX15-IPX    0000000
097400           END-IF                                                 0000000
097410         END-IF                                                   0000000
097420     END-IF.                                                      0000000
097430                                                                  0000000
097440     MOVE PRTINDXX-NOMINDEX15-IPX  TO IPPPRI-NOMINDEX             0000000
097450                                      IPPPRI-LIBINDEX.            0000000
097460                                                                  0000000
097470     IF  SAY-CINDEX  =  '023CN'                                   0000000
097480         MOVE 'Indice CM-CIC Salaris '  TO IPPPRI-LIBINDEX       0000000
097490         Perform  RECHERCHE-TAUX-FIXE                             0000000
097500     End-if                                                       0000000
097510*                                                                 0000000
097520*SUP PERFORM  RECHERCHE-LIBELLE-INDEX.                            0000000
097530*                                                                 0000000
097540     IF   SAY-DINDEX     NUMERIC   AND                            0000000
097550          SAY-DINDEX     NOT   =   ZERO                           0000000
097560                                                                  0000000
097570          PERFORM AFFECT-ZONE-DATINDEX.                           0000000
097580                                                                  0000000
097590                                                                  0000000
097600     IF  ( SAY-CINDEX (1:3) =  '002' OR '003' or '005' )          0000000
097610         PERFORM  RECHERCHE-VALINDEX                              0000000
097620     ELSE                                                         0000000
097630         IF      SAY-VINDEX      NUMERIC                          0000000
097640         AND     SAY-VINDEX      NOT = ZERO                       0000000
097650              MOVE    SAY-VINDEX      TO IPPPRI-VALINDEX.         0000000
097660* VALEUR INDEX SUR 5C.                                            0000000
097670     IF      SAY-TX-VAL-IND  NUMERIC   AND                        0000000
097680             SAY-TX-VAL-IND  NOT = ZERO                           0000000
097690          MOVE    SAY-TX-VAL-IND  TO IPPPRI-VALINDE5.             0000000
097700                                                                  0000000
097710     MOVE  SPACE  TO  IPPPRI-IDX                                  0000000
097720                                                                  0000000
097730     IF  SAY-CINDEX (1:3) = '188'                                 0000000
097740         PERFORM  RECHERCHE-COB-1825                              0000000
097750     Else                                                         0000000
097760         IF  SAY-CINDEX (1:3) = '023'                             0000000
097770             PERFORM  RECHERCHE-COB-3679                          0000000
097780     END-IF                                                       0000000
097790                                                                  0000000
097800D    DISPLAY 'SAY-TX-MARGE-IND ' SAY-TX-MARGE-IND                 0000000
097810     IF  ORGS01-BANQUE-CIC  or                                    0000000
097820         ORGS01-FEDE-ARRAS  or                                    0000000
097830         ORGS01-FEDE-LAVAL                                        0000000
097840         IF SAY-TX-MARGE-IND  NUMERIC                             0000000
097850            MOVE  SAY-TX-MARGE-IND  TO  W-TX9                     0000000
097860            MOVE  W-TX9             TO  IPPPRI-MARGIDX            0000000
097870            MOVE  W-TX9             TO  IPPPRI-MARGID5            0000000
097880         END-IF                                                   0000000
097890         IF SAY-DT-FIN-NEUTRAL NUMERIC AND                        0000000
097900            SAY-DT-FIN-NEUTRAL NOT  =  ZERO                       0000000
097910            STRING  SAY-DT-FIN-NEUTRAL (6:2)   '.'                0000000
097920                    SAY-DT-FIN-NEUTRAL (4:2)   '.'                0000000
097930                    SAY-DT-FIN-NEUTRAL (1:4) DELIMITED BY SIZE    0000000
097940                                            INTO  IPPPRI-DATFIX   0000000
097950         END-IF                                                   0000000
097960         IF  SAY-DUR-FIXITE-X   NUMERIC                           0000000
097970            MOVE   SAY-DUR-FIXITE   TO  IPPPRI-DURFIX             0000000
097980         END-IF                                                   0000000
097990     END-IF.                                                      0000000
098000*                                                                 0000000
098010     IF  CPT-TX-MINI-IND  numeric  and                            0000000
098020         CPT-TX-MINI-IND  =  zero                                 0000000
098030         if  W-VARTAUX  =  '1850'                                 0000000
098040             move  '1851'  to  W-VARTAUX                          0000000
098050         Else                                                     0000000
098060           if  W-VARTAUX  =  '1852'                               0000000
098070               move  '1853'  to  W-VARTAUX                        0000000
098080           Else                                                   0000000
098090              if  W-VARTAUX  =  '1854'                            0000000
098100                 move  '1855'  to  W-VARTAUX                      0000000
098110              Else                                                0000000
098120                if  W-VARTAUX  =  '1856'                          0000000
098130                  move  '1857'  to  W-VARTAUX                     0000000
098140                End-if                                            0000000
098150              End-if                                              0000000
098160            End-if                                                0000000
098170          End-if                                                  0000000
098180      End-if                                                      0000000
098190      .                                                           0000000
098200                                                                  0000000
098210D    DISPLAY 'W-VARTAUX = ' W-VARTAUX.                            0000000
098220D    DISPLAY 'IPPPRI-MARGIDX ' IPPPRI-MARGIDX.                    0000000
098230 RECHERCHE-TAUX-FIXE.                                             0000000
098240* Recherche valeur du taux fixe en cas de passage de salari  tau0000000
098250* charger IPPPRI-TAUFIX                                           0000000
098260*                                                                 0000000
098270                                                                  0000000
098280                                                                  0000000
098290                                                                  0000000
098300 Index-cee.                                                       0000000
098310                                                                  0000000
098320d    if  modif-index display 'modif-index = oui'  end-if          0000000
098330     if  Avenant  and                                             0000000
098340         (modif-index or w-clause-ren not = space )               0000000
098350         Move  w-clause-ren  to  w-vartaux                        0000000
098360     Else                                                         0000000
098370         if  not  avenant                                         0000000
098380             Perform  Index-cee-ouv.                              0000000
098390                                                                  0000000
098400d    display 'w-vartaux '  w-vartaux                              0000000
098410     IF  W-VARTAUX   =  '1734'  and avenant                       0000000
098420         MOVE  '1736'  TO  W-VARTAUX                              0000000
098430     End-if.                                                      0000000
098440                                                                  0000000
098450 Index-cee-ouv.                                                   0000000
098460                                                                  0000000
098470     IF  IPXPRO-BUTOIR-5ANS                                       0000000
098480         if      ( langue-francaise )                             0000000
098490             Perform  rech-clause-selon-duree                     0000000
098500             If  modif-index                                      0000000
098510                 move  w-clause-ren  to  w-vartaux                0000000
098520             End-if                                               0000000
098530         End-if                                                   0000000
098540     End-if                                                       0000000
098550                                                                  0000000
098560     IF  W-VARTAUX   =  '1734'  and avenant                       0000000
098570         MOVE  '1736'  TO  W-VARTAUX                              0000000
098580     Else                                                         0000000
098590      If W-VARTAUX   =  '1465'                                    0000000
098600         IF  ORGS01-ASSIMILE-LYON                                 0000000
098610             IF  IPXPRO-OPTION-TX-FIXE                            0000000
098620                 MOVE  '1481'  TO  W-VARTAUX                      0000000
098630             Else                                                 0000000
098640                 MOVE  '1466'  TO  W-VARTAUX                      0000000
098650             End-if                                               0000000
098660         Else                                                     0000000
098670          If  ORGS01-ASSIMILE-IDF                                 0000000
098680                                                                  0000000
098690             IF  IPXPRO-OPTION-TX-FIXE                            0000000
098700                 if  avenant                                      0000000
098710                     MOVE  '1597'  TO  W-VARTAUX                  0000000
098720                 Else                                             0000000
098730                     MOVE  '1595'  TO  W-VARTAUX                  0000000
098740                 End-if                                           0000000
098750             Else                                                 0000000
098760                 if  avenant                                      0000000
098770                     MOVE  '1596'  TO  W-VARTAUX                  0000000
098780                 Else                                             0000000
098790                     MOVE  '1600'  TO  W-VARTAUX                  0000000
098800                 End-if                                           0000000
098810             END-IF                                               0000000
098820          Else                                                    0000000
098830* CEE hors Lyon et Paris                                          0000000
098840           IF  IPXPRO-OPTION-TX-FIXE                              0000000
098850               if  avenant                                        0000000
098860                   MOVE  '1499'  TO  W-VARTAUX                    0000000
098870               Else                                               0000000
098880                   MOVE  '1481'  TO  W-VARTAUX                    0000000
098890               End-if                                             0000000
098900           Else                                                   0000000
098910               if  avenant                                        0000000
098920                   MOVE  '1498'  TO  W-VARTAUX                    0000000
098930               End-if                                             0000000
098940           END-IF                                                 0000000
098950          END-IF                                                  0000000
098960         END-IF                                                   0000000
098970      END-IF                                                      0000000
098980     END-IF                                                       0000000
098990                                                                  0000000
099000     IF  ORGS01-ASSIMILE-CMSMB                                    0000000
099010         IF  ( W-VARTAUX   =  '1465' )                            0000000
099020             IF  IPXPRO-OPTION-TX-FIXE                            0000000
099030                 IF  AVENANT                                      0000000
099040                     MOVE  '1598'  TO  W-VARTAUX                  0000000
099050                 END-IF                                           0000000
099060             Else                                                 0000000
099070                 IF  AVENANT                                      0000000
099080                     MOVE  '1599'  TO  W-VARTAUX                  0000000
099090                 END-IF                                           0000000
099100             END-IF                                               0000000
099110         END-IF                                                   0000000
099120     END-IF.                                                      0000000
099130                                                                  0000000
099140 RECH-CLAUSE-SELON-DUREE.                                         0000000
099150d    display 'say-cindex ' say-cindex                             0000000
099160     set  pas-modif-index to  true                                0000000
099170     if  say-cindex  not  =  space                                0000000
099180               Perform  varying   i-ren  from  1  by 1            0000000
099190                          until  i-ren  >  15                     0000000
099200                    or    modif-index                             0000000
099210d                display 'w-ren-idx  ' w-ren-idx (i-ren)          0000000
099220d                display 'w-ren-cl-duree  ' w-ren-cl-duree (i-ren)0000000
099230                 if  say-cindex  =  w-ren-idx (i-ren)             0000000
099240                   Set     modif-index  to  true                  0000000
099250                   If say-duram  <=  w-ren-cl-duree (i-ren)       0000000
099260                     Move w-ren-cl-ouv-plus(i-ren) to w-clause-ren0000000
099270                   Else                                           0000000
099280                     Move w-ren-cl (i-ren) to w-clause-ren        0000000
099290                   End-if                                         0000000
099300                 End-if                                           0000000
099310              End-perform                                         0000000
099320     End-if.                                                      0000000
099330                                                                  0000000
099340d    display 'clause renego '   w-clause-ren                      0000000
099350     .                                                            0000000
099360* fin   bis                                                       0000000
099370                                                                  0000000
099380*-------------------                                              0000000
099390 RECHERCHE-COB-1825.                                              0000000
099400*-------------------                                              0000000
099410*                                                                 0000000
099420     MOVE  SPACES          TO IPPPRI-VALINDEX-X                   0000000
099430     PERFORM  INIT-SBCFAL                                         0000000
099440     PERFORM  APPEL-SBCGAPEL-1825.                                0000000
099450                                                                  0000000
099460     IF  SBCFRE-TRT-CORRECT                                       0000000
099470         MOVE  SBCS01-L0001-FMT-CAR (1)  TO  W-RES6               0000000
099480         MOVE  W-RES6 (1:4)    TO  IPPPRI-VALINDEX-X              0000000
099490     ELSE                                                         0000000
099500                                                                  0000000
099510D      DISPLAY 'SBCE01-L0001-DATE-EFFET   :'                      0000000
099520D                                 SBCE01-L0001-DATE-EFFET '**'    0000000
099530D      DISPLAY 'SBCS01-L0001-FMT-CAR (1)  :'                      0000000
099540D                                 SBCS01-L0001-FMT-CAR (1) '**'   0000000
099550D      DISPLAY 'SBCFRE-COD-RET-PRIMAIRE   :'                      0000000
099560D                                 SBCFRE-COD-RET-PRIMAIRE  '**'   0000000
099570           MOVE  'xxx'           TO  W-RES6  IPPPRI-VALINDEX-X    0000000
099580     END-IF.                                                      0000000
099590                                                                  0000000
099600*-------------------                                              0000000
099610 RECHERCHE-COB-3679.                                              0000000
099620*-------------------                                              0000000
099630*                                                                 0000000
099640     MOVE  SPACES          TO IPPPRI-VALINDEX-X                   0000000
099650     PERFORM  INIT-SBCFAL                                         0000000
099660     PERFORM  APPEL-SBCGAPEL-3679.                                0000000
099670                                                                  0000000
099680     IF  SBCFRE-TRT-CORRECT                                       0000000
099690         MOVE  SBCS01-L0001-FMT-CAR (1)  TO  W-RES6               0000000
099700         MOVE  W-RES6 (1:4)    TO  IPPPRI-VALINDEX-X              0000000
099710     ELSE                                                         0000000
099720                                                                  0000000
099730D      DISPLAY 'SBCE01-L0001-DATE-EFFET   :'                      0000000
099740D                                 SBCE01-L0001-DATE-EFFET '**'    0000000
099750D      DISPLAY 'SBCS01-L0001-FMT-CAR (1)  :'                      0000000
099760D                                 SBCS01-L0001-FMT-CAR (1) '**'   0000000
099770D      DISPLAY 'SBCFRE-COD-RET-PRIMAIRE   :'                      0000000
099780D                                 SBCFRE-COD-RET-PRIMAIRE  '**'   0000000
099790           MOVE  '1000'          TO  W-RES6  IPPPRI-VALINDEX-X    0000000
099800     END-IF.                                                      0000000
099810                                                                  0000000
099820*--------------------                                             0000000
099830 RECHERCHE-VALINDEX.                                              0000000
099840*--------------------                                             0000000
099850*                                                                 0000000
099860     MOVE    SAY-BANQ        TO ITFTAU-COD-BANQUE.                0000000
099870     MOVE    SAY-NCAIS       TO ITFTAU-COD-CAISSE.                0000000
099880     MOVE    ZERO            TO ITFTAU-COD-COMPTE.                0000000
099890     MOVE    SAY-RACINE      TO ITFTAU-COD-NUMCPT.                0000000
099900     MOVE    SAY-CAT         TO ITFTAU-COD-PRODCPT.               0000000
099910     MOVE    SAY-DEVISE      TO ITFTAU-COD-DEVISE.                0000000
099920                                                                  0000000
099930     IF  (SAY-CINDEX (1:3)  =  '002' OR '003' or '005' )          0000000
099940          MOVE '245' TO ITFTAU-COD-TYPTAUX                        0000000
099950     ELSE                                                         0000000
099960          MOVE    SAY-CINDEX      TO ITFTAU-COD-TYPTAUX.          0000000
099970     MOVE ZERO               TO ITFTAU-TAU-VAR.                   0000000
099980                                                                  0000000
099990*    IF  EXIST-PRTCPT  =  1                                       0000000
100000*        MOVE CP2-DATOUV         TO ITFTAU-DAT-DEBPER-SAMJ        0000000
100010*                                   ITFTAU-DAT-FINPER-SAMJ        0000000
100020*    ELSE                                                         0000000
100030*        MOVE    DATJOUR         TO ITFTAU-DAT-DEBPER-SAMJ        0000000
100040*                                   ITFTAU-DAT-FINPER-SAMJ.       0000000
100050* sbo09032006 modif alim date de rech de l'index                  0000000
100060d    display 'DINDEX=' DINDEX-10                                  0000000
100070     IF DINDEX-10(7:4) NUMERIC                                    0000000
100080                                                                  0000000
100090        STRING DINDEX-10(7:4)                                     0000000
100100               DINDEX-10(4:2)                                     0000000
100110               DINDEX-10(1:2)                                     0000000
100120        DELIMITED SIZE  INTO ITFTAU-DAT-DEBPER-SAMJ               0000000
100130        MOVE ITFTAU-DAT-DEBPER-SAMJ TO ITFTAU-DAT-FINPER-SAMJ     0000000
100140     ELSE                                                         0000000
100150        MOVE DATJOUR      TO ITFTAU-DAT-DEBPER-SAMJ               0000000
100160                             ITFTAU-DAT-FINPER-SAMJ               0000000
100170     END-IF                                                       0000000
100180                                                                  0000000
100190D    DISPLAY 'ITFTAU-DAT-DEBPER-SAMJ=' ITFTAU-DAT-DEBPER-SAMJ     0000000
100200D    DISPLAY 'ITFTAU-DAT-FINPER-SAMJ=' ITFTAU-DAT-FINPER-SAMJ     0000000
100210                                                                  0000000
100220     MOVE SPACE              TO ITFTAU-CODE-OPTION.               0000000
100230                                                                  0000000
100240     MOVE '3'           TO ITFTAU-NBR-DECIMALES.                  0000000
100250                                                                  0000000
100260     MOVE 'DL1'              TO ITFTAU-COD-TYPACCES.              0000000
100270                                                                  0000000
100280     IF  DATJOUR  NUMERIC                                         0000000
100290         MOVE  DATJOURN       TO  ITFTAU-DATE-JOUR                0000000
100300       ELSE                                                       0000000
100310         MOVE  ZERO           TO  ITFTAU-DATE-JOUR                0000000
100320     END-IF                                                       0000000
100330                                                                  0000000
100340D    DISPLAY 'VALEURS AVT APPEL'.                                 0000000
100350D    DISPLAY 'ITFTAU-FONC-ENTREE = ' ITFTAU-FONC-ENTREE.          0000000
100360D    DISPLAY 'ITFTAU-NBR-DECIMAL = ' ITFTAU-NBR-DECIMALES.        0000000
100370                                                                  0000000
100380     CALL 'ZCALLPGM'      USING ZITFTAU                           0000000
100390                                 ITFTAU                           0000000
100400                                 IDXTAU                           0000000
100410                                 CONINT                           0000000
100420                                 TRETAU                           0000000
100430                                 PCBCO1                           0000000
100440                                 PCBCO2                           0000000
100450                                 PCBCO3                           0000000
100460                                 PCBCO4                           0000000
100470                                 PCBCO5.                          0000000
100480                                                                  0000000
100490     IF   ITFTAU-BONRETOUR  OR                                    0000000
100500          ITFTAU-RC  = '67'                                       0000000
100510          MOVE  ITFTAU-TAU-VAL    TO  IPPPRI-VALINDEX             0000000
100520                                      IPPPRI-VALINDE5.            0000000
100530                                                                  0000000
100540D    DISPLAY 'ITFTAU-RC'  ITFTAU-RC                               0000000
100550D    DISPLAY 'ITFTAU   '  ITFTAU-TAU-VAL.                         0000000
100560D    DISPLAY 'ITFTAU   '  ITFTAU.                                 0000000
100570D    DISPLAY 'ITFTAU-LIB-ANOMAL   '  ITFTAU-LIB-ANOMAL.           0000000
100580D    DISPLAY 'NOMINDEX '  IPPPRI-NOMINDEX.                        0000000
100590                                                                  0000000
100600*--------------------                                             0000000
100610 AFFECT-ZONE-DATINDEX.                                            0000000
100620*--------------------                                             0000000
100630****                                                              0000000
100640     MOVE '37.??00' TO ZDATE-PARMS.                               0000000
100650****                                                              0000000
100660     MOVE ZERO       TO PROBLEME-DATE.                            0000000
100670     MOVE ZDATE-PARMS           TO   CV-ZDATE-PARAM-GROUPE        0000000
100680     MOVE    SAY-DINDEX         TO   CV-ZDATE-DATE1               0000000
100690     MOVE DINDEX-10             TO   CV-ZDATE-DATE2               0000000
100700     MOVE  'O'                  TO   ZDAT2000-GESTION-SIECLE      0000000
100710     PERFORM ZDAT2-ZDAT2000                                       0000000
100720     MOVE CV-ZDATE-PARAM-GROUPE TO   ZDATE-PARMS                  0000000
100730     MOVE CV-ZDATE-DATE2        TO   DINDEX-10                    0000000
100740     IF   ZDATE-RETOUR NOT = ZERO                                 0000000
100750D         DISPLAY 'DATE INDEX INCORRECTE - RETOUR ZDATE'          0000000
100760          MOVE '1'          TO PROBLEME-DATE                      0000000
100770     ELSE MOVE DINDEX-10    TO IPPPRI-DATINDEX.                   0000000
100780*                                                                 0000000
100790*------------------------                                         0000000
100800 LECTURE-PRTIND02.                                                0000000
100810*------------------------                                         0000000
100820D    DISPLAY  'IPPBATCH, LECTURE TABLE PRTIND02'                  0000000
100830     MOVE  SAY-CINDEX TO W-CINDEX                                 0000000
100840     MOVE  SPACE  TO PRTIND02                                     0000000
100850                     GESPAR-PRTIND02                              0000000
100860                                                                  0000000
100870     PERFORM  INIT-ZPARAPEL-L1003                                 0000000
100880     MOVE  'PRTIND02'      TO ZPAVAL-L1003-COD-TAB                0000000
100890     MOVE  W-CINDEX(4:2)   TO ZPAVAL-L1003-CLE-POS-TAB            0000000
100900     PERFORM  APPEL-ZPARAPEL-L1003                                0000000
100910                                                                  0000000
100920     IF  NOT PARFRE-TRT-CORRECT                                   0000000
100930       DISPLAY  'PBM SUR POSTE GESPAR INDEX '                     0000000
100940       ZPAVAL-L1003-COD-TAB                                       0000000
100950       ' /  RETOUR-CODE = ' PARFRE-COD-RET-PRIMAIRE               0000000
100960       DISPLAY  'CAISSE  ' IPPMA2-CAISSE                          0000000
100970       DISPLAY  'RACINE  ' IPPMA2-RACINE                          0000000
100980       DISPLAY  'DOSSIER ' IPPMA2-DOSS                            0000000
100990       MOVE  SPACE  TO  ANOM-44                                   0000000
101000       STRING  'PB PRTIND02 ' W-CINDEX                            0000000
101010         DELIMITED BY SIZE INTO  ANOM-44                          0000000
101020       MOVE  44  TO TEST-1                                        0000000
101030       PERFORM  TRAIT-ANOMALIE                                    0000000
101040       MOVE  ZERO  TO  PRTIND02-TMIN                              0000000
101050       MOVE  ZERO  TO  PRTIND02-TMAX                              0000000
101060     ELSE                                                         0000000
101070       MOVE  ZPAVRE-L1003-ZON-VAR-PO TO GESPAR-PRTIND02           0000000
101080       IF  GESPAR-PRTIND02-REPMINI-S  = '-'                       0000000
101090         COMPUTE  GESPAR-PRTIND02-REPMINI =                       0000000
101100                  GESPAR-PRTIND02-REPMINI * -1                    0000000
101110       END-IF                                                     0000000
101120       IF  GESPAR-PRTIND02-REPMAXI-S  = '-'                       0000000
101130         COMPUTE  GESPAR-PRTIND02-REPMAXI =                       0000000
101140                  GESPAR-PRTIND02-REPMAXI * -1                    0000000
101150       END-IF                                                     0000000
101160       IF  GESPAR-PRTIND02-TXPLAN-S  = '-'                        0000000
101170         COMPUTE  GESPAR-PRTIND02-TXPLAN  =                       0000000
101180                  GESPAR-PRTIND02-TXPLAN  * -1                    0000000
101190       END-IF                                                     0000000
101200       IF  GESPAR-PRTIND02-TXPLAF-S  = '-'                        0000000
101210         COMPUTE  GESPAR-PRTIND02-TXPLAF  =                       0000000
101220                  GESPAR-PRTIND02-TXPLAF  * -1                    0000000
101230       END-IF                                                     0000000
101240       MOVE  ZPAVAL-L1003-CLE-POS-TAB TO PRTIND02-COND            0000000
101250d      display  'GESPAR-PRTIND02-TXPLAN ' GESPAR-PRTIND02-TXPLAN  0000000
101260d      display  'GESPAR-PRTIND02-TXPLAF ' GESPAR-PRTIND02-TXPLAF  0000000
101270       MOVE  GESPAR-PRTIND02-TXPLAN   TO PRTIND02-TMIN            0000000
101280       MOVE  GESPAR-PRTIND02-TXPLAF   TO PRTIND02-TMAX            0000000
101290D      DISPLAY  'TABLE PRTIND02'                                  0000000
101300D      DISPLAY  ' PRTIND02-COND   ' PRTIND02-COND                 0000000
101310D      DISPLAY  ' PRTIND02-TMIN   ' PRTIND02-TMIN                 0000000
101320D      DISPLAY  ' PRTIND02-TMAX   ' PRTIND02-TMAX                 0000000
101330     END-IF                                                       0000000
101340     .                                                            0000000
101350                                                                  0000000
101360*-------------------------                                        0000000
101370 CNTRL-NUMERICITE.                                                0000000
101380*-------------------------                                        0000000
101390                                                                  0000000
101400     IF   SAY-MTCRED NOT NUMERIC                                  0000000
101410     OR   SAY-MTCRED = ZERO                                       0000000
101420          DISPLAY 'MTCRED NON CONFORME' SAY-MTCRE                 0000000
101430          MOVE 8 TO TEST-1                                        0000000
101440          PERFORM TRAIT-ANOMALIE.                                 0000000
101450                                                                  0000000
101460     IF not ( SAY-MGES    =  '6' )                                0000000
101470        IF   SAY-DURAM  NOT NUMERIC                               0000000
101480        OR   SAY-DURAM  = ZERO                                    0000000
101490             DISPLAY 'DURAM  NON CONFORME ' SAY-DUR               0000000
101500             MOVE 8 TO TEST-1                                     0000000
101510             PERFORM TRAIT-ANOMALIE                               0000000
101520     ELSE                                                         0000000
101530        IF   SAY-DURAMS NOT NUMERIC                               0000000
101540        OR   SAY-DURAMS = ZERO                                    0000000
101550             DISPLAY 'DURAMS NON CONFORME ' SAY-DURS              0000000
101560             MOVE 8 TO TEST-1                                     0000000
101570             PERFORM TRAIT-ANOMALIE.                              0000000
101580*                                                                 0000000
101590*--------------                                                   0000000
101600*                                                                 0000000
101610     IF   SAY-FRAUT9 NOT NUMERIC                                  0000000
101620          DISPLAY 'FRAUT9 NON CONFORME ' SAY-FRAUT                0000000
101630          MOVE 8 TO TEST-1                                        0000000
101640          PERFORM TRAIT-ANOMALIE                                  0000000
101650     end-if                                                       0000000
101660     IF   SAY-FRHYP9 NOT NUMERIC                                  0000000
101670          DISPLAY 'FRHYP9 NON CONFORME ' SAY-FRHYP                0000000
101680          MOVE 8 TO TEST-1                                        0000000
101690          PERFORM TRAIT-ANOMALIE                                  0000000
101700     end-if                                                       0000000
101710*                                                                 0000000
101720****     : ON ACCEPTE TAUX ZERO POUR MODE DE GESTION 1 ou 6       0000000
101730*                                                                 0000000
101740      IF   SAY-TAUDB  NOT NUMERIC                                 0000000
101750      OR  (SAY-TAUDB = ZERO AND NOT (SAY-MGES = '1' OR '6')       0000000
101760      AND  (SAY-CNAT NOT = '291' AND '302' AND '304' AND '306'    0000000
101770                        and  '200'  AND  '301'  and  '303'))      0000000
101780           DISPLAY 'TAUDB  NON CONFORME ' SAY-TAUD                0000000
101790           MOVE 8 TO TEST-1                                       0000000
101800           PERFORM TRAIT-ANOMALIE.                                0000000
101810                                                                  0000000
101820*-------------------------                                        0000000
101830 TRAIT-TABAMORT.                                                  0000000
101840*-------------------------                                        0000000
101850                                                                  0000000
101860     IF (CONTRAT  OR  CONTRAT-GPR)  AND                           0000000
101870         SAY-PERFR   =  '8'                                       0000000
101880              MOVE    1    TO Z-INDDIFF                           0000000
101890              MOVE    1    TO IPPPRI-INDDIFF                      0000000
101900D         DISPLAY 'TRAIT-DIFFERE-TOTAL'                           0000000
101910*rde19        PERFORM TRAIT-DIFFERE-TOTAL                         0000000
101920     ELSE                                                         0000000
101930              MOVE ZERO    TO Z-INDDIFF                           0000000
101940              MOVE ZERO    TO IPPPRI-INDDIFF                      0000000
101950              MOVE ZERO    TO IPPPRI-MTDIFF.                      0000000
101960D    DISPLAY  'IPPPRI-INDDIFF'  IPPPRI-INDDIFF.                   0000000
101970***                                                               0000000
101980     PERFORM TRAIT-TABAMORT-PO.                                   0000000
101990                                                                  0000000
102000     IF  SUITE                                                    0000000
102010         IF   Z-TYPPRET    = 'PC'   OR                            0000000
102020             (SAY-CNAT  =  '291' OR '304' OR '302' )              0000000
102030              or  IPXPRO-PPL   or ipxpro-ptz-caen                 0000000
102040              or  ipxpro-ptz-orleans                              0000000
102050              PERFORM CHARGE-SPECIAL-PC-NEW2.                     0000000
102060                                                                  0000000
102070 TRAIT-DIFFERE-TOTAL.                                             0000000
102080*-------------------------                                        0000000
102090                                                                  0000000
102100     MOVE ZERO TO Z-TOTAL-HYPOTHETIQUE                            0000000
102110                  Z-SUPP-CAPITAL.                                 0000000
102120                                                                  0000000
102130     If  NOT ( SAY-ASS-MENSUELLE )                                0000000
102140         PERFORM CALCUL-Z-SUPP-CAPITAL                            0000000
102150     End-if                                                       0000000
102160                                                                  0000000
102170     COMPUTE Z-TOTAL-HYPOTHETIQUE =                               0000000
102180             SAY-MTCRED + Z-SUPP-CAPITAL.                         0000000
102190     MOVE Z-TOTAL-HYPOTHETIQUE TO IPPPRI-MTDIFF.                  0000000
102200                                                                  0000000
102210 CALCUL-Z-SUPP-CAPITAL.                                           0000000
102220*-------------------------                                        0000000
102230                                                                  0000000
102240D    DISPLAY  'SA2-DATDEC  = '  SA2-DATDEC.                       0000000
102250     IF   SA2-DATDEC   NUMERIC AND                                0000000
102260          SA2-DATDEC    >  ZERO                                   0000000
102270             MOVE SA2-DATDEC  TO W-DATDEB                         0000000
102280         ELSE                                                     0000000
102290             MOVE W-DATE-8    TO W-DATDEB.                        0000000
102300                                                                  0000000
102310     MOVE  FIN-DE-FRANCHISE TO  W-DATFIN.                         0000000
102320                                                                  0000000
102330D    DISPLAY 'DATE DEB1 ' W-DATDEB.                               0000000
102340D    DISPLAY 'DATE FIN1 ' W-DATFIN.                               0000000
102350     INITIALIZE DATS20                                            0000000
102360     MOVE  W-DATFIN          TO   DATS20-I-DATE1                  0000000
102370     MOVE  W-DATDEB          TO   DATS20-I-DATE2                  0000000
102380     PERFORM ZDAT2-PRETNBJ                                        0000000
102390     MOVE DATS20-O-NBJOURS-9 TO   ZNBR.                           0000000
102400*                                                                 0000000
102410D    DISPLAY 'DATE DEB2 ' W-DATDEB.                               0000000
102420D    DISPLAY 'DATE FIN2 ' W-DATFIN.                               0000000
102430D    DISPLAY 'ZNBR     ' ZNBR.                                    0000000
102440*                                                                 0000000
102450     MOVE  ZERO    TO  WS-TAUX-FR.                                0000000
102460     IF  SAY-TAFR    NUMERIC AND                                  0000000
102470         SAY-TAUFR   >  ZERO                                      0000000
102480         MOVE  SAY-TAUFR    TO  WS-TAUX-FR                        0000000
102490     ELSE                                                         0000000
102500         IF  SAY-TAUD    NUMERIC                                  0000000
102510             MOVE  SAY-TAUDB    TO  WS-TAUX-FR.                   0000000
102520                                                                  0000000
102530     IF  ZNBR  >  ZERO   AND                                      0000000
102540         SAY-MTCRE   NUMERIC                                      0000000
102550         IF  IPPMA2-LABEL-APPLI = 'IPP'                           0000000
102560             IF  SAY-CALINT  =  '2'                               0000000
102570               COMPUTE Z-SUPP-CAPITAL =                           0000000
102580                (( SAY-MTCRED  * WS-TAUX-FR )  * ZNBR ) / 36000   0000000
102590             ELSE                                                 0000000
102600               COMPUTE Z-SUPP-CAPITAL =                           0000000
102610                (( SAY-MTCRED  * WS-TAUX-FR )  * ZNBR ) / 36500   0000000
102620         ELSE                                                     0000000
102630             IF  (ORGS01-BANQUE-CIC)                              0000000
102640                 COMPUTE Z-SUPP-CAPITAL =                         0000000
102650                  (( SAY-MTCRED  * WS-TAUX-FR ) * ZNBR) / 36500   0000000
102660                  COMPUTE   NB-MOIS-FRANCHISE =   ZNBR / 30       0000000
102670                  IF  ZNBR > ( NB-MOIS-FRANCHISE * 30 )           0000000
102680                      ADD  1  TO NB-MOIS-FRANCHISE                0000000
102690                  END-IF                                          0000000
102700             ELSE                                                 0000000
102710                 COMPUTE Z-SUPP-CAPITAL =                         0000000
102720                  (( SAY-MTCRED  * WS-TAUX-FR ) * 7,5) / 1200     0000000
102730                  MOVE   7,5     TO   NB-MOIS-FRANCHISE.          0000000
102740*  7,5 = suivant exemple du contrat                               0000000
102750*    1/4 du montant tout les 3 mois.                              0000000
102760*                                                                 0000000
102770D    DISPLAY  'Z-SUPP-CAPITAL = '    Z-SUPP-CAPITAL.              0000000
102780                                                                  0000000
102790 TRAIT-TABAMORT-PO.                                               0000000
102800*------------------                                               0000000
102810     MOVE ZERO                     TO CTL-R34.                    0000000
102820     MOVE SAY-MTCRED               TO Z-MTCRED.                   0000000
102830**** DIFFERE-TOTAL                                                0000000
102840     IF Z-INDDIFF  = 1                  and                       0000000
102850*rde19                                                            0000000
102860        z-total-hypothetique  numeric   and                       0000000
102870        z-total-hypothetique  >  zero                             0000000
102880*rde19                                                            0000000
102890        MOVE Z-TOTAL-HYPOTHETIQUE TO SAY-MTCRED.                  0000000
102900*                                                                 0000000
102910*    IF Z-TYPCRED NOT = 'IMMO-DV' AND 'PROF-DV' AND 'CONS-DV'     0000000
102920     IF not ( SAY-MGES    =  '6' )                                0000000
102930        MOVE SAY-DURAM   TO Z-DURAMORT                            0000000
102940     ELSE                                                         0000000
102950        MOVE SAY-DURAMS  TO Z-DURAMORT.                           0000000
102960*                                                                 0000000
102970*------>                                                          0000000
102980*                                                                 0000000
102990                                                                  0000000
103000     PERFORM TRAIT-TXCOTOCM.                                      0000000
103010     MOVE Z-TXCOTOCM TO IPPPRI-TXCOTOCM.                          0000000
103020*                                                                 0000000
103030     IF  SAY-FRAUT   NOT  NUMERIC                                 0000000
103040         OR  AVENANT                                              0000000
103050         MOVE  ZERO  TO  SAY-FRAUT9                               0000000
103060     END-IF                                                       0000000
103070                                                                  0000000
103080     IF  SAY-FRAUT9  NOT  =  ZERO                                 0000000
103090         MOVE SAY-FRAUT9      TO IPPPRI-MFRAIS                    0000000
103100       ELSE                                                       0000000
103110         MOVE ZERO            TO IPPPRI-MFRAIS-X                  0000000
103120     End-If                                                       0000000
103130                                                                  0000000
103140     IF  SAY-MTCOM  NOT NUMERIC                                   0000000
103150         MOVE   ZERO         TO SAY-MTCOM9                        0000000
103160     END-IF                                                       0000000
103170                                                                  0000000
103180     MOVE SAY-MTCOM9         TO W-MTCOM9                          0000000
103190                                                                  0000000
103200*    COMPUTE SAY-MTCOM9 = SAY-MTCOM9 +  Z-MCOTOCM.                0000000
103210                                                                  0000000
103220D        DISPLAY '  test roger   '                                0000000
103230D        DISPLAY '  Z-DURAMORT = ' Z-DURAMORT                     0000000
103240D        DISPLAY '  Z-DURAMOR1 = Z-DURAMORT '                     0000000
103250                                                                  0000000
103260     IF  SUITE                                                    0000000
103270         PERFORM  TRAIT-TABAMORT-PO-S.                            0000000
103280                                                                  0000000
103290 TRAIT-TABAMORT-PO-S.                                             0000000
103300*--------------------                                             0000000
103310                                                                  0000000
103320     MOVE PRTSAY TO IPPCPL-PRTSAY.                                0000000
103330                                                                  0000000
103340D    DISPLAY 'PRTSAY  ' PRTSAY.                                   0000000
103350D    DISPLAY 'TAUX LT ' SAY-TAUDLT.                               0000000
103360D    DISPLAY 'DUREE T ' SAY-DURLT.                                0000000
103370D    DISPLAY 'MGES    ' SAY-MGES                                  0000000
103380D    DISPLAY 'MGES-NEW' SAY-MODGES-NEW.                           0000000
103390                                                                  0000000
103400     move  'N'  to  ipxcal-o-cod-ass-obl                          0000000
103410                                                                  0000000
103420     IF PRET-TSE-OUI                                              0000000
103430        PERFORM RECALCUL-TAUX                                     0000000
103440     END-IF                                                       0000000
103450                                                                  0000000
103460     Perform  appel-IPXZCALY                                      0000000
103470                                                                  0000000
103480     If  suite                                                    0000000
103490         PERFORM  CHGT-TAM-SAI                                    0000000
103500     End-if                                                       0000000
103510     .                                                            0000000
103520                                                                  0000000
103530     IF  SUITE                                                    0000000
103540         PERFORM RECTIF-TAUX-COM.                                 0000000
103550                                                                  0000000
103560                                                                  0000000
103570     IF  SUITE                                                    0000000
103580         MOVE Z-MTCRED             TO SAY-MTCRED.                 0000000
103590                                                                  0000000
103600 RECTIF-TAUX-COM.                                                 0000000
103610*                                                                 0000000
103620     IF  SAY-MTCOM     NUMERIC                                    0000000
103630         IF  SAY-MTCOM9     NOT  =  ZERO                          0000000
103640             IF  CTE-TCOM  =  ZERO                                0000000
103650                 MOVE  0,001  TO  CTE-TCOM                        0000000
103660                 ADD   0,001  TO  CTE-TEGL.                       0000000
103670                                                                  0000000
103680     IF  SAY-FRHYP     NUMERIC                                    0000000
103690         IF  SAY-FRHYP9     NOT  =  ZERO                          0000000
103700             IF  CTE-TFRH  =  ZERO                                0000000
103710                 MOVE  0,001  TO  CTE-TFRH                        0000000
103720                 ADD   0,001  TO  CTE-TEGL.                       0000000
103730                                                                  0000000
103740     IF  SAY-FRAUT     NUMERIC                                    0000000
103750         IF  SAY-FRAUT9     NOT  =  ZERO                          0000000
103760             IF  CTE-TAFR  =  ZERO                                0000000
103770                 MOVE  0,001  TO  CTE-TAFR                        0000000
103780                 ADD   0,001  TO  CTE-TEGL.                       0000000
103790*                                                                 0000000
103800 CHGT-TAM-SAI.                                                    0000000
103810                                                                  0000000
103820     If  not ( say-mges  =  '6' )                                 0000000
103830         PERFORM  CHGT-CALX-SAI-TABELT                            0000000
103840               VARYING IT FROM 1 BY 1 UNTIL IT > 20               0000000
103850         PERFORM  CHGT-CALX-SAI-TRAVAIL                           0000000
103860         PERFORM  CHGT-CALX-TAM                                   0000000
103870     Else                                                         0000000
103880         Perform  CHGT-CALX-DIVERS                                0000000
103890     End-if                                                       0000000
103900     .                                                            0000000
103910                                                                  0000000
103920                                                                  0000000
103930 CHGT-CALX-SAI-TABELT.                                            0000000
103940*---------------------                                            0000000
103950                                                                  0000000
103960      IF   CO3-TER (IT)   NUMERIC                                 0000000
103970           MOVE CO3-TER (IT) TO SAI-TER  (IT)                     0000000
103980D          DISPLAY 'CO3-TER '   IT ' ' SAI-TER  (IT)              0000000
103990      ELSE                                                        0000000
104000           MOVE ZERO         TO SAI-TER  (IT).                    0000000
104010      IF   CO3-NB  (IT) NUMERIC                                   0000000
104020           MOVE CO3-NB (IT)  TO SAI-NB   (IT)                     0000000
104030D          DISPLAY 'CO3-NB  '   IT ' ' SAI-NB   (IT)              0000000
104040      ELSE                                                        0000000
104050           MOVE ZERO         TO SAI-NB   (IT).                    0000000
104060      IF   CO3-TX  (IT) NUMERIC                                   0000000
104070           MOVE CO3-TX (IT)  TO SAI-TAUX (IT)                     0000000
104080D          DISPLAY 'CO3-TX  '   IT ' ' SAI-TAUX (IT)              0000000
104090      ELSE                                                        0000000
104100           MOVE ZERO                     TO SAI-TAUX (IT).        0000000
104110                                                                  0000000
104120      MOVE ZERO                          TO SAI-PR   (IT).        0000000
104130                                                                  0000000
104140 CHGT-CALX-SAI-TRAVAIL.                                           0000000
104150*-------------------------                                        0000000
104160                                                                  0000000
104170D       display 'IPXCAL-O-NBECH9 = ' IPXCAL-O-NBECH9              0000000
104180D       DISPLAY 'CO1-NPER        = ' CO1-NPER                     0000000
104190D       DISPLAY 'NB-MOIS-FRANCHISE = ' NB-MOIS-FRANCHISE          0000000
104200        MOVE  IPXCAL-O-NBECH9     TO  SAI-NPER                    0000000
104210                                                                  0000000
104220        if  say-perfr  =  8                                       0000000
104230             IF   IPXCAL-TINT-CAP      NUMERIC                    0000000
104240               compute  IPPPRI-MTDIFF  =                          0000000
104250                           IPXCAL-TINT-CAP   +  SAY-MTCRED        0000000
104260d              display 'mtdiff ' ipppri-mtdiff                    0000000
104270             End-if                                               0000000
104280        End-if                                                    0000000
104290                                                                  0000000
104300D       DISPLAY 'SAI-NPER = ' SAI-NPER                            0000000
104310                                                                  0000000
104320        IF TAM-TINT OF PRTCO4  NUMERIC                            0000000
104330           MOVE TAM-TINT OF PRTCO4 TO SAI-TINT                    0000000
104340        ELSE                                                      0000000
104350           MOVE ZERO               TO SAI-TINT.                   0000000
104360        MOVE ZERO                TO SAI-TINT1.                    0000000
104370                                                                  0000000
104380D       DISPLAY ' CO1-TCOM '  CO1-TCOM.                           0000000
104390        IF CO1-TCOM NUMERIC                                       0000000
104400           MOVE CO1-TCOM  TO SAI-TCOM                             0000000
104410        ELSE                                                      0000000
104420           MOVE ZERO      TO SAI-TCOM.                            0000000
104430                                                                  0000000
104440        If  88-ps-oui                                             0000000
104450            MOVE IPXCAL-O-TPS TO SAI-TPS                          0000000
104460        ELSE                                                      0000000
104470            MOVE zero         TO SAI-TPS                          0000000
104480        End-if                                                    0000000
104490                                                                  0000000
104500D       DISPLAY ' CO1-TAFR '  CO1-TAFR                            0000000
104510        IF CO1-TAFR NUMERIC                                       0000000
104520           MOVE CO1-TAFR  TO SAI-TFRAUT                           0000000
104530        ELSE                                                      0000000
104540           MOVE ZERO      TO SAI-TFRAUT.                          0000000
104550D       DISPLAY ' CO1-TFRH '  CO1-TFRH.                           0000000
104560        IF CO1-TFRH NUMERIC                                       0000000
104570           MOVE CO1-TFRH  TO SAI-TFRH                             0000000
104580        ELSE                                                      0000000
104590           MOVE ZERO      TO SAI-TFRH.                            0000000
104600                                                                  0000000
104610        IF  not  ( APXTRE-ENCOURS )                               0000000
104620D           DISPLAY 'CO1-MTASS ' CO1-MTASS                        0000000
104630            IF CO1-MTASS NUMERIC                                  0000000
104640               MOVE CO1-MTASS TO SAI-MTASS                        0000000
104650            ELSE                                                  0000000
104660               MOVE ZERO      TO SAI-MTASS                        0000000
104670            END-IF                                                0000000
104680D           DISPLAY 'CO1-TCAS  ' CO1-TCAS                         0000000
104690            IF CO1-TCAS NUMERIC                                   0000000
104700               MOVE CO1-TCAS  TO SAI-TCAS                         0000000
104710            ELSE                                                  0000000
104720               MOVE ZERO      TO SAI-TCAS                         0000000
104730        ELSE                                                      0000000
104740D           DISPLAY 'TAM-TASS ' TAM-TASS OF PRTCO4                0000000
104750            IF TAM-TASS OF PRTCO4  NUMERIC                        0000000
104760               MOVE TAM-TASS OF PRTCO4 TO SAI-MTASS               0000000
104770            ELSE                                                  0000000
104780               MOVE ZERO      TO SAI-MTASS                        0000000
104790            END-IF                                                0000000
104800D           DISPLAY 'CO1-TCAS  ' CO1-TCAS                         0000000
104810            IF CO3-TXASS (1)  NUMERIC                             0000000
104820               MOVE CO3-TXASS (1)  TO SAI-TCAS                    0000000
104830            ELSE                                                  0000000
104840               MOVE ZERO      TO SAI-TCAS.                        0000000
104850                                                                  0000000
104860        IF CO1-TEMO NUMERIC                                       0000000
104870           MOVE CO1-TEMO  TO SAI-TEFF                             0000000
104880        ELSE                                                      0000000
104890           MOVE ZERO      TO SAI-TEFF.                            0000000
104900D       DISPLAY 'CO1-TEMO :' CO1-TEMO                             0000000
104910D       DISPLAY 'SAI-TEFF :' SAI-TEFF                             0000000
104920D       DISPLAY 'CO1-TEGL av recalcul  ' CO1-TEGL.                0000000
104930D       DISPLAY 'CO1-TEGL av recalcul  ' CO1-TEGL.                0000000
104940                                                                  0000000
104950        IF CO1-TEGL NUMERIC                                       0000000
104960           MOVE CO1-TEGL  TO SAI-TEGL                             0000000
104970        ELSE                                                      0000000
104980           MOVE ZERO      TO SAI-TEGL.                            0000000
104990                                                                  0000000
105000                                                                  0000000
105010     IF  IPPMA2-LABEL-APPLI  =  'IPI'                             0000000
105020         IF  TEG-SANS-ASS-I                                       0000000
105030             IF  APXTRE-ENCOURS                                   0000000
105040                                                                  0000000
105050                                                                  0000000
105060                 MOVE  APXTRE-TEGASS TO SAI-TCAS                  0000000
105070             END-IF                                               0000000
105080         END-IF                                                   0000000
105090     END-IF.                                                      0000000
105100*  teg                        recalcul teg causearrondi.          0000000
105110d    display ' CO3-TX (1)    '   CO3-TX (1)                       0000000
105120d    display ' SAI-TPS       '   SAI-TPS                          0000000
105130d    display ' SAI-TCOM      '   SAI-TCOM                         0000000
105140d    display ' SAI-TFRAUT    '   SAI-TFRAUT                       0000000
105150d    display ' SAI-TCAS      '   SAI-TCAS                         0000000
105160d    display ' SAI-TFRH      '   SAI-TFRH                         0000000
105170                                                                  0000000
105180     COMPUTE  SAI-TEGL = CO3-TX (1) +  SAI-TPS +                  0000000
105190              SAI-TCOM + SAI-TFRAUT + SAI-TCAS + SAI-TFRH.        0000000
105200     move sai-tegl  to  ipxcal-o-teg.                             0000000
105210                                                                  0000000
105220D    DISPLAY  'SAI-TCAS  '  SAI-TCAS.                             0000000
105230D    DISPLAY  'SAI-TEGL ap recalul '  SAI-TEGL.                   0000000
105240                                                                  0000000
105250     IF   Z-TYPPRET = 'PC'                                        0000000
105260          IF   CO1-TEMH NUMERIC                                   0000000
105270               MOVE CO1-TEMH  TO SAI-TEMH                         0000000
105280          ELSE                                                    0000000
105290               MOVE ZERO      TO SAI-TEMH.                        0000000
105300                                                                  0000000
105310 CHGT-CALX-TAM.                                                   0000000
105320*--------------                                                   0000000
105330                                                                  0000000
105340     IF IP = 1                                                    0000000
105350        MOVE PRTCO4    TO PRTCO41                                 0000000
105360     ELSE                                                         0000000
105370     IF IP = 2                                                    0000000
105380        MOVE PRTCO4    TO PRTCO42                                 0000000
105390     ELSE                                                         0000000
105400     IF IP = 3                                                    0000000
105410        MOVE PRTCO4    TO PRTCO43                                 0000000
105420     ELSE                                                         0000000
105430     IF IP = 4                                                    0000000
105440        MOVE PRTCO4    TO PRTCO44.                                0000000
105450                                                                  0000000
105460     MOVE SAI-NPER  TO SAI-NPER-STOCK (IP).                       0000000
105470     MOVE SAY-CNAT  TO SAI-CNAT-STOCK (IP).                       0000000
105480     MOVE SAY-PERFR TO SAI-PERFR-STOCK(IP).                       0000000
105490     MOVE SPACE     TO SAI-TYPB-STOCK (IP).                       0000000
105500                                                                  0000000
105510     IF  SA2-DATEC NUMERIC                                        0000000
105520         STRING SA2-DATEC(7:2)                                    0000000
105530                SA2-DATEC(5:2)                                    0000000
105540                SA2-DATEC(1:4) DELIMITED BY SIZE                  0000000
105550                          INTO SAI-DATEC-STOCK (IP)               0000000
105560     ELSE                                                         0000000
105570         MOVE ZERO      TO SAI-DATEC-STOCK (IP).                  0000000
105580                                                                  0000000
105590                                                                  0000000
105600 MODIF-DONNEES-PRET.                                              0000000
105610                                                                  0000000
105620     IF  SUITE                                                    0000000
105630         IF  CPT-DATEFNT  NUMERIC  AND                            0000000
105640             CPT-DATEFNT  >  ZERO                                 0000000
105650             MOVE CPT-DATEFNT    TO   SAY-DATEC                   0000000
105660         ELSE                                                     0000000
105670             MOVE CPT-DPROEC     TO   SAY-DATEC                   0000000
105680         END-IF                                                   0000000
105690* pret divers et avenant , les int. sont a recalculer a partir    0000000
105700*   de la date du jour.                                           0000000
105710         IF  SAY-MGES  =  '6'                                     0000000
105720             MOVE  W-DATRAIT   TO  SAY-DATDEC                     0000000
105730         END-IF                                                   0000000
105740                                                                  0000000
105750         MOVE  PRTSAY         TO IPPCPL-PRTSAY.                   0000000
105760                                                                  0000000
105770                                                                  0000000
105780 RECTIF-DUREE-BONIFIEE.                                           0000000
105790*-------------------------                                        0000000
105800     MOVE ZERO TO Z-DURB-RECTIF.                                  0000000
105810****                                                              0000000
105820     MOVE ZERO       TO Z-DURFRANC.                               0000000
105830     IF      SA2-DATDEC      NOT  =  SPACE                        0000000
105840          MOVE SA2-DATDEC       TO ZPRTNBMO-D1                    0000000
105850     ELSE                                                         0000000
105860          PERFORM  CDATE-FIN-MOIS.                                0000000
105870                                                                  0000000
105880     MOVE  ZPRTNBMO-D1   TO  IPPRCFRA-DATDEB.                     0000000
105890*                                                                 0000000
105900     MOVE  SA2-DATEC        TO IPPRCFRA-DATFIN.                   0000000
105910     IF   Z-DURFRANC  =  ZERO                                     0000000
105920          IF   SA2-DATEC   NUMERIC                                0000000
105930           AND SA2-DATEC   NOT  =  ZERO                           0000000
105940               PERFORM CALCUL-DURFRANC.                           0000000
105950*                                                                 0000000
105960     IF   PROBLEME-DATE = ZERO                                    0000000
105970          MOVE ZERO TO Z-DIVIDENDE                                0000000
105980          MOVE ZERO TO Z-RESTE                                    0000000
105990          DIVIDE Z-DURFRANC BY Z-PER                              0000000
106000                            GIVING Z-DIVIDENDE                    0000000
106010                            REMAINDER Z-RESTE                     0000000
106020D         DISPLAY 'Z-DIVIDENDE ' Z-DIVIDENDE ' ' Z-RESTE          0000000
106030          IF  Z-RESTE = ZERO                                      0000000
106040              COMPUTE Z-DURB-RECTIF = Z-DIVIDENDE * Z-PER         0000000
106050          ELSE                                                    0000000
106060              COMPUTE Z-DURB-RECTIF = (Z-DIVIDENDE + 1)           0000000
106070                                      * Z-PER.                    0000000
106080*                                                                 0000000
106090D    DISPLAY 'RECTIF AGRI: ' Z-DURB-RECTIF.                       0000000
106100     COMPUTE Z-DURB-RECTIF = SAY-DURAMLT - Z-DURB-RECTIF.         0000000
106110                                                                  0000000
106120 TRAIT-TXCOTOCM.                                                  0000000
106130*-------------------------                                        0000000
106140     MOVE    ZERO     TO Z-TXCOTOCM.                              0000000
106150     MOVE    ZERO     TO Z-MCOTOCM.                               0000000
106160****                                 spitab     prtgarco          0000000
106170     IF SAY-GAR1 EQUAL '81' OR '82' OR '87'                       0000000
106180        PERFORM APPEL-ZPRTCOAR                                    0000000
106190        IF   COA-TXCOMGES NUMERIC                                 0000000
106200             MOVE COA-TXCOMGES TO Z-TXCOTOCM                      0000000
106210        ELSE MOVE ZERO         TO Z-TXCOTOCM.                     0000000
106220                                                                  0000000
106230     COMPUTE W-MONT = ( SAY-MTCRED * Z-DURAMORT                   0000000
106240                      * Z-TXCOTOCM ) / 1200.                      0000000
106250     MOVE W-MONT TO Z-MCOTOCM.                                    0000000
106260     IF Z-MCOTOCM NOT = ZERO                                      0000000
106270        MOVE Z-MCOTOCM  TO IPPPRI-MCOTOCM                         0000000
106280     ELSE                                                         0000000
106290        MOVE ZERO       TO IPPPRI-MCOTOCM-X.                      0000000
106300****                                                              0000000
106310*                                                                 0000000
106320 APPEL-ZPRTCOAR.                                                  0000000
106330*-------------------------                                        0000000
106340*                                                                 0000000
106350*    /COA RAJOUTE PAR CLAUSS LE 12/08/91                          0000000
106360*    APPEL SS-PGM ZPRTCOAR                                        0000000
106370     MOVE ZERO          TO  COA-RC.                               0000000
106380     MOVE SAY-FED       TO  COA-FED.                              0000000
106390     MOVE SAY-BANQ      TO  COA-BANQ.                             0000000
106400     MOVE SAY-NCAIS     TO  COA-CAISSE.                           0000000
106410     MOVE SAY-GAR1      TO  COA-GAR.                              0000000
106420     MOVE SAY-CNAT      TO  COA-CPROD.                            0000000
106430*    A L'OUVERTURE : DATE DU JOUR                                 0000000
106440*    EN MODIF      : CP2-DATOUV                                   0000000
106450     IF   DATOUV-SSAAMMJJ NUMERIC                                 0000000
106460     AND  DATOUV-SSAAMMJJ GREATER THAN ZERO                       0000000
106470          MOVE DATOUV-SSAAMMJJ TO  COA-DATOUV                     0000000
106480     ELSE MOVE W-DATE          TO  COA-DATOUV.                    0000000
106490     MOVE W-DATE        TO  COA-DATJOUR.                          0000000
106500     MOVE 'X'           TO  COA-ORIG.                             0000000
106510*                                                                 0000000
106520D    DISPLAY 'PRTCOA PARAMETRES ALLER '                           0000000
106530D    DISPLAY '- COA-FED       = ' COA-FED.                        0000000
106540D    DISPLAY '- COA-BANQ      = ' COA-BANQ.                       0000000
106550D    DISPLAY '- COA-GAR       = ' COA-GAR.                        0000000
106560D    DISPLAY '- COA-CPROD     = ' COA-CPROD.                      0000000
106570D    DISPLAY '- COA-DATOUV    = ' COA-DATOUV.                     0000000
106580D    DISPLAY '- COA-ORIG      = ' COA-ORIG.                       0000000
106590D    DISPLAY '- COA-CAISSE    = ' COA-CAISSE.                     0000000
106600D    DISPLAY '- COA-DATJOUR   = ' COA-DATJOUR.                    0000000
106610                                                                  0000000
106620     CALL 'ZCALLPGM' USING ZPRTCOAR                               0000000
106630                           PCBSPI                                 0000000
106640                           PRTCOA.                                0000000
106650                                                                  0000000
106660D    DISPLAY 'PRTCOA PARAMETRES RETOUR'                           0000000
106670D    DISPLAY '- COA-TXCOMGAR  = ' COA-TXCOMGAR.                   0000000
106680D    DISPLAY '- COA-TXCOMGES  = ' COA-TXCOMGES.                   0000000
106690D    DISPLAY '- COA-RC        = ' COA-RC.                         0000000
106700D    DISPLAY '- COA-MSG       = ' COA-MSG.                        0000000
106710*                                                                 0000000
106720     IF NOT COA-RC-OK                                             0000000
106730          DISPLAY 'PROBLEME ZPRTCOAR : '                          0000000
106740                SAY-NCAI '/'                                      0000000
106750                SAY-RAC1 '/'                                      0000000
106760                SAY-DOSSIER '/'                                   0000000
106770                SAY-CAT                                           0000000
106780                'RC = '                                           0000000
106790                COA-RC.                                           0000000
106800*                                                                 0000000
106810     IF COA-RC-ANOM                                               0000000
106820      OR COA-ACTIF-NON                                            0000000
106830        MOVE ZERO    TO COA-TXCOMGAR                              0000000
106840                        COA-TXCOMGES.                             0000000
106850                                                                  0000000
106860 CHARGE-SAI-TABELT.                                               0000000
106870*-------------------------                                        0000000
106880      IF   TE1-TERME      OF TABAMO (IT) NUMERIC                  0000000
106890           MOVE TE1-TERME OF TABAMO (IT) TO SAI-TER  (IT)         0000000
106900      ELSE                                                        0000000
106910           MOVE ZERO                     TO SAI-TER  (IT).        0000000
106920      IF   TE1-NBTER      OF TABAMO (IT) NUMERIC                  0000000
106930           MOVE TE1-NBTER OF TABAMO (IT) TO SAI-NB   (IT)         0000000
106940      ELSE                                                        0000000
106950           MOVE ZERO                     TO SAI-NB   (IT).        0000000
106960      IF   TE1-TAUX       OF TABAMO (IT) NUMERIC                  0000000
106970           MOVE TE1-TAUX  OF TABAMO (IT) TO SAI-TAUX (IT)         0000000
106980      ELSE                                                        0000000
106990           MOVE ZERO                     TO SAI-TAUX (IT).        0000000
107000                                                                  0000000
107010      MOVE ZERO                          TO SAI-PR   (IT).        0000000
107020                                                                  0000000
107030                                                                  0000000
107040 CHARGE-SPECIAL-PC-NEW2.                                          0000000
107050*----------------------                                           0000000
107060                                                                  0000000
107070     MOVE ZERO      TO IPPRGT-TXCFFREF.                           0000000
107080     MOVE ZERO      TO IPPRGT-TXCFFMRG.                           0000000
107090     MOVE ZERO      TO IPPRGT-TXCFFMAX.                           0000000
107100     MOVE ZERO      TO IPPRGT-DURREVIS.                           0000000
107110     MOVE ZERO      TO IPPRGT-DURANNEE.                           0000000
107120*                                                                 0000000
107130     MOVE ZERO       TO W-TAUX.                                   0000000
107140     MOVE ZERO       TO W-MRG-FIXE-MOINS12                        0000000
107150                        W-MRG-FIXE-12-15                          0000000
107160                        W-MRG-FIXE-15-20                          0000000
107170                        W-MRG-FIXE-PLUS20.                        0000000
107180                                                                  0000000
107190     MOVE ZERO       TO W-MRG-VAR-MOINS12                         0000000
107200                        W-MRG-VAR-12-15                           0000000
107210                        W-MRG-VAR-15-20                           0000000
107220                        W-MRG-VAR-PLUS20.                         0000000
107230                                                                  0000000
107240     MOVE ZERO       TO W-TAUMAX.                                 0000000
107250*                                                                 0000000
107260     PERFORM INIT-NUM-COND-TAUX.                                  0000000
107270     MOVE  'CHARGE-SPECIAL-PC-NEW2'  TO  PARA-ERR-SBC             0000000
107280     PERFORM RECH-BASE-COND.                                      0000000
107290                                                                  0000000
107300     IF  SBCFRE-TRT-CORRECT                                       0000000
107310         PERFORM TRAIT-TAUX-PC-NEW.                               0000000
107320                                                                  0000000
107330*                                                                 0000000
107340 TRAIT-TAUX-PC-NEW.                                               0000000
107350*------------------                                               0000000
107360                                                                  0000000
107370     IF   SBCS01-L0001-NB-OCC-VAL  =  1  AND                      0000000
107380          SBCS01-L0001-NB-DEC  =  4                               0000000
107390          PERFORM RECH-TAUX-BASE-COND                             0000000
107400          PERFORM INIT-NUM-COND-MARGES                            0000000
107410          MOVE  'TRAIT-TAUX-PC-NEW 1 '  TO  PARA-ERR-SBC          0000000
107420          PERFORM RECH-BASE-COND                                  0000000
107430                                                                  0000000
107440          IF   SBCFRE-TRT-CORRECT                                 0000000
107450               PERFORM TRAIT-MARGES-PC-NEW                        0000000
107460          ELSE                                                    0000000
107470               NEXT SENTENCE                                      0000000
107480     ELSE                                                         0000000
107490          MOVE  'TRAIT-TAUX-PC-NEW 2 '  TO  PARA-ERR-SBC          0000000
107500          PERFORM  ERREUR-SBCGAPEL.                               0000000
107510                                                                  0000000
107520*                                                                 0000000
107530 RECH-TAUX-BASE-COND.                                             0000000
107540*--------------------                                             0000000
107550                                                                  0000000
107560                                                                  0000000
107570     IF  SBCS01-L0001-TYP-PCT                                     0000000
107580       IF  SBCS01-L0001-PCT (1)  NUMERIC                          0000000
107590           MOVE  SBCS01-L0001-PCT (1)  TO  W-TAUX                 0000000
107600d          display 'SBO2901 W-TAUX =' W-TAUX                      0000000
107610       END-IF                                                     0000000
107620     END-IF                                                       0000000
107630     .                                                            0000000
107640                                                                  0000000
107650 TRAIT-MARGES-PC-NEW.                                             0000000
107660*--------------------                                             0000000
107670*                                                                 0000000
107680     IF   SBCS01-L0001-NB-OCC-VAL  =  8  AND                      0000000
107690          SBCS01-L0001-NB-DEC  =  4                               0000000
107700          PERFORM RECH-MARGES-BASE-COND                           0000000
107710          PERFORM AFFECT-TX-CFF                                   0000000
107720     ELSE                                                         0000000
107730          MOVE  'TRAIT-MARGES-PC-NEW'  TO  PARA-ERR-SBC           0000000
107740          PERFORM  ERREUR-SBCGAPEL                                0000000
107750     END-IF                                                       0000000
107760     .                                                            0000000
107770*                                                                 0000000
107780 RECH-MARGES-BASE-COND.                                           0000000
107790*----------------------                                           0000000
107800*                                                                 0000000
107810     IF   SBCS01-L0001-PCT (1)  NUMERIC                           0000000
107820     AND  SBCS01-L0001-PCT (2)  NUMERIC                           0000000
107830     AND  SBCS01-L0001-PCT (3)  NUMERIC                           0000000
107840     AND  SBCS01-L0001-PCT (4)  NUMERIC                           0000000
107850          MOVE  SBCS01-L0001-PCT (1)  TO W-MRG-FIXE-MOINS12       0000000
107860          MOVE  SBCS01-L0001-PCT (2)  TO W-MRG-FIXE-12-15         0000000
107870          MOVE  SBCS01-L0001-PCT (3)  TO W-MRG-FIXE-15-20         0000000
107880          MOVE  SBCS01-L0001-PCT (4)  TO W-MRG-FIXE-PLUS20.       0000000
107890                                                                  0000000
107900     IF   SBCS01-L0001-PCT (5)  NUMERIC                           0000000
107910     AND  SBCS01-L0001-PCT (6)  NUMERIC                           0000000
107920     AND  SBCS01-L0001-PCT (7)  NUMERIC                           0000000
107930     AND  SBCS01-L0001-PCT (8)  NUMERIC                           0000000
107940          MOVE  SBCS01-L0001-PCT (5)  TO W-MRG-VAR-MOINS12        0000000
107950          MOVE  SBCS01-L0001-PCT (6)  TO W-MRG-VAR-12-15          0000000
107960          MOVE  SBCS01-L0001-PCT (7)  TO W-MRG-VAR-15-20          0000000
107970          MOVE  SBCS01-L0001-PCT (8)  TO W-MRG-VAR-PLUS20.        0000000
107980                                                                  0000000
107990 AFFECT-TX-CFF.                                                   0000000
108000*--------------                                                   0000000
108010                                                                  0000000
108020d    display 'sbo29012007 AFFECT-TX-CFF SAY-VTAU=' SAY-VTAU       0000000
108030     MOVE W-TAUX    TO IPPRGT-TXCFFREF.                           0000000
108040                                                                  0000000
108050     IF   SAY-VTAU = '1'                                          0000000
108060          PERFORM AFFECT-TX-FIXE                                  0000000
108070     ELSE                                                         0000000
108080          PERFORM AFFECT-TX-VAR.                                  0000000
108090                                                                  0000000
108100     MOVE W-TAUMAX  TO IPPRGT-TXCFFMAX                            0000000
108110                                                                  0000000
108120*    If  ipxpro-ppl                                               0000000
108130         MOVE W-TAUMAX  TO IPPPRI-TXEFFMHY                        0000000
108140d    display 'sbo29012007 IPPPRI-TXEFFMHY=' IPPPRI-TXEFFMHY       0000000
108150*    End-if.                                                      0000000
108160     .                                                            0000000
108170                                                                  0000000
108180 AFFECT-TX-FIXE.                                                  0000000
108190*---------------                                                  0000000
108200     MOVE  ZERO  TO  WS-DURTOT.                                   0000000
108210     IF  (SAY-CNAT     =  '291' OR '304' OR '302') AND            0000000
108220          SAY-TZBAR-DIFFERE-100                                   0000000
108230          MOVE Z-DURTOTAL  TO  WS-DURTOT                          0000000
108240     ELSE                                                         0000000
108250          IF   SAY-DURAM NUMERIC                                  0000000
108260               MOVE  SAY-DURAM  TO  WS-DURTOT.                    0000000
108270                                                                  0000000
108280D    DISPLAY  ' DURTOT ' SAY-CNAT ' ' WS-DURTOT.                  0000000
108290D    DISPLAY  ' W-MRG-FIXE-MOINS12=' W-MRG-FIXE-MOINS12           0000000
108300D    DISPLAY  ' W-MRG-FIXE-12-15  =' W-MRG-FIXE-12-15             0000000
108310D    DISPLAY  ' W-MRG-FIXE-15-20  =' W-MRG-FIXE-15-20             0000000
108320D    DISPLAY  ' W-MRG-FIXE-PLUS20.=' W-MRG-FIXE-PLUS20            0000000
108330                                                                  0000000
108340     IF   WS-DURTOT NOT > 144                                     0000000
108350          MOVE W-MRG-FIXE-MOINS12 TO IPPRGT-TXCFFMRG              0000000
108360          COMPUTE W-TAUMAX = W-TAUX + W-MRG-FIXE-MOINS12          0000000
108370     ELSE                                                         0000000
108380     IF   WS-DURTOT > 144 AND NOT > 180                           0000000
108390          MOVE W-MRG-FIXE-12-15   TO IPPRGT-TXCFFMRG              0000000
108400          COMPUTE W-TAUMAX = W-TAUX + W-MRG-FIXE-12-15            0000000
108410     ELSE                                                         0000000
108420     IF   WS-DURTOT > 180 AND NOT > 240                           0000000
108430          MOVE W-MRG-FIXE-15-20   TO IPPRGT-TXCFFMRG              0000000
108440          COMPUTE W-TAUMAX = W-TAUX + W-MRG-FIXE-15-20            0000000
108450     ELSE                                                         0000000
108460          MOVE W-MRG-FIXE-PLUS20  TO IPPRGT-TXCFFMRG              0000000
108470          COMPUTE W-TAUMAX = W-TAUX + W-MRG-FIXE-PLUS20.          0000000
108480                                                                  0000000
108490D         DISPLAY 'TXCFF '           IPPRGT-TXCFFMRG.             0000000
108500                                                                  0000000
108510 AFFECT-TX-VAR.                                                   0000000
108520*--------------                                                   0000000
108530                                                                  0000000
108540     IF   SAY-DURAM NUMERIC                                       0000000
108550     AND  SAY-DURAM NOT > 144                                     0000000
108560          MOVE W-MRG-VAR-MOINS12 TO IPPRGT-TXCFFMRG               0000000
108570          COMPUTE W-TAUMAX = W-TAUX + W-MRG-VAR-MOINS12           0000000
108580     ELSE                                                         0000000
108590     IF   SAY-DURAM NUMERIC                                       0000000
108600     AND  SAY-DURAM > 144 AND NOT > 180                           0000000
108610          MOVE W-MRG-VAR-12-15   TO IPPRGT-TXCFFMRG               0000000
108620          COMPUTE W-TAUMAX = W-TAUX + W-MRG-VAR-12-15             0000000
108630     ELSE                                                         0000000
108640     IF   SAY-DURAM NUMERIC                                       0000000
108650     AND  SAY-DURAM > 180 AND NOT > 240                           0000000
108660          MOVE W-MRG-VAR-15-20   TO IPPRGT-TXCFFMRG               0000000
108670          COMPUTE W-TAUMAX = W-TAUX + W-MRG-VAR-15-20             0000000
108680     ELSE                                                         0000000
108690          MOVE W-MRG-VAR-PLUS20  TO IPPRGT-TXCFFMRG               0000000
108700          COMPUTE W-TAUMAX = W-TAUX + W-MRG-VAR-PLUS20.           0000000
108710                                                                  0000000
108720 INIT-NUM-COND-TAUX.                                              0000000
108730*-------------------                                              0000000
108740                                                                  0000000
108750     MOVE '0000484'       TO  COND-NUMERO.                        0000000
108760                                                                  0000000
108770 INIT-NUM-COND-MARGES.                                            0000000
108780*---------------------                                            0000000
108790                                                                  0000000
108800     IF   SAY-CNAT = '265'                                        0000000
108810          PERFORM INIT-COND-MARGE-265                             0000000
108820     ELSE                                                         0000000
108830          PERFORM INIT-COND-MARGE-FGAS.                           0000000
108840                                                                  0000000
108850 INIT-COND-MARGE-265.                                             0000000
108860*--------------------                                             0000000
108870                                                                  0000000
108880     MOVE '0000485'       TO  COND-NUMERO.                        0000000
108890                                                                  0000000
108900 INIT-COND-MARGE-FGAS.                                            0000000
108910*---------------------                                            0000000
108920                                                                  0000000
108930     MOVE '0000486'       TO  COND-NUMERO.                        0000000
108940                                                                  0000000
108950 RECH-BASE-COND.                                                  0000000
108960*---------------                                                  0000000
108970     PERFORM  INIT-SBCFAL                                         0000000
108980     PERFORM  APPEL-SBCGAPEL                                      0000000
108990                                                                  0000000
109000     IF   SBCFRE-TRT-INCORRECT                                    0000000
109010          OR   SBCS01-L0001-NB-OCC-VAL   NOT NUMERIC              0000000
109020          OR   SBCS01-L0001-NB-DEC       NOT NUMERIC              0000000
109030          MOVE  'RECH-BASE-COND'  TO  PARA-ERR-SBC                0000000
109040          PERFORM  ERREUR-SBCGAPEL                                0000000
109050     END-IF                                                       0000000
109060     .                                                            0000000
109070                                                                  0000000
109080                                                                  0000000
109090 ERREUR-SBCGAPEL.                                                 0000000
109100*---------------                                                  0000000
109110     DISPLAY 'ERREUR IPXBATCH / RETOUR SBCGAPEL'.                 0000000
109120     DISPLAY '***  ' PARA-ERR-SBC  '  ***'                        0000000
109130     DISPLAY '- IPPMA2-CLE = ' IPPMA2-CLE.                        0000000
109140     DISPLAY '       '                                            0000000
109150     DISPLAY '***  SORTIE  SBCGAPEL  ***'                         0000000
109160     DISPLAY '       '                                            0000000
109170     DISPLAY  'SBCFRE-COD-RET-PRIMAIRE = '                        0000000
109180                                     SBCFRE-COD-RET-PRIMAIRE      0000000
109190     DISPLAY  'SBCFRE-COD-RET-SCD      = ' SBCFRE-COD-RET-SCD     0000000
109200     DISPLAY  '      '                                            0000000
109210     DISPLAY  '  **  SBCFRE-MSG-ERR-TEC  **'                      0000000
109220     DISPLAY  'SBCFRE-TEC-PGM          = ' SBCFRE-TEC-PGM         0000000
109230     DISPLAY  'SBCFRE-TEC-DATE         = ' SBCFRE-TEC-DATE        0000000
109240     DISPLAY  'SBCFRE-TEC-HEURE        = ' SBCFRE-TEC-HEURE       0000000
109250     DISPLAY  'SBCFRE-TEC-IDE-ORD      = ' SBCFRE-TEC-IDE-ORD     0000000
109260     DISPLAY  'SBCFRE-TEC-RET          = ' SBCFRE-TEC-RET         0000000
109270     DISPLAY  'SBCFRE-TEC-IDE-DMD      = ' SBCFRE-TEC-IDE-DMD     0000000
109280     DISPLAY  'SBCFRE-TEC-IDE-UTI      = ' SBCFRE-TEC-IDE-UTI     0000000
109290     DISPLAY  'SBCFRE-TEC-IDE-EME      = ' SBCFRE-TEC-IDE-EME     0000000
109300     DISPLAY  '      '                                            0000000
109310     DISPLAY  '  **  SBCFRE-MSG-ERR-MET  **'                      0000000
109320     DISPLAY  'SBCFRE-MET-PGM          = ' SBCFRE-MET-PGM         0000000
109330     DISPLAY  'SBCFRE-MET-RET-PR       = ' SBCFRE-MET-RET-PR      0000000
109340     DISPLAY  'SBCFRE-MET-RET-SCD      = ' SBCFRE-MET-RET-SCD     0000000
109350     DISPLAY  'SBCFRE-MET-MSG          = ' SBCFRE-MET-MSG         0000000
109360     DISPLAY  '      '                                            0000000
109370     DISPLAY '***  ENTREE  SBCGAPEL  ***'                         0000000
109380     DISPLAY '       '                                            0000000
109390     DISPLAY 'SBCE01-L0001-REF-ORG... = ' SBCE01-L0001-REF-ORG    0000000
109400     DISPLAY 'SBCE01-L0001-COD-BQE... = ' SBCE01-L0001-COD-BQE    0000000
109410     DISPLAY 'SBCE01-L0001-REF-CND... = ' SBCE01-L0001-REF-CND    0000000
109420     DISPLAY 'SBCE01-L0001-REF-PRD... = ' SBCE01-L0001-REF-PRD    0000000
109430     DISPLAY 'SBCE01-L0001-IDE-CLI... = ' SBCE01-L0001-IDE-CLI    0000000
109440     DISPLAY 'SBCE01-L0001-REF-CLI... = ' SBCE01-L0001-REF-CLI    0000000
109450     DISPLAY 'SBCE01-L0001-DEVISE.... = ' SBCE01-L0001-DEVISE     0000000
109460     DISPLAY 'SBCE01-L0001-DATE-EFFET = ' SBCE01-L0001-DATE-EFFET 0000000
109470     DISPLAY 'SBCE01-L0001-IDE-ORG... = ' SBCE01-L0001-IDE-ORG    0000000
109480     DISPLAY 'SBCE01-L0001-REF-ORG... = ' SBCE01-L0001-REF-ORG    0000000
109490     DISPLAY 'SBCE01-L0001-TYPE-DEMANDE. = '                      0000000
109500              SBCE01-L0001-TYPE-DEMANDE                           0000000
109510     DISPLAY 'SBCE01-L0001-FLAG-CONTROLE = '                      0000000
109520              SBCE01-L0001-FLAG-CONTROLE                          0000000
109530     DISPLAY '       '                                            0000000
109540     .                                                            0000000
109550                                                                  0000000
109560*-------------------------                                        0000000
109570 TRAIT-CAPITAL-LETTRE.                                            0000000
109580*-------------------------                                        0000000
109590                                                                  0000000
109600     MOVE IPPMA2-DEVISE   TO ZPRTLETT-DEVISE.                     0000000
109610     MOVE SAY-MTCRED      TO ZPRTLETT-MONTANT-N.                  0000000
109620     MOVE ZERO            TO IPPPRI-MCAPITAL-X.                   0000000
109630                                                                  0000000
109640     IF (CONTRAT OR  CONTRAT-GPR) and                             0000000
109650         SAY-MTCRED  NOT  =  ZERO                                 0000000
109660             MOVE SAY-MTCRED      TO IPPPRI-MCAPITAL              0000000
109670             ADD  SAY-MTCRED      TO Z-MTOTPRET                   0000000
109680     ELSE                                                         0000000
109690d            display  'Cpt-crd      '  cpt-crd                    0000000
109700d            display  'Cpt-soldaux  '  cpt-soldaux                0000000
109710d            display  'Avenant = oui'                             0000000
109720             IF CPT-CRD      NUMERIC   AND                        0000000
109730                CPT-SOLDAUX  NUMERIC                              0000000
109740d               display  'Crd et Soldaux OK'                      0000000
109750                COMPUTE     W-KRDU  =                             0000000
109760                      CPT-CRD  +  CPT-SOLDAUX                     0000000
109770                MOVE  W-KRDU      TO  IPPPRI-KRDU                 0000000
109780                MOVE  CPT-MONT    TO  IPPPRI-MCAPITAL             0000000
109790                                      ZPRTLETT-MONTANT-N.         0000000
109800                                                                  0000000
109810D    DISPLAY ' KRDU ' IPPPRI-KRDU.                                0000000
109820                                                                  0000000
109830     PERFORM MONTANT-EN-LETTRES.                                  0000000
109840                                                                  0000000
109850     IF ZPRTLETT-OPTION NOT = ZERO                                0000000
109860        MOVE 9 TO TEST-1                                          0000000
109870        PERFORM  TRAIT-ANOMALIE                                   0000000
109880     ELSE                                                         0000000
109890        MOVE ZPRTLETT-MONTANT-L TO IPPPRI-LCAPITAL.               0000000
109900                                                                  0000000
109910 MONTANT-EN-LETTRES.                                              0000000
109920*-------------------------                                        0000000
109930     MOVE SPACE       TO ZPRTLETT-SORTIES.                        0000000
109940     MOVE SPACE       TO ZPRTLETT-MONTANT-L.                      0000000
109950     MOVE 160         TO ZPRTLETT-LONGUEUR.                       0000000
109960     MOVE ZERO        TO ZPRTLETT-OPTION.                         0000000
109970     CALL 'ZCALLPGM' USING ZPRTLETT                               0000000
109980                           ZPRTLETT-PARAMS.                       0000000
109990                                                                  0000000
110000*-------------------------                                        0000000
110010 TRAIT-TAUX-LETTRE.                                               0000000
110020*-------------------------                                        0000000
110030                                                                  0000000
110040     IF   SAY-TAUSURD  NOT  NUMERIC                               0000000
110050          MOVE  ZERO  TO  SAY-TSURD                               0000000
110060     END-IF                                                       0000000
110070     IF   SAY-TAUSURI  NOT  NUMERIC                               0000000
110080          MOVE  ZERO  TO  SAY-TSURI                               0000000
110090     END-IF                                                       0000000
110100                                                                  0000000
110110     IF SAY-MGES  =  '6'                                          0000000
110120        MOVE SAY-TAUDBS     TO IPPPRI-TXPRET  IPPPRI-TXEFFECT     0000000
110130        MOVE SAY-TAUDBS     TO ZTAUXLET-TAUX  w-tau1j             0000000
110140        MOVE WS-TAUX        TO IPPPRI-TXFRANCH-X                  0000000
110150     ELSE                                                         0000000
110160        IF  APXTRE-ENCOURS                                        0000000
110170             COMPUTE  WS-TAUX  =  SAY-TAUDB  - APXTRE-TAUTARPLV   0000000
110180             MOVE WS-TAUX        TO IPPPRI-TXPRET                 0000000
110190             MOVE WS-TAUX        TO ZTAUXLET-TAUX w-tau1j         0000000
110200             IF  SAY-TAFR  NUMERIC                                0000000
110210                COMPUTE  WS-TAUX-FR =                             0000000
110220                                    SAY-TAUFR - APXTRE-TAUTARPLV  0000000
110230                MOVE     WS-TAUX-FR   TO  IPPPRI-TXFRANCH         0000000
110240             ELSE                                                 0000000
110250                MOVE     WS-TAUX    TO  IPPPRI-TXFRANCH           0000000
110260             END-IF                                               0000000
110270        ELSE                                                      0000000
110280             IF SAY-TAFR NUMERIC                                  0000000
110290                MOVE SAY-TAUFR   TO IPPPRI-TXFRANCH               0000000
110300             ELSE                                                 0000000
110310                MOVE SAY-TAUDB   TO IPPPRI-TXFRANCH               0000000
110320             END-IF                                               0000000
110330             MOVE SAY-TAUDB      TO IPPPRI-TXPRET                 0000000
110340             MOVE SAY-TAUDB      TO ZTAUXLET-TAUX  w-tau1j        0000000
110350        END-IF                                                    0000000
110360     END-IF                                                       0000000
110370     If  orgs01-banque-cic                                        0000000
110380         If  say-cnat  not  =  '307'                              0000000
110390             MOVE  Zero       TO IPPPRI-TXFRANCH-X                0000000
110400         End-if                                                   0000000
110410     End-if                                                       0000000
110420                                                                  0000000
110430     If  dossier-goethe  or langue-allemande                      0000000
110440         Perform  CALCUL-INT-1JOUR                                0000000
110450     End-if                                                       0000000
110460     .                                                            0000000
110470                                                                  0000000
110480D    DISPLAY 'SAY-TAUDB = ' SAY-TAUDB                             0000000
110490D    DISPLAY 'APXTRE-TAUTARPLV ' APXTRE-TAUTARPLV                 0000000
110500D    DISPLAY 'SAY-TSURD = ' SAY-TSURD                             0000000
110510D    DISPLAY 'SAY-TSURI = ' SAY-TSURI                             0000000
110520                                                                  0000000
110530*--------------------                                             0000000
110540                                                                  0000000
110550*FG-0190-POUR LES PRETS BONIFIES AGRICOLES, LE TAUX DU PRET EST LE0000000
110560*       -TAUX EFFECTIF MOYEN                                      0000000
110570                                                                  0000000
110580     IF (( IPPMA2-2-CNAT9 (IP) > 600 AND < 610) OR                0000000
110590          (IPPMA2-2-CNAT (IP) = '620' OR '621')                   0000000
110600          OR  (IPPMA2-2-CNAT (IP) > '640' and < '648'))           0000000
110610        IF  (Z-DURAMOR1  NOT  =  Z-DURAMORT)                      0000000
110620D          DISPLAY '  Z-DURAMORT dif   Z-DURAMOR1'                0000000
110630D          DISPLAY '  Z-DURAMORT = ' Z-DURAMORT                   0000000
110640D          DISPLAY '  Z-DURAMOR1 = ' Z-DURAMOR1                   0000000
110650D          DISPLAY '  SAI-TEFF   = ' SAI-TEFF                     0000000
110660           MOVE SAI-TEFF       TO IPPPRI-TXPRET                   0000000
110670           MOVE SAI-TEFF       TO ZTAUXLET-TAUX.                  0000000
110680                                                                  0000000
110690     MOVE  3          TO ZTAUXLET-NBRDEC.                         0000000
110700     MOVE ZERO        TO ZTAUXLET-OPTION.                         0000000
110710     MOVE SPACE       TO ZTAUXLET-TEXTE.                          0000000
110720     MOVE ZERO        TO ZTAUXLET-RETOUR.                         0000000
110730     CALL 'ZCALLPGM' USING ZTAUXLET                               0000000
110740                           ZTAUXLET-TAUX                          0000000
110750                           ZTAUXLET-NBRDEC                        0000000
110760                           ZTAUXLET-OPTION                        0000000
110770                           ZTAUXLET-LONGUEUR                      0000000
110780                           ZTAUXLET-TEXTE                         0000000
110790                           ZTAUXLET-RETOUR.                       0000000
110800     IF   ZTAUXLET-RETOUR  NOT  =  ZERO                           0000000
110810          MOVE 10 TO TEST-1                                       0000000
110820          PERFORM  TRAIT-ANOMALIE                                 0000000
110830     ELSE MOVE ZTAUXLET-TEXTE TO IPPPRI-LTXPRET                   0000000
110840          IF  LANGUE-ALLEMANDE                                    0000000
110850              MOVE 'PROZENT'      TO IPPPRI-LTXPRET-PC            0000000
110860          ELSE                                                    0000000
110870              MOVE 'POUR-CENT'    TO IPPPRI-LTXPRET-PC.           0000000
110880                                                                  0000000
110890 CALCUL-INT-1JOUR.                                                0000000
110900                                                                  0000000
110910     Compute  w-int1j rounded = (say-mtcred * w-tau1j) / 36500    0000000
110920     Move     w-int1j    to  IPPPRI-TZINT                         0000000
110930d    display 'w-int1j  '     IPPPRI-TZINT                         0000000
110940     .                                                            0000000
110950                                                                  0000000
110960*---------------                                                  0000000
110970 TRAIT-PAIEMENT.                                                  0000000
110980*---------------                                                  0000000
110990                                                                  0000000
111000     IF  LANGUE-ALLEMANDE                                         0000000
111010         PERFORM  TRAIT-PAIEMENT-AL                               0000000
111020     ELSE                                                         0000000
111030         PERFORM  TRAIT-PAIEMENT-FR                               0000000
111040     END-IF                                                       0000000
111050     .                                                            0000000
111060                                                                  0000000
111070*---------------                                                  0000000
111080 TRAIT-PAIEMENT-AL.                                               0000000
111090*---------------                                                  0000000
111100                                                                  0000000
111110     MOVE    ZERO            TO IPPPRI-PERFR.                     0000000
111120     If say-ass-mensuelle                                         0000000
111130       IF  NOT  AVENANT                                           0000000
111140           IF SAY-DEJJR  NOT = '05' AND NOT = '10' AND NOT = '15' 0000000
111150                   AND NOT = '20' AND NOT = '25'                  0000000
111160                MOVE 'LETZTEN TAG ' TO IPPPRI-JOUFRANC            0000000
111170           ELSE                                                   0000000
111180                MOVE SAY-DEJJR      TO IPPPRI-JOUFRANC            0000000
111190       ELSE                                                       0000000
111200           IF CPT-D13JJ  NOT = '05' AND NOT = '10' AND NOT = '15' 0000000
111210                   AND NOT = '20' AND NOT = '25'                  0000000
111220                MOVE 'LETZTEN TAG  ' TO IPPPRI-JOUFRANC           0000000
111230           ELSE                                                   0000000
111240                MOVE CPT-D13JJ      TO IPPPRI-JOUFRANC            0000000
111250           END-IF                                                 0000000
111260       END-IF                                                     0000000
111270     Else                                                         0000000
111280       MOVE 'LETZTEN TAG '     TO IPPPRI-JOUFRANC                 0000000
111290     End-if.                                                      0000000
111300                                                                  0000000
111310     IF   SAY-PERFR  = '3'                                        0000000
111320          MOVE 'QUARTALS'    TO IPPPRI-PERFRANC                   0000000
111330     ELSE                                                         0000000
111340     IF   SAY-PERFR  = '6'                                        0000000
111350          MOVE 'HALBJAHRES'  TO IPPPRI-PERFRANC                   0000000
111360     ELSE                                                         0000000
111370     IF   SAY-PERFR  = '9'                                        0000000
111380          MOVE 'JAHRES'      TO IPPPRI-PERFRANC                   0000000
111390     ELSE                                                         0000000
111400     IF   SAY-PERFR  = '7'                                        0000000
111410          MOVE   SPACE       TO IPPPRI-JOUFRANC                   0000000
111420          MOVE   SPACE       TO IPPPRI-PERFRANC                   0000000
111430          IF  ( ORGS01-FEDE-CEE )                                 0000000
111440                                                                  0000000
111450              MOVE    '7'        TO IPPPRI-PERFR                  0000000
111460          ELSE                                                    0000000
111470              MOVE    '1'        TO IPPPRI-PERFR                  0000000
111480          END-IF                                                  0000000
111490     ELSE                                                         0000000
111500     IF   SAY-PERFR  = '8'                                        0000000
111510          MOVE   SPACE       TO IPPPRI-JOUFRANC                   0000000
111520          MOVE   SPACE       TO IPPPRI-PERFRANC                   0000000
111530          MOVE    '2'        TO IPPPRI-PERFR                      0000000
111540     ELSE                                                         0000000
111550          MOVE 'MONATS'      TO IPPPRI-PERFRANC.                  0000000
111560                                                                  0000000
111570     IF  NOT  AVENANT                                             0000000
111580         IF   SAY-DEJJR  NOT = '05' AND NOT = '10' AND NOT = '15' 0000000
111590                 AND NOT = '20' AND NOT = '25'                    0000000
111600              MOVE 'LETZTEN TAG ' TO IPPPRI-JOUTERME              0000000
111610         ELSE                                                     0000000
111620              MOVE SAY-DEJJR      TO IPPPRI-JOUTERME              0000000
111630     ELSE                                                         0000000
111640         IF   CPT-D13JJ  NOT = '05' AND NOT = '10' AND NOT = '15' 0000000
111650                 AND NOT = '20' AND NOT = '25'                    0000000
111660              MOVE 'LETZTEN TAG  ' TO IPPPRI-JOUTERME             0000000
111670         ELSE                                                     0000000
111680              MOVE CPT-D13JJ      TO IPPPRI-JOUTERME              0000000
111690         END-IF                                                   0000000
111700     END-IF.                                                      0000000
111710                                                                  0000000
111720     MOVE 12 TO Z-NBMOIS.                                         0000000
111730                                                                  0000000
111740*                                                                 0000000
111750*    IF   Z-TYPCRED = 'IMMO-DV' OR 'PROF-DV' OR 'CONS-DV'         0000000
111760     IF SAY-MGES  =  '6'                                          0000000
111770          PERFORM TRAIT-PEREMBS-AL                                0000000
111780     ELSE                                                         0000000
111790          PERFORM TRAIT-PEREMB-AL.                                0000000
111800                                                                  0000000
111810 TRAIT-PEREMB-AL.                                                 0000000
111820*-----                                                            0000000
111830     IF   SAY-PEREMB  = '1'                                       0000000
111840          MOVE  12               TO Z-NBMOIS                      0000000
111850          MOVE 'MONAT '           TO IPPPRI-PERTERME              0000000
111860          MOVE 'MONATSRATEN   '  TO IPPPRI-LIBTERME.              0000000
111870     IF   SAY-PEREMB  = '3'                                       0000000
111880          MOVE  4                TO Z-NBMOIS                      0000000
111890          MOVE 'QUARTAL '        TO IPPPRI-PERTERME               0000000
111900          MOVE 'QUARTALSRATEN  ' TO IPPPRI-LIBTERME.              0000000
111910     IF   SAY-PEREMB  = '6'                                       0000000
111920          MOVE  2                TO Z-NBMOIS                      0000000
111930          MOVE 'HALBJAHR '       TO IPPPRI-PERTERME               0000000
111940          MOVE 'HALBJAHRESRATEN  ' TO IPPPRI-LIBTERME.            0000000
111950     IF   SAY-PEREMB  = '9'                                       0000000
111960          MOVE  1                TO Z-NBMOIS                      0000000
111970          MOVE 'JAHR '           TO IPPPRI-PERTERME               0000000
111980          MOVE 'JAHRESRATEN  '       TO IPPPRI-LIBTERME.          0000000
111990                                                                  0000000
112000     IF   Z-MODEGEST = 1                                          0000000
112010          IF   SAY-PERDEG   = '5'                                 0000000
112020               MOVE IPPPRI-JOUTERME TO IPPPRI-JOUINTER            0000000
112030               MOVE IPPPRI-PERTERME TO IPPPRI-PERINTER            0000000
112040          ELSE PERFORM TRAIT-PAIEMENT-MG1-AL.                     0000000
112050                                                                  0000000
112060*                                                                 0000000
112070 TRAIT-PEREMBS-AL.                                                0000000
112080                                                                  0000000
112090     IF   SAY-PEREMBS = '1'                                       0000000
112100          MOVE  12               TO Z-NBMOIS                      0000000
112110          MOVE 'MONAT '          TO IPPPRI-PERTERME               0000000
112120          MOVE 'MONATSRATEN   '  TO IPPPRI-LIBTERME.              0000000
112130     IF   SAY-PEREMBS = '3'                                       0000000
112140          MOVE  4                TO Z-NBMOIS                      0000000
112150          MOVE 'QUARTAL '        TO IPPPRI-PERTERME               0000000
112160          MOVE 'QUARTALSRATEN     ' TO IPPPRI-LIBTERME.           0000000
112170     IF   SAY-PEREMBS = '6'                                       0000000
112180          MOVE  2                TO Z-NBMOIS                      0000000
112190          MOVE 'HALBJAHR '       TO IPPPRI-PERTERME               0000000
112200          MOVE 'HALBJAHRESRATEN' TO IPPPRI-LIBTERME.              0000000
112210     IF   SAY-PEREMBS = '9'                                       0000000
112220          MOVE  1                TO Z-NBMOIS                      0000000
112230          MOVE 'JAHR '           TO IPPPRI-PERTERME               0000000
112240          MOVE 'JAHRESRATEN  '   TO IPPPRI-LIBTERME.              0000000
112250                                                                  0000000
112260     IF   Z-MODEGEST = 1                                          0000000
112270          IF   SAY-PERDEGS  = '5'                                 0000000
112280               MOVE IPPPRI-JOUTERME TO IPPPRI-JOUINTER            0000000
112290               MOVE IPPPRI-PERTERME TO IPPPRI-PERINTER            0000000
112300          ELSE PERFORM TRAIT-PAIEMENT-MG1S-AL.                    0000000
112310                                                                  0000000
112320*-------                                                          0000000
112330                                                                  0000000
112340*-------------------------                                        0000000
112350 TRAIT-PAIEMENT-MG1S-AL.                                          0000000
112360*-------------------------                                        0000000
112370     MOVE 'LETZTEN TAG '     TO IPPPRI-JOUINTER.                  0000000
112380     IF   SAY-PERDEGS = '1'                                       0000000
112390          MOVE 'MONATS '      TO IPPPRI-PERINTER.                 0000000
112400     IF   SAY-PERDEGS = '3'                                       0000000
112410          MOVE 'QUARTALS '    TO IPPPRI-PERINTER.                 0000000
112420     IF   SAY-PERDEGS = '6'                                       0000000
112430          MOVE 'HALBJAHRES '   TO IPPPRI-PERINTER.                0000000
112440     IF   SAY-PERDEGS = '9'                                       0000000
112450          MOVE 'JAHRES  '      TO IPPPRI-PERINTER.                0000000
112460                                                                  0000000
112470*-------------------------                                        0000000
112480 TRAIT-PAIEMENT-MG1-AL.                                           0000000
112490*-------------------------                                        0000000
112500     MOVE 'LETZTEN TAG '     TO IPPPRI-JOUINTER.                  0000000
112510     IF   SAY-PERDEG  = '1'                                       0000000
112520          MOVE 'MONATS '      TO IPPPRI-PERINTER.                 0000000
112530     IF   SAY-PERDEG  = '3'                                       0000000
112540          MOVE 'QUARTALS '    TO IPPPRI-PERINTER.                 0000000
112550     IF   SAY-PERDEG  = '6'                                       0000000
112560          MOVE 'HALBJAHRES '   TO IPPPRI-PERINTER.                0000000
112570     IF   SAY-PERDEG  = '9'                                       0000000
112580          MOVE 'JAHRES  '      TO IPPPRI-PERINTER.                0000000
112590*                                                                 0000000
112600*                                                                 0000000
112610                                                                  0000000
112620*-----------------                                                0000000
112630 TRAIT-PAIEMENT-FR.                                               0000000
112640*-----------------                                                0000000
112650                                                                  0000000
112660     MOVE    ZERO            TO IPPPRI-PERFR.                     0000000
112670*                                                                 0000000
112680     If  say-ass-mensuelle                                        0000000
112690       IF  NOT  AVENANT                                           0000000
112700           IF SAY-DEJJR  NOT = '05' AND NOT = '10' AND NOT = '15' 0000000
112710                   AND NOT = '20' AND NOT = '25'                  0000000
112720                MOVE 'DERNIER JOUR' TO IPPPRI-JOUFRANC            0000000
112730           ELSE                                                   0000000
112740                MOVE SAY-DEJJR      TO IPPPRI-JOUFRANC            0000000
112750       ELSE                                                       0000000
112760           IF CPT-D13JJ  NOT = '05' AND NOT = '10' AND NOT = '15' 0000000
112770                   AND NOT = '20' AND NOT = '25'                  0000000
112780                MOVE 'DERNIER JOUR' TO IPPPRI-JOUFRANC            0000000
112790           ELSE                                                   0000000
112800                MOVE CPT-D13JJ      TO IPPPRI-JOUFRANC            0000000
112810           END-IF                                                 0000000
112820       End-if                                                     0000000
112830     Else                                                         0000000
112840         MOVE 'DERNIER JOUR'     TO IPPPRI-JOUFRANC.              0000000
112850*                                                                 0000000
112860     IF   SAY-PERFR  = '3'                                        0000000
112870          MOVE 'TRIMESTRE '  TO IPPPRI-PERFRANC                   0000000
112880     ELSE                                                         0000000
112890     IF   SAY-PERFR  = '6'                                        0000000
112900          MOVE 'SEMESTRE '   TO IPPPRI-PERFRANC                   0000000
112910     ELSE                                                         0000000
112920     IF   SAY-PERFR  = '9'                                        0000000
112930          MOVE 'ANNEE '      TO IPPPRI-PERFRANC                   0000000
112940     ELSE                                                         0000000
112950     IF   SAY-PERFR  = '7'                                        0000000
112960          MOVE   SPACE       TO IPPPRI-JOUFRANC                   0000000
112970          MOVE   SPACE       TO IPPPRI-PERFRANC                   0000000
112980          IF  ( ORGS01-FEDE-CEE )                                 0000000
112990                                                                  0000000
113000              MOVE    '7'        TO IPPPRI-PERFR                  0000000
113010          ELSE                                                    0000000
113020              MOVE    '1'        TO IPPPRI-PERFR                  0000000
113030          END-IF                                                  0000000
113040     ELSE                                                         0000000
113050     IF   SAY-PERFR  = '8'                                        0000000
113060          MOVE 'DERNIER JOUR' TO IPPPRI-JOUFRANC                  0000000
113070          MOVE 'MOIS  '       TO IPPPRI-PERFRANC                  0000000
113080          MOVE    '2'         TO IPPPRI-PERFR                     0000000
113090     ELSE                                                         0000000
113100          MOVE 'MOIS '        TO IPPPRI-PERFRANC.                 0000000
113110d    display 'ipppri-perfr ' ipppri-perfr                         0000000
113120     IF  NOT  AVENANT                                             0000000
113130         IF   SAY-DEJJR  NOT = '05' AND NOT = '10' AND NOT = '15' 0000000
113140                 AND NOT = '20' AND NOT = '25'                    0000000
113150              MOVE 'DERNIER JOUR' TO IPPPRI-JOUTERME              0000000
113160         ELSE                                                     0000000
113170              MOVE SAY-DEJJR      TO IPPPRI-JOUTERME              0000000
113180     ELSE                                                         0000000
113190         IF   CPT-D13JJ  NOT = '05' AND NOT = '10' AND NOT = '15' 0000000
113200                 AND NOT = '20' AND NOT = '25'                    0000000
113210              MOVE 'DERNIER JOUR' TO IPPPRI-JOUTERME              0000000
113220         ELSE                                                     0000000
113230              MOVE CPT-D13JJ      TO IPPPRI-JOUTERME              0000000
113240         END-IF                                                   0000000
113250     END-IF.                                                      0000000
113260                                                                  0000000
113270**   If  say-ass-mensuelle                                        0000000
113280*        If ( ( say-perfr   =  '7'  or  '8' )   or                0000000
113290*             ( say-mges    =  '6'   and                          0000000
113300*               say-perdeg  =  '5' ) )                            0000000
113310*            continue                                             0000000
113320*        Else                                                     0000000
113330*            Move  ipppri-jouterme  to  ipppri-joufranc           0000000
113340**   End-if.                                                      0000000
113350                                                                  0000000
113360     IF IPXPRO-PPL  or  ipxpro-pl92                               0000000
113370                    or  ipxpro-pl-annecy                          0000000
113380        MOVE ZERO TO IPPPRI-PERFR                                 0000000
113390     END-IF                                                       0000000
113400                                                                  0000000
113410     MOVE 12 TO Z-NBMOIS.                                         0000000
113420                                                                  0000000
113430*                                                                 0000000
113440*    IF   Z-TYPCRED = 'IMMO-DV' OR 'PROF-DV' OR 'CONS-DV'         0000000
113450     IF SAY-MGES  =  '6'                                          0000000
113460          PERFORM TRAIT-PEREMBS                                   0000000
113470     ELSE                                                         0000000
113480          PERFORM TRAIT-PEREMB.                                   0000000
113490                                                                  0000000
113500     IF  (ORGS01-BANQUE-CIC OR ORGS01-FEDE-ARRAS )                0000000
113510         IF  NOT  ( SAY-PERFR  = '7'  OR  '8' )                   0000000
113520             MOVE  IPPPRI-JOUTERME   TO  IPPPRI-JOUFRANC          0000000
113530             MOVE  IPPPRI-PERTERME   TO  IPPPRI-PERFRANC          0000000
113540         END-IF                                                   0000000
113550     END-IF                                                       0000000
113560     .                                                            0000000
113570                                                                  0000000
113580 TRAIT-PEREMB.                                                    0000000
113590*-----                                                            0000000
113600     IF   SAY-PEREMB  = '1'                                       0000000
113610          MOVE  12               TO Z-NBMOIS                      0000000
113620          MOVE 'MOIS '           TO IPPPRI-PERTERME               0000000
113630          MOVE 'MENSUALITE(S) '  TO IPPPRI-LIBTERME.              0000000
113640     IF   SAY-PEREMB  = '3'                                       0000000
113650          MOVE  4                TO Z-NBMOIS                      0000000
113660          MOVE 'TRIMESTRE '      TO IPPPRI-PERTERME               0000000
113670          MOVE 'TRIMESTRIALITE(S) ' TO IPPPRI-LIBTERME.           0000000
113680     IF   SAY-PEREMB  = '6'                                       0000000
113690          MOVE  2                TO Z-NBMOIS                      0000000
113700          MOVE 'SEMESTRE '       TO IPPPRI-PERTERME               0000000
113710          MOVE 'SEMESTRIALITE(S) ' TO IPPPRI-LIBTERME.            0000000
113720     IF   SAY-PEREMB  = '9'                                       0000000
113730          MOVE  1                TO Z-NBMOIS                      0000000
113740          MOVE 'ANNEE '          TO IPPPRI-PERTERME               0000000
113750          MOVE 'ANNUITE(S) '       TO IPPPRI-LIBTERME.            0000000
113760                                                                  0000000
113770     IF   Z-MODEGEST = 1                                          0000000
113780          IF   SAY-PERDEG   = '5'                                 0000000
113790               MOVE IPPPRI-JOUTERME TO IPPPRI-JOUINTER            0000000
113800               MOVE IPPPRI-PERTERME TO IPPPRI-PERINTER            0000000
113810          ELSE PERFORM TRAIT-PAIEMENT-MG1.                        0000000
113820                                                                  0000000
113830*                                                                 0000000
113840 TRAIT-PEREMBS.                                                   0000000
113850                                                                  0000000
113860     IF   SAY-PEREMBS = '3'                                       0000000
113870          MOVE  4                TO Z-NBMOIS                      0000000
113880          MOVE 'TRIMESTRE '      TO IPPPRI-PERTERME               0000000
113890          MOVE 'TRIMESTRIALITE(S) ' TO IPPPRI-LIBTERME            0000000
113900     Else                                                         0000000
113910       IF   SAY-PEREMBS = '6'                                     0000000
113920            MOVE  2                TO Z-NBMOIS                    0000000
113930            MOVE 'SEMESTRE '       TO IPPPRI-PERTERME             0000000
113940            MOVE 'SEMESTRIALITE(S) ' TO IPPPRI-LIBTERME           0000000
113950       Else                                                       0000000
113960         IF   SAY-PEREMBS = '9'                                   0000000
113970              MOVE  1                TO Z-NBMOIS                  0000000
113980              MOVE 'ANNEE '          TO IPPPRI-PERTERME           0000000
113990              MOVE 'ANNUITE(S) '     TO IPPPRI-LIBTERME           0000000
114000         Else                                                     0000000
114010*          IF   SAY-PEREMBS = '1'                                 0000000
114020                MOVE  12               TO Z-NBMOIS                0000000
114030                MOVE 'MOIS '           TO IPPPRI-PERTERME         0000000
114040                MOVE 'MENSUALITE(S) '    TO IPPPRI-LIBTERME.      0000000
114050                                                                  0000000
114060     IF   Z-MODEGEST = 1                                          0000000
114070          IF   SAY-PERDEGS  = '5'                                 0000000
114080               MOVE IPPPRI-JOUTERME TO IPPPRI-JOUINTER            0000000
114090               MOVE IPPPRI-PERTERME TO IPPPRI-PERINTER            0000000
114100          ELSE PERFORM TRAIT-PAIEMENT-MG1S.                       0000000
114110                                                                  0000000
114120*-------                                                          0000000
114130                                                                  0000000
114140*-------------------------                                        0000000
114150 TRAIT-PAIEMENT-MG1S.                                             0000000
114160*-------------------------                                        0000000
114170     MOVE 'DERNIER JOUR'     TO IPPPRI-JOUINTER.                  0000000
114180     IF   SAY-PERDEGS = '1'                                       0000000
114190          MOVE 'MOIS '       TO IPPPRI-PERINTER.                  0000000
114200     IF   SAY-PERDEGS = '3'                                       0000000
114210          MOVE 'TRIMESTRE '  TO IPPPRI-PERINTER.                  0000000
114220     IF   SAY-PERDEGS = '6'                                       0000000
114230          MOVE 'SEMESTRE '   TO IPPPRI-PERINTER.                  0000000
114240     IF   SAY-PERDEGS = '9'                                       0000000
114250          MOVE 'ANNEE '      TO IPPPRI-PERINTER.                  0000000
114260                                                                  0000000
114270*-------------------------                                        0000000
114280 TRAIT-PAIEMENT-MG1.                                              0000000
114290*-------------------------                                        0000000
114300     MOVE 'DERNIER JOUR'     TO IPPPRI-JOUINTER.                  0000000
114310     IF   SAY-PERDEG  = '1'                                       0000000
114320          MOVE 'MOIS '       TO IPPPRI-PERINTER.                  0000000
114330     IF   SAY-PERDEG  = '3'                                       0000000
114340          MOVE 'TRIMESTRE '  TO IPPPRI-PERINTER.                  0000000
114350     IF   SAY-PERDEG  = '6'                                       0000000
114360          MOVE 'SEMESTRE '   TO IPPPRI-PERINTER.                  0000000
114370     IF   SAY-PERDEG  = '9'                                       0000000
114380          MOVE 'ANNEE '      TO IPPPRI-PERINTER.                  0000000
114390                                                                  0000000
114400*-------------------                                              0000000
114410 TRAIT-PAIEMENT-IPI.                                              0000000
114420*-------------------                                              0000000
114430                                                                  0000000
114440     MOVE SPACE TO IPPPRI-JTERME.                                 0000000
114450     MOVE SPACE TO IPPPRI-PERTERME.                               0000000
114460     MOVE SPACE TO IPPPRI-PERTERMX.                               0000000
114470     MOVE SPACE TO IPPPRI-JINTER.                                 0000000
114480     MOVE SPACE TO IPPPRI-PERINTER.                               0000000
114490                                                                  0000000
114500D    DISPLAY ' DATE ECH ' SA2-DATEC.                              0000000
114510                                                                  0000000
114520     IF  Z-TYPCRED = 'IMMO-DV'                                    0000000
114530         IF  LANGUE-ALLEMANDE                                     0000000
114540             PERFORM TRAIT-PAIEMENT-IPI-DV-AL                     0000000
114550         ELSE                                                     0000000
114560             PERFORM TRAIT-PAIEMENT-IPI-DV                        0000000
114570     ELSE                                                         0000000
114580         IF  LANGUE-ALLEMANDE                                     0000000
114590             PERFORM  TRAIT-PAIEMENT-IPI-PO-AL                    0000000
114600         ELSE                                                     0000000
114610             PERFORM TRAIT-PAIEMENT-IPI-PO.                       0000000
114620                                                                  0000000
114630*---------------------                                            0000000
114640 TRAIT-PAIEMENT-IPI-PO.                                           0000000
114650*---------------------                                            0000000
114660                                                                  0000000
114670     IF  AVENANT                                                  0000000
114680         MOVE  CPT-DPROEC       TO  W-DAT-ECH                     0000000
114690     ELSE                                                         0000000
114700         MOVE  SA2-DATEC        TO  W-DAT-ECH                     0000000
114710     END-IF                                                       0000000
114720                                                                  0000000
114730     IF   SAY-PEREMB  = '1'                                       0000000
114740          MOVE 'MOIS' TO IPPPRI-PERTERME                          0000000
114750          MOVE 'MOIS' TO IPPPRI-PERTERMX                          0000000
114760          IF   NOT  (W-DAT-ECH (7:2)  = '05' OR '10' OR '15'      0000000
114770                                             OR '20' OR '25')     0000000
114780               MOVE 'DERNIER JOUR'   TO IPPPRI-JTERME             0000000
114790          ELSE MOVE W-DAT-ECH(7:2)   TO IPPPRI-JTERME.            0000000
114800                                                                  0000000
114810     IF   SAY-PEREMB  = '3'                                       0000000
114820          MOVE 'TRIMESTRE' TO IPPPRI-PERTERME                     0000000
114830          MOVE 'ANNEE'     TO IPPPRI-PERTERMX                     0000000
114840          PERFORM INIT-W-JTERME-T                                 0000000
114850          IF   W-DAT-ECH(5:4)  NUMERIC                            0000000
114860               PERFORM AFFECT-JTERME-T-MM                         0000000
114870               PERFORM AFFECT-JTERME-T-JJ                         0000000
114880               MOVE W-JTERME-T TO IPPPRI-JTERME.                  0000000
114890                                                                  0000000
114900     IF   SAY-PEREMB  = '6'                                       0000000
114910          MOVE 'SEMESTRE' TO IPPPRI-PERTERME                      0000000
114920          MOVE 'ANNEE'    TO IPPPRI-PERTERMX                      0000000
114930          PERFORM INIT-W-JTERME-S                                 0000000
114940          IF   W-DAT-ECH(5:4)  NUMERIC                            0000000
114950               PERFORM AFFECT-JTERME-S-MM                         0000000
114960               PERFORM AFFECT-JTERME-S-JJ                         0000000
114970               MOVE W-JTERME-S TO IPPPRI-JTERME.                  0000000
114980                                                                  0000000
114990     IF   SAY-PEREMB  = '9'                                       0000000
115000          MOVE 'ANNEE' TO IPPPRI-PERTERME                         0000000
115010          MOVE 'ANNEE' TO IPPPRI-PERTERMX                         0000000
115020          IF   W-DAT-ECH  NUMERIC                                 0000000
115030               STRING W-DAT-ECH(7:2) DELIMITED BY SIZE            0000000
115040                      '/'            DELIMITED BY SIZE            0000000
115050                      W-DAT-ECH(5:2) DELIMITED BY SIZE            0000000
115060                 INTO IPPPRI-JTERME.                              0000000
115070                                                                  0000000
115080     IF   Z-MODEGEST = 1                                          0000000
115090          IF   SAY-PERDEG   = '5'                                 0000000
115100               MOVE IPPPRI-JTERME   TO IPPPRI-JINTER              0000000
115110               MOVE IPPPRI-PERTERMX TO IPPPRI-PERINTER            0000000
115120          ELSE PERFORM TRAIT-PAIEMENT-MG1-IPI.                    0000000
115130                                                                  0000000
115140*                                                                 0000000
115150*---------------------                                            0000000
115160 TRAIT-PAIEMENT-IPI-DV.                                           0000000
115170*---------------------                                            0000000
115180                                                                  0000000
115190     IF   SAY-PEREMBS = '1'                                       0000000
115200          MOVE 'MOIS '           TO IPPPRI-PERTERME.              0000000
115210     IF   SAY-PEREMBS = '3'                                       0000000
115220          MOVE 'TRIMESTRE '      TO IPPPRI-PERTERME.              0000000
115230     IF   SAY-PEREMBS = '6'                                       0000000
115240          MOVE 'SEMESTRE '       TO IPPPRI-PERTERME.              0000000
115250     IF   SAY-PEREMBS = '9'                                       0000000
115260          MOVE 'ANNEE '          TO IPPPRI-PERTERME.              0000000
115270                                                                  0000000
115280     PERFORM TRAIT-PAIEMENT-MG1S-IPI.                             0000000
115290                                                                  0000000
115300*                                                                 0000000
115310*                                                                 0000000
115320                                                                  0000000
115330*---------------------                                            0000000
115340 TRAIT-PAIEMENT-IPI-PO-AL.                                        0000000
115350*---------------------                                            0000000
115360                                                                  0000000
115370     IF  AVENANT                                                  0000000
115380         MOVE  CPT-DPROEC       TO  W-DAT-ECH                     0000000
115390     ELSE                                                         0000000
115400         MOVE  SA2-DATEC        TO  W-DAT-ECH                     0000000
115410     END-IF                                                       0000000
115420                                                                  0000000
115430     IF   SAY-PEREMB  = '1'                                       0000000
115440          MOVE 'MONATS' TO IPPPRI-PERTERME                        0000000
115450                          IPPPRI-PERTERMX                         0000000
115460          IF   NOT  (W-DAT-ECH (7:2)  = '05' OR '10' OR '15'      0000000
115470                                             OR '20' OR '25')     0000000
115480               MOVE 'LETZTEN'   TO IPPPRI-JTERME                  0000000
115490          ELSE MOVE W-DAT-ECH(7:2)   TO IPPPRI-JTERME.            0000000
115500                                                                  0000000
115510     IF   SAY-PEREMB  = '3'                                       0000000
115520          MOVE 'QUARTALS' TO IPPPRI-PERTERME                      0000000
115530          MOVE 'JAHRES'     TO IPPPRI-PERTERMX                    0000000
115540          PERFORM INIT-W-JTERME-T                                 0000000
115550          IF   W-DAT-ECH(5:4)  NUMERIC                            0000000
115560               PERFORM AFFECT-JTERME-T-MM                         0000000
115570               PERFORM AFFECT-JTERME-T-JJ                         0000000
115580               MOVE W-JTERME-T TO IPPPRI-JTERME.                  0000000
115590                                                                  0000000
115600     IF   SAY-PEREMB  = '6'                                       0000000
115610          MOVE 'HALBJAHRES' TO IPPPRI-PERTERME                    0000000
115620          MOVE 'JAHRES'    TO IPPPRI-PERTERMX                     0000000
115630          PERFORM INIT-W-JTERME-S                                 0000000
115640          IF   W-DAT-ECH(5:4)  NUMERIC                            0000000
115650               PERFORM AFFECT-JTERME-S-MM                         0000000
115660               PERFORM AFFECT-JTERME-S-JJ                         0000000
115670               MOVE W-JTERME-S TO IPPPRI-JTERME.                  0000000
115680                                                                  0000000
115690     IF   SAY-PEREMB  = '9'                                       0000000
115700          MOVE 'JAHRES' TO IPPPRI-PERTERME                        0000000
115710          MOVE 'JAHRES' TO IPPPRI-PERTERMX                        0000000
115720          IF   W-DAT-ECH  NUMERIC                                 0000000
115730               STRING W-DAT-ECH(7:2) DELIMITED BY SIZE            0000000
115740                      '/'            DELIMITED BY SIZE            0000000
115750                      W-DAT-ECH(5:2) DELIMITED BY SIZE            0000000
115760                 INTO IPPPRI-JTERME.                              0000000
115770                                                                  0000000
115780     IF   Z-MODEGEST = 1                                          0000000
115790          IF   SAY-PERDEG   = '5'                                 0000000
115800               MOVE IPPPRI-JTERME   TO IPPPRI-JINTER              0000000
115810               MOVE IPPPRI-PERTERMX TO IPPPRI-PERINTER            0000000
115820          ELSE PERFORM TRAIT-PAIEMENT-MG1-IPI.                    0000000
115830                                                                  0000000
115840*                                                                 0000000
115850*---------------------                                            0000000
115860 TRAIT-PAIEMENT-IPI-DV-AL.                                        0000000
115870*---------------------                                            0000000
115880                                                                  0000000
115890     IF   SAY-PEREMBS = '1'                                       0000000
115900          MOVE 'MONATS'           TO IPPPRI-PERTERME.             0000000
115910     IF   SAY-PEREMBS = '3'                                       0000000
115920          MOVE 'QUARTALS '      TO IPPPRI-PERTERME.               0000000
115930     IF   SAY-PEREMBS = '6'                                       0000000
115940          MOVE 'HALBJAHRES '       TO IPPPRI-PERTERME.            0000000
115950     IF   SAY-PEREMBS = '9'                                       0000000
115960          MOVE 'JAHRES '          TO IPPPRI-PERTERME.             0000000
115970                                                                  0000000
115980     PERFORM TRAIT-PAIEMENT-MG1S-IPI-AL.                          0000000
115990                                                                  0000000
116000 INIT-W-JTERME-T.                                                 0000000
116010                                                                  0000000
116020     MOVE SPACE TO W-JTERME-T.                                    0000000
116030     MOVE '/'   TO W-JTERME-T-M1-S.                               0000000
116040     MOVE '/'   TO W-JTERME-T-M2-S.                               0000000
116050     MOVE '/'   TO W-JTERME-T-M3-S.                               0000000
116060     MOVE '/'   TO W-JTERME-T-M4-S.                               0000000
116070     MOVE ' - ' TO W-JTERME-T-S1.                                 0000000
116080     MOVE ' - ' TO W-JTERME-T-S2.                                 0000000
116090     MOVE ' - ' TO W-JTERME-T-S3.                                 0000000
116100                                                                  0000000
116110 INIT-W-JTERME-S.                                                 0000000
116120                                                                  0000000
116130     MOVE SPACE TO W-JTERME-S.                                    0000000
116140     MOVE '/'   TO W-JTERME-S-M1-S.                               0000000
116150     MOVE '/'   TO W-JTERME-S-M2-S.                               0000000
116160     MOVE ' - ' TO W-JTERME-S-S1.                                 0000000
116170                                                                  0000000
116180 AFFECT-JTERME-T-MM.                                              0000000
116190                                                                  0000000
116200     IF   W-DAT-ECH(5:2) = '01' OR '04' OR '07' OR '10'           0000000
116210          MOVE '01' TO W-JTERME-T-M1-MM                           0000000
116220          MOVE '04' TO W-JTERME-T-M2-MM                           0000000
116230          MOVE '07' TO W-JTERME-T-M3-MM                           0000000
116240          MOVE '10' TO W-JTERME-T-M4-MM                           0000000
116250     ELSE                                                         0000000
116260     IF   W-DAT-ECH(5:2) = '02' OR '05' OR '08' OR '11'           0000000
116270          MOVE '02' TO W-JTERME-T-M1-MM                           0000000
116280          MOVE '05' TO W-JTERME-T-M2-MM                           0000000
116290          MOVE '08' TO W-JTERME-T-M3-MM                           0000000
116300          MOVE '11' TO W-JTERME-T-M4-MM                           0000000
116310     ELSE                                                         0000000
116320     IF   W-DAT-ECH(5:2) = '03' OR '06' OR '09' OR '12'           0000000
116330          MOVE '03' TO W-JTERME-T-M1-MM                           0000000
116340          MOVE '06' TO W-JTERME-T-M2-MM                           0000000
116350          MOVE '09' TO W-JTERME-T-M3-MM                           0000000
116360          MOVE '12' TO W-JTERME-T-M4-MM.                          0000000
116370                                                                  0000000
116380 AFFECT-JTERME-T-JJ.                                              0000000
116390                                                                  0000000
116400     MOVE W-DAT-ECH(7:2) TO W-JTERME-T-M1-JJ                      0000000
116410                            W-JTERME-T-M2-JJ                      0000000
116420                            W-JTERME-T-M3-JJ                      0000000
116430                            W-JTERME-T-M4-JJ.                     0000000
116440     MOVE W-JTERME-T-M1-MM TO K.                                  0000000
116450     IF   W-JTERME-T-M1-JJ   >  '25'                              0000000
116460          MOVE TFM-JOUR(K) TO W-JTERME-T-M1-JJ.                   0000000
116470                                                                  0000000
116480     MOVE W-JTERME-T-M2-MM TO K.                                  0000000
116490     IF   W-JTERME-T-M2-JJ   >  '25'                              0000000
116500          MOVE TFM-JOUR(K) TO W-JTERME-T-M2-JJ.                   0000000
116510                                                                  0000000
116520     MOVE W-JTERME-T-M3-MM TO K.                                  0000000
116530     IF   W-JTERME-T-M3-JJ   >  '25'                              0000000
116540          MOVE TFM-JOUR(K) TO W-JTERME-T-M3-JJ.                   0000000
116550                                                                  0000000
116560     MOVE W-JTERME-T-M4-MM TO K.                                  0000000
116570     IF   W-JTERME-T-M4-JJ   >  '25'                              0000000
116580          MOVE TFM-JOUR(K) TO W-JTERME-T-M4-JJ.                   0000000
116590                                                                  0000000
116600 AFFECT-JTERME-S-MM.                                              0000000
116610                                                                  0000000
116620     IF   W-DAT-ECH (5:2)  = '01' OR '07'                         0000000
116630          MOVE '01' TO W-JTERME-S-M1-MM                           0000000
116640          MOVE '07' TO W-JTERME-S-M2-MM                           0000000
116650     ELSE                                                         0000000
116660     IF   W-DAT-ECH (5:2)  = '02' OR '08'                         0000000
116670          MOVE '02' TO W-JTERME-S-M1-MM                           0000000
116680          MOVE '08' TO W-JTERME-S-M2-MM                           0000000
116690     ELSE                                                         0000000
116700     IF   W-DAT-ECH (5:2)  = '03' OR '09'                         0000000
116710          MOVE '03' TO W-JTERME-S-M1-MM                           0000000
116720          MOVE '09' TO W-JTERME-S-M2-MM                           0000000
116730     ELSE                                                         0000000
116740     IF   W-DAT-ECH (5:2)  = '04' OR '10'                         0000000
116750          MOVE '04' TO W-JTERME-S-M1-MM                           0000000
116760          MOVE '10' TO W-JTERME-S-M2-MM                           0000000
116770     ELSE                                                         0000000
116780     IF   W-DAT-ECH (5:2)  = '05' OR '11'                         0000000
116790          MOVE '05' TO W-JTERME-S-M1-MM                           0000000
116800          MOVE '11' TO W-JTERME-S-M2-MM                           0000000
116810     ELSE                                                         0000000
116820     IF   W-DAT-ECH (5:2)  = '06' OR '12'                         0000000
116830          MOVE '06' TO W-JTERME-S-M1-MM                           0000000
116840          MOVE '12' TO W-JTERME-S-M2-MM.                          0000000
116850                                                                  0000000
116860 AFFECT-JTERME-S-JJ.                                              0000000
116870                                                                  0000000
116880     MOVE W-DAT-ECH(7:2) TO W-JTERME-S-M1-JJ                      0000000
116890                            W-JTERME-S-M2-JJ.                     0000000
116900     MOVE W-JTERME-S-M1-MM TO K.                                  0000000
116910     IF   W-JTERME-S-M1-JJ  >  '25'                               0000000
116920          MOVE TFM-JOUR(K) TO W-JTERME-S-M1-JJ.                   0000000
116930                                                                  0000000
116940     MOVE W-JTERME-S-M2-MM TO K.                                  0000000
116950     IF   W-JTERME-S-M2-JJ  >  '25'                               0000000
116960          MOVE TFM-JOUR(K) TO W-JTERME-S-M2-JJ.                   0000000
116970                                                                  0000000
116980*                                                                 0000000
116990 TRAIT-PAIEMENT-MG1S-IPI.                                         0000000
117000                                                                  0000000
117010     MOVE 'DERNIER JOUR'     TO IPPPRI-JINTER.                    0000000
117020     IF   SAY-PERDEGS = '1'                                       0000000
117030          MOVE 'MOIS '       TO IPPPRI-PERINTER.                  0000000
117040     IF   SAY-PERDEGS = '3'                                       0000000
117050          MOVE 'TRIMESTRE '  TO IPPPRI-PERINTER.                  0000000
117060     IF   SAY-PERDEGS = '6'                                       0000000
117070          MOVE 'SEMESTRE '   TO IPPPRI-PERINTER.                  0000000
117080     IF   SAY-PERDEGS = '9'                                       0000000
117090          MOVE 'ANNEE '      TO IPPPRI-PERINTER.                  0000000
117100*                                                                 0000000
117110*------                                                           0000000
117120 TRAIT-PAIEMENT-MG1S-IPI-AL.                                      0000000
117130                                                                  0000000
117140     MOVE 'DERNIER JOUR'     TO IPPPRI-JINTER.                    0000000
117150     IF   SAY-PERDEGS = '1'                                       0000000
117160          MOVE 'MOIS '       TO IPPPRI-PERINTER.                  0000000
117170     IF   SAY-PERDEGS = '3'                                       0000000
117180          MOVE 'TRIMESTRE '  TO IPPPRI-PERINTER.                  0000000
117190     IF   SAY-PERDEGS = '6'                                       0000000
117200          MOVE 'SEMESTRE '   TO IPPPRI-PERINTER.                  0000000
117210     IF   SAY-PERDEGS = '9'                                       0000000
117220          MOVE 'ANNEE '      TO IPPPRI-PERINTER.                  0000000
117230*                                                                 0000000
117240*------                                                           0000000
117250*                                                                 0000000
117260                                                                  0000000
117270 TRAIT-PAIEMENT-MG1-IPI-AL.                                       0000000
117280                                                                  0000000
117290     MOVE 'LETZTEN TAG'     TO IPPPRI-JINTER.                     0000000
117300     IF   SAY-PERDEG  = '1'                                       0000000
117310          MOVE 'MONAT'      TO IPPPRI-PERINTER.                   0000000
117320     IF   SAY-PERDEG  = '3'                                       0000000
117330          MOVE 'QUARTAL '  TO IPPPRI-PERINTER.                    0000000
117340     IF   SAY-PERDEG  = '6'                                       0000000
117350          MOVE 'HALBJAHR '   TO IPPPRI-PERINTER.                  0000000
117360     IF   SAY-PERDEG  = '9'                                       0000000
117370          MOVE 'JAHR '      TO IPPPRI-PERINTER.                   0000000
117380                                                                  0000000
117390*                                                                 0000000
117400                                                                  0000000
117410 TRAIT-PAIEMENT-MG1-IPI.                                          0000000
117420                                                                  0000000
117430     MOVE 'DERNIER JOUR '     TO IPPPRI-JINTER.                   0000000
117440     IF   SAY-PERDEG  = '1'                                       0000000
117450          MOVE 'MOIS '       TO IPPPRI-PERINTER.                  0000000
117460     IF   SAY-PERDEG  = '3'                                       0000000
117470          MOVE 'TRIMESTRE '  TO IPPPRI-PERINTER.                  0000000
117480     IF   SAY-PERDEG  = '6'                                       0000000
117490          MOVE 'SEMESTRE '   TO IPPPRI-PERINTER.                  0000000
117500     IF   SAY-PERDEG  = '9'                                       0000000
117510          MOVE 'ANNEE '      TO IPPPRI-PERINTER.                  0000000
117520                                                                  0000000
117530*-------------------------                                        0000000
117540 TRAIT-RAZ.                                                       0000000
117550*-------------------------                                        0000000
117560     MOVE ZERO  TO Z-TOTCOUT.                                     0000000
117570     MOVE ZERO  TO Z-TOTCOUT-FA.                                  0000000
117580     MOVE ZERO  TO Z-TOTINTER.                                    0000000
117590     MOVE ZERO  TO Z-TOTINTER-PC.                                 0000000
117600     MOVE ZERO  TO Z-DURTOTAL.                                    0000000
117610     MOVE ZERO  TO Z-DURFRANC.                                    0000000
117620     MOVE ZERO  TO Z-MFRGARAN.                                    0000000
117630     MOVE ZERO  TO Z-TXGARAN.                                     0000000
117640     MOVE ZERO  TO Z-MREMBMIN.                                    0000000
117650*-------------------------                                        0000000
117660 TRAIT-PRET-TAUX.                                                 0000000
117670*-------------------------                                        0000000
117680* Pour viter les carts sur la 3eme dcimales .....              0000000
117690* ex :  5,901  et  5,900   ou  5,500   et  5,499                  0000000
117700*                                                                 0000000
117710                                                                  0000000
117720     MOVE ZERO                 TO IPPPRI-TXCOMMIS.                0000000
117730     PERFORM VENTIL-COMMIS.                                       0000000
117740     IF   SAI-TFRAUT   NUMERIC                                    0000000
117750          MOVE SAI-TFRAUT      TO IPPPRI-TXFRAIS                  0000000
117760          ADD  SAI-TFRAUT      TO Z-TXGARAN.                      0000000
117770     IF   SAI-TFRH     NUMERIC                                    0000000
117780          MOVE SAI-TFRH        TO IPPPRI-TXFRHYPO                 0000000
117790          ADD  SAI-TFRH        TO Z-TXGARAN.                      0000000
117800     MOVE Z-TXGARAN            TO IPPPRI-TXGARAN.                 0000000
117810                                                                  0000000
117820     IF SAI-TCAS    NUMERIC                                       0000000
117830        MOVE SAI-TCAS     TO IPPPRI-TXASSURA                      0000000
117840     ELSE                                                         0000000
117850        MOVE ZERO         TO IPPPRI-TXASSURA-X                    0000000
117860     END-IF                                                       0000000
117870                                                                  0000000
117880     If  88-ps-oui                                                0000000
117890         IF   SAI-TPS      NUMERIC                                0000000
117900              MOVE SAI-TPS         TO IPPPRI-TXPSOC               0000000
117910         ELSE                                                     0000000
117920              MOVE  ZERO           TO IPPPRI-TXPSOC               0000000
117930         End-if                                                   0000000
117940     ELSE                                                         0000000
117950         MOVE  ZERO           TO IPPPRI-TXPSOC                    0000000
117960     End-if                                                       0000000
117970                                                                  0000000
117980D    DISPLAY 'TXFRHYPO: ' IPPPRI-TXFRHYPO.                        0000000
117990D    DISPLAY 'TAUX ASS: ' IPPPRI-TXASSURA.                        0000000
118000D    DISPLAY 'TPS     : ' IPPPRI-TXPSOC.                          0000000
118010D    DISPLAY 'SAI-TPS   ' SAI-TPS                                 0000000
118020D    DISPLAY 'SAI-TCAS  ' SAI-TCAS.                               0000000
118030D    DISPLAY 'SAI-TEGL  ' SAI-TEGL.                               0000000
118040                                                                  0000000
118050*taeg                                                             0000000
118060d    display 'IPXCAL-O-TEG-PAR-PER :' IPXCAL-O-TEG-PAR-PER        0000000
118070d    display 'IPXCAL-O-TEG  :' IPXCAL-O-TEG                       0000000
118080d    display 'IPXCAL-O-TAEG :' IPXCAL-O-TAEG                      0000000
118090     MOVE IPXCAL-O-TEG-PAR-PER TO  W-TRAV-TEG                     0000000
118100     MOVE W-TRAV-TEG           TO  IPPPRI-TXEFFPER                0000000
118110                                                                  0000000
118120     if IPPMA2-LABEL-APPLI = 'IPC'                                0000000
118130        MOVE IPXCAL-O-TAEG        TO  W-TRAV-TEG                  0000000
118140     else                                                         0000000
118150        MOVE IPXCAL-O-TEG         TO  W-TRAV-TEG                  0000000
118160     end-if                                                       0000000
118170                                                                  0000000
118180     MOVE W-TRAV-TEG   TO IPPPRI-TXEFFGLO                         0000000
118190* rdegoethe                                                       0000000
118200     If  dossier-goethe  or langue-allemande                      0000000
118210         MOVE IPXCAL-O-TAEG TO W-TRAV-TEG                         0000000
118220         MOVE W-TRAV-TEG   TO IPPPRI-EIGMAR                       0000000
118230     End-if                                                       0000000
118240* rdegoethe                                                       0000000
118250*    if  Ipxcal-o-pct-ass  numeric                                0000000
118260*        Move  ipxcal-o-pct-ass  to  ipppri-pctass                0000000
118270*    End-if                                                       0000000
118280D    DISPLAY 'IPPPRI-TXEFFGLO  :' IPPPRI-TXEFFGLO                 0000000
118290D    DISPLAY 'IPPPRI-PCTASS    :' IPPPRI-PCTASS                   0000000
118300                                                                  0000000
118310**** IPI                                                          0000000
118320*%%BUTOIRS                                                        0000000
118330     MOVE    ZERO  TO  IPPPRI-TXMINIX                             0000000
118340     MOVE    ZERO  TO  IPPPRI-TXMAXIX                             0000000
118350     MOVE    ZERO  TO  IPPPRI-TXMINI5X                            0000000
118360     MOVE    ZERO  TO  IPPPRI-TXMAXI5X                            0000000
118370     MOVE    ZERO  TO  IPPRGT-TXRETENUX                           0000000
118380     MOVE    ZERO  TO  W-BUTMIN    W-BUTMAX.                      0000000
118390*                                                                 0000000
118400* clause mut.                                                     0000000
118410*                                                                 0000000
118420* sbo08102007 modif du test restitution des butoirs               0000000
118430*             restitus par IPR ou  recalculer                   0000000
118440     IF ( ORGS01-FEDE-CEE   and                                   0000000
118450        ( SAY-CNAT = '200' or  '293' OR '300')  and               0000000
118460        ( SAY-VTAU = '2' AND SAY-CINDEX  =  space ))              0000000
118470        IF  ((SAY-TMIN NUMERIC AND SAY-TMIN NOT = 99,000 )        0000000
118480         AND (SAY-TMAX NUMERIC AND SAY-TMAX NOT = 99,000))        0000000
118490                  MOVE SAY-TMIN     TO IPPPRI-BUTMIN  W-BUTMIN    0000000
118500                  MOVE SAY-TMAX     TO IPPPRI-BUTMAX  W-BUTMAX    0000000
118510                  PERFORM  TXMINI-TXMAXI                          0000000
118520                                                                  0000000
118530        end-if                                                    0000000
118540     else                                                         0000000
118550        if ( IPXPRO-BUTOIR-5ANS ) or                              0000000
118560           ( ORGS01-FEDE-CEE   and   say-cindex (4:1) = 'Y' )     0000000
118570                                                                  0000000
118580* les butoirs ( -2/+2 ) ne sont pas renseigns ...                0000000
118590d                   display 'TXMINI-TXMAXI-2'                     0000000
118600                    PERFORM  TXMINI-TXMAXI-2                      0000000
118610        end-if                                                    0000000
118620     end-if                                                       0000000
118630                                                                  0000000
118640     If  ORGS01-BANQUE-CIC                                        0000000
118650         IF  SAY-TAUD  NUMERIC                                    0000000
118660             IF  APXTRE-ENCOURS                                   0000000
118670                 COMPUTE  WS-TAUX  =                              0000000
118680                   SAY-TAUDB   -  APXTRE-TAUTARPLV                0000000
118690             ELSE                                                 0000000
118700                 MOVE    SAY-TAUDB   TO  WS-TAUX                  0000000
118710             END-IF                                               0000000
118720         end-if                                                   0000000
118730                                                                  0000000
118740d        Display 'SAY-TX-MINI-IND = ' SAY-TX-MINI-IND             0000000
118750         IF  SAY-TX-MINI-IND    NUMERIC   and                     0000000
118760             SAY-TX-MINI-IND    NOT  =  ZERO                      0000000
118770            MOVE  SAY-TX-MINI-IND   TO  IPPPRI-TXMINI             0000000
118780            MOVE  SAY-TX-MINI-IND   TO  IPPPRI-TXMINI5            0000000
118790                                                                  0000000
118800            if  ws-taux > SAY-TX-MINI-IND                         0000000
118810                COMPUTE  W-TX9   = WS-TAUX  - SAY-TX-MINI-IND     0000000
118820            Else                                                  0000000
118830                Move  zero  to  w-tx9                             0000000
118840            End-if                                                0000000
118850                                                                  0000000
118860            MOVE     1         to  w-butmin                       0000000
118870            MOVE     W-TX9     TO  IPPPRI-BUTMIN                  0000000
118880         Else                                                     0000000
118890*...THU - SA7968768 - 2012-04-25 - DEB                            0000000
118900            MOVE  ws-taux      TO  IPPPRI-TXMINI                  0000000
118910*--       --MOVE ws-taux TO IPPPRI-TXMINI5 Il f Taux mini  zro 0000000
118920            MOVE   ZERO          TO IPPPRI-TXMINI5                0000000
118930            MOVE  Zero         TO  IPPPRI-BUTMIN                  0000000
118940*     Pointer sur la RS ne mentionnant qu'un taux plafond         0000000
118950*--  Et ne plus pointer sur la RS avec prsence d'un taux plancher0000000
118960*--       --MOVE  1            to  w-butmin                       0000000
118970            MOVE     0           to w-butmin                      0000000
118980         End-if                                                   0000000
118990                                                                  0000000
119000d        Display 'SAY-TX-MAXI-IND = ' SAY-TX-MAXI-IND             0000000
119010         IF (SAY-TX-MAXI-IND    NUMERIC   AND  NOT                0000000
119020            (SAY-TX-MAXI-IND    =  ZERO  OR                       0000000
119030             SAY-TX-MAXI-IND    >  50) )                          0000000
119040            MOVE  SAY-TX-MAXI-IND   TO  IPPPRI-TXMAXI             0000000
119050            MOVE  SAY-TX-MAXI-IND   TO  IPPPRI-TXMAXI5            0000000
119060            COMPUTE  W-TX9   = SAY-TX-MAXI-IND - WS-TAUX          0000000
119070            MOVE     W-TX9     TO  IPPPRI-BUTMAX   W-BUTMAX       0000000
119080         END-IF                                                   0000000
119090     END-IF.                                                      0000000
119100                                                                  0000000
119110     IF  ORGS01-FEDE-LAVAL  or ORGS01-FEDE-CAEN                   0000000
119120       IF  SAY-CINDEX  =  '245ZO'                                 0000000
119130         IF  SAY-TX-MINI-IND    NUMERIC   and                     0000000
119140             SAY-TX-MINI-IND    NOT  =  ZERO                      0000000
119150            MOVE  SAY-TX-MINI-IND   TO  IPPPRI-TXMINI             0000000
119160            MOVE  SAY-TX-MINI-IND   TO  IPPPRI-TXMINI5            0000000
119170         END-IF                                                   0000000
119180         IF  SAY-TX-MAXI-IND    NUMERIC   and                     0000000
119190             SAY-TX-MAXI-IND    NOT  =  ZERO                      0000000
119200            MOVE  SAY-TX-MAXI-IND   TO  IPPPRI-TXMAXI             0000000
119210            MOVE  SAY-TX-MAXI-IND   TO  IPPPRI-TXMAXI5            0000000
119220         END-IF                                                   0000000
119230       END-IF                                                     0000000
119240     END-IF.                                                      0000000
119250                                                                  0000000
119260d    display 'IPPPRI-TXMini ' IPPPRI-TXMini                       0000000
119270d    display 'IPPPRI-TXMAXI ' IPPPRI-TXMAXI                       0000000
119280*  01242                                                          0000000
119290                                                                  0000000
119300     IF  SAY-CINDEX (1:3)  =  '188'                               0000000
119310             Move  zero  to  ws-taux                              0000000
119320             IF    ( IPXPRO-CREDIT-MIXTE )                        0000000
119330                                                                  0000000
119340                 if SAY-MIXT-TAUDB-V  numeric                     0000000
119350                    IF  APXTRE-ENCOURS                            0000000
119360                        COMPUTE  WS-TAUX  =                       0000000
119370                            SAY-MIXT-TAUDB-V  -  APXTRE-TAUTARPLV 0000000
119380                    ELSE                                          0000000
119390                        MOVE  SAY-MIXT-TAUDB-V  to  WS-TAUX       0000000
119400                    END-IF                                        0000000
119410                 END-IF                                           0000000
119420             Else                                                 0000000
119430                                                                  0000000
119440               IF  AVENANT  AND  CPT-TAUXA NUMERIC                0000000
119450                            AND  CPT-TAUXA  >  ZERO               0000000
119460                   IF  APXTRE-ENCOURS                             0000000
119470                       COMPUTE  WS-TAUX  =                        0000000
119480                               CPT-TAUXA   -  APXTRE-TAUTARPLV    0000000
119490                   ELSE                                           0000000
119500                       MOVE    CPT-TAUXA   TO  WS-TAUX            0000000
119510                   END-IF                                         0000000
119520               Else                                               0000000
119530                                                                  0000000
119540                 IF  SAY-TAUD  NUMERIC                            0000000
119550                   IF  APXTRE-ENCOURS                             0000000
119560                       COMPUTE  WS-TAUX  =                        0000000
119570                         SAY-TAUDB   -  APXTRE-TAUTARPLV          0000000
119580                   ELSE                                           0000000
119590                       MOVE    SAY-TAUDB   TO  WS-TAUX            0000000
119600                   END-IF                                         0000000
119610                 END-IF                                           0000000
119620               END-IF                                             0000000
119630             End-if                                               0000000
119640                                                                  0000000
119650         IF  SAY-TX-MINI-IND    NUMERIC   and                     0000000
119660             SAY-TX-MINI-IND    NOT  =  ZERO                      0000000
119670            MOVE  SAY-TX-MINI-IND   TO  IPPPRI-TXMINI             0000000
119680            MOVE  SAY-TX-MINI-IND   TO  IPPPRI-TXMINI5            0000000
119690            if  ws-taux > SAY-TX-MINI-IND                         0000000
119700              COMPUTE  W-TX9   = WS-TAUX  - SAY-TX-MINI-IND       0000000
119710            Else                                                  0000000
119720              Move  zero  to  w-tx9                               0000000
119730            End-if                                                0000000
119740            MOVE     W-TX9     TO  IPPPRI-BUTMIN   W-BUTMIN       0000000
119750         End-if                                                   0000000
119760         IF (SAY-TX-MAXI-IND    NUMERIC   AND  NOT                0000000
119770            (SAY-TX-MAXI-IND    =  ZERO  OR                       0000000
119780             SAY-TX-MAXI-IND    >  50) )                          0000000
119790            MOVE  SAY-TX-MAXI-IND   TO  IPPPRI-TXMAXI             0000000
119800            MOVE  SAY-TX-MAXI-IND   TO  IPPPRI-TXMAXI5            0000000
119810            COMPUTE  W-TX9   = SAY-TX-MAXI-IND - WS-TAUX          0000000
119820            MOVE     W-TX9     TO  IPPPRI-BUTMAX   W-BUTMAX       0000000
119830         END-IF                                                   0000000
119840     END-IF.                                                      0000000
119850                                                                  0000000
119860D    DISPLAY 'SAY-TXMIN      '  SAY-TX-MINI-IND                   0000000
119870D    DISPLAY 'SAY-TXMAX      '  SAY-TX-MAXI-IND                   0000000
119880                                                                  0000000
119890D    DISPLAY 'IPPPRI-TXMINIX ' IPPPRI-TXMINIX                     0000000
119900D    DISPLAY 'IPPPRI-TXMAXIX ' IPPPRI-TXMAXIX                     0000000
119910D    DISPLAY 'IPPPRI-TXMINI5 ' IPPPRI-TXMINI5X                    0000000
119920D    DISPLAY 'IPPPRI-TXMAXI5 ' IPPPRI-TXMAXI5X                    0000000
119930                                                                  0000000
119940* test sur vtau = 1 (ancien index, devenu tx fixe !!!)           0000000
119950                                                                  0000000
119960     IF   (ORGS01-FEDE-CEE ) and                                  0000000
119970         (IPPMA2-LABEL-APPLI     = 'IPI' or                       0000000
119980         (IPPMA2-LABEL-APPLI     = 'IPC' and                      0000000
119990        (say-cindex = '240HK' or '245HK' or '243HJ' or '270HJ'))) 0000000
120000              if NOT (SAY-CINDEX(1:3) =  SPACE OR 'SUP' or '188') 0000000
120010                 if   NOT (SAY-VTAU = '1' )                       0000000
120020                      if (SAY-TX-MINI-IND    NUMERIC  and         0000000
120030                          SAY-TX-MAXI-IND    NUMERIC ) and        0000000
120040                         (SAY-TX-MAXI-IND    >  ZERO  and         0000000
120050                          SAY-TX-MAXI-IND    <  50)               0000000
120060                                  PERFORM  TXMINI-TXMAXI-2        0000000
120070                      Else                                        0000000
120080                                                                  0000000
120090                        PERFORM  LECTURE-PRTIND02                 0000000
120100* pour ne pas avoir la clause des butoirs.                        0000000
120110                        IF  SAY-CINDEX (4 : 1)  NOT  =  'Z'       0000000
120120                          IF  SAY-CINDEX (1 : 3)  NOT  =  '373'   0000000
120130                              IF   PRTIND02-TMIN NUMERIC AND      0000000
120140                                   PRTIND02-TMAX NUMERIC          0000000
120150                                   PERFORM  TXMINI-TXMAXI-PC.     0000000
120160                                                                  0000000
120170     IF  ((ORGS01-FEDE-CEE  )     and                             0000000
120180          IPPMA2-LABEL-APPLI     = 'IPI')                         0000000
120190          if ( SAY-CINDEX(1:3) =   '188' or '023' or '373')       0000000
120200               or  IPXPRO-BUTOIR-5ANS                             0000000
120210            IF  AVENANT  AND  CPT-TAUXA NUMERIC                   0000000
120220                         AND  CPT-TAUXA  >  ZERO                  0000000
120230                IF  APXTRE-ENCOURS                                0000000
120240                    COMPUTE  WS-TAUX  =                           0000000
120250                            CPT-TAUXA   -  APXTRE-TAUTARPLV       0000000
120260                ELSE                                              0000000
120270                    MOVE    CPT-TAUXA   TO  WS-TAUX               0000000
120280                END-IF                                            0000000
120290                MOVE     WS-TAUX      TO  IPPRGT-TXRETENU         0000000
120300            end-if                                                0000000
120310          end-if                                                  0000000
120320     end-if.                                                      0000000
120330                                                                  0000000
120340d    Display 'TRAIT-PRET-TAUX = '                                 0000000
120350d    Display 'IPPRGT-TXRETENU 01 = ' IPPRGT-TXRETENU              0000000
120360                                                                  0000000
120370     IF   ORGS01-FEDE-CEE   and  say-cindex  =  '281HE'           0000000
120380d         display 'TXMINI-TXMAXI-2 281he'                         0000000
120390          PERFORM  LECTURE-PRTIND02                               0000000
120400          If (SAY-TX-MINI-IND     numeric )                       0000000
120410           and                                                    0000000
120420             (SAY-TX-MAXI-IND     Numeric  and                    0000000
120430              SAY-TX-MAXI-IND    >  zero   and                    0000000
120440              SAY-TX-MAXI-IND    <  20     )                      0000000
120450              PERFORM  TXMINI-TXMAXI-2                            0000000
120460          Else                                                    0000000
120470              Move PRTIND02-TMIN   to  SAY-TX-MINI-IND            0000000
120480              Move PRTIND02-TMAX   to  SAY-TX-MAXI-IND            0000000
120490              PERFORM  TXMINI-TXMAXI-PC                           0000000
120500          end-if                                                  0000000
120510     end-if                                                       0000000
120520                                                                  0000000
120530     move  zero  to  ipppri-butoir                                0000000
120540*                                                                 0000000
120550*          0 rien                                                 0000000
120560*          1 min > 0 et max = 0                                   0000000
120570*          2 min > 0 et max > 0  20094  nouvelle  gamme           0000000
120580*          3 min = 0 et max > 0  20016                            0000000
120590*          4 min > 0 et max > 0  20094  ancienne  gamme           0000000
120600*          5  si 218 28                                           0000000
120610                                                                  0000000
120620D    DISPLAY 'W-BUTMIN  ' W-BUTMIN                                0000000
120630D    DISPLAY 'W-BUTMAX  ' W-BUTMAX                                0000000
120640                                                                  0000000
120650                                                                  0000000
120660     if  not ( IPXPRO-BUTOIR-5ANS )                               0000000
120670         If (w-butmin  numeric  and                               0000000
120680             w-butmin  >  zero )                                  0000000
120690             move   1  to  ipppri-butoir                          0000000
120700d                  display 'butoir53 = ' ipppri-butoir            0000000
120710                                                                  0000000
120720               If (w-butmax  numeric  and                         0000000
120730                   w-butmax  >  zero  and                         0000000
120740                   w-butmax  <  50 )                              0000000
120750                   move   2  to  ipppri-butoir                    0000000
120760d                  display 'butoir54 = ' ipppri-butoir            0000000
120770               End-if                                             0000000
120780          Else                                                    0000000
120790                                                                  0000000
120800               If (w-butmax  numeric  and                         0000000
120810                   w-butmax  >  zero  and                         0000000
120820                   w-butmax  <  50 )                              0000000
120830                   move   3  to  ipppri-butoir                    0000000
120840d                  display 'butoir31 = ' ipppri-butoir            0000000
120850               End-if                                             0000000
120860          End-if                                                  0000000
120870      End-if.                                                     0000000
120880                                                                  0000000
120890      if orgs01-banque-cic                                        0000000
120900         if (ipxpro-cic-21828  or                                 0000000
120910             ipxpro-cic-20016  or                                 0000000
120920             w-cprod = '20031' )                                  0000000
120930             move   3  to  ipppri-butoir                          0000000
120940d           display 'butoir5= ' ipppri-butoir                     0000000
120950         Else                                                     0000000
120960                                                                  0000000
120970            IF  ipxpro-cic-20094                                  0000000
120980                move   2  to  ipppri-butoir                       0000000
120990d           display 'butoir51= ' ipppri-butoir                    0000000
121000                                                                  0000000
121010            Else                                                  0000000
121020              If (w-butmin  numeric  and                          0000000
121030                  w-butmin  >  zero )                             0000000
121040                                                                  0000000
121050                  If (w-butmax  numeric  and                      0000000
121060                      w-butmax  >  zero  and                      0000000
121070                      w-butmax  <  50 )                           0000000
121080                      move   2  to  ipppri-butoir                 0000000
121090d           display 'butoir52= ' ipppri-butoir                    0000000
121100                  End-if                                          0000000
121110              Else                                                0000000
121120                                                                  0000000
121130                  If (w-butmax  numeric  and                      0000000
121140                      w-butmax  >  zero  and                      0000000
121150                      w-butmax  <  50 )                           0000000
121160                      move   3  to  ipppri-butoir                 0000000
121170d                     display 'butoir31 = ' ipppri-butoir         0000000
121180                  End-if                                          0000000
121190              End-if                                              0000000
121200            End-if                                                0000000
121210         End-if                                                   0000000
121220                                                                  0000000
121230          if   IPXPRO-CIC-AN-GAMME  and                           0000000
121240               ipppri-butoir  not  =  zero                        0000000
121250               move   4  to  ipppri-butoir                        0000000
121260d              display 'butoir4= ' ipppri-butoir                  0000000
121270          End-if                                                  0000000
121280     End-if                                                       0000000
121290d    display 'butoir fin = ' ipppri-butoir                        0000000
121300     .                                                            0000000
121310                                                                  0000000
121320     MOVE IPPRGT TO IPPRGT-STOCK(IP)                              0000000
121330                                                                  0000000
121340     If (say-cindex = '023CN' or '281HE' or '240HK'               0000000
121350        or '245HK' or '243HJ' or '270HJ' )    and  avenant        0000000
121360         move   zero  to   ipppri-butoir                          0000000
121370     End-if.                                                      0000000
121380                                                                  0000000
121390     INITIALIZE  LCHATEL-O (IP)                                   0000000
121400         If  say-vtau  = '2'                                      0000000
121410            if (((orgs01-fede-antilles                            0000000
121420            or orgs01-fede-Arras )                                0000000
121430               and ( say-mges =  '2'  or  '4' ))                  0000000
121440             or                                                   0000000
121450              (orgs01-fede-cee                                    0000000
121460                 and ( say-mges =  '2'  or  '4' or  '6' )))       0000000
121470                     Perform  Appel-IPXZLCHA                      0000000
121480                     If  IPXLCH-O-RETOUR-OK                       0000000
121490                         Perform  MEF-Chatel                      0000000
121500                     Else                                         0000000
121510                         INITIALIZE  LCHATEL-O (IP)               0000000
121520                         display 'IPXZLCHA erreur '               0000000
121530                         display  IPXLCH-O-LIBELLE                0000000
121540                     End-if                                       0000000
121550            End-if                                                0000000
121560         End-if                                                   0000000
121570     .                                                            0000000
121580                                                                  0000000
121590 Appel-IPXZLCHA.                                                  0000000
121600                                                                  0000000
121610     Initialize  IPXLCH                                           0000000
121620                                                                  0000000
121630     Move  orgs01-banque    to   IPXLCH-I-REF-BQE                 0000000
121640     Move  say-ncais        to   IPXLCH-I-REF-CAI                 0000000
121650     Move  say-mtcred       to   IPXLCH-I-MT-CRED                 0000000
121660     Move  say-duram        to   IPXLCH-I-DURAM                   0000000
121670                                                                  0000000
121680     If  say-mges  =  '6'                                         0000000
121690        MOVE  SA2-DATDEC    TO  IPXLCH-I-DATDEB                   0000000
121700        MOVE  SA2-DATECH1   TO  IPXLCH-I-DT-REMB(1)               0000000
121710        MOVE  SAy-ech1      TO  IPXLCH-I-MT-REMB(1)               0000000
121720        Move  '01'          to  IPXLCH-I-PERDEG                   0000000
121730*      If  say-perdeg  =  '9'                                     0000000
121740*          Move  '12'             to   IPXLCH-I-PERDEG            0000000
121750*      Else                                                       0000000
121760*          String '0'                                             0000000
121770*                say-perdeg  delimited by size                    0000000
121780*                               into   IPXLCH-I-PERDEG            0000000
121790*      End-if                                                     0000000
121800*    Else                                                         0000000
121810*      If  say-peremb  =  '9'                                     0000000
121820*          Move  '12'             to   IPXLCH-I-PEREMB            0000000
121830*      Else                                                       0000000
121840*          String '0'                                             0000000
121850*                say-peremb  delimited by size                    0000000
121860*                               into   IPXLCH-I-PEREMB            0000000
121870*          Move  '01'  to   IPXLCH-I-PEREMB                       0000000
121880*      End-if                                                     0000000
121890     End-if                                                       0000000
121900     Move  '01'  to   IPXLCH-I-PEREMB                             0000000
121910                                                                  0000000
121920*    If  APXTR5-TYPTAR-ENCOURS                                    0000000
121930     If  IPXCAL-ENCOURS                                           0000000
121940       COMPUTE IPXLCH-I-TAUDB =                                   0000000
121950*           say-taudb  - APXTR5-TAUASSPRT                         0000000
121960            say-taudb  - IPXCAL-TAUTARPLV                         0000000
121970     else                                                         0000000
121980         Move  say-taudb        to   IPXLCH-I-TAUDB               0000000
121990     End-if                                                       0000000
122000d    display  ' IPXLCH-I-TAUDB ' IPXLCH-I-TAUDB                   0000000
122010     if   say-mges = '4'                                          0000000
122020          Move   'P'            to   IPXLCH-I-MGES                0000000
122030     Else                                                         0000000
122040          Move   say-mges       to   IPXLCH-I-MGES                0000000
122050     End-if                                                       0000000
122060     Move  say-vter             to   IPXLCH-I-VTER                0000000
122070                                                                  0000000
122080     move  say-cindex           to   IPXLCH-I-CINDEX              0000000
122090                                                                  0000000
122100     If (say-cindex  =  '003Z3' or '375ZG' or '375ZF' or '245ZB') 0000000
122110         Move  120  to  IPXLCH-I-DUR-FIX                          0000000
122120     Else                                                         0000000
122130      If (say-cindex =  '374ZD' or '374ZE' or '354DT' or '354ZZ') 0000000
122140          Move   60  to  IPXLCH-I-DUR-FIX                         0000000
122150      Else                                                        0000000
122160       If (say-cindex = '374ZD' or '374ZE' or '354DT' or '354ZZ'  0000000
122170                                                      or '245ZA') 0000000
122180           Move   60  to  IPXLCH-I-DUR-FIX                        0000000
122190       Else                                                       0000000
122200        IF  SAY-DUR-FIXITE-X   NUMERIC                            0000000
122210          If  say-dur-fixite  <  12                               0000000
122220              MOVE    12              to   IPXLCH-I-DUR-FIX       0000000
122230          else                                                    0000000
122240              MOVE   SAY-DUR-FIXITE   to   IPXLCH-I-DUR-FIX       0000000
122250          END-IF                                                  0000000
122260        Else                                                      0000000
122270          MOVE    12              to   IPXLCH-I-DUR-FIX           0000000
122280        END-IF                                                    0000000
122290       END-IF                                                     0000000
122300      END-IF                                                      0000000
122310     END-IF.                                                      0000000
122320                                                                  0000000
122330     If  say-mges  =  '6'                                         0000000
122340         If  say-duram  =  say-dur-fixite                         0000000
122350             Add    6       to  IPXLCH-I-DURAM                    0000000
122360             Perform  Date-plus-6mois                             0000000
122370         End-if                                                   0000000
122380     End-if                                                       0000000
122390                                                                  0000000
122400d    display  'IPXLCH-I-DUR-FIX ' IPXLCH-I-DUR-FIX                0000000
122410                                                                  0000000
122420     if (orgs01-fede-cee  and say-cindex = '373AR')               0000000
122430         Move  1                    to   w-butmax                 0000000
122440         Move  1                    to   w-butmin                 0000000
122450     End-if                                                       0000000
122460                                                                  0000000
122470d    display 'w-butmax '    w-butmax                              0000000
122480d    display 'w-butmin '    w-butmin                              0000000
122490                                                                  0000000
122500     if  w-butmax =  zero                                         0000000
122510         Move  2                    to   IPXLCH-I-TAU-BUT-MAX     0000000
122520     Else                                                         0000000
122530         Move  w-butmax             to   IPXLCH-I-TAU-BUT-MAX     0000000
122540     End-if                                                       0000000
122550                                                                  0000000
122560     If    w-butmin   =   zero                                    0000000
122570         Move  2                    to   IPXLCH-I-TAU-BUT-MIN     0000000
122580     Else                                                         0000000
122590         Move  w-butmin             to   IPXLCH-I-TAU-BUT-MIN     0000000
122600     End-if                                                       0000000
122610                                                                  0000000
122620     move  Z-NBPALIER           to   IPXLCH-I-NBPAL               0000000
122630     move  say-devise           to   IPXLCH-I-DEV-PRT             0000000
122640                                                                  0000000
122650     if   say-mges = '4'                                          0000000
122660       Perform  varying i-pal from 1 by 1                         0000000
122670             until   i-pal  >  Z-NBPALIER                         0000000
122680             move   SAI-TER  (i-pal)                              0000000
122690                                to IPXLCH-I-PAL-MT-TERME(i-pal)   0000000
122700             move   sai-nb   (i-pal)                              0000000
122710                                to IPXLCH-I-PAL-NB-MOIS (i-pal)   0000000
122720       End-perform                                                0000000
122730     End-if                                                       0000000
122740*PGI - R40738 - 10/06/2011 - DEB                                  0000000
122750     Move  SIT-ISC-CODE-IMS      to  IPXLCH-I-SITEX               0000000
122760*    Move  ZISC-IMS              to  IPXLCH-I-SITEX               0000000
122770*PGI - R40738 - 10/06/2011 - FIN                                  0000000
122780                                                                  0000000
122790     IF  (SAY-CINDEX (1:3)  =  '002' OR '003' or '005' )          0000000
122800          MOVE '245' TO IPXLCH-I-CINDEX(1:3)                      0000000
122810     End-if                                                       0000000
122820                                                                  0000000
122830     Call 'zcallpgm'  using  IPXZLCHA                             0000000
122840                             IPXLCH                               0000000
122850                             IOPCB                                0000000
122860     .                                                            0000000
122870                                                                  0000000
122880 Date-plus-6mois.                                                 0000000
122890*---------------                                                  0000000
122900                                                                  0000000
122910     INITIALIZE DATS20                                            0000000
122920     MOVE  'D01'                TO DATS20-I-FONCTION              0000000
122930     MOVE  IPXLCH-I-DT-REMB(1)  TO DATS20-I-DATE1                 0000000
122940     MOVE  'J'                  TO DATS20-I-ENTREE-TYPE1          0000000
122950     MOVE  'A'                  TO DATS20-I-ENTREE-SENS1          0000000
122960     MOVE  'J'                  TO DATS20-I-RETOUR-TYPE1          0000000
122970     MOVE  'A'                  TO DATS20-I-RETOUR-SENS1          0000000
122980     MOVE  'O'                  TO DATS20-I-RETOUR-SIECLE         0000000
122990                                                                  0000000
123000     Move  6   to  DATS20-I-NBMOIS                                0000000
123010                                                                  0000000
123020     CALL 'ZCALLPGM' USING ZDAT2000 DATS20                        0000000
123030     MOVE DATS20-O-MSG   TO IPXLCH-I-DT-REMB(1)                   0000000
123040                                                                  0000000
123050D    Display 'IPXLCH-I-DT-REMB(1) ' IPXLCH-I-DT-REMB(1)           0000000
123060     .                                                            0000000
123070                                                                  0000000
123080 MEF-Chatel.                                                      0000000
123090                                                                  0000000
123100*                                           + IPXCAL-O-TOT-ASS-FAC0000000
123110*                + SAY-MTCOM9 + SAY-FRAUT9 + SAY-FRHYP9           0000000
123120     IF  SAY-PARSOC NOT NUMERIC                                   0000000
123130         MOVE   ZERO         TO SAY-PARSOC9                       0000000
123140                                W-PARSOC9                         0000000
123150     Else                                                         0000000
123160         If  88-ps-oui                                            0000000
123170             MOVE   SAY-PARSOC9  TO W-PARSOC9                     0000000
123180         Else                                                     0000000
123190             MOVE   Zero         TO W-PARSOC9                     0000000
123200         END-IF                                                   0000000
123210     END-IF                                                       0000000
123220                                                                  0000000
123230     MOVE    IPXLCH-I-DUR-FIX to  cha-dur-fix (ip)                0000000
123240     MOVE    say-mges         to  cha-modges  (ip)                0000000
123250                                                                  0000000
123260     If  say-mges  =  '6'                                         0000000
123270         If  say-duram  =  say-dur-fixite                         0000000
123280             Move  'D'      to      cha-modges  (ip)              0000000
123290         End-if                                                   0000000
123300     End-if                                                       0000000
123310                                                                  0000000
123320     move  say-vter    to    cha-vter (ip)                        0000000
123330d    display 'cha-dur-fix '  cha-dur-fix (ip)                     0000000
123340d    display 'cha-vter    '  cha-vter    (ip)                     0000000
123350                                                                  0000000
123360* exemple a + 2                                                   0000000
123370     If  SAY-MODGES-NEW  =  '1'                                   0000000
123380         Move 'O'                     to  CHA-PAL(ip)             0000000
123390     End-if                                                       0000000
123400                                                                  0000000
123410     Move '+'                     to  CHA-SIG-PLUS  (ip)          0000000
123420                                      CHA-SIGDC-PLUS(ip)          0000000
123430                                      CHA-SIGDD-PLUS(ip)          0000000
123440     move  IPXLCH-O-TAU-PLUS      to  CHA-VAR-PLUS  (ip)          0000000
123450                                                                  0000000
123460     Move  IPXLCH-O-DIFF-DUR-PLUS to  CHA-DIFDU-PLUS(ip)          0000000
123470*    Move  IPXLCH-O-TOTINT-PLUS   to  CHA-COUT-PLUS (ip)          0000000
123480     COMPUTE  CHA-COUT-PLUS (ip) =    IPXLCH-O-TOTINT-PLUS        0000000
123490                                    + IPXCAL-O-TOT-ASS-OBL        0000000
123500                                    + IPXCAL-O-TOT-ASS-FAC        0000000
123510                                    + SAY-MTCOM9                  0000000
123520                                    + SAY-FRAUT9                  0000000
123530                                    + SAY-FRHYP9                  0000000
123540                                    + W-PARSOC9                   0000000
123550                                                                  0000000
123560                                                                  0000000
123570     Perform  varying i-pal from 1 by 1                           0000000
123580              until  IPXLCH-O-PAL-TERME-P  (i-pal) = zero         0000000
123590                                                                  0000000
123600       Move IPXLCH-O-PAL-TERME-P  (i-pal)                         0000000
123610                                  to CHA-TER-PLUS (ip  i-pal)     0000000
123620       Move IPXLCH-O-PAL-NB-MOIS-P(i-pal)                         0000000
123630                                  to CHA-DUR-PLUS (ip  i-pal)     0000000
123640     End-perform                                                  0000000
123650                                                                  0000000
123660* exemple a - 2                                                   0000000
123670     Move '-'                     to  CHA-SIG-MOINS   (ip)        0000000
123680                                      CHA-SIGDC-MOINS (ip)        0000000
123690                                      CHA-SIGDD-MOINS (ip)        0000000
123700     move  IPXLCH-O-TAU-MOINS     to  CHA-VAR-MOINS   (ip)        0000000
123710                                                                  0000000
123720     Move  IPXLCH-O-DIFF-DUR-MOINS to CHA-DIFDU-MOINS (ip)        0000000
123730*    Move  IPXLCH-O-TOTINT-MOINS  to  CHA-COUT-MOINS  (ip)        0000000
123740     COMPUTE  CHA-COUT-MOINS(ip)  =   IPXLCH-O-TOTINT-MOINS       0000000
123750                                    + IPXCAL-O-TOT-ASS-OBL        0000000
123760                                    + IPXCAL-O-TOT-ASS-FAC        0000000
123770                                    + SAY-MTCOM9                  0000000
123780                                    + SAY-FRAUT9                  0000000
123790                                    + SAY-FRHYP9                  0000000
123800                                    + W-PARSOC9                   0000000
123810                                                                  0000000
123820                                                                  0000000
123830     Perform  varying i-pal from 1 by 1                           0000000
123840              until  IPXLCH-O-PAL-TERME-M  (i-pal) = zero         0000000
123850                                                                  0000000
123860       Move IPXLCH-O-PAL-TERME-M  (i-pal)                         0000000
123870                                   to CHA-TER-MOINS(ip  i-pal)    0000000
123880       Move IPXLCH-O-PAL-NB-MOIS-M(i-pal)                         0000000
123890                                   to CHA-DUR-MOINS(ip  i-pal)    0000000
123900     End-perform                                                  0000000
123910                                                                  0000000
123920* exemple autre                                                   0000000
123930     Move '+'                     to  CHA-SIG-AUT  (ip)           0000000
123940                                      CHA-SIGDC-AUT(ip)           0000000
123950                                      CHA-SIGDD-AUT(ip)           0000000
123960     move  IPXLCH-O-TAU-MOY       to  CHA-VAR-AUT  (ip)           0000000
123970                                                                  0000000
123980     Move  IPXLCH-O-DIFF-DUR-MOY  to  CHA-DIFDU-AUT(ip)           0000000
123990*    Move  IPXLCH-O-TOTINT-MOY    to  CHA-COUT-AUT (ip)           0000000
124000                                                                  0000000
124010     COMPUTE  CHA-COUT-AUT(ip)   =    IPXLCH-O-TOTINT-MOY         0000000
124020                                    + IPXCAL-O-TOT-ASS-OBL        0000000
124030                                    + IPXCAL-O-TOT-ASS-FAC        0000000
124040                                    + SAY-MTCOM9                  0000000
124050                                    + SAY-FRAUT9                  0000000
124060                                    + SAY-FRHYP9                  0000000
124070                                    + W-PARSOC9                   0000000
124080                                                                  0000000
124090     Perform  varying i-pal from 1 by 1                           0000000
124100              until  IPXLCH-O-PAL-TERME-A  (i-pal) = zero         0000000
124110                                                                  0000000
124120       Move IPXLCH-O-PAL-TERME-A  (i-pal)                         0000000
124130                                  to CHA-TER-AUT (ip  i-pal)      0000000
124140       Move IPXLCH-O-PAL-NB-MOIS-A(i-pal)                         0000000
124150                                  to CHA-DUR-AUT (ip  i-pal)      0000000
124160     End-perform                                                  0000000
124170d    Perform  disp-chatel                                         0000000
124180     .                                                            0000000
124190 TXMINI-TXMAXI-2.                                                 0000000
124200                                                                  0000000
124210D    DISPLAY 'TXMINI-TXMAXI-2 '                                   0000000
124220D    DISPLAY 'SAY-TBASE '         SAY-TBASE                       0000000
124230D    DISPLAY 'CPT-TAUXA '         CPT-TAUXA                       0000000
124240D    DISPLAY 'SAY-TAUDB '         SAY-TAUDB                       0000000
124250D    display 'SAY-TMIN  '         SAY-TMIN                        0000000
124260D    display 'SAY-TMAX  '         SAY-TMAX                        0000000
124270D    DISPLAY 'SAY-TX-MINI-IND '   SAY-TX-MINI-IND                 0000000
124280D    DISPLAY 'SAY-TX-MAXI-IND '   SAY-TX-MAXI-IND                 0000000
124290                                                                  0000000
124300     IF   AVENANT  AND  CPT-TAUXA  NUMERIC                        0000000
124310                   AND  CPT-TAUXA   >   ZERO                      0000000
124320          IF  APXTRE-ENCOURS                                      0000000
124330              COMPUTE  WS-TAUX  =                                 0000000
124340                       CPT-TAUXA   -  APXTRE-TAUTARPLV            0000000
124350          ELSE                                                    0000000
124360              MOVE     CPT-TAUXA   TO   WS-TAUX                   0000000
124370          END-IF                                                  0000000
124380                                                                  0000000
124390     Else                                                         0000000
124400          IF  APXTRE-ENCOURS                                      0000000
124410             COMPUTE  WS-TAUX  =                                  0000000
124420               SAY-taudb    -   APXTRE-TAUTARPLV                  0000000
124430          ELSE                                                    0000000
124440             MOVE  SAY-TAUDB  TO  WS-TAUX                         0000000
124450          END-IF                                                  0000000
124460     END-IF                                                       0000000
124470                                                                  0000000
124480     MOVE      WS-TAUX     TO  IPPRGT-TXRETENU                    0000000
124490     Move  zero  to  w-butmax  w-butmin                           0000000
124500                                                                  0000000
124510*    IF  SAY-TX-MINI-IND    NUMERIC   and                         0000000
124520*        SAY-TX-MINI-IND    NOT  =  ZERO                          0000000
124530                                                                  0000000
124540     IF  SAY-TX-MINI-IND    NUMERIC                               0000000
124550                                                                  0000000
124560         MOVE  SAY-TX-MINI-IND   TO  IPPPRI-TXMINI                0000000
124570         if  ws-taux  >  SAY-TX-MINI-IND                          0000000
124580           COMPUTE  W-TX9   = WS-TAUX  - SAY-TX-MINI-IND          0000000
124590         Else                                                     0000000
124600           Move  zero   to  w-tx9                                 0000000
124610         End-if                                                   0000000
124620         MOVE     W-TX9     TO  IPPPRI-BUTMIN   W-BUTMIN          0000000
124630     End-if                                                       0000000
124640                                                                  0000000
124650     IF (SAY-TX-MAXI-IND    NUMERIC   AND  NOT                    0000000
124660        (SAY-TX-MAXI-IND    =  ZERO  OR                           0000000
124670         SAY-TX-MAXI-IND    >  50) )                              0000000
124680        MOVE  SAY-TX-MAXI-IND   TO  IPPPRI-TXMAXI                 0000000
124690        COMPUTE  W-TX9   = SAY-TX-MAXI-IND - WS-TAUX              0000000
124700        MOVE     W-TX9     TO  IPPPRI-BUTMAX   W-BUTMAX           0000000
124710     END-IF                                                       0000000
124720* pour renego                                                     0000000
124730     If  avenant                                                  0000000
124740         If  w-butmin       =  zero  and                          0000000
124750             w-butmax  not  =  zero                               0000000
124760             Move  zero  to  IPPPRI-BUTMIN   IPPPRI-TXMINI        0000000
124770         End-if                                                   0000000
124780     End-if                                                       0000000
124790D    DISPLAY  'IPPPRI-TXMIN  '  IPPPRI-TXMINI                     0000000
124800D    DISPLAY  'IPPPRI-TXMAX  '  IPPPRI-TXMAXI                     0000000
124810D    DISPLAY  'IPPPRI-BUTMIN '  IPPPRI-BUTMIN                     0000000
124820D    DISPLAY  'IPPPRI-BUTMAX '  IPPPRI-BUTMAX                     0000000
124830D    DISPLAY  'IPPRGT-TXRETENU ' IPPRGT-TXRETENUX                 0000000
124840     .                                                            0000000
124850                                                                  0000000
124860 TXMINI-TXMAXI-PC.                                                0000000
124870                                                                  0000000
124880D    display 'TXMINI-TXMAXI-PC '                                  0000000
124890D    display 'SAY-TMIN  '         SAY-TMIN                        0000000
124900D    display 'SAY-TMAX  '         SAY-TMAX                        0000000
124910D    DISPLAY 'SAY-TX-MINI-IND '   SAY-TX-MINI-IND                 0000000
124920D    DISPLAY 'SAY-TX-MAXI-IND '   SAY-TX-MAXI-IND                 0000000
124930D    DISPLAY 'PRTIND02-TMIN   '   PRTIND02-TMIN                   0000000
124940D    DISPLAY 'PRTIND02-TMAX   '   PRTIND02-TMAX                   0000000
124950                                                                  0000000
124960     IF   PRTIND02-TMIN   <   ZERO                                0000000
124970        MULTIPLY  -1  BY  PRTIND02-TMIN.                          0000000
124980                                                                  0000000
124990     Move    PRTIND02-TMIN  to  W-PRTIND02-TMIN                   0000000
125000     Move    PRTIND02-TMAX  to  W-PRTIND02-TMAX                   0000000
125010                                                                  0000000
125020     IF   W-PRTIND02-TMIN   <  20   OR                            0000000
125030          W-PRTIND02-TMAX   <  20                                 0000000
125040        MOVE  W-PRTIND02-TMIN       TO IPPPRI-BUTMIN  W-BUTMIN    0000000
125050        MOVE  W-PRTIND02-TMAX       TO IPPPRI-BUTMAX  W-BUTMAX    0000000
125060                                                                  0000000
125070* avenant et contrat tauxbase ou tauda (taux initial)             0000000
125080D    DISPLAY  'TAUA '  SAY-TAUA9                                  0000000
125090        IF  AVENANT                                               0000000
125100           IF IPXPRO-CREDIT-MIXTE                                 0000000
125110             IF ( CPT-MIXT-TAUX-V NUMERIC AND                     0000000
125120                  CPT-MIXT-TAUX-V > ZERO )                        0000000
125130                IF  APXTRE-ENCOURS                                0000000
125140                    COMPUTE  WS-TAUX  =                           0000000
125150                         CPT-MIXT-TAUX-V  -  APXTRE-TAUTARPLV     0000000
125160                ELSE                                              0000000
125170                    MOVE CPT-MIXT-TAUX-V TO  WS-TAUX              0000000
125180                END-IF                                            0000000
125190                MOVE     WS-TAUX      TO  IPPRGT-TXRETENU         0000000
125200                COMPUTE  W-TRAV-TX  = WS-TAUX - W-PRTIND02-TMIN   0000000
125210                MOVE     W-TRAV-TX    TO  IPPPRI-TXMINI           0000000
125220                COMPUTE  W-TRAV-TX  = WS-TAUX + W-PRTIND02-TMAX   0000000
125230                MOVE     W-TRAV-TX    TO  IPPPRI-TXMAXI           0000000
125240             END-IF                                               0000000
125250           ELSE                                                   0000000
125260             IF ( CPT-TAUXA NUMERIC   AND                         0000000
125270                  CPT-TAUXA  >  ZERO  )                           0000000
125280                IF  APXTRE-ENCOURS                                0000000
125290                    COMPUTE  WS-TAUX  =                           0000000
125300                            CPT-TAUXA   -  APXTRE-TAUTARPLV       0000000
125310                ELSE                                              0000000
125320                    MOVE    CPT-TAUXA   TO  WS-TAUX               0000000
125330                END-IF                                            0000000
125340                MOVE     WS-TAUX      TO  IPPRGT-TXRETENU         0000000
125350                If ws-taux  >  W-PRTIND02-TMIN                    0000000
125360                 COMPUTE  W-TRAV-TX  = WS-TAUX - W-PRTIND02-TMIN  0000000
125370                Else                                              0000000
125380                 Move  zero  to  W-TRAV-TX                        0000000
125390                End-if                                            0000000
125400                MOVE     W-TRAV-TX    TO  IPPPRI-TXMINI           0000000
125410                COMPUTE  W-TRAV-TX  = WS-TAUX + W-PRTIND02-TMAX   0000000
125420                MOVE     W-TRAV-TX    TO  IPPPRI-TXMAXI           0000000
125430              END-IF                                              0000000
125440           END-IF                                                 0000000
125450                                                                  0000000
125460        ELSE                                                      0000000
125470                                                                  0000000
125480             IF IPXPRO-CREDIT-MIXTE                               0000000
125490                                                                  0000000
125500               IF  SAY-MIXT-TAUDB-V NUMERIC                       0000000
125510                   IF  APXTRE-ENCOURS                             0000000
125520                       COMPUTE  WS-TAUX  =                        0000000
125530                       SAY-MIXT-TAUDB-V -  APXTRE-TAUTARPLV       0000000
125540                   ELSE                                           0000000
125550                       MOVE  SAY-MIXT-TAUDB-V TO WS-TAUX          0000000
125560                   END-IF                                         0000000
125570**cha1805                                                         0000000
125580                   If  ws-taux > W-PRTIND02-TMIN                  0000000
125590                    COMPUTE W-TRAV-TX = WS-TAUX - W-PRTIND02-TMIN 0000000
125600                   Else                                           0000000
125610                    move  zero  to  w-trav-tx                     0000000
125620                   End-if                                         0000000
125630                   MOVE     W-TRAV-TX   TO  IPPPRI-TXMINI w-butmin0000000
125640                   COMPUTE  W-TRAV-TX = WS-TAUX + W-PRTIND02-TMAX 0000000
125650                   MOVE     W-TRAV-TX   TO  IPPPRI-TXMAXI w-butmax0000000
125660               END-IF                                             0000000
125670             ELSE                                                 0000000
125680               IF  SAY-TAUD  NUMERIC                              0000000
125690                   IF  APXTRE-ENCOURS                             0000000
125700                       COMPUTE  WS-TAUX  =                        0000000
125710                         SAY-TAUDB   -  APXTRE-TAUTARPLV          0000000
125720                   ELSE                                           0000000
125730                       MOVE    SAY-TAUDB   TO  WS-TAUX            0000000
125740                   END-IF                                         0000000
125750                                                                  0000000
125760                   If  ws-taux > W-PRTIND02-TMIN                  0000000
125770                    COMPUTE W-TRAV-TX = WS-TAUX - W-PRTIND02-TMIN 0000000
125780                   Else                                           0000000
125790                    move  zero  to  w-trav-tx                     0000000
125800                   End-if                                         0000000
125810                   MOVE     W-TRAV-TX    TO  IPPPRI-TXMINI        0000000
125820                                                                  0000000
125830                   COMPUTE  W-TRAV-TX  = WS-TAUX + W-PRTIND02-TMAX0000000
125840                   MOVE     W-TRAV-TX    TO  IPPPRI-TXMAXI        0000000
125850               END-IF                                             0000000
125860             END-IF                                               0000000
125870        END-IF                                                    0000000
125880     END-IF                                                       0000000
125890     .                                                            0000000
125900*    If  avenant                                                  0000000
125910*      if say-cindex = '023CN'                                    0000000
125920*         MOVE      zero        TO  IPPRGT-TXRETENUX              0000000
125930*      End-if                                                     0000000
125940*    End-if                                                       0000000
125950                                                                  0000000
125960*                                                                 0000000
125970D    DISPLAY  'IPPPRI-TXMIN '  IPPPRI-TXMINI                      0000000
125980D    DISPLAY  'IPPPRI-TXMAX '  IPPPRI-TXMAXI                      0000000
125990D    DISPLAY  'IPPRGT-TXRETENU ' IPPRGT-TXRETENUX                 0000000
126000     .                                                            0000000
126010*--------------------                                             0000000
126020 TXMINI-TXMAXI.                                                   0000000
126030*--------------------                                             0000000
126040D    DISPLAY  'TAUBASE '  SAY-TBASE.                              0000000
126050     IF   AVENANT  AND  SAY-TBASE  NUMERIC                        0000000
126060                   AND  SAY-TBASE   >   ZERO                      0000000
126070          IF  APXTRE-ENCOURS                                      0000000
126080              COMPUTE  WS-TAUX  =                                 0000000
126090                       SAY-TBASE   -  APXTRE-TAUTARPLV            0000000
126100          ELSE                                                    0000000
126110              MOVE    SAY-TBASE   TO  WS-TAUX                     0000000
126120          END-IF                                                  0000000
126130          MOVE      WS-TAUX     TO  IPPRGT-TXRETENU               0000000
126140          if  ws-taux  >  SAY-TMIN                                0000000
126150            COMPUTE  W-TRAV-TX  =   WS-TAUX  -  SAY-TMIN          0000000
126160          Else                                                    0000000
126170            Move  zero  to  W-TRAV-TX                             0000000
126180          End-if                                                  0000000
126190          MOVE     W-TRAV-TX    TO  IPPPRI-TXMINI                 0000000
126200          COMPUTE  W-TRAV-TX  =   WS-TAUX  +  SAY-TMAX            0000000
126210          MOVE     W-TRAV-TX    TO  IPPPRI-TXMAXI                 0000000
126220     ELSE                                                         0000000
126230     IF  SAY-TAUD  NUMERIC                                        0000000
126240          IF  APXTRE-ENCOURS                                      0000000
126250              COMPUTE  WS-TAUX  =                                 0000000
126260                       SAY-TAUDB   -  APXTRE-TAUTARPLV            0000000
126270          ELSE                                                    0000000
126280              MOVE    SAY-TAUDB   TO  WS-TAUX                     0000000
126290          END-IF                                                  0000000
126300          if  ws-taux  >  SAY-TMIN                                0000000
126310            COMPUTE  W-TRAV-TX  =   WS-TAUX  -  SAY-TMIN          0000000
126320          Else                                                    0000000
126330            Move  zero  to  W-TRAV-TX                             0000000
126340          End-if                                                  0000000
126350                                                                  0000000
126360          MOVE     W-TRAV-TX    TO  IPPPRI-TXMINI                 0000000
126370          COMPUTE  W-TRAV-TX  =   WS-TAUX  + SAY-TMAX             0000000
126380          MOVE     W-TRAV-TX    TO  IPPPRI-TXMAXI.                0000000
126390                                                                  0000000
126400D    DISPLAY  'TXRETENU='  IPPRGT-TXRETENU.                       0000000
126410                                                                  0000000
126420 VENTIL-COMMIS.                                                   0000000
126430*-------------------------                                        0000000
126440     IF Z-MCOTOCM NOT = ZERO OR W-MTCOM9  NOT = ZERO              0000000
126450        COMPUTE Z-TXCOMMIS = SAI-TCOM * W-MTCOM9                  0000000
126460                           / (Z-MCOTOCM + W-MTCOM9)               0000000
126470     ELSE MOVE ZERO TO Z-TXCOMMIS.                                0000000
126480     MOVE Z-TXCOMMIS TO IPPPRI-TXCOMMIS.                          0000000
126490     COMPUTE Z-TXCOTOCM = SAI-TCOM - Z-TXCOMMIS.                  0000000
126500     MOVE Z-TXCOTOCM TO IPPPRI-TXCOTOCM.                          0000000
126510D    DISPLAY 'IPPPRI-TXCOMMIS '   IPPPRI-TXCOMMIS.                0000000
126520                                                                  0000000
126530*-------------------------                                        0000000
126540 TRAIT-DUREES.                                                    0000000
126550*-------------------------                                        0000000
126560*    CALCUL EFFECTIF DE DURFRANC ---> VOIR SS-PGM                 0000000
126570*                                                                 0000000
126580*    DURFRANC = ZERO SI PAR EXPLE DATE 1ER DECAISST NON FOURNIE   0000000
126590*    (CONTRAIREMENT A IMMOBILIER OU DURFRANC = 24 PAR DEFAUT)     0000000
126600*                                                                 0000000
126610     MOVE ZERO                 TO PROBLEME-DATE.                  0000000
126620*                                                                 0000000
126630     IF   SA2-DATDEC  NUMERIC                                     0000000
126640      AND SA2-DATDEC  NOT  =  ZERO                                0000000
126650          MOVE SA2-DATDEC  TO  IPPRCFRA-DATDEB                    0000000
126660     ELSE                                                         0000000
126670          MOVE W-DATE-8    TO  IPPRCFRA-DATDEB.                   0000000
126680                                                                  0000000
126690*  PAS DE FRANCHISE EN MODE DE GESTION 6                          0000000
126700* (DATE DE FIN = DATE DE DEBUT)                                   0000000
126710      IF   SAY-MGES  =  '6'                                       0000000
126720           MOVE  IPPRCFRA-DATDEB  TO IPPRCFRA-DATFIN              0000000
126730           move  zero             to Z-DURFRANC                   0000000
126740           move  zero             to FIN-DE-FRANCHISE             0000000
126750      ELSE                                                        0000000
126760           MOVE  SA2-DATEC        TO IPPRCFRA-DATFIN              0000000
126770           IF   Z-DURFRANC  =  ZERO                               0000000
126780                PERFORM CALCUL-DURFRANC                           0000000
126790           End-if                                                 0000000
126800      End-if.                                                     0000000
126810*                                                                 0000000
126820**** EN IMMOBILIER IPI DURFRANC = 24 PAR DEFAUT                   0000000
126830     IF  NOT (SAY-CNAT    =  '291' OR '304' OR '302')             0000000
126840         IF   IPPMA2-LABEL-APPLI = 'IPI'                          0000000
126850                    AND  NOT (ORGS01-FEDE-CICP)                   0000000
126860              MOVE   24       TO IPPPRI-DURFRANC                  0000000
126870              IF SAY-MGES  =  '6'                                 0000000
126880*             IF   Z-TYPCRED = 'IMMO-DV'                          0000000
126890                   MOVE ZERO  TO IPPPRI-DURFRANC-X                0000000
126900              ELSE NEXT SENTENCE                                  0000000
126910         ELSE                                                     0000000
126920         IF   Z-DURFRANC NOT = ZERO                               0000000
126930              MOVE Z-DURFRANC TO IPPPRI-DURFRANC                  0000000
126940         ELSE                                                     0000000
126950              MOVE ZERO       TO IPPPRI-DURFRANC-X                0000000
126960     ELSE                                                         0000000
126970         IF  SAY-TZBAR-DIFFERE-100                                0000000
126980             AND  Z-DURFRANC  NOT  =  ZERO                        0000000
126990                  MOVE Z-DURFRANC TO IPPPRI-DURFRANC              0000000
127000             ELSE                                                 0000000
127010                  MOVE ZERO       TO Z-DURFRANC                   0000000
127020                  MOVE ZERO       TO IPPPRI-DURFRANC-X.           0000000
127030                                                                  0000000
127040     IF   SAY-MGES  =  '6'                                        0000000
127050          MOVE ZERO        TO IPPPRI-DURFRANC-X                   0000000
127060          MOVE ZERO        TO Z-DURFRANC                          0000000
127070          MOVE SAY-DURAMS  TO Z-DURAMORT                          0000000
127080     ELSE                                                         0000000
127090          MOVE SAY-DURAM   TO Z-DURAMORT                          0000000
127100     END-IF.                                                      0000000
127110*                                                                 0000000
127120*    IF  (SA2-DATDEC  =  ZERO  OR  SPACE)                         0000000
127130*        IF  ORGS01-FEDE-CAEN   AND  IPPMA2-LABEL-APPLI = 'IPC'   0000000
127140*            MOVE ZERO        TO IPPPRI-DURFRANC-X                0000000
127150*            MOVE ZERO        TO Z-DURFRANC                       0000000
127160*        END-IF                                                   0000000
127170*    END-IF.                                                      0000000
127180                                                                  0000000
127190D    DISPLAY  'SAY-CD-SOUS-PROD ' SAY-CD-SOUS-PROD.               0000000
127200     IF  IPXPRO-TT-AUTO                                           0000000
127210         MOVE  '1'   TO  IPPPRI-TTAUTO                            0000000
127220         MOVE  ZERO  TO  IPPPRI-DURFRANC-X                        0000000
127230         MOVE  ZERO  TO  Z-DURFRANC.                              0000000
127240                                                                  0000000
127250     IF  AVENANT                                                  0000000
127260         MOVE  ZERO  TO  IPPPRI-DURFRANC-X                        0000000
127270         MOVE  ZERO  TO  Z-DURFRANC.                              0000000
127280                                                                  0000000
127290     COMPUTE Z-DURTOTAL = Z-DURAMORT + Z-DURFRANC.                0000000
127300     MOVE Z-DURAMORT         TO IPPPRI-DURAMORT.                  0000000
127310                                                                  0000000
127320D    DISPLAY '  Z-DURAMORT = ' Z-DURAMORT.                        0000000
127330                                                                  0000000
127340     IF (( IPPMA2-2-CNAT9 (IP) > 600 AND < 610)                   0000000
127350          OR  (IPPMA2-2-CNAT (IP) = '620' OR '621')               0000000
127360          OR  (IPPMA2-2-CNAT (IP) > '640' and < '648'))           0000000
127370        PERFORM RECTIF-DUREE-BONIFIEE                             0000000
127380        MOVE Z-DURB-RECTIF TO Z-DURAMOR1                          0000000
127390        MOVE Z-DURB-RECTIF TO SAY-DURAMLT                         0000000
127400D       DISPLAY 'PRET AGRICOLE RECONNU Z-DURAMOR1= ' Z-DURAMOR1   0000000
127410                                                                  0000000
127420        IF APXTRE-ENCOURS                                         0000000
127430            COMPUTE  Z-TAUX1  =  SAY-TAUDB  -  APXTRE-TAUTARPLV   0000000
127440            COMPUTE  Z-TAUX2  =  SAY-TAUDBLT                      0000000
127450        ELSE                                                      0000000
127460            MOVE SAY-TAUDBLT   TO Z-TAUX2                         0000000
127470            MOVE SAY-TAUDB     TO Z-TAUX1                         0000000
127480        END-IF                                                    0000000
127490                                                                  0000000
127500        MOVE 9,00          TO SAY-COEFK                           0000000
127510        COMPUTE Z-DURAMOR2 = SAY-DURAM - Z-DURAMOR1               0000000
127520D       DISPLAY 'PRET AGRICOLE RECONNU Z-DURAMOR2= ' Z-DURAMOR2   0000000
127530                                                                  0000000
127540        IF   (Z-DURAMOR1  =  Z-DURAMORT)                          0000000
127550D          DISPLAY '  Z-DURAMORT = ' Z-DURAMORT                   0000000
127560D          DISPLAY '  Z-DURAMOR1 = Z-DURAMORT '                   0000000
127570D          DISPLAY ' SAY-TAUDBLT = ' SAY-TAUDBLT                  0000000
127580           MOVE ZERO   TO IPPPRI-DURAMOR2-X                       0000000
127590           MOVE SPACES TO SAY-TAUDLT                              0000000
127600        END-IF                                                    0000000
127610     ELSE                                                         0000000
127620        MOVE ZERO                 TO IPPPRI-DURAMOR1-X            0000000
127630D       DISPLAY 'PAS PRET AGRICOLE ' IPPPRI-DURAMOR1-X            0000000
127640        MOVE ZERO                 TO IPPPRI-DURAMOR2-X.           0000000
127650*                                                                 0000000
127660*FG-0190-MEMORISATION DES DUREES BONIFIEE ET NON BONIFIEE POUR    0000000
127670*       -LES PRETS AGRICOLES, DES 2 NB DE TERMES ET DES 2 TAUX.   0000000
127680                                                                  0000000
127690     IF   ((   IPPMA2-2-CNAT9 (IP) > 600 AND < 610)               0000000
127700          OR  (IPPMA2-2-CNAT (IP) = '620' OR '621')               0000000
127710          OR  (IPPMA2-2-CNAT (IP) > '640' and < '648'))           0000000
127720D          DISPLAY 'Z-DURAMORT      = ' Z-DURAMORT                0000000
127730D          DISPLAY 'Z-DURAMOR1      = ' Z-DURAMOR1                0000000
127740           IF  Z-DURAMOR1  NOT  =  Z-DURAMORT                     0000000
127750D              DISPLAY 'Z-DURAMOR1      = ' Z-DURAMOR1            0000000
127760D              DISPLAY 'Z-DURAMOR2      = ' Z-DURAMOR2            0000000
127770D              DISPLAY 'Z-DURAMOR1  /=  Z-DURAMOR2 '              0000000
127780D              DISPLAY 'Z-TAUX1 '       Z-TAUX1                   0000000
127790D              DISPLAY 'Z-TAUX2 '       Z-TAUX2                   0000000
127800               MOVE Z-DURAMOR1         TO IPPPRI-DURAMOR1         0000000
127810               MOVE Z-DURAMOR2         TO IPPPRI-DURAMOR2         0000000
127820               COMPUTE Z-NBTERME1 = (Z-DURAMOR1 * Z-NBMOIS) / 12  0000000
127830               COMPUTE Z-NBTERME2 = (Z-DURAMOR2 * Z-NBMOIS) / 12  0000000
127840               MOVE Z-NBTERME1         TO IPPPRI-NBTERM01         0000000
127850               MOVE Z-NBTERME2         TO IPPPRI-NBTERM02         0000000
127860               MOVE Z-TAUX1            TO IPPPRI-TXTERM01         0000000
127870               MOVE Z-TAUX2            TO IPPPRI-TXTERM02         0000000
127880           ELSE                                                   0000000
127890               MOVE ZERO               TO IPPPRI-DURAMOR2-X       0000000
127900               MOVE Z-DURAMOR1         TO IPPPRI-DURAMOR1         0000000
127910               COMPUTE Z-NBTERME1 = (Z-DURAMOR1 * Z-NBMOIS) / 12  0000000
127920               MOVE Z-NBTERME1         TO IPPPRI-NBTERM01         0000000
127930               MOVE Z-TAUX1            TO IPPPRI-TXTERM01.        0000000
127940                                                                  0000000
127950* pour prets edf.............debut                                0000000
127960     IF  IPXPRO-BONIF-EDF                                         0000000
127970         IF IPPMA2-TAUX-NON-BONIFIE-9  NUMERIC                    0000000
127980            MOVE IPPMA2-TAUX-NON-BONIFIE-9   TO IPPPRI-TXTERM02   0000000
127990         END-IF                                                   0000000
128000     END-IF                                                       0000000
128010* pour prets edf.............fin                                  0000000
128020                                                                  0000000
128030     COMPUTE Z-NBTERME = (Z-DURAMORT * Z-NBMOIS) / 12.            0000000
128040     MOVE Z-NBTERME          TO IPPPRI-NBTERME.                   0000000
128050     IF   Z-NBTERME = 1                                           0000000
128060     OR  (Z-TYPCRED = 'PROF-DV' OR 'CONS-DV')                     0000000
128070          MOVE '1'      TO IPPPRI-INDTERME                        0000000
128080     ELSE                                                         0000000
128090          MOVE '0'      TO IPPPRI-INDTERME.                       0000000
128100     MOVE Z-DURTOTAL         TO IPPPRI-DURTOTAL.                  0000000
128110d    display 'txterm02 ' IPPPRI-TXTERM02.                         0000000
128120                                                                  0000000
128130*------------------                                               0000000
128140 CALCUL-DURFRANC.                                                 0000000
128150*------------------                                               0000000
128160*                                                                 0000000
128170     IF   SAY-PEREMB NUMERIC                                      0000000
128180          IF   SAY-PEREMB = '9'                                   0000000
128190               MOVE 12 TO Z-PER                                   0000000
128200          ELSE                                                    0000000
128210               MOVE SAY-PEREMB  TO Z-PER-9                        0000000
128220               MOVE  Z-PER-9    TO Z-PER                          0000000
128230     ELSE                                                         0000000
128240          MOVE  1  TO Z-PER.                                      0000000
128250*                                                                 0000000
128260     MOVE Z-PER       TO IPPRCFRA-TYPECH.                         0000000
128270     CALL 'ZCALLPGM' USING IPPRCFRA                               0000000
128280                           CTL                                    0000000
128290                           IPPRCFRA-DATDEB                        0000000
128300                           IPPRCFRA-DATFIN                        0000000
128310                           IPPRCFRA-TYPECH                        0000000
128320                           IPPRCFRA-NBRECH.                       0000000
128330*                                                                 0000000
128340     IF CTL-R12 = '01'                                            0000000
128350D       DISPLAY 'LES DATES NE SONT PAS NUMERIQUES'                0000000
128360        MOVE ZERO  TO Z-DURFRANC                                  0000000
128370        MOVE '1'   TO PROBLEME-DATE.                              0000000
128380     IF CTL-R12 = '02'                                            0000000
128390D       DISPLAY 'DATE PREMIERE ECHEANCE < PREMIER DECAISSEMENT'   0000000
128400        MOVE ZERO  TO Z-DURFRANC                                  0000000
128410        MOVE '1'   TO PROBLEME-DATE.                              0000000
128420*                                                                 0000000
128430D    DISPLAY 'IPPRCFRA-TYPECH   = ' IPPRCFRA-TYPECH.              0000000
128440D    DISPLAY 'IPPRCFRA-NBRECH   = ' IPPRCFRA-NBRECH.              0000000
128450*                                                                 0000000
128460     IF CTL-R12 = '00' AND PROBLEME-DATE = ZERO                   0000000
128470        MOVE IPPRCFRA-DATFIN TO FIN-DE-FRANCHISE                  0000000
128480        MOVE IPPRCFRA-NBRECH TO Z-DURFRANC                        0000000
128490     ELSE                                                         0000000
128500        if  ctl-r34  not  =  zero                                 0000000
128510d         display 'ctl '  ctl                                     0000000
128520          MOVE ZERO            TO ctl-r34                         0000000
128530          MOVE ZERO            TO Z-DURFRANC                      0000000
128540          MOVE ZERO            TO FIN-DE-FRANCHISE.               0000000
128550D    DISPLAY 'Z-DURFRANC        = ' Z-DURFRANC.                   0000000
128560*                                                                 0000000
128570*----------------                                                 0000000
128580 TRAIT-PALIERS.                                                   0000000
128590*----------------                                                 0000000
128600     MOVE ZERO TO Z-NBTERM.                                       0000000
128610     MOVE ZERO TO Z-NBTERM-FR                                     0000000
128620     MOVE ZERO TO Z-NBPALIER.                                     0000000
128630     MOVE ZERO TO WS-EPAECH.                                      0000000
128640*                                                                 0000000
128650     IF IPPMA2-LABEL-APPLI = 'IPC' AND                            0000000
128660        (SAY-EPA-MONT9 NUMERIC)                                   0000000
128670        IF (SAY-EPA-MONT9 NOT = ZERO)                             0000000
128680        AND (SAY-EPA-BANQUE9 NUMERIC)                             0000000
128690        AND (SAY-EPA-BANQUE9 NOT = ZERO)                          0000000
128700        AND (SAY-EPA-CAISSE9 NUMERIC)                             0000000
128710        AND (SAY-EPA-CAISSE9 NOT = ZERO)                          0000000
128720        AND (SAY-EPA-COMPTE9 NUMERIC)                             0000000
128730        AND (SAY-EPA-COMPTE9 NOT = ZERO)                          0000000
128740           MOVE  SAY-EPA-MONT9  TO  WS-EPAECH.                    0000000
128750*                                                                 0000000
128760*FG-0190-RECUPERATION DES 2 TERMES DES PRETS A L'AGRICULTURE      0000000
128770*                                                                 0000000
128780     IF ((IPPMA2-2-CNAT9 (IP) > 600 AND < 610) OR                 0000000
128790        (IPPMA2-2-CNAT (IP) = '620' OR   '621')                   0000000
128800          OR  (IPPMA2-2-CNAT (IP) > '640' and < '648'))           0000000
128810D        DISPLAY ' Z-DURAMORT ' Z-DURAMORT                        0000000
128820D        DISPLAY ' Z-DURAMOR1 ' Z-DURAMOR1                        0000000
128830             IF Z-DURAMOR1  NOT  =  Z-DURAMORT                    0000000
128840                MOVE 2 TO IPPPRI-NBPALIER                         0000000
128850                                                                  0000000
128860d                 display 'Z-NBTERME1            = ' Z-NBTERME1   0000000
128870d                 display 'Z-NBTERME2            = ' Z-NBTERME2   0000000
128880                                                                  0000000
128890                  COMPUTE  W-MTTERME1   =                         0000000
128900                       TAM-TER OF PRTCO4 (1)  -                   0000000
128910                       TAM-ASS OF PRTCO4 (1)                      0000000
128920                  MOVE  W-MTTERME1    TO    IPPPRI-MTTERM01       0000000
128930                                                                  0000000
128940                  COMPUTE ITER = Z-NBTERME1 + 1                   0000000
128950                  COMPUTE  W-MTTERME2   =                         0000000
128960                       TAM-TER OF PRTCO4 (ITER)  -                0000000
128970                       TAM-ASS OF PRTCO4 (ITER)                   0000000
128980                  MOVE  W-MTTERME2    TO    IPPPRI-MTTERM02       0000000
128990                                                                  0000000
129000                                                                  0000000
129010                COMPUTE Z-NBTERM = Z-NBTERME1 + Z-NBTERME2        0000000
129020             ELSE                                                 0000000
129030                MOVE 1    TO IPPPRI-NBPALIER                      0000000
129040d                 display 'TAM-TER OF TABAMO (1) = '              0000000
129050d                          TAM-TER OF TABAMO (1)                  0000000
129060                  MOVE TAM-TER OF TABAMO (1) TO IPPPRI-MTTERM01   0000000
129070d                 display 'Z-NBTERM              = ' Z-NBTERM     0000000
129080d                 display 'co3-TER           (1) = '              0000000
129090d                          co3-ter (1)                            0000000
129100                  MOVE CO3-TER  (1)          TO IPPPRI-MTTERM01   0000000
129110                                                                  0000000
129120                                                                  0000000
129130                MOVE ZERO TO IPPPRI-MTTERM02                      0000000
129140                MOVE Z-NBTERME TO Z-NBTERM                        0000000
129150     ELSE                                                         0000000
129160         PERFORM TRAIT-PALIERS-PO.                                0000000
129170*                                                                 0000000
129180****     AUTO                                                     0000000
129190**** MGES 4 : CREDIT AUTO PROGRESSIF SUR 2 PALIERS                0000000
129200**** UTILISATION CLAUSE COPY SAI-TRAVAIL                          0000000
129210*                                                                 0000000
129220     IF   SAY-MGES = '4'                                          0000000
129230     AND  SAY-CNAT = '266'                                        0000000
129240          IF  SAY-PALR(1) NUMERIC                                 0000000
129250          AND SAY-PALR(2) NUMERIC                                 0000000
129260               MOVE 2           TO IPPPRI-NBPALIER                0000000
129270               MOVE SAI-NB(1)   TO IPPPRI-NBTERM01                0000000
129280               MOVE SAI-TER(1)  TO IPPPRI-MTTERM01                0000000
129290               COMPUTE WS-TERME = SAI-TER(1) + WS-EPAECH          0000000
129300               MOVE WS-TERME    TO IPPPRI-EPATER                  0000000
129310               MOVE SAI-TAUX(1) TO IPPPRI-TXTERM01                0000000
129320               MOVE SAI-NB(2)   TO IPPPRI-NBTERM02                0000000
129330               COMPUTE WS-TERME = SAI-TER(2) + WS-EPAECH          0000000
129340               MOVE WS-TERME    TO IPPPRI-EPATER2                 0000000
129350               MOVE SAI-TER(2)  TO IPPPRI-MTTERM02                0000000
129360               MOVE SAI-TAUX(2) TO IPPPRI-TXTERM02                0000000
129370               MOVE ZERO        TO IPPPRI-NBTERME                 0000000
129380               MOVE SPACE       TO IPPPRI-MTTERME-X.              0000000
129390                                                                  0000000
129400 TRAIT-PALIERS-PO.                                                0000000
129410*-------------------------                                        0000000
129420                                                                  0000000
129430     IF SAI-TER (1) NUMERIC AND SAI-TER(1) NOT = ZERO             0000000
129440        COMPUTE WS-TERME = SAI-TER(1) + WS-EPAECH                 0000000
129450        MOVE WS-TERME    TO  IPPPRI-EPATER                        0000000
129460        MOVE SAI-TER(1)  TO IPPPRI-MTTERME                        0000000
129470     ELSE                                                         0000000
129480        MOVE ZERO        TO  IPPPRI-MTTERME-X                     0000000
129490        MOVE ZERO        TO  IPPPRI-EPATER2-X                     0000000
129500        MOVE ZERO        TO  IPPPRI-EPATER-X.                     0000000
129510     PERFORM TRAIT-PALIERS-PO-LOOP                                0000000
129520             VARYING IT FROM 1 BY 1 UNTIL IT GREATER 10           0000000
129530                     OR SAI-NB  (IT) NOT NUMERIC                  0000000
129540                     OR SAI-TER (IT) NOT NUMERIC                  0000000
129550                     OR SAI-NB  (IT) = ZERO.                      0000000
129560                                                                  0000000
129570 TRAIT-PALIERS-PO-LOOP.                                           0000000
129580*-------------------------                                        0000000
129590D    DISPLAY 'IT = ' IT.                                          0000000
129600     ADD  SAI-NB  (IT)   TO Z-NBTERM.                             0000000
129610     ADD 1 TO Z-NBPALIER.                                         0000000
129620D    DISPLAY 'Z-NBTERM = ' Z-NBTERM.                              0000000
129630D    DISPLAY 'Z-NBPALIER = ' Z-NBPALIER.                          0000000
129640                                                                  0000000
129650*                                                                 0000000
129660*------------------                                               0000000
129670 TRAIT-PALIERS-IMMO.                                              0000000
129680*------------------                                               0000000
129690*                                                                 0000000
129700     MOVE ZERO TO Z-NBTERM.                                       0000000
129710     MOVE ZERO TO Z-NBPALIER.                                     0000000
129720     MOVE ZERO TO Z-TOTINTER-PC.                                  0000000
129730*                                                                 0000000
129740* convertir  la  dure totale  en fonction de la periodicit.     0000000
129750                                                                  0000000
129760     if  say-peremb  =  9                                         0000000
129770         MOVE      12      to  w-per                              0000000
129780     Else                                                         0000000
129790         If   say-peremb   numeric  and                           0000000
129800              say-peremb   >   zero                               0000000
129810              MOVE say-peremb   to  w-per                         0000000
129820         Else                                                     0000000
129830              MOVE 1            to  w-per                         0000000
129840         End-if                                                   0000000
129850     End-if                                                       0000000
129860     If   w-per  =  zero                                          0000000
129870          MOVE 1            to  w-per                             0000000
129880     End-if                                                       0000000
129890d    display 'w-per = ' w-per                                     0000000
129900                                                                  0000000
129910     IF   (Z-TYPPRET = 'PO' OR 'EL')                              0000000
129920          OR (Z-TYPPRET = 'PC'  or 'CF' or 'PP')                  0000000
129930          PERFORM TRAIT-PALIERS-IMMO-PO                           0000000
129940     ELSE PERFORM TRAIT-PALIERS-IMMO-PC.                          0000000
129950*                                                                 0000000
129960*    if   say-modges-new  =  '1'                                  0000000
129970*         Compute  z-nbterm  =  z-nbterm  /  w-per   ipxbatch     0000000
129980*         move     z-nbterm  to  ipppri-duramort                  0000000
129990*    End-if                                                       0000000
130000                                                                  0000000
130010     MOVE Z-NBTERM   TO IPPPRI-NBTERME.                           0000000
130020     MOVE Z-NBPALIER TO IPPPRI-NBPALIER.                          0000000
130030*                                                                 0000000
130040 TRAIT-PALIERS-IMMO-PO.                                           0000000
130050*----------------------                                           0000000
130060                                                                  0000000
130070     IF   SAI-TER (1) NUMERIC AND SAI-TER(1) NOT = ZERO           0000000
130080          MOVE SAI-TER (1) TO  IPPPRI-MTTERME                     0000000
130090     ELSE MOVE ZERO        TO  IPPPRI-MTTERME-X.                  0000000
130100*                                                                 0000000
130110     PERFORM TRAIT-PALIERS-IMMO-PO-LOOP                           0000000
130120             VARYING IT FROM 1 BY 1 UNTIL IT GREATER 10           0000000
130130                     OR SAI-NB  (IT) NOT NUMERIC                  0000000
130140                     OR SAI-TER (IT) NOT NUMERIC                  0000000
130150                     OR SAI-NB  (IT) = ZERO.                      0000000
130160                                                                  0000000
130170     MOVE IPPRGT TO IPPRGT-STOCK(IP).                             0000000
130180*                                                                 0000000
130190 TRAIT-PALIERS-IMMO-PO-LOOP.                                      0000000
130200*-------------------------                                        0000000
130210D    DISPLAY 'IT = ' IT.                                          0000000
130220**** IPI : SPECIMMO                                               0000000
130230                                                                  0000000
130240                                                                  0000000
130250     MOVE sai-nb (it)    TO IPPRGT-NBTER-I(IT)                    0000000
130260     MOVE SAI-TER (IT)   TO IPPRGT-MTTER-I(IT).                   0000000
130270     MOVE SAI-TAUX(IT)   TO IPPRGT-TXTER-I(IT).                   0000000
130280*                                                                 0000000
130290     ADD  SAI-NB  (IT)   TO Z-NBTERM.                             0000000
130300     ADD  1              TO Z-NBPALIER.                           0000000
130310D    DISPLAY 'Z-NBTERM = ' Z-NBTERM.                              0000000
130320D    DISPLAY 'Z-NBPALIER = ' Z-NBPALIER.                          0000000
130330                                                                  0000000
130340*                                                                 0000000
130350 TRAIT-PALIERS-IMMO-PC.                                           0000000
130360*----------------------                                           0000000
130370     PERFORM COMPACTAGE-PALIERS-PC.                               0000000
130380     PERFORM TRAITEMENT-PALIERS-PC-BOUC                           0000000
130390          VARYING IT FROM  1 BY 1                                 0000000
130400          UNTIL   IT GREATER THAN 10                              0000000
130410          OR      SAI-NB   (IT) NOT NUMERIC                       0000000
130420          OR      SAI-TER  (IT) NOT NUMERIC                       0000000
130430          OR      SAI-TAUX (IT) NOT NUMERIC                       0000000
130440          OR      SAI-NB   (IT) = ZERO.                           0000000
130450     COMPUTE Z-TOTINTER-PC = Z-TOTINTER-PC - SAY-MTCRED.          0000000
130460     MOVE IPPRGT TO IPPRGT-STOCK(IP).                             0000000
130470*                                                                 0000000
130480 COMPACTAGE-PALIERS-PC.                                           0000000
130490*                                                                 0000000
130500     MOVE 1 TO TX TZ.                                             0000000
130510     PERFORM COMPACTAGE-PALIERS-PC-BOUC                           0000000
130520          VARYING TY FROM  2 BY 1                                 0000000
130530          UNTIL   TY GREATER THAN 10                              0000000
130540          OR      SAI-NB   (TY) NOT NUMERIC                       0000000
130550          OR      SAI-TER  (TY) NOT NUMERIC                       0000000
130560          OR      SAI-TAUX (TY) NOT NUMERIC                       0000000
130570          OR      SAI-NB   (TY) = ZERO.                           0000000
130580*                                                                 0000000
130590 COMPACTAGE-PALIERS-PC-BOUC.                                      0000000
130600*                                                                 0000000
130610     MOVE TZ TO TX.                                               0000000
130620     IF   SAI-TER     (TX) =  SAI-TER   (TY)                      0000000
130630     AND  SAI-TAUX    (TX) =  SAI-TAUX  (TY)                      0000000
130640          ADD SAI-NB  (TY) TO SAI-NB    (TX)                      0000000
130650          MOVE SPACE       TO SAI-TAB   (TY)                      0000000
130660     ELSE COMPUTE TZ = TX + 1                                     0000000
130670          IF   TZ NOT = TY                                        0000000
130680               MOVE SAI-TAB  (TY) TO SAI-TAB  (TZ)                0000000
130690               MOVE SPACE         TO SAI-TAB  (TY).               0000000
130700*                                                                 0000000
130710 TRAITEMENT-PALIERS-PC-BOUC.                                      0000000
130720*                                                                 0000000
130730     MOVE SAI-NB    (IT) TO  IPPRGT-NBTER-I(IT).                  0000000
130740     MOVE SAI-TER   (IT) TO  IPPRGT-MTTER-I(IT).                  0000000
130750     MOVE SAI-TAUX  (IT) TO  IPPRGT-TXTER-I(IT).                  0000000
130760     MOVE SAI-PR    (IT) TO  IPPRGT-PRTER-I(IT).                  0000000
130770     ADD  SAI-NB    (IT) TO  Z-NBTERM.                            0000000
130780     ADD  1              TO  Z-NBPALIER.                          0000000
130790     COMPUTE Z-TOTINTER-PC = Z-TOTINTER-PC +                      0000000
130800                            (SAI-NB  (IT) * SAI-TER  (IT)).       0000000
130810                                                                  0000000
130820*-------------------------                                        0000000
130830 TRAIT-MONTANTS.                                                  0000000
130840*-------------------------                                        0000000
130850*                                                                 0000000
130860*     SI C'EST UN PRET RELAIS                                     0000000
130870*        ON CALCUL LE NOMBRE D'ECHEANCE                           0000000
130880*        ET ON RENSEIGNE LES ECHEANCES.                           0000000
130890*--------                                                         0000000
130900*                                                                 0000000
130910     IF  SAY-MGES    =  '6'                                       0000000
130920         PERFORM TRAIT-DIVERS.                                    0000000
130930                                                                  0000000
130940     IF   SUITE                                                   0000000
130950          PERFORM  TRAIT-MONTANTS-SUITE.                          0000000
130960                                                                  0000000
130970*                                                                 0000000
130980 TRAIT-MONTANTS-SUITE.                                            0000000
130990*                                                                 0000000
131000*                                                                 0000000
131010     IF   SAY-GAR1 EQUAL '81' OR '82' OR '87'                     0000000
131020          IF   COA-TXCOMGAR NUMERIC                               0000000
131030               COMPUTE W-MONT                                     0000000
131040               = (SAY-MTCRED * COA-TXCOMGAR / 100)                0000000
131050               MOVE W-MONT TO Z-MVERSOCM                          0000000
131060          ELSE MOVE ZERO TO Z-MVERSOCM                            0000000
131070     ELSE MOVE ZERO TO Z-MVERSOCM.                                0000000
131080*                                                                 0000000
131090     IF Z-MVERSOCM NOT = ZERO                                     0000000
131100        MOVE Z-MVERSOCM      TO IPPPRI-MVERSOCM                   0000000
131110     ELSE                                                         0000000
131120        MOVE ZERO          TO IPPPRI-MVERSOCM-X.                  0000000
131130                                                                  0000000
131140     IF  SAY-MTCOM   NUMERIC  AND                                 0000000
131150         SAY-MTCOM9  NOT  =  ZERO                                 0000000
131160         MOVE SAY-MTCOM9      TO IPPPRI-MCOMMISS                  0000000
131170         MOVE SAY-MTCOM9      TO Z-COMM (IP)                      0000000
131180     ELSE                                                         0000000
131190        MOVE ZERO            TO IPPPRI-MCOMMISS.                  0000000
131200*       MOVE ZERO            TO IPPPRI-MCOMMISS-X.                0000000
131210                                                                  0000000
131220d    display 'SAY-FRHYP9 = ' SAY-FRHYP9                           0000000
131230     IF (CONTRAT  OR  CONTRAT-GPR)  AND                           0000000
131240         SAY-FRHYP9  NOT  =  ZERO                                 0000000
131250        MOVE SAY-FRHYP9      TO IPPPRI-MFRHYPO                    0000000
131260     ELSE                                                         0000000
131270        MOVE ZERO            TO IPPPRI-MFRHYPO.                   0000000
131280*       MOVE ZERO            TO IPPPRI-MFRHYPO-X.                 0000000
131290d    display 'IPPPRI-MFRHYPO = ' IPPPRI-MFRHYPO                   0000000
131300d    display 'SAY-FRAUT9     = ' SAY-FRAUT9                       0000000
131310     COMPUTE Z-MFRGARAN = SAY-FRAUT9 + SAY-FRHYP9.                0000000
131320                                                                  0000000
131330                                                                  0000000
131340     IF (CONTRAT  OR  CONTRAT-GPR)  AND                           0000000
131350         Z-MFRGARAN  NOT  =  ZERO                                 0000000
131360        MOVE Z-MFRGARAN      TO IPPPRI-MFRGARAN                   0000000
131370     ELSE                                                         0000000
131380        MOVE ZERO            TO IPPPRI-MFRGARAN                   0000000
131390     End-if                                                       0000000
131400                                                                  0000000
131410     MOVE  ZERO            TO IPPPRI-MPERASSU.                    0000000
131420                                                                  0000000
131430     IF  NOT  APXTRE-ENCOURS                                      0000000
131440       if   APXTRE-FLGASS-DELEG                                   0000000
131450          AND NOT ( say-gas1     =  '6'  and                      0000000
131460                    say-gas3     =  '1'  )                        0000000
131470            Move  'O'  to  ass-deleg (ip)                         0000000
131480       Else                                                       0000000
131490            Move  'N'  to  ass-deleg (ip)                         0000000
131500       End-if                                                     0000000
131510     End-if                                                       0000000
131520                                                                  0000000
131530d    display 'mpe290709'                                          0000000
131540d    display 'IPXCAL-O-ASS-PER :' IPXCAL-O-ASS-PER                0000000
131550d    display 'IPXCAL-O-ASS-DLG :' IPXCAL-O-ASS-DLG                0000000
131560     if IPXCAL-O-ASS-PER  not = zero                              0000000
131570*       Il y a une assurance souscrite aux ACM                    0000000
131580        MOVE IPXCAL-O-ASS-PER     TO IPPPRI-MPERASSU              0000000
131590     else                                                         0000000
131600*       Pas d'assurance ACM                                       0000000
131610        MOVE IPXCAL-O-ASS-DLG     TO IPPPRI-MPERASSU              0000000
131620     end-if                                                       0000000
131630d    display 'ipppri-mperassu :' ipppri-mperassu                  0000000
131640                                                                  0000000
131650     Perform  init-dtffran                                        0000000
131660                                                                  0000000
131670d    display 'SAY-COD-CAPI ' SAY-COD-CAPI                         0000000
131680D    DISPLAY 'SAY-MGES     ' SAY-MGES                             0000000
131690D    DISPLAY 'SAY-PERDEG   ' SAY-PERDEG                           0000000
131700                                                                  0000000
131710*                                                                 0000000
131720*-------------                                                    0000000
131730*                                                                 0000000
131740     IF SAI-TINT   NUMERIC                                        0000000
131750D       DISPLAY ' Z-TOTINTER ' Z-TOTINTER                         0000000
131760D       DISPLAY ' SAI-TINT ' SAI-TINT                             0000000
131770        ADD  SAI-TINT        TO    Z-TOTINTER.                    0000000
131780     IF SAI-TINT1  NUMERIC                                        0000000
131790D       DISPLAY ' SAI-TINT1 ' SAI-TINT1                           0000000
131800        ADD  SAI-TINT1       TO    Z-TOTINTER.                    0000000
131810     MOVE ZERO            TO IPPPRI-MTOTASFA-X.                   0000000
131820                                                                  0000000
131830     IF  IPXCAL-O-TOT-ASS-OBL NOT = ZERO                          0000000
131840         MOVE IPXCAL-O-TOT-ASS-OBL TO IPPPRI-MTOTASSU             0000000
131850     ELSE                                                         0000000
131860d       display 'Z-DurTotal   :' Z-DurTotal                       0000000
131870d       display 'Z-DurAmort   :' Z-DurAmort                       0000000
131880d       display 'Z-DurFranc   :' Z-DurFranc                       0000000
131890d       display 'Z-PER        :' Z-PER                            0000000
131900        IF  IPXCAL-O-ASS-DLG NOT = ZERO                           0000000
131910            compute w-totdlg = (IPXCAL-O-ASS-DLG / Z-Per)         0000000
131920                  * Z-DurTotal                                    0000000
131930d           display 'w-totdlg :' w-totdlg                         0000000
131940            move w-totdlg          TO IPPPRI-MTOTASSU             0000000
131950        Else                                                      0000000
131960        IF  ((ORGS01-FEDE-CEE or                                  0000000
131970              ORGS01-FEDE-CMO )                                   0000000
131980          AND  NOT  APXTRE-ENCOURS )                              0000000
131990                                                                  0000000
132000            MOVE ZERO            TO IPPPRI-MTOTASSU               0000000
132010        ELSE                                                      0000000
132020            MOVE ZERO            TO IPPPRI-MTOTASSU-X.            0000000
132030*                                                                 0000000
132040     IF  (TEG-SANS-ASS-I                AND                       0000000
132050          IPPMA2-LABEL-APPLI = 'IPI')                             0000000
132060          IF   IPXCAL-O-TOT-ASS-FAC NOT = ZERO                    0000000
132070               MOVE IPXCAL-O-TOT-ASS-FAC   TO IPPPRI-MTOTASFA     0000000
132080          END-IF                                                  0000000
132090     END-IF.                                                      0000000
132100*                                                                 0000000
132110     if  ipxcal-tint-cap    numeric                               0000000
132120         if  not  ( avenant )                                     0000000
132130             add  ipxcal-tint-cap    to  z-totinter               0000000
132140         End-if                                                   0000000
132150     End-if.                                                      0000000
132160                                                                  0000000
132170     IF Z-TOTINTER NOT = ZERO                                     0000000
132180        MOVE Z-TOTINTER          TO IPPPRI-TOTINTER               0000000
132190     ELSE                                                         0000000
132200        MOVE ZERO                TO IPPPRI-TOTINTER.              0000000
132210*                                                                 0000000
132220**** LE COUT TOTAL N'APPARAIT QU'EN PRETS IMMOBILIERS             0000000
132230*                                                                 0000000
132240     IF  SAY-MTCOM  NOT NUMERIC                                   0000000
132250         MOVE   ZERO         TO SAY-MTCOM9                        0000000
132260     END-IF                                                       0000000
132270                                                                  0000000
132280     IF  SAY-PARSOC NOT NUMERIC                                   0000000
132290         MOVE   ZERO         TO SAY-PARSOC9                       0000000
132300                                W-PARSOC9                         0000000
132310     Else                                                         0000000
132320         If  88-ps-oui                                            0000000
132330             MOVE   SAY-PARSOC9  TO W-PARSOC9                     0000000
132340         Else                                                     0000000
132350             MOVE   Zero         TO W-PARSOC9                     0000000
132360         END-IF                                                   0000000
132370     END-IF                                                       0000000
132380                                                                  0000000
132390d    display 'IPXCAL-O-TOT-ASS-OBL ' IPXCAL-O-TOT-ASS-OBL         0000000
132400d    display 'IPXCAL-O-TOT-ASS-FAC ' IPXCAL-O-TOT-ASS-FAC         0000000
132410                                                                  0000000
132420     IF   IPPMA2-LABEL-APPLI = 'IPI'                              0000000
132430          COMPUTE Z-TOTCOUT = Z-TOTINTER + IPXCAL-O-TOT-ASS-OBL   0000000
132440                                            + IPXCAL-O-TOT-ASS-FAC0000000
132450                 + SAY-MTCOM9 + SAY-FRAUT9 + SAY-FRHYP9           0000000
132460                                           + W-PARSOC9            0000000
132470          IF   Z-TOTCOUT NOT = ZERO                               0000000
132480               MOVE Z-TOTCOUT    TO IPPPRI-TOTCOUT                0000000
132490          ELSE                                                    0000000
132500               MOVE ZERO         TO IPPPRI-TOTCOUT                0000000
132510          END-IF                                                  0000000
132520                                                                  0000000
132530          If  IPXCAL-SENIOR  = 'O'                                0000000
132540          or  IPXCAL-O-ASS-FACU                                   0000000
132550              COMPUTE Z-TOTCOUT-FA = Z-TOTINTER                   0000000
132560                   + SAY-MTCOM9 + SAY-FRAUT9 + SAY-FRHYP9         0000000
132570                   + W-PARSOC9                                    0000000
132580          Else                                                    0000000
132590           IF  TEG-SANS-ASS-I                                     0000000
132600              COMPUTE Z-TOTCOUT-FA = Z-TOTINTER +                 0000000
132610                                          IPXCAL-O-TOT-ASS-OBL    0000000
132620                   + SAY-MTCOM9 + SAY-FRAUT9 + SAY-FRHYP9         0000000
132630                   + W-PARSOC9                                    0000000
132640           End-if                                                 0000000
132650          End-if                                                  0000000
132660              IF   Z-TOTCOUT-FA  NOT = ZERO                       0000000
132670                   MOVE Z-TOTCOUT-FA    TO IPPPRI-TOTCTFA         0000000
132680              ELSE                                                0000000
132690                   MOVE ZERO         TO IPPPRI-TOTCTFA            0000000
132700              END-IF                                              0000000
132710     Else                                                         0000000
132720       IF   IPPMA2-LABEL-APPLI  =  'IPC'                          0000000
132730            COMPUTE Z-TOTCOUT    = Z-TOTINTER                     0000000
132740                    + SAY-MTCOM9 + SAY-FRAUT9 + SAY-FRHYP9        0000000
132750                    + W-PARSOC9                                   0000000
132760            MOVE Z-TOTCOUT    TO IPPPRI-TOTCOUT                   0000000
132770       End-if                                                     0000000
132780     END-IF.                                                      0000000
132790*                                                                 0000000
132800     IF  SAY-PARSOC9  NUMERIC  AND (CONTRAT OR  CONTRAT-GPR)      0000000
132810         MOVE SAY-PARSOC9  TO Z-PARSOCIA                          0000000
132820     ELSE                                                         0000000
132830         MOVE ZERO         TO Z-PARSOCIA.                         0000000
132840*  CAPSO                                                          0000000
132850     IF  CAI-CAIDEVC-NON-FORCE                                    0000000
132860         MOVE  'EUR'               TO    CAI-CAIDEVC              0000000
132870     END-IF.                                                      0000000
132880                                                                  0000000
132890D    DISPLAY 'SAY-DEV-PARSOC = ' SAY-DEV-PARSOC                   0000000
132900D    DISPLAY 'CAI-CAIDEVC    = ' CAI-CAIDEVC                      0000000
132910                                                                  0000000
132920*  CAPSO                                                          0000000
132930     IF Z-PARSOCIA  >  ZERO                                       0000000
132940        MOVE Z-PARSOCIA TO IPPPRI-PARSOCIA                        0000000
132950        If  88-ps-oui                                             0000000
132960            PERFORM  APPEL-ZPSOVAL                                0000000
132970            IF  PSOVAL-TRT-CORRECT                                0000000
132980                DIVIDE SAY-PARSOC9 BY PSOVAL-VAL-PRIN             0000000
132990                    GIVING Z-NBPS                                 0000000
133000                MOVE   Z-NBPS    TO  IPPPRI-NBPS                  0000000
133010            END-IF                                                0000000
133020        END-IF                                                    0000000
133030     ELSE                                                         0000000
133040        MOVE ZERO       TO IPPPRI-PARSOCIA-X                      0000000
133050     End-if                                                       0000000
133060*                                                                 0000000
133070d    display 'IPPPRI-PARSOCIA-X = ' IPPPRI-PARSOCIA-X             0000000
133080d    display 'IPPPRI-PARSOCIA = ' IPPPRI-PARSOCIA                 0000000
133090d    display  'clps     =' ipppri-clps                            0000000
133100                                                                  0000000
133110*                                                                 0000000
133120     IF   IPXPRO-BONIF-EDF                                        0000000
133130          MOVE    '1'           TO  IPPPRI-BONEDF                 0000000
133140     END-IF.                                                      0000000
133150                                                                  0000000
133160*         CREDIPLAN                                               0000000
133170                                                                  0000000
133180     MOVE  ZERO      TO IPPPRI-EPAECH-X.                          0000000
133190     MOVE  ZERO      TO IPPPRI-INDEPA.                            0000000
133200     IF  NOT  AVENANT                                             0000000
133210         MOVE  ZERO      TO IPPPRI-EPATOT-X.                      0000000
133220*                                                                 0000000
133230     IF   IPPMA2-LABEL-APPLI = 'IPC'   AND                        0000000
133240        (SAY-EPA-MONT9 NUMERIC)                                   0000000
133250        IF (SAY-EPA-MONT9 NOT = ZERO)                             0000000
133260        AND (SAY-EPA-BANQUE9 NUMERIC)                             0000000
133270        AND (SAY-EPA-BANQUE9 NOT = ZERO)                          0000000
133280        AND (SAY-EPA-CAISSE9 NUMERIC)                             0000000
133290        AND (SAY-EPA-CAISSE9 NOT = ZERO)                          0000000
133300        AND (SAY-EPA-COMPTE9 NUMERIC)                             0000000
133310        AND (SAY-EPA-COMPTE9 NOT = ZERO)                          0000000
133320         IF SAY-DUR NUMERIC                                       0000000
133330          IF SAY-DURAM NOT = ZERO                                 0000000
133340           MOVE  SAY-EPA-MONT9  TO  WS-EPAECH                     0000000
133350           MOVE     '1'         TO  IPPPRI-INDEPA                 0000000
133360           MOVE    WS-EPAECH    TO  IPPPRI-EPAECH                 0000000
133370           COMPUTE IPPPRI-EPATOT = SAY-EPA-MONT9 * SAY-DURAM.     0000000
133380***                                                               0000000
133390* LOI MADELIN   CUMUL DES PRETS (MTCRED + 20 % )                  0000000
133400*                                                                 0000000
133410      COMPUTE  W-TOTAL-MONT120 =                                  0000000
133420               W-TOTAL-MONT120 + (SAY-MTCRED * 1,2 ).             0000000
133430*                                                                 0000000
133440D     DISPLAY 'W-TOTAL-MONT120 = '  W-TOTAL-MONT120.              0000000
133450*                                                                 0000000
133460* prets aux collectivits. EIGeig                                 0000000
133470*   03/97                                                         0000000
133480*                                                                 0000000
133490     IF  IPPPRI-EIG       =    1                                  0000000
133500         PERFORM  TRAIT-EIG.                                      0000000
133510*                                                                 0000000
133520     MOVE  ZERO           TO  IPPPRI-MREMBMIN-X                   0000000
133530     .                                                            0000000
133540                                                                  0000000
133550* Extase                                                          0000000
133560d    DISPLAY 'MONTANT PRT ' SAY-MTCRED                            0000000
133570d    DISPLAY 'CAPASS      ' SAY-CAPASS                            0000000
133580d    DISPLAY 'CODASS      ' SAY-GAS1 SAY-GAS3                     0000000
133590d    DISPLAY 'MPERASSU    ' IPPPRI-MPERASSU.                      0000000
133600d    DISPLAY 'MTOTASSU    ' IPPPRI-MTOTASSU.                      0000000
133610d    DISPLAY 'MTOTASFA    ' ipppri-MTOTASFA.                      0000000
133620*                                                                 0000000
133630 TRAIT-EIG.                                                       0000000
133640                                                                  0000000
133650     PERFORM  LECTURE-IPPCPL-E.                                   0000000
133660**   IF  (SAY-CNAT  =  '282' OR '284' OR '285'                    0000000
133670*          OR '643' OR '644' OR '645' OR '646')                   0000000
133680*         MOVE    1   TO  IPPPRI-EIG                              0000000
133690*    ELSE                                                         0000000
133700**        MOVE  ZERO  TO  IPPPRI-EIG.                             0000000
133710                                                                  0000000
133720     IF  (SAY-CNAT  =  '284')                                     0000000
133730          MOVE     1  TO  IPPPRI-COLRSMP                          0000000
133740     ELSE                                                         0000000
133750          MOVE  ZERO  TO  IPPPRI-COLRSMP.                         0000000
133760                                                                  0000000
133770     IF  (SAY-CNAT  =  '282')                                     0000000
133780          MOVE  1      TO  IPPPRI-CODEVI                          0000000
133790          MOVE  1      TO  IPPPRI-INDMAR                          0000000
133800*         MOVE  2,5    TO  IPPPRI-EIGMAR                          0000000
133810     ELSE                                                         0000000
133820          MOVE  ZERO   TO  IPPPRI-CODEVI                          0000000
133830          MOVE  ZERO   TO  IPPPRI-INDMAR.                         0000000
133840                                                                  0000000
133850     IF  (SAY-CINDEX (1:3) = '230')                               0000000
133860          MOVE     1   TO  IPPPRI-EIGTAM                          0000000
133870     ELSE                                                         0000000
133880          IF  (SAY-CINDEX (1:2)  =  '24' OR '27')                 0000000
133890               MOVE   2     TO  IPPPRI-EIGTAM                     0000000
133900          ELSE                                                    0000000
133910               MOVE  ZERO   TO  IPPPRI-EIGTAM.                    0000000
133920*                                                                 0000000
133930D    DISPLAY 'EIGTAM ' IPPPRI-EIGTAM                              0000000
133940     IF  (ORGS01-FEDE-CEE AND NOT ORGS01-ASSIMILE-IDF) AND        0000000
133950                                                                  0000000
133960         SAY-MGES     =   2                                       0000000
133970         IF  (SAY-CINDEX (1:2)  =  '24' OR '27')                  0000000
133980             MOVE  3  TO  IPPPRI-INDPEN                           0000000
133990         ELSE                                                     0000000
134000             IF  ORGS01-ASSIMILE-LYON                             0000000
134010                 MOVE  2  TO  IPPPRI-INDPEN                       0000000
134020             ELSE                                                 0000000
134030                 MOVE  1  TO  IPPPRI-INDPEN                       0000000
134040     ELSE                                                         0000000
134050         MOVE  0  TO  IPPPRI-INDPEN.                              0000000
134060**                                                                0000000
134070     STRING  IPPCPLE-EIG-LIBAC1                                   0000000
134080             IPPCPLE-EIG-LIBAC2                                   0000000
134090              DELIMITED BY SIZE INTO  IPPPRI-COLACC.              0000000
134100     Perform  init-dtffran.                                       0000000
134110                                                                  0000000
134120D    DISPLAY 'IPPCPLE-EIG-DERDEC = ' IPPCPLE-EIG-DERDEC           0000000
134130                                                                  0000000
134140     STRING IPPCPLE-EIG-DERDEC (7 : 2) '.'                        0000000
134150            IPPCPLE-EIG-DERDEC (5 : 2) '.'                        0000000
134160            IPPCPLE-EIG-DERDEC (1 : 4)                            0000000
134170            DELIMITED BY SIZE INTO IPPPRI-DTFDEC.                 0000000
134180                                                                  0000000
134190D    DISPLAY  'INDEMPR ' IPPPRI-INDEMPR.                          0000000
134200D    DISPLAY  'DATEC   ' SA2-DATEC.                               0000000
134210D    DISPLAY  'DTFFRAN ' IPPPRI-DTFFRAN.                          0000000
134220D    DISPLAY  'COLACC  ' IPPPRI-COLACC.                           0000000
134230                                                                  0000000
134240 INIT-DTFFRAN.                                                    0000000
134250                                                                  0000000
134260*                                                                 0000000
134270     IF  SAY-MGES  =  '6'                                         0000000
134280         Evaluate  say-perdeg                                     0000000
134290             when  '3'                                            0000000
134300                move  3  to z-per                                 0000000
134310             when  '6'                                            0000000
134320                move  6  to z-per                                 0000000
134330             when  '9'                                            0000000
134340                move  12 to z-per                                 0000000
134350             when  other                                          0000000
134360                move  1  to z-per                                 0000000
134370         End-evaluate                                             0000000
134380     Else                                                         0000000
134390         IF   SAY-PEREMB NUMERIC                                  0000000
134400              IF   SAY-PEREMB = '9'                               0000000
134410                   MOVE 12 TO Z-PER                               0000000
134420              ELSE                                                0000000
134430                   MOVE SAY-PEREMB  TO Z-PER-9                    0000000
134440                   MOVE  Z-PER-9    TO Z-PER                      0000000
134450         ELSE                                                     0000000
134460              MOVE  1  TO Z-PER.                                  0000000
134470                                                                  0000000
134480*                                                                 0000000
134490     MOVE       1       TO  ZNBR                                  0000000
134500     INITIALIZE DATS20                                            0000000
134510     MOVE  'D01'         TO DATS20-I-FONCTION                     0000000
134520     MOVE  SA2-DATEC     TO DATS20-I-DATE1                        0000000
134530     MOVE  'J'           TO DATS20-I-ENTREE-TYPE1                 0000000
134540     MOVE  'A'           TO DATS20-I-ENTREE-SENS1                 0000000
134550     MOVE  ZNBR          TO DATS20-I-NBJOURS                      0000000
134560     COMPUTE  DATS20-I-NBMOIS   =  Z-PER    * -1                  0000000
134570     MOVE     'O'        TO DATS20-I-RETOUR-SIECLE                0000000
134580     CALL 'ZCALLPGM' USING ZDAT2000 DATS20                        0000000
134590     UNSTRING DATS20-O-DATE    DELIMITED BY SPACE                 0000000
134600     INTO     WS-DATE-X                                           0000000
134610     STRING WS-DATE-X (7 : 2) '.'                                 0000000
134620            WS-DATE-X (5 : 2) '.'                                 0000000
134630            WS-DATE-X (1 : 7)                                     0000000
134640            DELIMITED BY SIZE INTO IPPPRI-DTFFRAN.                0000000
134650                                                                  0000000
134660                                                                  0000000
134670*-------------------------                                        0000000
134680 TRAIT-DATE-DEBLOCAGE.                                            0000000
134690*-------------------------                                        0000000
134700                                                                  0000000
134710     MOVE '27.??00' TO ZDATE-PARMS.                               0000000
134720                                                                  0000000
134730     IF   (SA2-DATDEC  = zero or space)                           0000000
134740          PERFORM  CDATE-FIN-MOIS                                 0000000
134750          MOVE   ZPRTNBMO-D1    TO  SA2-DATDEC.                   0000000
134760                                                                  0000000
134770     IF SA2-DATDEC NOT = ZERO                                     0000000
134780         STRING SA2-DATDEC (7 : 2)  '.'                           0000000
134790                SA2-DATDEC (5 : 2)  '.'                           0000000
134800                SA2-DATDEC (1 : 4)  DELIMITED BY SIZE             0000000
134810                                    INTO  IPPPRI-DPREMDEB         0000000
134820     ELSE                                                         0000000
134830          MOVE '----------'         TO IPPPRI-DPREMDEB.           0000000
134840                                                                  0000000
134850                                                                  0000000
134860*-------------------------                                        0000000
134870 TRAIT-PREM-ECHEANCE.                                             0000000
134880*-------------------------                                        0000000
134890                                                                  0000000
134900***                                                               0000000
134910     IF   SA2-DATEC     NUMERIC                                   0000000
134920      AND SA2-DATEC     NOT  =  ZERO                              0000000
134930          STRING  SA2-DATEC (7:2)   '.'                           0000000
134940                  SA2-DATEC (5:2)   '.'                           0000000
134950                  SA2-DATEC (1:4)   '.'                           0000000
134960          DELIMITED BY SIZE       INTO IPPPRI-DPREMCAP            0000000
134970     ELSE                                                         0000000
134980         IF  SAY-MGES  =  6         AND                           0000000
134990              SA2-DATECH1  NUMERIC  AND                           0000000
135000              SA2-DATECH1   NOT  =  ZERO                          0000000
135010              STRING  SA2-DATECH1 (7:2)   '.'                     0000000
135020                      SA2-DATECH1 (5:2)   '.'                     0000000
135030                      SA2-DATECH1 (1:4)   '.'                     0000000
135040              DELIMITED BY SIZE       INTO IPPPRI-DPREMCAP        0000000
135050         ELSE                                                     0000000
135060              MOVE '----------'         TO IPPPRI-DPREMCAP.       0000000
135070                                                                  0000000
135080***                                                               0000000
135090*-------------------------                                        0000000
135100 TRAIT-DATE-ACCORD.                                               0000000
135110*-------------------------                                        0000000
135120**                                                                0000000
135130     IF  CONTRAT  OR  CONTRAT-GPR                                 0000000
135140         IF   SA2-DATAC     NUMERIC                               0000000
135150          AND SA2-DATAC     NOT  =  ZERO                          0000000
135160              STRING  SA2-DATAC (7:2)   '.'                       0000000
135170                      SA2-DATAC (5:2)   '.'                       0000000
135180                      SA2-DATAC (1:4)   '.'                       0000000
135190              DELIMITED BY SIZE       INTO IPPPRI-DATACCOR        0000000
135200         ELSE                                                     0000000
135210              MOVE '----------'         TO IPPPRI-DATACCOR        0000000
135220     ELSE                                                         0000000
135230*  Avenant                                                        0000000
135240         IF  SAY-MGES  =  6                                       0000000
135250             STRING    W-DATE  (7:2)   '.'                        0000000
135260                       W-DATE  (5:2)   '.'                        0000000
135270                       W-DATE  (1:4)   '.'                        0000000
135280             DELIMITED BY SIZE       INTO IPPPRI-DATACCOR         0000000
135290         ELSE                                                     0000000
135300             If cpt-dprec  numeric and                            0000000
135310                cpt-dprec  not  =  zero                           0000000
135320                Move  cpt-dprec  to  w-DATACCOR                   0000000
135330             Else                                                 0000000
135340                Move    datjour  to  w-DATACCOR                   0000000
135350             End-if                                               0000000
135360                                                                  0000000
135370             INITIALIZE  DATS20                                   0000000
135380             MOVE  'D01'              TO DATS20-I-FONCTION        0000000
135390             MOVE     w-DATACCOR      TO DATS20-I-DATE1           0000000
135400             MOVE     'J'             TO DATS20-I-ENTREE-TYPE1    0000000
135410             MOVE     'A'             TO DATS20-I-ENTREE-SENS1    0000000
135420             MOVE     +1              TO DATS20-I-NBJOURS         0000000
135430                                                                  0000000
135440             CALL     'ZCALLPGM'      USING ZDAT2000 DATS20       0000000
135450                                                                  0000000
135460D    DISPLAY 'DATS20-O-DATE ' DATS20-O-DATE                       0000000
135470                                                                  0000000
135480             IF    DATS20-O-CODRET  =  ZERO                       0000000
135490                   STRING DATS20-O-DATE (7:2) '.'                 0000000
135500                          DATS20-O-DATE (5:2) '.'                 0000000
135510                          DATS20-O-DATE (1:4) DELIMITED BY SIZE   0000000
135520                                        INTO  IPPPRI-DATACCOR     0000000
135530D              DISPLAY 'DATACCOR ' IPPPRI-DATACCOR                0000000
135540             ELSE                                                 0000000
135550                DISPLAY 'DATACCOR KO ' DATS20-O-CODRET            0000000
135560                                       DATS20-O-LIBRET            0000000
135570             END-IF                                               0000000
135580         END-IF                                                   0000000
135590     END-IF.                                                      0000000
135600*                                                                 0000000
135610                                                                  0000000
135620*                                                                 0000000
135630***        TRAITEMENT GARANTIE PAR PRET : POUR INSTRUCTION        0000000
135640*                                                                 0000000
135650*-------------------------                                        0000000
135660 TRAIT-PRET-GARANTIE-IPX.                                         0000000
135670*-------------------------                                        0000000
135680                                                                  0000000
135690d    display 'recherche de garanties pour :'                      0000000
135700D    DISPLAY 'IP     ='   IP.                                     0000000
135710D    DISPLAY 'NO PRET='   IT.                                     0000000
135720D    DISPLAY 'CODE   ='   WP-CODE-GARANTIE  (IP IT).              0000000
135730D    DISPLAY 'ORDRE  ='   WP-NO-ORDRE9      (IP IT).              0000000
135740                                                                  0000000
135750     IF  WP-CODE-GARANTIE  (IP IT) NOT = SPACES AND               0000000
135760         WP-CODE-GARANTIE  (IP IT) NOT = ZEROES AND               0000000
135770         WP-NO-ORDRE9      (IP IT) NUMERIC                        0000000
135780         PERFORM  TRAIT-PRET-GARANTIE-IPX-S.                      0000000
135790*                                                                 0000000
135800*-------------------------                                        0000000
135810 TRAIT-PRET-GARANTIE-IPX-S.                                       0000000
135820*-------------------------                                        0000000
135830                                                                  0000000
135840D    DISPLAY 'TRAIT-PRET-GARANTIE'.                               0000000
135850D    DISPLAY 'SAY-MTCRED = ' SAY-MTCRED                           0000000
135860     MOVE SPACES TO IPPEDG.                                       0000000
135870     MOVE SPACES TO IPPEDG-DONNEE.                                0000000
135880     MOVE ZERO   TO W-VEHDEPT.                                    0000000
135890     MOVE '00' TO IPPEDG-INDGARNA.                                0000000
135900*                                                                 0000000
135910* pret conso avec ass en % mais <= 140000F .                      0000000
135920*                                                                 0000000
135930     IF SUITE                                                     0000000
135940        IF  APXTRE-ENCOURS                                        0000000
135950            IF  NOT (IPPMA2-LABEL-APPLI = 'IPP' )                 0000000
135960*               IF ( (SAY-DEVISE     = 'FRF'        AND           0000000
135970*                SAY-MTCRED  <= W-SCRIVENER-FRF)                  0000000
135980*                OR                                               0000000
135990                IF  (SAY-DEVISE     = 'EUR'        AND            0000000
136000                   SAY-MTCRED  <= W-SCRIVENER-EUR )               0000000
136010                   MOVE '1' TO IPPEDG-AS214.                      0000000
136020                                                                  0000000
136030     IF SUITE                                                     0000000
136040        IF  WP-CODE-GARANTIE (IP IT) = '36' OR '37'               0000000
136050                           OR 'HY'         OR '40' OR '41'        0000000
136060            MOVE 'O' TO CAUTION-PREVUE.                           0000000
136070d    display 'CAUTION-PREVUE ' caution-prevue                     0000000
136080*                                                                 0000000
136090     IF SUITE                                                     0000000
136100        IF (WP-CODE-GARANTIE (IP IT) = '65' OR '51' or '67'       0000000
136110                            or 'AF' or 'BD' or  'SV' or 'SW' )    0000000
136120            MOVE 'O' TO NANTVAL-PREVUE.                           0000000
136130*                                                                 0000000
136140     IF SUITE                                                     0000000
136150        IF (WP-CODE-GARANTIE (IP IT) = '42' )                     0000000
136160            Perform  TYPE-TARIF-42                                0000000
136170            If TARIF-INITIO-OK                                    0000000
136180                MOVE  '1' TO ipppri-initio                        0000000
136190D               DISPLAY 'INITIO >> OK'                            0000000
136200            Else                                                  0000000
136210D               DISPLAY 'INITIO >> KO'                            0000000
136220                MOVE Zero TO ipppri-initio                        0000000
136230            End-if                                                0000000
136240        End-if                                                    0000000
136250     End-if                                                       0000000
136260*                                                                 0000000
136270     IF SUITE                                                     0000000
136280        IF (WP-CODE-GARANTIE (IP IT) = '65'  or                   0000000
136290                               'AF' or 'BD' or  'SV' or 'SW' )    0000000
136300           and not ORGS01-FEDE-LAVAL                              0000000
136310            MOVE 'O' TO CREMO65-PREVUE.                           0000000
136320*                                                                 0000000
136330     IF SUITE                                                     0000000
136340        IF (WP-CODE-GARANTIE (IP IT) = '67')                      0000000
136350            MOVE 'O' TO NANTI67-PREVUE.                           0000000
136360*                                                                 0000000
136370     IF SUITE                                                     0000000
136380        IF (WP-CODE-GARANTIE (IP IT) = '24' )                     0000000
136390            MOVE 'O' TO WARRANT-PREVUE.                           0000000
136400*                                                                 0000000
136410     IF SUITE                                                     0000000
136420        if ORGS01-FEDE-LAVAL                                      0000000
136430           IF (WP-CODE-GARANTIE (IP IT) = '50' OR '52' or '66'    0000000
136440                                               or '68' )          0000000
136450              IF  IPPMA2-NOTAIRE  =  SPACE                        0000000
136460                  MOVE 'O' TO LETEN00-PREVUE                      0000000
136470              END-IF                                              0000000
136480        else                                                      0000000
136490           IF (WP-CODE-GARANTIE (IP IT) = '50' OR '51' OR '52'    0000000
136500                            OR '65' OR '66' OR '67' OR '68'       0000000
136510                            or 'AF' or 'BD' or 'SV' or 'SW' )     0000000
136520              IF  IPPMA2-NOTAIRE  =  SPACE                        0000000
136530                  MOVE 'O' TO LETEN00-PREVUE                      0000000
136540              END-IF                                              0000000
136550           END-IF                                                 0000000
136560        END-IF                                                    0000000
136570     END-IF.                                                      0000000
136580*                                                                 0000000
136590     IF SUITE                                                     0000000
136600        IF ( (WP-CODE-GARANTIE (IP IT) = '44' OR '53' OR '55')    0000000
136610           OR                                                     0000000
136620           ( Z-ASVI (IP) = '61') )                                0000000
136630            MOVE 'O' TO ASSURANCE-EXTERNE.                        0000000
136640*                                                                 0000000
136650     IF SUITE                                                     0000000
136660        MOVE WP-CODE-GARANTIE (IP IT)  TO IPPEDG-INDGARTY         0000000
136670        PERFORM LECTURE-GARANTIE.                                 0000000
136680                                                                  0000000
136690     IF SUITE                                                     0000000
136700d       display 'gar-typegar ' gar-typegar                        0000000
136710        IF GAR-TYPEGAR = '01'                                     0000000
136720*   LE GARANT EST LE DEBITEUR                                     0000000
136730           MOVE '00' TO IPPEDG-INDGARNA                           0000000
136740        ELSE                                                      0000000
136750*   LE GARANT EST AUTRE DEBITEUR                                  0000000
136760           MOVE '01' TO IPPEDG-INDGARNA                           0000000
136770        End-if                                                    0000000
136780     End-if.                                                      0000000
136790                                                                  0000000
136800     IF SUITE                                                     0000000
136810         PERFORM TRAIT-GARANTIE                                   0000000
136820     End-if.                                                      0000000
136830                                                                  0000000
136840*                                                                 0000000
136850     IF SUITE                                                     0000000
136860        MOVE  TYPEGAR-GAR    TO   WP-TYPEGAR (IP IT).             0000000
136870                                                                  0000000
136880     IF SUITE                                                     0000000
136890        PERFORM AFFECTATION-LIBELLE.                              0000000
136900                                                                  0000000
136910     MOVE SPACE TO EDITION-GAGE-ONLY.                             0000000
136920                                                                  0000000
136930     IF SUITE                                                     0000000
136940        IF   IPPMA2-IMP-GAGE = 'G'                                0000000
136950             MOVE 'O'   TO EDITION-GAGE-ONLY.                     0000000
136960                                                                  0000000
136970     IF SUITE                                                     0000000
136980        IF TOP-PRET-AVEC-GARANTIE  or                             0000000
136990           LANGUE-ALLEMANDE                                       0000000
137000            PERFORM TRAIT-TYPE-GARANTIE                           0000000
137010        End-if                                                    0000000
137020     End-if                                                       0000000
137030                                                                  0000000
137040     IF SUITE                                                     0000000
137050        PERFORM DEVISE-GARANTIE.                                  0000000
137060                                                                  0000000
137070     IF SUITE                                                     0000000
137080        IF Z-INDGARTI = ' '                                       0000000
137090*          INDIQUE QU'IL FAUT EDITER LE TITRE 'GARANTIE'          0000000
137100           MOVE  '1' TO IPPEDG-INDGARTI                           0000000
137110           MOVE  '1' TO Z-INDGARTI                                0000000
137120        ELSE                                                      0000000
137130*          INDIQUE QUE LE TITRE 'GARANTIE' EST DEJA EN PLACE      0000000
137140           MOVE  ZERO TO IPPEDG-AS214                             0000000
137150           MOVE  '9'  TO IPPEDG-INDGARTI.                         0000000
137160*                                                                 0000000
137170     IF SUITE                                                     0000000
137180        IF  (ORGS01-FEDE-CEE  and                                 0000000
137190            WP-CODE-GARANTIE(IP IT)   =  '99')                    0000000
137200            IF   IT = 1                                           0000000
137210                 MOVE SPACE   TO  Z-INDGARTI                      0000000
137220            END-IF                                                0000000
137230        ELSE                                                      0000000
137240            COMPUTE  IG = (IP - 1) * NBGAR-PRET  + W-IT           0000000
137250*           WRITE EFMVT FROM IPPEDG                               0000000
137260D           DISPLAY 'W-IT    '   W-IT                             0000000
137270D           DISPLAY ' CODE GAR (' IP ' ' IT ') : '                0000000
137280D                                       WP-CODE-GARANTIE(IP IT)   0000000
137290            MOVE IPPEDG                  TO IPPEDG-STOCK   (IG)   0000000
137300D           DISPLAY 'IPPEDG  ' IG ' ' IPPEDG-STOCK   (IG)         0000000
137310            MOVE WP-NO-ORDRE9(IP IT)     TO NO-ORDRE-STOCK (IG)   0000000
137320*           WRITE EFMVT FROM IPPEDG-DONNEE                        0000000
137330*           ADD  2      TO CPT-FMVT                               0000000
137340            MOVE IPPEDG-DONNEE           TO CPLEDG-STOCK  (IG)    0000000
137350            MOVE W-VEHDEPT               TO VEHDEPT-STOCK (IG)    0000000
137360            ADD  1  TO   W-IT                                     0000000
137370        END-IF                                                    0000000
137380     END-IF.                                                      0000000
137390                                                                  0000000
137400**** IPI : CLAUSES GARANTIES                                      0000000
137410     IF SUITE                                                     0000000
137420        IF   IPPMA2-LABEL-APPLI = 'IPI'                           0000000
137430             PERFORM DEST-CAUTION-IMMO                            0000000
137440             PERFORM DEST-AUTRE-GARANTIE-IMMO                     0000000
137450        ELSE PERFORM DEST-CAUTION                                 0000000
137460             PERFORM DEST-AUTRE-GARANTIE.                         0000000
137470                                                                  0000000
137480*-------------------------                                        0000000
137490 DEVISE-GARANTIE.                                                 0000000
137500*-------------------------                                        0000000
137510                                                                  0000000
137520D    DISPLAY  'W-GAR-DEVISE ' W-GAR-DEVISE.                       0000000
137530                                                                  0000000
137540     MOVE  W-GAR-DEVISE       TO IPPEDG-DEVGARC                   0000000
137550     if IPPEDG-DEVGARC = spaces                                   0000000
137560        move 'EUR'            to IPPEDG-DEVGARC                   0000000
137570     end-if                                                       0000000
137580                                                                  0000000
137590     IF  (W-GAR-DEVISE      =  'EUR'  OR  SPACE)                  0000000
137600           MOVE  LIB1-EUR           TO IPPEDG-DEVGARL             0000000
137610       ELSE                                                       0000000
137620         IF  W-GAR-DEVISE     =  'DEM'                            0000000
137630             MOVE  LIB1-DEM           TO IPPEDG-DEVGARL           0000000
137640         ELSE                                                     0000000
137650             IF W-GAR-DEVISE    =  'CHF'                          0000000
137660                 MOVE  LIB1-CHF         TO IPPEDG-DEVGARL         0000000
137670           ELSE                                                   0000000
137680                 IF  W-GAR-DEVISE   =  'USD'                      0000000
137690                     MOVE  LIB1-USD         TO IPPEDG-DEVGARL     0000000
137700                 ELSE                                             0000000
137710                    IF  W-GAR-DEVISE   =  'JPY'                   0000000
137720                       MOVE  LIB1-JPY         TO IPPEDG-DEVGARL.  0000000
137730                                                                  0000000
137740*-------------------------                                        0000000
137750 TRAIT-GARANTIE.                                                  0000000
137760*-------------------------                                        0000000
137770                                                                  0000000
137780D    DISPLAY  'IPPBATCH, LECTURE TABLE IPP11GAR-POSTE'            0000000
137790     MOVE  SPACE  TO IPP11GAR-POSTE                               0000000
137800     IF  IPPMA2-LABEL-APPLI = 'IPC'                               0000000
137810       MOVE  'IPC11GAR' TO W-ZPAVAL-L1003-COD-TAB                 0000000
137820     ELSE                                                         0000000
137830       IF  IPPMA2-LABEL-APPLI = 'IPI'                             0000000
137840         MOVE  'IPI11GAR' TO W-ZPAVAL-L1003-COD-TAB               0000000
137850       ELSE                                                       0000000
137860         MOVE  'IPP11GAR' TO W-ZPAVAL-L1003-COD-TAB               0000000
137870       END-IF                                                     0000000
137880     END-IF                                                       0000000
137890                                                                  0000000
137900     PERFORM  INIT-ZPARAPEL-L1003                                 0000000
137910     MOVE  W-ZPAVAL-L1003-COD-TAB    TO ZPAVAL-L1003-COD-TAB      0000000
137920     MOVE  WP-CODE-GARANTIE  (IP IT) TO ZPAVAL-L1003-CLE-POS-TAB  0000000
137930     PERFORM  APPEL-ZPARAPEL-L1003                                0000000
137940                                                                  0000000
137950     IF  PARFRE-TRT-CORRECT                                       0000000
137960       MOVE  ZPAVAL-L1003-CLE-POS-TAB TO IPP11GAR-POSTE-CLE       0000000
137970       MOVE  ZPAVRE-L1003-ZON-VAR-PO  TO IPP11GAR-POSTE-DONNEE    0000000
137980D      DISPLAY 'TABLE IPP11GAR-POSTE'                             0000000
137990D      DISPLAY '  CODEGAR-IPP       : ' CODEGAR-IPP               0000000
138000D      DISPLAY '  CODEGAR-GAR       : ' CODEGAR-GAR               0000000
138010D      DISPLAY '  LIBELLE-IPP       : ' LIBELLE-IPP               0000000
138020D      DISPLAY '  LIBRED-IPP        : ' LIBRED-IPP                0000000
138030D      DISPLAY '  INDIC-ACTE-NOT    : ' INDIC-ACTE-NOT            0000000
138040D      DISPLAY '  INDGAR-IPP        : ' INDGAR-IPP                0000000
138050D      DISPLAY '  RESERVE-DIDO      : ' RESERVE-DIDO              0000000
138060D      DISPLAY '  INDIC-EDT         : ' INDIC-EDT                 0000000
138070D      DISPLAY '  RANG-GAR          : ' RANG-GAR                  0000000
138080D      DISPLAY '  POURCENT-GAR      : ' POURCENT-GAR              0000000
138090D      DISPLAY '  DESCRIPTION-OBLIG : ' DESCRIPTION-OBLIG         0000000
138100D      DISPLAY '  MODNAME-GAR       : ' MODNAME-GAR               0000000
138110D      DISPLAY '  TYPEGAR-GAR       : ' TYPEGAR-GAR               0000000
138120                                                                  0000000
138130       PERFORM  TRAIT-INDGAR-IPP                                  0000000
138140       IF  DESCRIPTION-OBLIG = 'RED'                              0000000
138150         MOVE  '1'  TO FEED-RED (IP IT)                           0000000
138160       END-IF                                                     0000000
138170     ELSE                                                         0000000
138180       MOVE  99  TO IPPEDG-INDGAR                                 0000000
138190     END-IF.                                                      0000000
138200                                                                  0000000
138210     PERFORM LECTURE-GARNAG-GESPAR                                0000000
138220                                                                  0000000
138230D    DISPLAY 'INDGAR '   IPPEDG-INDGAR.                           0000000
138240D    DISPLAY 'INDGAR '   IPPEDG-INDGAR.                           0000000
138250D    DISPLAY 'INDGAR '   IPPEDG-INDGAR.                           0000000
138260     .                                                            0000000
138270                                                                  0000000
138280*=================================================================0000000
138290 LECTURE-GARNAG-GESPAR.                                           0000000
138300                                                                  0000000
138310     INITIALIZE YAUCGSP                                           0000000
138320                                                                  0000000
138330     SET  AUCGSP-E-FCT-L0010          TO TRUE                     0000000
138340     IF IPXFAL-EME-MOD-TRT-BA-IMS                                 0000000
138350        SET  AUCGSP-TEMPS-DIFFERE-IMS TO TRUE                     0000000
138360     ELSE                                                         0000000
138370        SET  AUCGSP-TEMPS-DIFFERE     TO TRUE                     0000000
138380     END-IF                                                       0000000
138390     MOVE 'IPR1'                      TO AUCGSP-E-COD-APPLI       0000000
138400                                                                  0000000
138410     MOVE 'GARNAG'                    TO AUCGSP-E-NOM-TAB-GES     0000000
138420     MOVE 'GARNAG'                    TO AUCGSP-E-COD-TAB-GES     0000000
138430     MOVE 10                          TO AUCGSP-E-LGR-CLE         0000000
138440                                                                  0000000
138450     MOVE length of garnag            TO AUCGSP-E-LGR-ENR         0000000
138460     MOVE WP-CODE-GARNAG (IP IT)      TO AUCGSP-E-DONNEES         0000000
138470                                                                  0000000
138480                                                                  0000000
138490     CALL 'zcallpgm'  using AUCZGESP  YAUCGSP                     0000000
138500                                                                  0000000
138510     IF AUCGSP-TRT-CORRECT                                        0000000
138520        MOVE AUCGSP-S-DONNEES(1)      to GARNAG                   0000000
138530        string  GARNAG-LIB1-GAR                                   0000000
138540                GARNAG-LIB2-GAR                                   0000000
138550                 delimited by size into libelle-ipp               0000000
138560                                                                  0000000
138570     ELSE                                                         0000000
138580                                                                  0000000
138590        string AUCGSP-COD-RET-GES                                 0000000
138600               AUCGSP-LIB-RET                                     0000000
138610        delimited size              INTO ANOM-44                  0000000
138620                                                                  0000000
138630        MOVE  44  TO TEST-1                                       0000000
138640        PERFORM  TRAIT-ANOMALIE                                   0000000
138650     END-IF                                                       0000000
138660     .                                                            0000000
138670*-----------------                                                0000000
138680 TRAIT-INDGAR-IPP.                                                0000000
138690*-----------------                                                0000000
138700                                                                  0000000
138710d    display 'Avant trait-indgar-ipp ' indgar-ipp.                0000000
138720                                                                  0000000
138730     If ( WP-CODE-GARANTIE  (IP IT) = '89' or 'CG' )              0000000
138740          MOVE  zero      TO IPPEDG-INDGAR                        0000000
138750     Else                                                         0000000
138760                                                                  0000000
138770        EVALUATE TRUE                                             0000000
138780        WHEN ORGS01-FEDE-LAVAL                                    0000000
138790           PERFORM TRAIT-INDGAR-IPP-FEDE14                        0000000
138800                                                                  0000000
138810        WHEN ORGS01-FEDE-ARRAS                                    0000000
138820           PERFORM TRAIT-INDGAR-IPP-FEDE17                        0000000
138830                                                                  0000000
138840        WHEN ORGS01-FEDE-CEE                                      0000000
138850        WHEN ORGS01-FEDE-ANTILLES                                 0000000
138860*... GR Sara 2336969 / 16.11.2009                                 0000000
138870*... On doit traiter les garanties du CMO et du CMA comme la      0000000
138880*... fd 11                                                      0000000
138890        WHEN ORGS01-FEDE-CMA                                      0000000
138900        WHEN ORGS01-FEDE-CMO                                      0000000
138910*... Fin GR Sara 2336969                                          0000000
138920           PERFORM TRAIT-INDGAR-IPP-FEDE11-20                     0000000
138930                                                                  0000000
138940        WHEN OTHER                                                0000000
138950           PERFORM TRAIT-INDGAR-IPP-AUTRES-FEDE                   0000000
138960                                                                  0000000
138970        END-EVALUATE                                              0000000
138980                                                                  0000000
138990     END-IF.                                                      0000000
139000                                                                  0000000
139010d    display 'Aprs trait-indgar-ipp IPPEDG-INDGAR = '            0000000
139020d                                  IPPEDG-INDGAR.                 0000000
139030*===============================================================  0000000
139040 TRAIT-INDGAR-IPP-FEDE11-20.                                      0000000
139050     if COND-WP-CODE-GARNAG (ip it)                               0000000
139060        MOVE  198       TO IPPEDG-INDGAR                          0000000
139070     Else                                                         0000000
139080        continue                                                  0000000
139090     end-if                                                       0000000
139100                                                                  0000000
139110d    display 'sbo18052007'                                        0000000
139120d    display 'GAR-LIB-DESCR= ' GAR-LIB-DESCR                      0000000
139130d    display 'GAR-FILL7(1:3)=' GAR-FILL7(1:3)                     0000000
139140d    display 'INDGAR-IPP    =' INDGAR-IPP                         0000000
139150                                                                  0000000
139160* pour les bons de caisse, on utilise une autre clause et autre   0000000
139170* definition en fct de la nature du bien.                         0000000
139180     if GAR-FILL7(1:3) = '047' or '048'                           0000000
139190        if INDGAR-IPP = '80'                                      0000000
139200           move 'U8'               to INDGAR-IPP                  0000000
139210        end-if                                                    0000000
139220        if INDGAR-IPP = 'AF'                                      0000000
139230           move 'U9'               to INDGAR-IPP                  0000000
139240        end-if                                                    0000000
139250        if INDGAR-IPP = 'BD'                                      0000000
139260           move 'UA'               to INDGAR-IPP                  0000000
139270        end-if                                                    0000000
139280        if INDGAR-IPP = 'SW'                                      0000000
139290           move 'UB'               to INDGAR-IPP                  0000000
139300        end-if                                                    0000000
139310     end-if                                                       0000000
139320                                                                  0000000
139330     if INDGAR-IPP     numeric                                    0000000
139340         and INDGAR-IPP not = '80'                                0000000
139350         and INDGAR-IPP not = '81'                                0000000
139360         and INDGAR-IPP not = '70'                                0000000
139370         and INDGAR-IPP not = '97'                                0000000
139380           MOVE INDGAR-IPP TO IPPEDG-INDGAR                       0000000
139390     Else                                                         0000000
139400        Evaluate INDGAR-IPP                                       0000000
139410         when 'EN'                                                0000000
139420             MOVE        165      TO IPPEDG-INDGAR                0000000
139430         when 'AK'                                                0000000
139440             MOVE       9000      TO IPPEDG-INDGAR                0000000
139450         when 'GL'                                                0000000
139460         when 'GM'                                                0000000
139470         when 'GN'                                                0000000
139480         when 'GP'                                                0000000
139490         when 'GQ'                                                0000000
139500*            MOVE        004      TO IPPEDG-INDGAR                0000000
139510             MOVE        2000     TO IPPEDG-INDGAR                0000000
139520         when 'U8'                                                0000000
139530         when 'U9'                                                0000000
139540         when 'UA'                                                0000000
139550         when 'UB'                                                0000000
139560             MOVE        520      TO IPPEDG-INDGAR                0000000
139570         when 'EJ'                                                0000000
139580         when 'CC'                                                0000000
139590         when 'CD'                                                0000000
139600         when 'RU'                                                0000000
139610         when 'RV'                                                0000000
139620             MOVE       0590      TO IPPEDG-INDGAR                0000000
139630         when '70'                                                0000000
139640             MOVE       5500      TO IPPEDG-INDGAR                0000000
139650                                                                  0000000
139660         when 'BB'                                                0000000
139670         when 'BC'                                                0000000
139680         when 'QM'                                                0000000
139690         when 'QN'                                                0000000
139700             MOVE        500      TO IPPEDG-INDGAR                0000000
139710         when '80'                                                0000000
139720         when 'AF'                                                0000000
139730         when 'BD'                                                0000000
139740         when 'SV'                                                0000000
139750         when 'SW'                                                0000000
139760             MOVE        022      TO IPPEDG-INDGAR                0000000
139770         when 'RA'                                                0000000
139780         when 'E9'                                                0000000
139790         when 'RB'                                                0000000
139800         when 'RC'                                                0000000
139810         when 'RD'                                                0000000
139820             MOVE        550      TO IPPEDG-INDGAR                0000000
139830         when '81'                                                0000000
139840         when 'BE'                                                0000000
139850         when 'BF'                                                0000000
139860         when 'R3'                                                0000000
139870         when 'R4'                                                0000000
139880         when 'R5'                                                0000000
139890         when 'R6'                                                0000000
139900         when 'R7'                                                0000000
139910         when 'R8'                                                0000000
139920         when 'R9'                                                0000000
139930             MOVE        540      TO IPPEDG-INDGAR                0000000
139940                                                                  0000000
139950         when '97'                                                0000000
139960         when 'SZ'                                                0000000
139970         when 'T1'                                                0000000
139980         when 'EL'                                                0000000
139990         when 'AL'                                                0000000
140000         when 'EE'                                                0000000
140010             MOVE        198      TO IPPEDG-INDGAR                0000000
140020         when '$$'                                                0000000
140030             MOVE        1900     TO IPPEDG-INDGAR                0000000
140040         when other                                               0000000
140050             MOVE        199      TO IPPEDG-INDGAR                0000000
140060         end-evaluate                                             0000000
140070                                                                  0000000
140080       End-if                                                     0000000
140090       .                                                          0000000
140100*===============================================================  0000000
140110 TRAIT-INDGAR-IPP-FEDE17.                                         0000000
140120     if INDGAR-IPP  numeric                                       0000000
140130        MOVE INDGAR-IPP TO IPPEDG-INDGAR                          0000000
140140     Else                                                         0000000
140150        if indgar-ipp  = 'A5'                                     0000000
140160           MOVE  105       TO IPPEDG-INDGAR                       0000000
140170        Else                                                      0000000
140180           if (indgar-ipp  = 'AK' )                               0000000
140190              MOVE  9000      TO IPPEDG-INDGAR                    0000000
140200           Else                                                   0000000
140210                                                                  0000000
140220              MOVE  199       TO IPPEDG-INDGAR                    0000000
140230           End-if                                                 0000000
140240        End-if                                                    0000000
140250     End-if                                                       0000000
140260     .                                                            0000000
140270*===============================================================  0000000
140280 TRAIT-INDGAR-IPP-FEDE14.                                         0000000
140290*    if (WP-CODE-GARNAG (ip it)    =  '720' or '021' or '540'     0000000
140300*         or '550' or '590' or '660' or '620' or '261' or '260')  0000000
140310*             MOVE     11       TO IPPEDG-INDGAR                  0000000
140320     if (WP-CODE-GARNAG (ip it)    =   '021'                      0000000
140330           or '590' or '660' or '620' or '261' or '260')          0000000
140340              MOVE     11       TO IPPEDG-INDGAR                  0000000
140350     end-if                                                       0000000
140360* pour les bons de caisse, on utilise une autre clause et autre   0000000
140370* definition en fct de la nature du bien.                         0000000
140380d    display 'GAR-FILL7(1:3)=' GAR-FILL7(1:3)                     0000000
140390     if GAR-FILL7(1:3) = '047' or '048' or '067' or '068'         0000000
140400        if INDGAR-IPP = '80' or 'JP'                              0000000
140410           move 'U8'               to INDGAR-IPP                  0000000
140420        end-if                                                    0000000
140430        if INDGAR-IPP = 'AF' or 'JQ'                              0000000
140440           move 'U9'               to INDGAR-IPP                  0000000
140450        end-if                                                    0000000
140460        if INDGAR-IPP = 'BD'                                      0000000
140470           move 'UA'               to INDGAR-IPP                  0000000
140480        end-if                                                    0000000
140490        if INDGAR-IPP = 'SW'                                      0000000
140500           move 'UB'               to INDGAR-IPP                  0000000
140510        end-if                                                    0000000
140520     end-if                                                       0000000
140530     if  INDGAR-IPP  numeric                                      0000000
140540          and INDGAR-IPP not = '80'                               0000000
140550          and INDGAR-IPP not = '81'                               0000000
140560          and INDGAR-IPP not = '70'                               0000000
140570          MOVE INDGAR-IPP TO IPPEDG-INDGAR                        0000000
140580     Else                                                         0000000
140590          evaluate indgar-ipp                                     0000000
140600          when 'EN'                                               0000000
140610              MOVE    165       TO IPPEDG-INDGAR                  0000000
140620          when 'HY'                                               0000000
140630              MOVE    168       TO IPPEDG-INDGAR                  0000000
140640          when 'A1'                                               0000000
140650          when 'AZ'                                               0000000
140660          when 'QA'                                               0000000
140670          when 'QB'                                               0000000
140680          when 'QC'                                               0000000
140690              MOVE     10       TO IPPEDG-INDGAR                  0000000
140700          when 'AK'                                               0000000
140710              MOVE    9000      TO IPPEDG-INDGAR                  0000000
140720          when 'GL'                                               0000000
140730          when 'GM'                                               0000000
140740          when 'GN'                                               0000000
140750          when 'GP'                                               0000000
140760          when 'GQ'                                               0000000
140770              MOVE       2000     TO IPPEDG-INDGAR                0000000
140780          when 'U8'                                               0000000
140790          when 'U9'                                               0000000
140800          when 'UA'                                               0000000
140810          when 'UB'                                               0000000
140820              MOVE       520      TO IPPEDG-INDGAR                0000000
140830          when 'JP'                                               0000000
140840          when 'JQ'                                               0000000
140850              MOVE       023      TO IPPEDG-INDGAR                0000000
140860          when 'EJ'                                               0000000
140870          when 'CC'                                               0000000
140880          when 'CD'                                               0000000
140890          when 'RU'                                               0000000
140900          when 'RV'                                               0000000
140910              MOVE      0590      TO IPPEDG-INDGAR                0000000
140920          when '70'                                               0000000
140930              MOVE      5500      TO IPPEDG-INDGAR                0000000
140940                                                                  0000000
140950          when 'BB'                                               0000000
140960          when 'BC'                                               0000000
140970          when 'QM'                                               0000000
140980          when 'QN'                                               0000000
140990              MOVE       500      TO IPPEDG-INDGAR                0000000
141000          when '80'                                               0000000
141010          when 'AF'                                               0000000
141020          when 'BD'                                               0000000
141030          when 'SV'                                               0000000
141040          when 'SW'                                               0000000
141050              MOVE       022      TO IPPEDG-INDGAR                0000000
141060          when 'RA'                                               0000000
141070          when 'E9'                                               0000000
141080          when 'RB'                                               0000000
141090          when 'RC'                                               0000000
141100          when 'RD'                                               0000000
141110              MOVE       550      TO IPPEDG-INDGAR                0000000
141120          when '81'                                               0000000
141130          when 'BE'                                               0000000
141140          when 'BF'                                               0000000
141150          when 'R3'                                               0000000
141160          when 'R4'                                               0000000
141170          when 'R5'                                               0000000
141180          when 'R6'                                               0000000
141190          when 'R7'                                               0000000
141200          when 'R8'                                               0000000
141210          when 'R9'                                               0000000
141220              MOVE       540      TO IPPEDG-INDGAR                0000000
141230          when 'UN'                                               0000000
141240          when 'UH'                                               0000000
141250              MOVE       142      TO IPPEDG-INDGAR                0000000
141260          when 'SZ'                                               0000000
141270          when 'T1'                                               0000000
141280          when 'EL'                                               0000000
141290          when 'AL'                                               0000000
141300          when 'EE'                                               0000000
141310              MOVE       198      TO IPPEDG-INDGAR                0000000
141320          when other                                              0000000
141330              MOVE    199         TO IPPEDG-INDGAR                0000000
141340          end-evaluate                                            0000000
141350                                                                  0000000
141360     End-if                                                       0000000
141370     .                                                            0000000
141380*================================================================ 0000000
141390 TRAIT-INDGAR-IPP-AUTRES-FEDE.                                    0000000
141400     if INDGAR-IPP  numeric                                       0000000
141410        IF INDGAR-IPP = '97'                                      0000000
141420           MOVE         199               TO IPPEDG-INDGAR        0000000
141430        else                                                      0000000
141440           MOVE INDGAR-IPP                TO IPPEDG-INDGAR        0000000
141450        end-if                                                    0000000
141460     Else                                                         0000000
141470      evaluate     indgar-ipp                                     0000000
141480       when      'A1'                                             0000000
141490            MOVE         101               TO IPPEDG-INDGAR       0000000
141500       when      'A2'                                             0000000
141510            MOVE         102               TO IPPEDG-INDGAR       0000000
141520       when      'A3'                                             0000000
141530            MOVE         103               TO IPPEDG-INDGAR       0000000
141540       when      'A4'                                             0000000
141550            MOVE         104               TO IPPEDG-INDGAR       0000000
141560       when      'A5'                                             0000000
141570            MOVE         105               TO IPPEDG-INDGAR       0000000
141580       when      'A6'                                             0000000
141590            MOVE         106               TO IPPEDG-INDGAR       0000000
141600       when      'A7'                                             0000000
141610            MOVE         107               TO IPPEDG-INDGAR       0000000
141620       when      'A8'                                             0000000
141630            MOVE         108               TO IPPEDG-INDGAR       0000000
141640       when      'A9'                                             0000000
141650            MOVE         109               TO IPPEDG-INDGAR       0000000
141660       when      'AA'                                             0000000
141670            MOVE         110               TO IPPEDG-INDGAR       0000000
141680       when      'AB'                                             0000000
141690            MOVE         111               TO IPPEDG-INDGAR       0000000
141700       when      'AC'                                             0000000
141710            MOVE         112               TO IPPEDG-INDGAR       0000000
141720       when      'EB'                                             0000000
141730            MOVE         152               TO IPPEDG-INDGAR       0000000
141740       when      'EC'                                             0000000
141750            MOVE         153               TO IPPEDG-INDGAR       0000000
141760       when      'E4'                                             0000000
141770            MOVE         154               TO IPPEDG-INDGAR       0000000
141780       when      'EE'                                             0000000
141790            MOVE         155               TO IPPEDG-INDGAR       0000000
141800       when      'EF'                                             0000000
141810            MOVE         156               TO IPPEDG-INDGAR       0000000
141820       when      'E7'                                             0000000
141830            MOVE         157               TO IPPEDG-INDGAR       0000000
141840       when      'E8'                                             0000000
141850            MOVE         158               TO IPPEDG-INDGAR       0000000
141860       when      'DC'                                             0000000
141870            MOVE         143               TO IPPEDG-INDGAR       0000000
141880       when      'EG'                                             0000000
141890            MOVE         167               TO IPPEDG-INDGAR       0000000
141900       when      'EN'                                             0000000
141910            MOVE         165               TO IPPEDG-INDGAR       0000000
141920       WHEN      'EL'                                             0000000
141930       WHEN      'AL'                                             0000000
141940            MOVE         172               TO IPPEDG-INDGAR       0000000
141950       when      'E6'                                             0000000
141960            MOVE         166               TO IPPEDG-INDGAR       0000000
141970       when      'SX'                                             0000000
141980            MOVE         167               TO IPPEDG-INDGAR       0000000
141990       when      'HY'                                             0000000
142000            MOVE         168               TO IPPEDG-INDGAR       0000000
142010       when      'AK'                                             0000000
142020            MOVE         9000              TO IPPEDG-INDGAR       0000000
142030       when 'UN'                                                  0000000
142040       when 'UH'                                                  0000000
142050              MOVE       142               TO IPPEDG-INDGAR       0000000
142060       when other                                                 0000000
142070            MOVE         199               TO IPPEDG-INDGAR       0000000
142080     end-evaluate                                                 0000000
142090     .                                                            0000000
142100*================================================================ 0000000
142110*---------------------                                            0000000
142120 AFFECTATION-LIBELLE.                                             0000000
142130*---------------------                                            0000000
142140***  IPPEDG-INDGAR : INDICATEUR DU TYPE DE GARANTIE POUR DIDO     0000000
142150*       ISSU DE SPITAB (IPP11GAR)                                 0000000
142160*       - 10 HYPOTHEQUE (CODES GARANTIE 10 A 18 SAUF 14)          0000000
142170*       - 19 PROMESSE D'HYPOTHEQUE             (CODE GARANTIE 19) 0000000
142180*       - 15 PRIVILEGE DE PRETEUR DE DENIERS   (CODE GARANTIE 14) 0000000
142190*       - 20 NANTISSEMENT DE FONDS DE COMMERCE (CODE GARANTIE 50) 0000000
142200*       - 30 NANTISSEMENT D'OUTILLAGE          (CODE GARANTIE 68) 0000000
142210*       - 40 GAGE SUR VEHICULE                 (CODE GARANTIE 52) 0000000
142220*       - 70 NANTISSEMENT DE TITRES            (CODE GARANTIE 51) 0000000
142230*       - 80 AUTRES NANTISSEMENT (CODES GARANTIE 59,65,66)        0000000
142240*       - 81 NANTISSEMENT DE PARTS SOCIALES (CODE GARANTIE 67)    0000000
142250*       - 90 CAUTION             (CODES GARANTIE 36,37,40,41)     0000000
142260*       - 91 ORGANISMES CAUTION AVEC ADRESSES                     0000000
142270*       - 98 AUTRES GARANTIES AVEC DESCRIPTION (CODE GARANTIE 99) 0000000
142280*       - 99 AUTRES GARANTIES SANS DESCRIPTION (CODE GARANTIE 99) 0000000
142290***                                                               0000000
142300                                                                  0000000
142310     IF IPPEDG-INDGAR = 10 OR = 15                                0000000
142320        MOVE '1'     TO FEED-HYPO (IP IT).                        0000000
142330*                                                                 0000000
142340******* FORCAGE TO IPPEDG-INDGAR A 99 POUR LES HYPOTHEQUES SANS   0000000
142350******* DESCRIPTION                                               0000000
142360******* QUE FAIT-ON PAR EXPLE D'UNE CAUTION SI PAS DE TEXTE SAISI 0000000
142370******* (CF CAUTION HYPOTHECAIRE 13)                              0000000
142380******* DECISION PRISE : ON EDITE SI TEXTE ET/OU SI CAUTION       0000000
142390*******                  (ET PAS SEULEMENT SI TEXTE)              0000000
142400*                                                                 0000000
142410*          PROMESSE HYPOTHEQUE = 19                               0000000
142420*                                                                 0000000
142430     MOVE 'N' TO HYP-DECRIT.                                      0000000
142440     IF IPPEDG-INDGAR = 10 OR 19                                  0000000
142450****    LA GARANTIE EST DECRITE                                   0000000
142460        IF  (GAR-LIB-DESCR NOT = SPACE                            0000000
142470        OR   GAR-CAUTION   NOT = SPACE)                           0000000
142480             string GARNAG-LIB1-GAR                               0000000
142490                    GARNAG-LIB2-GAR                               0000000
142500             delimited size     inTO IPPEDG-GARANTIE              0000000
142510                                                                  0000000
142520             MOVE 'O'          TO HYP-DECRIT                      0000000
142530****    LA GARANTIE N'EST PAS DECRITE                             0000000
142540        ELSE MOVE LIBELLE-IPP  TO IPPEDG-GARANTIE                 0000000
142550             MOVE 0099         TO IPPEDG-INDGAR                   0000000
142560     ELSE                                                         0000000
142570*       SBO10012006                                               0000000
142580d       display 'GARNAG-NAT-GAR=' GARNAG-NAT-GAR                  0000000
142590        if GARNAG-NAT-GAR = '001' or '002'                        0000000
142600           string GARNAG-LIB1-GAR(1:30)                           0000000
142610                  GAR-FILL7                                       0000000
142620             delimited size     inTO IPPEDG-GARANTIE              0000000
142630d          display 'IPPEDG-GARANTIE 1=' IPPEDG-GARANTIE           0000000
142640        else                                                      0000000
142650           string GARNAG-LIB1-GAR                                 0000000
142660                  GARNAG-LIB2-GAR                                 0000000
142670            delimited size     inTO IPPEDG-GARANTIE               0000000
142680d           display 'IPPEDG-GARANTIE 2=' IPPEDG-GARANTIE          0000000
142690        end-if                                                    0000000
142700d       display 'IPPEDG-GARANTIE=' IPPEDG-GARANTIE                0000000
142710d       display 'IPPEDG-INDEDG-X=' IPPEDG-INDEDG-X                0000000
142720d       display 'WP-CODE-GARANTIE=' WP-CODE-GARANTIE (IP IT)      0000000
142730        if IPPEDG-INDGAR           = 98   or                      0000000
142740           WP-CODE-GARANTIE (IP IT)= 'SR' or                      0000000
142750           WP-CODE-GARANTIE (IP IT)= 'SS' or                      0000000
142760           WP-CODE-GARANTIE (IP IT)= 'ST' or                      0000000
142770           WP-CODE-GARANTIE (IP IT)= 'SU'                         0000000
142780           move GAR-LIB-DESCR  to IPPEDG-DESCR                    0000000
142790d          display 'sbo IPPEDG-DESCR    =' IPPEDG-DESCR           0000000
142800d          display 'sbo IPPEDG-GARANTIE =' IPPEDG-GARANTIE        0000000
142810        end-if                                                    0000000
142820        if (indgar-ipp  = 'UH' or 'UN') and                       0000000
142830           (ORGS01-FEDE-CEE or                                    0000000
142840            orgs01-fede-arras )                                   0000000
142850           move 'LIB'    to GAR-INDIC-NATURE                      0000000
142860           string 'Caution de MUTARIS CAUTION,'                   0000000
142870                  ' dont le sige social est situ<NL>'           0000000
142880                  '6, rue Vandrezanne 75634 PARIS CEDEX 13 <NL>'  0000000
142890*                'Cette garantie sera prise par acte spar. <NL>'0000000
142900           delimited size    into GAR-LIB-DESCR                   0000000
142910        end-if                                                    0000000
142920**** SI ORGANISMES DE CAUTIONNEMENT AVEC ADRESSES                 0000000
142930**** AFFECTER ADRESSE                                             0000000
142940d       display 'IPPMA2-LABEL-APPLI=' IPPMA2-LABEL-APPLI          0000000
142950d       display 'IPPEDG-INDGAR     =' IPPEDG-INDGAR               0000000
142960        IF  IPPMA2-LABEL-APPLI = 'IPI'                            0000000
142970        AND ( IPPEDG-INDGAR =  91  OR  42 )                       0000000
142980            PERFORM TRAIT-OCMADR.                                 0000000
142990                                                                  0000000
143000**** RECHERCHE SI HYPOTHEQUE DROIT LOCAL                          0000000
143010     IF   HYP-EXIST = 'O'                                         0000000
143020**        IF   HYP-DECRIT = 'N'                                   0000000
143030               IF (IPPMA2-OBJET-IMM-CODDEP = '57' OR '67' OR '68')0000000
143040                   MOVE 'O' TO DROIT-LOCAL                        0000000
143050               Else                                               0000000
143060                    IF  (IPPEDG-INDGAR = 10 OR 19)                0000000
143070                   AND (GAR-LIB-DESCR NOT = SPACE                 0000000
143080                   OR  GAR-CAUTION   NOT = SPACE)                 0000000
143090                   AND (GAR-HYP-LOCAL = 'O')                      0000000
143100                       MOVE 'O' TO DROIT-LOCAL.                   0000000
143110                                                                  0000000
143120                                                                  0000000
143130***  MOVE  IPPEDG-GARANTIE   TO  W-LGAR (IP IT).                  0000000
143140     IF  ORGS01-FEDE-LAVAL                                        0000000
143150         IF   WP-CODE-GARANTIE (IP IT) = '50'                     0000000
143160              MOVE  'O' TO  NANFC00-PREVUE                        0000000
143170         ELSE                                                     0000000
143180           IF   WP-CODE-GARANTIE (IP IT) = '04'                   0000000
143190                MOVE  'O' TO  NANFA00-PREVUE                      0000000
143200           END-IF                                                 0000000
143210         END-IF                                                   0000000
143220     END-IF                                                       0000000
143230                                                                  0000000
143240     IF   WP-CODE-GARANTIE (IP IT) = '03'                         0000000
143250          MOVE  'O' TO  GRUND-PREVU                               0000000
143260     ELSE                                                         0000000
143270     IF   WP-CODE-GARANTIE (IP IT) = '68'                         0000000
143280          MOVE  'O' TO  GAR-68-PREVUE                             0000000
143290                                                                  0000000
143300     ELSE                                                         0000000
143310     IF   WP-CODE-GARANTIE (IP IT) = '95'                         0000000
143320          MOVE  'O' TO  GAR-95-PREVUE                             0000000
143330                                                                  0000000
143340     ELSE                                                         0000000
143350     IF   WP-CODE-GARANTIE (IP IT) = '97'                         0000000
143360          MOVE  'O' TO  GAR-97-PREVUE.                            0000000
143370                                                                  0000000
143380     IF (ORGS01-FEDE-CEE  or                                      0000000
143390         ORGS01-FEDE-LAVAL or                                     0000000
143400         ORGS01-FEDE-ANTILLES )                                   0000000
143410       IF  (WP-CODE-GARANTIE (IP IT) = 'AL' or 'EL' or            0000000
143420                   'SZ'  OR  'T1'  or  'PL' or 'PM'  or 'PN' )    0000000
143430            MOVE  'O' TO  naass000-prevue.                        0000000
143440                                                                  0000000
143450d    display 'say-mtcred ' say-mtcred                             0000000
143460                                                                  0000000
143470     .                                                            0000000
143480D    DISPLAY 'IPPEDG-GARANTIE =' IPPEDG-GARANTIE.                 0000000
143490                                                                  0000000
143500*---------------------                                            0000000
143510 TRAIT-TYPE-GARANTIE.                                             0000000
143520*---------------------                                            0000000
143530***     GAR-INDIC-NATURE INDIQUE SI LA NATURE (DESCRIPTION)       0000000
143540*                        EST STOCKEE :                            0000000
143550*          - LIB     --> LIBELLE LIBRE                            0000000
143560*          - HYP     --> DESCRIPTION HYPOTHEQUE                   0000000
143570*          - NFC     --> NANTISSEMENT DE FONDS DE COMMERCE        0000000
143580*          - NOU     --> NANTISSEMENT D'OUTILAGE                  0000000
143590*          - VEH     --> GAGE SUR VEHICULE                        0000000
143600*          - WAR     --> WARRANT AGRICOLE                         0000000
143610*                                                                 0000000
143620     IF (GAR-INDIC-NATURE = 'LIB'  OR 'CMH')                      0000000
143630        MOVE GAR-LIB-DESCR TO IPPEDG-DESCR.                       0000000
143640                                                                  0000000
143650     IF GAR-INDIC-NATURE = 'HYP'                                  0000000
143660      or WP-CODE-GARANTIE (IP IT) = '14'                          0000000
143670        PERFORM TRAIT-GAR-HYP.                                    0000000
143680                                                                  0000000
143690     IF GAR-INDIC-NATURE = 'VEH'                                  0000000
143700        PERFORM AFFECT-GAR-VEH.                                   0000000
143710                                                                  0000000
143720d    display 'GAR-INDIC-NATURE ' GAR-INDIC-NATURE                 0000000
143730d    display 'WP-CODE-GARANTIE ' WP-CODE-GARANTIE(IP IT)          0000000
143740                                                                  0000000
143750     IF (WP-CODE-GARANTIE (IP IT) = 'E4'                          0000000
143760                         or 'HY'     or '40' or '41'              0000000
143770                                     or '37' or '36'              0000000
143780                 or 'GL' or 'GM' or 'GN' or 'GP' or 'GQ')         0000000
143790             PERFORM AFFECT-GAR-CAU.                              0000000
143800                                                                  0000000
143810d    display 'GAR-CLE-CAU(1)=' GAR-CLE-CAU (1)                    0000000
143820d    display 'GAR-CLE-CAU(2)=' GAR-CLE-CAU (2)                    0000000
143830                                                                  0000000
143840     PERFORM TRAIT-CAUTION                                        0000000
143850             VARYING IG FROM 1 BY 1 UNTIL IG GREATER 2            0000000
143860                  OR GAR-CLE-CAU (IG) NOT NUMERIC.                0000000
143870d    display 'IPPEDG-CAU1NOM =' IPPEDG-CAU1NOM                    0000000
143880d    display 'IPPEDG-CAU1PRNM=' IPPEDG-CAU1PRNM                   0000000
143890d    display 'IPPEDG-CAU1ORIG=' IPPEDG-CAU1ORIG                   0000000
143900d    display 'IPPEDG-CAU1LIAI=' IPPEDG-CAU1LIAI                   0000000
143910d    display 'IPPEDG-CAU2NOM =' IPPEDG-CAU2NOM                    0000000
143920d    display 'IPPEDG-CAU2PRNM=' IPPEDG-CAU2PRNM                   0000000
143930d    display 'IPPEDG-CAU2ORIG=' IPPEDG-CAU2ORIG                   0000000
143940d    display 'IPPEDG-CAU1DOMI=' IPPEDG-CAU1DOMI                   0000000
143950d    display 'IPPEDG-CAU1ADR =' IPPEDG-CAU1ADR                    0000000
143960d    display 'IPPEDG-MGARCAPI=' IPPEDG-MGARCAPI                   0000000
143970d    display 'IPPEDG-DEVGARC =' IPPEDG-DEVGARC                    0000000
143980     .                                                            0000000
143990                                                                  0000000
144000*----------------                                                 0000000
144010 TRAIT-OCMADR.                                                    0000000
144020*----------------                                                 0000000
144030     MOVE WP-CODE-GARANTIE(IP IT)      TO PARAM-CODGAR.           0000000
144040     MOVE SPACE                        TO IPIOCA.                 0000000
144050     CALL 'ZCALLPGM' USING IPIRCADR                               0000000
144060                           CTL                                    0000000
144070                           PARAM-CODGAR                           0000000
144080                           IPIOCA.                                0000000
144090                                                                  0000000
144100D    DISPLAY 'IPIRCADR CTL       = ' CTL.                         0000000
144110D    DISPLAY 'IPIRCADR IPIOCA    = ' IPIOCA.                      0000000
144120D    DISPLAY 'gar-fill7          = ' gar-fill7(1:50)              0000000
144130                                                                  0000000
144140     IF   CTL-R34 = ZERO                                          0000000
144150d      display 'IPIOCA-ADR-RUE    '   IPIOCA-ADR-RUE              0000000
144160d      display 'IPIOCA-ADR-cplt   '   IPIOCA-ADR-cplt             0000000
144170d      display 'IPIOCA-ADR-cpos   '   IPIOCA-ADR-cpos             0000000
144180d      display 'IPIOCA-ADR-burdis '   IPIOCA-ADR-burdis           0000000
144190d      display 'IPIOCA-ADR-nom1   '   IPIOCA-ADR-nom1             0000000
144200d      display 'IPIOCA-ADR-nom2   '   IPIOCA-ADR-nom2             0000000
144210                                                                  0000000
144220          MOVE IPIOCA-ADR-RUE    TO IPPEDG-OCMADR1                0000000
144230          MOVE IPIOCA-ADR-CPLT   TO IPPEDG-OCMADR2                0000000
144240          MOVE IPIOCA-ADR-CPOS   TO IPPEDG-OCMADR4                0000000
144250          MOVE IPIOCA-ADR-BURDIS TO IPPEDG-OCMLOC                 0000000
144260     ELSE                                                         0000000
144270          MOVE SPACE TO IPPEDG-OCMADR                             0000000
144280          MOVE ZERO  TO CTL-RETOUR                                0000000
144290          MOVE SPACE TO CTL-LIBELLE.                              0000000
144300                                                                  0000000
144310*----------------                                                 0000000
144320 TRAIT-CAUTION.                                                   0000000
144330                                                                  0000000
144340d    display 'trait-caution '                                     0000000
144350d    display 'GAR-CLE-CAU (' IG ')=' GAR-CLE-CAU (IG)             0000000
144360d    display 'IPXESM-S-LM400-TIE-TYP(1) '                         0000000
144370d             IPXESM-S-LM400-TIE-TYP(1)                           0000000
144380                                                                  0000000
144390     IF IPXESM-S-LM400-TIE-TYP (1) = '1'                          0000000
144400        IF IG = 1                                                 0000000
144410           MOVE  '1' TO IPPEDG-INDCAU                             0000000
144420           PERFORM AFFECT-CAU-PHYS-1-GAR3                         0000000
144430        ELSE                                                      0000000
144440           MOVE  '2' TO IPPEDG-INDCAU                             0000000
144450           PERFORM AFFECT-CAU-PHYS-2-GAR3                         0000000
144460     ELSE                                                         0000000
144470           MOVE  '0' TO IPPEDG-INDCAU                             0000000
144480           PERFORM AFFECT-CAU-MORALE-GAR3.                        0000000
144490*       RANGER INFO CAUTION AVEC IG (MAX 2)                       0000000
144500     MOVE  IPPEDG-CAUADR1          TO       W-CAUADR1             0000000
144510     MOVE  IPPEDG-CAUADRC          TO       W-CAUADRC             0000000
144520     MOVE  IPPEDG-CAULOC           TO       W-CAULOC.             0000000
144530                                                                  0000000
144540*-------------------------                                        0000000
144550 AFFECT-CAU-PHYS-1-GAR3.                                          0000000
144560*-------------------------                                        0000000
144570                                                                  0000000
144580d    display 'AFFECT-CAU-PHYS-1-GAR3'                             0000000
144590d    display '-LM400-TIE-TIT     =' IPXESM-S-LM400-TIE-TIT (1)    0000000
144600d    display '-LM400-TIE-TYP     =' IPXESM-S-LM400-TIE-TYP (1)    0000000
144610d    display '-LM400-TIE-NOM-USGG=' IPXESM-S-LM400-TIE-NOM-USG(1) 0000000
144620d    display '-LM400-TIE-PRN     =' IPXESM-S-LM400-TIE-PRN (1)    0000000
144630d    display '-LM400-TIE-SEX     =' IPXESM-S-LM400-TIE-SEX (1)    0000000
144640d    display '-LM400-TIE-DAT-NAII=' IPXESM-S-LM400-TIE-DAT-NAI(1) 0000000
144650d    display '-LM400-TIE-NJF     =' IPXESM-S-LM400-TIE-NJF (1)    0000000
144660d    display '-LM400-TIE-PCS-LIBB=' IPXESM-S-LM400-TIE-PCS-LIB(1) 0000000
144670d    display '-LM400-TIE-CMU-NAII=' IPXESM-S-LM400-TIE-CMU-NAI(1) 0000000
144680d    display '-LM400-TIE-PAY-NAII=' IPXESM-S-LM400-TIE-PAY-NAI(1) 0000000
144690                                                                  0000000
144700                                                                  0000000
144710     MOVE '1'                  TO IPPEDG-INDCAU.                  0000000
144720     IF   IPXESM-S-LM400-TIE-TIT (1) = 'M  '                      0000000
144730          MOVE T-MONSIEUR      TO IPPEDG-CAU1TITR.                0000000
144740     IF   IPXESM-S-LM400-TIE-TIT (1) = 'MME'                      0000000
144750          MOVE T-MADAME        TO IPPEDG-CAU1TITR.                0000000
144760     IF   IPXESM-S-LM400-TIE-TIT (1) = 'MLE'                      0000000
144770          MOVE T-MADEMOISELLE  TO IPPEDG-CAU1TITR.                0000000
144780*                                                                 0000000
144790     MOVE IPXESM-S-LM400-TIE-PRN (1) TO IPPEDG-CAU1PRNM.          0000000
144800     MOVE IPXESM-S-LM400-TIE-NOM-USG (1) TO IPPEDG-CAU1NOM.       0000000
144810*                                                                 0000000
144820     IF   IPXESM-S-LM400-TIE-SEX (1) = 'M'                        0000000
144830          MOVE T-NE            TO IPPEDG-CAU1NAIS-NE              0000000
144840          MOVE T-DOMICILIE     TO IPPEDG-CAU1DOMI.                0000000
144850     IF   IPXESM-S-LM400-TIE-SEX (1) = 'F'                        0000000
144860          MOVE T-NEE           TO IPPEDG-CAU1NAIS-NE              0000000
144870          MOVE IPXESM-S-LM400-TIE-NJF (1) TO IPPEDG-CAU1NMJF      0000000
144880          MOVE T-DOMICILIEE    TO IPPEDG-CAU1DOMI.                0000000
144890                                                                  0000000
144900     MOVE T-LE                 TO IPPEDG-CAU1NAIS-LE.             0000000
144910     IF   IPXESM-S-LM400-TIE-DAT-NAI (1) = SPACE                  0000000
144920          MOVE SPACE           TO IPPPRI-EMP1NAIS-LE              0000000
144930          MOVE SPACE           TO IPPEDG-CAU1NAIS                 0000000
144940     ELSE                                                         0000000
144950*         FORMATAGE DATE AAAA-MM-JJ -> JJ-MM-AAAA                 0000000
144960          MOVE IPXESM-S-LM400-TIE-DAT-NAI (1) TO AAAA-MM-JJ       0000000
144970          MOVE CORRESPONDING AAAA-MM-JJ TO JJ-MM-AAAA             0000000
144980          MOVE JJ-MM-AAAA               TO IPPEDG-CAU1NAIS.       0000000
144990                                                                  0000000
145000     IF   IPPEDG-CAU1NAIS  =  SPACE                               0000000
145010          MOVE SPACE           TO IPPEDG-CAU1NAIS-NE.             0000000
145020*                                                                 0000000
145030     MOVE SPACE                     TO WADR-ADRESSE.              0000000
145040     MOVE SPACE                     TO W-ADRESSE W-ADRLIG-ACHEMIN.0000000
145050     MOVE SPACES                    TO WADR-BANQUE.               0000000
145060                                                                  0000000
145070     MOVE   1    TO   TOP-ADRESSE-CAU.                            0000000
145080                                                                  0000000
145090*    MOVE IPXESM-S-LM400-TIE-ADR-lig (1 1)  TO IPPEDG-CAUADR1     0000000
145100*    MOVE IPXESM-S-LM400-TIE-ADR-LIG (1 2)  TO IPPEDG-CAUADR2     0000000
145110     MOVE IPXESM-S-LM400-TIE-ADR-lig (1 4)  TO IPPEDG-CAUADR1     0000000
145120     MOVE IPXESM-S-LM400-TIE-ADR-LIG (1 6)  TO IPPEDG-CAULOC      0000000
145130*                                                                 0000000
145140     IF   IPPEDG-CAU1ADR = SPACE                                  0000000
145150          MOVE SPACE            TO IPPEDG-CAU1DOMI.               0000000
145160                                                                  0000000
145170     MOVE IPXESM-S-LM400-TIE-PCS-LIB(1) TO WS-CAU1PROF.           0000000
145180                                                                  0000000
145190*-------------------------                                        0000000
145200 AFFECT-CAU-PHYS-2-GAR3.                                          0000000
145210*-------------------------                                        0000000
145220d    display 'AFFECT-CAU-PHYS-2-GAR3 '                            0000000
145230     MOVE '2'                  TO IPPEDG-INDCAU.                  0000000
145240     MOVE T-ET                 TO IPPEDG-CAU1LIAI.                0000000
145250     IF   IPXESM-S-LM400-TIE-TIT (2) = 'M  '                      0000000
145260          MOVE T-MONSIEUR      TO IPPEDG-CAU2TITR.                0000000
145270     IF   IPXESM-S-LM400-TIE-TIT (2) = 'MME'                      0000000
145280          MOVE T-MADAME        TO IPPEDG-CAU2TITR.                0000000
145290     IF   IPXESM-S-LM400-TIE-TIT (2) = 'MLE'                      0000000
145300          MOVE T-MADEMOISELLE  TO IPPEDG-CAU2TITR.                0000000
145310*                                                                 0000000
145320     MOVE IPXESM-S-LM400-TIE-PRN (2) TO IPPEDG-CAU2PRNM.          0000000
145330     MOVE IPXESM-S-LM400-TIE-NOM-USG (2) TO IPPEDG-CAU2NOM.       0000000
145340*                                                                 0000000
145350     IF   IPXESM-S-LM400-TIE-SEX (2) = 'M'                        0000000
145360          MOVE T-NE            TO IPPEDG-CAU2NAIS-NE.             0000000
145370     IF   IPXESM-S-LM400-TIE-SEX (2) = 'F'                        0000000
145380         MOVE IPXESM-S-LM400-TIE-NJF (2) TO IPPEDG-CAU2NMJF       0000000
145390         MOVE T-NEE           TO IPPEDG-CAU2NAIS-NE.              0000000
145400                                                                  0000000
145410     MOVE T-LE                 TO IPPEDG-CAU2NAIS-LE.             0000000
145420     MOVE T-DOMICILIES         TO IPPEDG-CAU1DOMI.                0000000
145430     IF   IPXESM-S-LM400-TIE-DAT-NAI (2) = SPACE                  0000000
145440          MOVE SPACE           TO IPPEDG-CAU2NAIS-LE              0000000
145450          MOVE SPACE           TO IPPEDG-CAU2NAIS                 0000000
145460     ELSE                                                         0000000
145470*         FORMATAGE DATE AAAA-MM-JJ -> JJ-MM-AAAA                 0000000
145480          MOVE IPXESM-S-LM400-TIE-DAT-NAI (2) TO AAAA-MM-JJ       0000000
145490          MOVE CORRESPONDING AAAA-MM-JJ TO JJ-MM-AAAA             0000000
145500          MOVE JJ-MM-AAAA               TO IPPEDG-CAU2NAIS.       0000000
145510*                                                                 0000000
145520     IF   IPPEDG-CAU2NAIS = SPACE                                 0000000
145530          MOVE SPACE           TO IPPEDG-CAU2NAIS-NE.             0000000
145540*                                                                 0000000
145550     MOVE IPXESM-S-LM400-TIE-PCS-LIB(2) TO WS-CAU2PROF.           0000000
145560                                                                  0000000
145570*-------------------------                                        0000000
145580 AFFECT-CAU-MORALE-GAR3.                                          0000000
145590*-------------------------                                        0000000
145600d    display 'AFFECT-CAU-MORALE-GAR3'                             0000000
145610     MOVE '0'                  TO IPPEDG-INDCAU.                  0000000
145620     MOVE IPXESM-S-LM400-TIE-RSO (1) TO IPPEDG-CAURAISO.          0000000
145630*                                                                 0000000
145640     MOVE SPACE                     TO WADR-ADRESSE.              0000000
145650     MOVE SPACE                     TO W-ADRESSE W-ADRLIG-ACHEMIN.0000000
145660     MOVE SPACE                     TO WADR-BANQUE.               0000000
145670*    MOVE IPXESM-S-LM400-TIE-ADR-lig (1 1)  TO IPPEDG-CAUADR1     0000000
145680*    MOVE IPXESM-S-LM400-TIE-ADR-LIG (1 2)  TO IPPEDG-CAUADR2     0000000
145690     MOVE IPXESM-S-LM400-TIE-ADR-lig (1 4)  TO IPPEDG-CAUADR1     0000000
145700     MOVE IPXESM-S-LM400-TIE-ADR-LIG (1 6)  TO IPPEDG-CAULOC      0000000
145710     .                                                            0000000
145720                                                                  0000000
145730                                                                  0000000
145740*--------------                                                   0000000
145750 DEST-CAUTION.                                                    0000000
145760*--------------                                                   0000000
145770     MOVE ' ' TO TROUVE.                                          0000000
145780     COMPUTE IG = (IP - 1) * NBGAR-PRET  + IT.                    0000000
145790     MOVE IPPEDG-STOCK (IG) TO IPPEDG.                            0000000
145800D    DISPLAY 'IPPEDG-CAUTION1 ' IPPEDG-CAUTION1.                  0000000
145810D    DISPLAY 'IPPEDG-INDGAR   ' IPPEDG-INDGAR.                    0000000
145820                                                                  0000000
145830     IF  IPPEDG-CAUTION1 NOT = SPACES                             0000000
145840        IF  IPPEDG-INDGAR  = '0090'                               0000000
145850                MOVE '1'   TO D-GARCLAU (1)                       0000000
145860        End-if                                                    0000000
145870     End-if                                                       0000000
145880     .                                                            0000000
145890     if  IPPEDG-INDGARTY =  '40' or '41' or 'HY' or 'E2' or       0000000
145900                  '36'  or  'E3' or 'E4' or '13' or  'EF'         0000000
145910             or   'AZ'  or  'QA' or 'QB' or 'QC'                  0000000
145920          Perform ex-cau-immo                                     0000000
145930     End-if                                                       0000000
145940                                                                  0000000
145950d    display 'D-GARCLAU (1)=' D-GARCLAU (1).                      0000000
145960d    display 'D-DESTTYP ( ' I-DEST ' ) = ' D-DESTTYP (I-DEST).    0000000
145970     .                                                            0000000
145980                                                                  0000000
145990*----------------                                                 0000000
146000 DEST-CAUTION-IMMO.                                               0000000
146010*---------------- gar 8   gar8                                    0000000
146020     MOVE ' ' TO TROUVE.                                          0000000
146030     COMPUTE IG = (IP - 1) * NBGAR-PRET + IT.                     0000000
146040     MOVE IPPEDG-STOCK (IG) TO IPPEDG.                            0000000
146050     IF IPPEDG-CAUTION1 NOT = SPACES                              0000000
146060        IF IPPEDG-INDGAR = '0090'                                 0000000
146070           MOVE '1'   TO D-GARCLAU (2).                           0000000
146080                                                                  0000000
146090     if  IPPEDG-INDGARTY =  '40' or '41' or 'HY' or 'E2' or       0000000
146100                       '36' or  'E3' or 'E4' or '13' or  'EF'     0000000
146110                  or   'AZ'  or  'QA' or 'QB' or 'QC'             0000000
146120              Perform ex-cau-immo                                 0000000
146130     End-if                                                       0000000
146140     .                                                            0000000
146150 Ex-cau-immo.                                                     0000000
146160*         RESTRICTION AUX ENGAGEMENTS DE CAUTION                  0000000
146170*    AND IPPEDG-INDGAR = '0090'                                   0000000
146180        MOVE '0' TO TROUVE                                        0000000
146190        MOVE IPPEDG-CAURAISO TO W-CAURAISO                        0000000
146200        PERFORM DEST-CAUTION-1                                    0000000
146210                VARYING JT FROM 1 BY 1 UNTIL JT = IG              0000000
146220                     OR TROUVE = '1'.                             0000000
146230     IF TROUVE = '0'                                              0000000
146240d       display 'trouve ..........' trouve                        0000000
146250*       IF  (IPPEDG-INDGARTY    NOT  =  'EF')    sup 24/08/2006   0000000
146260          ADD 1 TO I-DEST                                         0000000
146270          ADD 1 TO NBR-DESTINATAIRES                              0000000
146280          MOVE 'CAU' TO D-DESTTYP (I-DEST)                        0000000
146290          MOVE IP    TO D-PRETNUM (I-DEST)                        0000000
146300          MOVE IT    TO D-GARNUM  (I-DEST)                        0000000
146310          MOVE IG    TO D-INDEX   (I-DEST).                       0000000
146320                                                                  0000000
146330D    Display 'D-DESTTYP ( ' I-DEST ' ) = ' D-DESTTYP (I-DEST).    0000000
146340                                                                  0000000
146350*-------------------                                              0000000
146360 DEST-CAUTION-1.                                                  0000000
146370*-------------------                                              0000000
146380     IF IPPEDG-STOCK (JT) NOT = SPACES                            0000000
146390        MOVE IPPEDG-STOCK (JT) TO IPPEDG                          0000000
146400D    DISPLAY 'IPPEDG-INDGARTY=' IPPEDG-INDGARTY                   0000000
146410D    Display 'IPPEDG-CAURAISO=' IPPEDG-CAURAISO                   0000000
146420D    Display 'W-CAURAISO     =' W-CAURAISO                        0000000
146430        IF IPPEDG-CAURAISO = W-CAURAISO and                       0000000
146440           (IPPEDG-INDGARTY =  '40' or '41' or 'HY' or 'E2' or    0000000
146450                               'E3' or 'E4' or '13' or  'EF' )    0000000
146460            MOVE '1' TO TROUVE.                                   0000000
146470                                                                  0000000
146480*----------------------                                           0000000
146490 DEST-AUTRE-GARANTIE.                                             0000000
146500*---------------------- gar 8   gar8                              0000000
146510     MOVE ' '                   TO TROUVE.                        0000000
146520     COMPUTE IG = (IP - 1) * NBGAR-PRET  + IT.                    0000000
146530     MOVE IPPEDG-STOCK (IG)       TO IPPEDG.                      0000000
146540     MOVE NO-ORDRE-STOCK (IG)     TO W-NO-ORDRE.                  0000000
146550                                                                  0000000
146560     IF IPPEDG-INDGAR   =  '0010'  OR = '0015'                    0000000
146570        MOVE '1'                  TO D-GARCLAU (5)                0000000
146580     END-IF                                                       0000000
146590                                                                  0000000
146600     IF   ( ORGS01-FEDE-CEE   and                                 0000000
146610         (IPPEDG-INDGAR   =  '0010' or '0015'  ))  OR             0000000
146620        ( (ORGS01-BANQUE-CIC)  AND                                0000000
146630          ( IPPEDG-INDGAR   =  '0010' OR '0102' ) )               0000000
146640          MOVE '1'                  TO D-GARCLAU (17).            0000000
146650                                                                  0000000
146660*--------------------------------------------------------------   0000000
146670*          PROMESSE HYPOTHEQUE  NUMCLAUP 2250                     0000000
146680D    DISPLAY 'IPPEDG-INDGAR' IPPEDG-INDGAR.                       0000000
146690     IF IPPEDG-INDGAR   =  '0019'                                 0000000
146700        MOVE '1'                  TO D-GARCLAU (10).              0000000
146710*--------------------------------------------------------------   0000000
146720*          garantie sogama      NUMCLAUP 2590                     0000000
146730D    DISPLAY 'IPPEDG-INDGAR' IPPEDG-INDGAR.                       0000000
146740     IF IPPEDG-INDGARTY =  27                                     0000000
146750        MOVE '1'                  TO D-GARCLAU (14).              0000000
146760*--------------------------------------------------------------   0000000
146770*          garantie siagi       NUMCLAUP 2610                     0000000
146780D    DISPLAY 'IPPEDG-INDGAR' IPPEDG-INDGAR.                       0000000
146790     IF IPPEDG-INDGARTY =  81                                     0000000
146800        MOVE '1'                  TO D-GARCLAU (16).              0000000
146810*--------------------------------------------------------------   0000000
146820*          garantie mutua-equip NUMCLAUP 2600                     0000000
146830D    DISPLAY 'IPPEDG-INDGAR' IPPEDG-INDGAR.                       0000000
146840     IF IPPEDG-INDGARTY =  54                                     0000000
146850        MOVE '1'                  TO D-GARCLAU (15).              0000000
146860*--------------------------------------------------------------   0000000
146870     IF IPPEDG-INDGAR   =  '0020'                                 0000000
146880        MOVE '1'                  TO D-GARCLAU (2)                0000000
146890        MOVE '1'                  TO D-GARCLAU (5)                0000000
146900        MOVE '0'                  TO TROUVE                       0000000
146910        MOVE 'NFC'                TO W-DESTTYP.                   0000000
146920     IF IPPEDG-INDGAR   =  '0004'                                 0000000
146930        MOVE '1'                  TO D-GARCLAU (18)               0000000
146940        MOVE '1'                  TO D-GARCLAU (5)                0000000
146950        MOVE '0'                  TO TROUVE                       0000000
146960        MOVE 'NFA'                TO W-DESTTYP.                   0000000
146970     IF IPPEDG-INDGAR   =  '0030'                                 0000000
146980        MOVE '1'                  TO D-GARCLAU (3)                0000000
146990        MOVE '1'                  TO D-GARCLAU (5)                0000000
147000        MOVE '0'                  TO TROUVE                       0000000
147010        MOVE 'NOU'                TO W-DESTTYP.                   0000000
147020     IF IPPEDG-INDGAR   =  '0040'                                 0000000
147030        MOVE '1'                  TO D-GARCLAU (4)                0000000
147040        MOVE '1'                  TO D-GARCLAU (5)                0000000
147050        MOVE '0'                  TO TROUVE                       0000000
147060        MOVE 'VEH'                TO W-DESTTYP.                   0000000
147070     IF IPPEDG-INDGARTY =  81 OR = 82 OR = 87                     0000000
147080           MOVE '1'               TO D-GARCLAU (7).               0000000
147090     IF IPPEDG-INDGAR   =  '0070' or '0770' or '5500' or '0590'   0000000
147100          MOVE '1'                  TO D-GARCLAU (8).             0000000
147110     IF IPPEDG-INDGAR   =  '0080'                                 0000000
147120        MOVE '1'                  TO D-GARCLAU (9).               0000000
147130     IF IPPEDG-INDGAR   =  '0081'                                 0000000
147140        MOVE '1'                  TO D-GARCLAU (11).              0000000
147150**** CAUTION HYPOTHECAIRE                                         0000000
147160     IF CAU-HYP-EXIST = 'O'                                       0000000
147170          MOVE '1'                  TO D-GARCLAU (12).            0000000
147180*                                                                 0000000
147190D    DISPLAY 'IPPEDG-INDGAR   ' IPPEDG-INDGAR.                    0000000
147200D    DISPLAY 'IPPEDG-INDGARTY ' IPPEDG-INDGARTY.                  0000000
147210     if (ORGS01-FEDE-CEE or ORGS01-FEDE-ANTILLES or               0000000
147220         ORGS01-FEDE-LAVAL ) and                                  0000000
147230        (IPPEDG-INDGAR   =  022 or 023 or 520 OR 521)             0000000
147240                                                                  0000000
147250*       NANTISSEMENT DE BONS DE CAISSE et CAPI 022 avec bien 047  0000000
147260        IF IPPEDG-INDGAR   =  '0520' OR '0521'                    0000000
147270           MOVE '1'                  TO D-GARCLAU (35)            0000000
147280d       display 'on positionne 35  sbo0406'                       0000000
147290        else                                                      0000000
147300*       NANTISSEMENT DE COMPTE REMUNERES 022                      0000000
147310           MOVE '1'                  TO D-GARCLAU (30)            0000000
147320d       display 'on positionne 30  sbo0406'                       0000000
147330        end-if                                                    0000000
147340     end-if                                                       0000000
147350*    GAGE ESPECE 004                                              0000000
147360     if (ORGS01-FEDE-CEE or ORGS01-FEDE-ANTILLES or               0000000
147370         ORGS01-FEDE-LAVAL ) and                                  0000000
147380        IPPEDG-INDGARTY =  'GL' or 'GM' or 'GN' or                0000000
147390                             'GP' or 'GQ'                         0000000
147400        MOVE '1'                  TO D-GARCLAU (18)               0000000
147410d       display 'on positionne 18  sbo0406'                       0000000
147420     end-if                                                       0000000
147430*    NANTISSEMENT DE PART DE SOCIETE COMMERCIALE 540              0000000
147440     if (ORGS01-FEDE-CEE or ORGS01-FEDE-ANTILLES or               0000000
147450         ORGS01-FEDE-LAVAL ) and                                  0000000
147460         IPPEDG-INDGAR   =  '0540' or '0550'                      0000000
147470        MOVE '1'                  TO D-GARCLAU (25)               0000000
147480d       display 'on positionne 25  sbo0406'                       0000000
147490     end-if                                                       0000000
147500                                                                  0000000
147510                                                                  0000000
147520*--------------------------------------------------------------   0000000
147530                                                                  0000000
147540**** MARSEILLE                                                    0000000
147550     IF GAR-MARSEILLE = 1                                         0000000
147560        MOVE '1'                  TO D-GARCLAU (13).              0000000
147570*                                                                 0000000
147580     IF TROUVE = '0'                                              0000000
147590        PERFORM DEST-AUTRE-GARANTIE-1                             0000000
147600          VARYING JT FROM 1 BY 1 UNTIL JT = IG                    0000000
147610               OR TROUVE = '1'.                                   0000000
147620     IF TROUVE = 0                                                0000000
147630        ADD 1 TO I-DEST                                           0000000
147640        MOVE IP                 TO D-PRETNUM      (I-DEST)        0000000
147650        MOVE IT                 TO D-GARNUM       (I-DEST)        0000000
147660        MOVE IG                 TO D-INDEX        (I-DEST)        0000000
147670        MOVE W-DESTTYP          TO D-DESTTYP      (I-DEST)        0000000
147680        ADD 1 TO NBR-DESTINATAIRES.                               0000000
147690                                                                  0000000
147700D    Display 'D-DESTTYP ( ' I-DEST ' ) = ' D-DESTTYP (I-DEST).    0000000
147710                                                                  0000000
147720*----------------------                                           0000000
147730 DEST-AUTRE-GARANTIE-IMMO.                                        0000000
147740*---------------------- gar 8  gar8                               0000000
147750     MOVE ' '                   TO TROUVE.                        0000000
147760     COMPUTE IG = (IP - 1) * NBGAR-PRET + IT.                     0000000
147770     MOVE IPPEDG-STOCK (IG)       TO IPPEDG.                      0000000
147780     MOVE NO-ORDRE-STOCK (IG)     TO W-NO-ORDRE.                  0000000
147790**** HYPOTHEQUE - PPD                                             0000000
147800     IF  (ORGS01-BANQUE-CIC )                                     0000000
147810         IF HYP-EXIST = 'O'                                       0000000
147820            MOVE '1'                  TO D-GARCLAU (1)            0000000
147830         END-IF                                                   0000000
147840         IF PPD-EXIST = 'O'                                       0000000
147850            MOVE '1'                  TO D-GARCLAU (14)           0000000
147860         END-IF                                                   0000000
147870     else                                                         0000000
147880         IF HYP-EXIST = 'O' OR PPD-EXIST = 'O'                    0000000
147890            MOVE '1'                  TO D-GARCLAU (1).           0000000
147900**** TITRES                                                       0000000
147910     IF IPPEDG-INDGAR   =  '0070' or '0770' or '5500' or '0590'   0000000
147920        MOVE '1'                  TO D-GARCLAU (3).               0000000
147930**** VALEURS                                                      0000000
147940     IF IPPEDG-INDGAR   =  '0080' or '0880'                       0000000
147950        MOVE '1'                  TO D-GARCLAU (4).               0000000
147960**** NANTISST PARTS SOCIALES                                      0000000
147970     IF IPPEDG-INDGAR   =  '0081' or '0881' or '0540' or '0550'   0000000
147980                                                                  0000000
147990        MOVE '1'                  TO D-GARCLAU (5).               0000000
148000****                                                              0000000
148010**** PROMESSE D'HYPOTHEQUE                                        0000000
148020                                                                  0000000
148030     IF  GAR-19-PREVUE  = 'O'                                     0000000
148040         MOVE '1'                  TO D-GARCLAU (6)               0000000
148050     END-IF.                                                      0000000
148060                                                                  0000000
148070D        DISPLAY ' GAR-19-PREVUE ' GAR-19-PREVUE                  0000000
148080D        DISPLAY ' 42-EXIST      ' 42-EXIST                       0000000
148090D        DISPLAY ' D-GARCLAU 6 ' D-GARCLAU (6)                    0000000
148100                                                                  0000000
148110**** AUCUNE HYPOTHEQUE EXISTE                                     0000000
148120D    DISPLAY 'AUCUNE-HYP-EXIST ' AUCUNE-HYP-EXIST.                0000000
148130                                                                  0000000
148140     IF ORGS01-FEDE-LAVAL                                         0000000
148150         IF  42-EXIST    =  'O'                                   0000000
148160             MOVE  '1'                 TO D-GARCLAU (7)           0000000
148170         END-IF                                                   0000000
148180     ELSE                                                         0000000
148190         IF   AUCUNE-HYP-EXIST = 'O'                              0000000
148200              IF  NOT  IPPMA2-LANGUE-ALLEMANDE                    0000000
148210                  MOVE '1'                  TO D-GARCLAU (7)      0000000
148220     END-IF.                                                      0000000
148230                                                                  0000000
148240* CLAUSE 3600                                                     0000000
148250****                                                              0000000
148260**** EXECUTION FORCEE (SI NOTARIE ET HYPOTHEQUE DROIT LOCAL)      0000000
148270****           ou pret avec GRUNDSCHULD                           0000000
148280     IF ( NOTARIE = 1                                             0000000
148290     AND  DROIT-LOCAL = 'O' )                                     0000000
148300*      OR  IPPEDG-INDGAR   =  '0003'                le 29/11/99   0000000
148310          MOVE '1'             TO D-GARCLAU (8).                  0000000
148320**** CLAUSE A ORDRE (SI SALARIE ET NOTARIE  OU  PC                0000000
148330     IF   NOTARIE = 1                                             0000000
148340     AND  IPPPRI-INDORD  =  '1'                                   0000000
148350          MOVE '1'             TO D-GARCLAU (9).                  0000000
148360**** ASSURANCE EXTERNE AU CREDIT MUTUEL                           0000000
148370     IF   ASSURANCE-EXTERNE = 'O'                                 0000000
148380          MOVE '1'             TO D-GARCLAU (11).                 0000000
148390**** CAUTION HYPOTHECAIRE                                         0000000
148400     IF CAU-HYP-EXIST = 'O'                                       0000000
148410        MOVE '1'                  TO D-GARCLAU (12).              0000000
148420**** MARSEILLE  RS CG210021                                       0000000
148430     IF GAR-MARSEILLE = 1                                         0000000
148440        MOVE '1'                  TO D-GARCLAU (13).              0000000
148450* ACM Caution                                                     0000000
148460     IF IPPEDG-INDGARTY =  'AK'                                   0000000
148470           MOVE '1'               TO D-GARCLAU (16).              0000000
148480* M F P                                                           0000000
148490     IF IPPEDG-INDGAR   =  '0029'                                 0000000
148500           MOVE '1'               TO D-GARCLAU (15).              0000000
148510                                                                  0000000
148520     if (ORGS01-FEDE-CEE or ORGS01-FEDE-ANTILLES or               0000000
148530         ORGS01-FEDE-LAVAL ) and                                  0000000
148540        (IPPEDG-INDGAR   =  022  or 023 or 520 OR 521)            0000000
148550                                                                  0000000
148560*       NANTISSEMENT DE BONS DE CAISSE et CAPI 022 avec bien 047  0000000
148570        IF IPPEDG-INDGAR   =  '0520' or '0521'                    0000000
148580           MOVE '1'                  TO D-GARCLAU (35)            0000000
148590        else                                                      0000000
148600*       NANTISSEMENT DE COMPTE REMUNERES 022                      0000000
148610           MOVE '1'                  TO D-GARCLAU (30)            0000000
148620        end-if                                                    0000000
148630     end-if                                                       0000000
148640                                                                  0000000
148650*    GAGE ESPECE 004                                              0000000
148660     if (ORGS01-FEDE-CEE or ORGS01-FEDE-ANTILLES or               0000000
148670         ORGS01-FEDE-LAVAL ) and                                  0000000
148680        IPPEDG-INDGARTY =  'GL' or 'GM' or 'GN' or                0000000
148690                           'GP' or 'GQ'                           0000000
148700        MOVE '1'                  TO D-GARCLAU (18)               0000000
148710     end-if                                                       0000000
148720                                                                  0000000
148730*    NANTISSEMENT DE PART DE SOCIETE COMMERCIALE 540              0000000
148740     if (ORGS01-FEDE-CEE or ORGS01-FEDE-ANTILLES or               0000000
148750         ORGS01-FEDE-LAVAL ) and                                  0000000
148760         IPPEDG-INDGAR   =  '0540'                                0000000
148770        MOVE '1'                  TO D-GARCLAU (32)               0000000
148780     end-if                                                       0000000
148790     .                                                            0000000
148800     IF  orgs01-banque-cic                                        0000000
148810         IF (IPPEDG-INDGARTY = 'A1' or 'CA' or 'Q8' or 'Q9' )     0000000
148820             MOVE '1'                  TO D-GARCLAU (31)          0000000
148830         End-if                                                   0000000
148840     End-if.                                                      0000000
148850d    display 'D-GARCLAU(31) ' D-GARCLAU (31).                     0000000
148860*                                                                 0000000
148870 DEST-AUTRE-GARANTIE-1.                                           0000000
148880*-----------------------                                          0000000
148890     IF IPPEDG-STOCK (JT) NOT = SPACES                            0000000
148900        MOVE IPPEDG-STOCK(JT) TO IPPEDG                           0000000
148910        PERFORM TEST-AUTRES.                                      0000000
148920                                                                  0000000
148930 TEST-AUTRES.                                                     0000000
148940*--------------                                                   0000000
148950     IF ((IPPEDG-INDGAR   = '0020' AND W-DESTTYP = 'NFC') OR      0000000
148960         (IPPEDG-INDGAR   = '0004' AND W-DESTTYP = 'NFA') OR      0000000
148970         (IPPEDG-INDGAR   = '0030' AND W-DESTTYP = 'NOU') OR      0000000
148980         (IPPEDG-INDGAR   = '0040' AND W-DESTTYP = 'VEH'))        0000000
148990         IF NO-ORDRE-STOCK(JT) = W-NO-ORDRE                       0000000
149000            MOVE '1'            TO TROUVE.                        0000000
149010                                                                  0000000
149020*-----------------                                                0000000
149030 TRAIT-GAR-HYP.                                                   0000000
149040*-----------------                                                0000000
149050      string GAR-HYP-DESCR-L1                                     0000000
149060             GAR-HYP-DESCR-L2                                     0000000
149070      delimited size    into IPPEDG-HYPO                          0000000
149080      string GAR-HYP-DESCR-L3                                     0000000
149090             GAR-HYP-DESCR-L4                                     0000000
149100             GAR-HYP-DESCR-L5                                     0000000
149110      delimited size    into IPPEDG-HYPOFILL                      0000000
149120*     MOVE GAR-LIB-DESCR  TO IPPEDG-HYPO.                         0000000
149130      IF   GAR-INDIC-NATURE = 'HYP'                               0000000
149140****       ON FORMATTE UNE ADRESSE CORRECTE SI HYP(OTHEQUE)       0000000
149150           MOVE SPACE TO IPPEDG-HYPOADR                           0000000
149160           STRING GAR-HYP-RUE      DELIMITED BY SIZE              0000000
149170                  ' '              DELIMITED BY SIZE              0000000
149180                  GAR-HYP-LOCALITE DELIMITED BY SIZE              0000000
149190                  ' '              DELIMITED BY SIZE              0000000
149200                  GAR-HYP-CODEBUR  DELIMITED BY SIZE              0000000
149210                  ' '              DELIMITED BY SIZE              0000000
149220                  GAR-HYP-BUR      DELIMITED BY SIZE              0000000
149230            INTO  IPPEDG-HYPOADR                                  0000000
149240         move GAR-HYP-CADASTRE      to IPPEDG-HYPOCADA            0000000
149250      end-if                                                      0000000
149260                                                                  0000000
149270d     display 'IPPEDG-HYPOCADA' IPPEDG-HYPOCADA                   0000000
149280d     display 'IPPEDG-HYPOADR ' IPPEDG-HYPOADR                    0000000
149290d     display 'IPPEDG-HYPO    ' IPPEDG-HYPO                       0000000
149300d     display 'gar-rang       ' gar-rang                          0000000
149310                                                                  0000000
149320      MOVE GAR-RANG       TO Z-RANG.                              0000000
149330      if  z-rang  =  space  or zero                               0000000
149340          MOVE '01'          TO Z-RANG                            0000000
149350      End-if                                                      0000000
149360      IF  LANGUE-ALLEMANDE                                        0000000
149370          PERFORM RANG-EN-LETTRE-AL                               0000000
149380      ELSE                                                        0000000
149390          PERFORM RANG-EN-LETTRE.                                 0000000
149400      MOVE Z-LIBRANG      TO IPPEDG-HYPORANG.                     0000000
149410d     display 'IPPEDG-HYPOADR  ' IPPEDG-HYPOADR                   0000000
149420d     display 'IPPEDG-HYPO     ' IPPEDG-HYPO                      0000000
149430d     display 'IPPEDG-HYPORANG ' IPPEDG-HYPORANG                  0000000
149440     MOVE  WP-NO-ORDRE9(IP IT) TO  II2                            0000000
149450D    DISPLAY ' NO GAR II2 '        II2                            0000000
149460D    DISPLAY ' PRET       '        It                             0000000
149470D    DISPLAY ' gar        '        Ip                             0000000
149480D    DISPLAY ' MTCRED     '        SAY-MTCRED                     0000000
149490D    DISPLAY ' MTCRED     '        SAY-MTCRED                     0000000
149500D    DISPLAY ' MT GAR     '        GAR-MONTANT                    0000000
149510*                                                                 0000000
149520     move GAR-MONTANT          to IPPEDG-MGARCAPI                 0000000
149530                                                                  0000000
149540     IF  GAR-DEVISE   =  SPACE                                    0000000
149550         MOVE  'EUR'      TO ZPRTLETT-DEVISE W-GAR-DEVISE         0000000
149560     ELSE                                                         0000000
149570         MOVE GAR-DEVISE  TO ZPRTLETT-DEVISE W-GAR-DEVISE         0000000
149580     END-IF                                                       0000000
149590*                                                                 0000000
149600*  mtothyp = total des montants garanties par hypotheque (GAR)    0000000
149610*                                               pour ttes devises 0000000
149620*   devmhf = total des prets  garanties par hypotheque (say)      0000000
149630*                                               pour ttes devises 0000000
149640                                                                  0000000
149650D    DISPLAY  'Avant '                                            0000000
149660D    DISPLAY  'W-INDIC-SAY( ' IP  ' ' W-INDIC-SAY (IP)            0000000
149670D    DISPLAY  'W-INDIC-GAR( ' II2 ' ' W-INDIC-GAR (II2)           0000000
149680D    DISPLAY  'GAR-MONTANT  '         GAR-MONTANT                 0000000
149690*                                                                 0000000
149700     IF  NOT ( SAY-DEVISE          =  'EUR')                      0000000
149710*  devise 'OUT'                                                   0000000
149720         IF  GAR-MONTANTX  NUMERIC                                0000000
149730             IF  W-MTGAR-MONT(II2)  =  ZERO  and                  0000000
149740                 W-INDIC-SAY  (IP)  =  ZERO                       0000000
149750                 MOVE GAR-MONTANT        TO W-MTGAR-MONT (II2)    0000000
149760                 ADD  W-MTGAR-MONT (II2) TO WS-MTOTHYP            0000000
149770                                            W-DEVPRC2             0000000
149780                 COMPUTE  W-DEVPRC =  W-DEVPRC2  *  0,2           0000000
149790                 MOVE     W-DEVPRC   TO  IPPPRI-DEVPRC            0000000
149800             END-IF                                               0000000
149810             MOVE  1             TO  W-INDIC-SAY  (IP)            0000000
149820         END-IF                                                   0000000
149830     ELSE                                                         0000000
149840*  devise 'IN'                                                    0000000
149850* -> Le montant est saisi dans GAR                                0000000
149860                                                                  0000000
149870* SI GAR3 VERIFICATION QUE LA GARANTIES N'A PAS DJA T PRISE    0000000
149880* DANS LE CUMUL SBO1606                                           0000000
149890D        DISPLAY ' SBO1606 MT-GARANTIE-DEJA-CUMULE'               0000000
149900D        DISPLAY  GAR-CTR-GAR '?=' W-GAR3HYP(1)                   0000000
149910D        DISPLAY  GAR-CTR-GAR '?=' W-GAR3HYP(2)                   0000000
149920                                                                  0000000
149930         IF GAR-CTR-GAR = W-GAR3HYP(1) OR                         0000000
149940            GAR-CTR-GAR = W-GAR3HYP(2)                            0000000
149950            SET MT-GARANTIE-DEJA-CUMULE       TO TRUE             0000000
149960         ELSE                                                     0000000
149970            SET MT-GARANTIE-PAS-ENCORE-CUMULE TO TRUE             0000000
149980         END-IF                                                   0000000
149990                                                                  0000000
150000d        display 'W-MTGAR-MONT ' II2 ' ' W-MTGAR-MONT(II2)        0000000
150010d        display 'W-INDIC-SAY  ' IP  ' ' W-INDIC-SAY (IP)         0000000
150020                                                                  0000000
150030         IF  GAR-MONTANTX  NUMERIC  AND                           0000000
150040             GAR-MONTANT  >  ZERO   AND                           0000000
150050             MT-GARANTIE-PAS-ENCORE-CUMULE                        0000000
150060             If    orgs01-fede-cee                                0000000
150070               Or ( W-MTGAR-MONT(II2)  =  ZERO  And               0000000
150080                   W-INDIC-SAY  (IP)  =  ZERO )                   0000000
150090                   MOVE  1             TO  W-INDIC-SAY (IP)       0000000
150100                       ADD   GAR-MONTANT   TO  WS-MTOTHYP         0000000
150110                   MOVE  GAR-MONTANT   TO  W-MTGAR-MONT(II2)      0000000
150120                                                                  0000000
150130d                  display 'RDE MTOTHYP='                         0000000
150140d                  display 'WS-MTOTHYP=' WS-MTOTHYP               0000000
150150                   IF W-GAR3HYP(1) = SPACES                       0000000
150160                         MOVE GAR-CTR-GAR   TO W-GAR3HYP(1)       0000000
150170                   ELSE                                           0000000
150180                         MOVE GAR-CTR-GAR   TO W-GAR3HYP(2)       0000000
150190                   END-IF                                         0000000
150200                                                                  0000000
150210             END-IF                                               0000000
150220                                                                  0000000
150230         ELSE                                                     0000000
150240* -> Le montant est absent de GAR donc on prend le montant du pret0000000
150250             IF  W-MTGAR-MONT(II2)  =  ZERO  AND                  0000000
150260                 W-INDIC-SAY  (IP)  =  ZERO                       0000000
150270                 ADD   SAY-MTCRED        TO  WS-MTOTHYP           0000000
150280                 MOVE  1                 TO  W-INDIC-SAY (IP)     0000000
150290D                DISPLAY 'SAY-MTCRED ' SAY-MTCRED                 0000000
150300             END-IF                                               0000000
150310         END-IF                                                   0000000
150320     END-IF.                                                      0000000
150330                                                                  0000000
150340     IF  W-INDIC-SAY2 (IP) NOT  =  1                              0000000
150350         ADD   SAY-MTCRED    TO  WS-DEVMHF                        0000000
150360         MOVE  1  TO  W-INDIC-SAY2 (IP)                           0000000
150370     END-IF                                                       0000000
150380     .                                                            0000000
150390                                                                  0000000
150400D    DISPLAY  'APRES '                                            0000000
150410D    DISPLAY  'W-INDIC-SAY( ' IP  ' ' W-INDIC-SAY (IP)            0000000
150420D    DISPLAY  'W-INDIC-GAR( ' II2 ' ' W-INDIC-GAR (II2)           0000000
150430D    DISPLAY  'WS-MTOTHYP =' WS-MTOTHYP.                          0000000
150440D    DISPLAY  'IPPEDG-MGARCAPI=' IPPEDG-MGARCAPI                  0000000
150450     .                                                            0000000
150460*-------------------------                                        0000000
150470 AFFECT-GAR-CAU.                                                  0000000
150480*-------------------------                                        0000000
150490                                                                  0000000
150500     IF   GAR-MONTANTX  NUMERIC  and                              0000000
150510          GAR-MONTANT   >  zero                                   0000000
150520          MOVE GAR-MONTANT            TO IPPEDG-MGARCAPI          0000000
150530                                         ZPRTLETT-MONTANT-N       0000000
150540          IF  GAR-DEVISE   =  SPACE                               0000000
150550              MOVE  'EUR'      TO ZPRTLETT-DEVISE W-GAR-DEVISE    0000000
150560          ELSE                                                    0000000
150570              MOVE GAR-DEVISE  TO ZPRTLETT-DEVISE W-GAR-DEVISE    0000000
150580          END-IF                                                  0000000
150590     Else                                                         0000000
150600          COMPUTE        W-MGARCAPI  = SAY-MTCRED * 1,2           0000000
150610          move       W-MGARCAPI  to  IPPEDG-MGARCAPI              0000000
150620          move       W-MGARCAPI  to  ZPRTLETT-MONTANT-N           0000000
150630          MOVE  say-devise       TO  ZPRTLETT-DEVISE W-GAR-DEVISE 0000000
150640     End-if                                                       0000000
150650                                                                  0000000
150660     PERFORM MONTANT-EN-LETTRES                                   0000000
150670                                                                  0000000
150680     IF ZPRTLETT-OPTION NOT = ZERO                                0000000
150690        MOVE 25 TO TEST-1                                         0000000
150700        PERFORM  TRAIT-ANOMALIE                                   0000000
150710     ELSE                                                         0000000
150720        MOVE ZPRTLETT-MONTANT-L  TO IPPEDG-LGARCAPI               0000000
150730     END-IF.                                                      0000000
150740d         display 'IPPEDG-MGARCAPI '  IPPEDG-MGARCAPI.            0000000
150750d         display 'IPPEDG-LGARCAPI '  IPPEDG-LGARCAPI.            0000000
150760                                                                  0000000
150770*-------------------------                                        0000000
150780 AFFECT-GAR-VEH.                                                  0000000
150790*-------------------------                                        0000000
150800                                                                  0000000
150810D    DISPLAY 'GAR-VEH = ' GAR-VEH                                 0000000
150820     MOVE GAR-VEH-MARQUE         TO IPPEDG-VEHMARQU.              0000000
150830     MOVE GAR-VEH-TYPE           TO IPPEDG-VEHTYPE.               0000000
150840     MOVE GAR-VEH-NUMSERIE       TO IPPEDG-VEHSERIE.              0000000
150850     MOVE GAR-VEH-ANNEEFABX      TO IPPEDG-VEHANNEE.              0000000
150860*                                                                 0000000
150870     MOVE   SPACES               TO IPPEDG-VEHTITUL               0000000
150880     IF  GAR-VEH-TITUL  NOT =  SPACES                             0000000
150890         MOVE GAR-VEH-TITUL          TO IPPEDG-VEHTITUL           0000000
150900     ELSE                                                         0000000
150910         IF  WS-EMP1NOM  NOT =  SPACES                            0000000
150920             MOVE  WS-EMP1NOM  TO  IPPEDG-VEHTITUL.               0000000
150930*                                                                 0000000
150940     IF GAR-VEH-DATECIRCX NUMERIC                                 0000000
150950        MOVE GAR-VEH-DATECIRCX    TO W-DATE-SSAAMMJJ              0000000
150960        MOVE '27.??00'            TO ZDATE-PARMS                  0000000
150970****                                                              0000000
150980        IF GAR-VEH-DATECIRC NOT = ZERO                            0000000
150990          MOVE ZDATE-PARMS           TO   CV-ZDATE-PARAM-GROUPE   0000000
151000          MOVE GAR-VEH-DATECIRC      TO   CV-ZDATE-DATE1          0000000
151010          MOVE IPPEDG-VEHDPMEC       TO   CV-ZDATE-DATE2          0000000
151020          MOVE  'O'                  TO   ZDAT2000-GESTION-SIECLE 0000000
151030          PERFORM ZDAT2-ZDAT2000                                  0000000
151040          MOVE CV-ZDATE-PARAM-GROUPE TO   ZDATE-PARMS             0000000
151050          MOVE CV-ZDATE-DATE2        TO   IPPEDG-VEHDPMEC         0000000
151060         ELSE                                                     0000000
151070          MOVE SPACE                 TO   IPPEDG-VEHDPMEC         0000000
151080        END-IF                                                    0000000
151090        IF   ZDATE-RETOUR NOT = ZERO                              0000000
151100             MOVE SPACE           TO IPPEDG-VEHDPMEC.             0000000
151110     MOVE GAR-VEH-NUMIMMATR      TO IPPEDG-VEHIMMAT.              0000000
151120**** ATTENTION : MISE A BLANC W-VEHDEPT                           0000000
151130**** GAR-VEH-CODEDPTX SUR 2 POSITIONS ET W-VEHDEPT SUR 3          0000000
151140     IF   GAR-VEH-CODEDPTX NOT = SPACE                            0000000
151150          MOVE SPACE TO W-VEHDEPT.                                0000000
151160**** CAS NORMAL                                                   0000000
151170     MOVE GAR-VEH-CODEDPTX       TO W-VEHDEPT                     0000000
151180                                    ZDEPART-CODE                  0000000
151190                                    ZPREFECT-CODE.                0000000
151200D    DISPLAY 'GAR-VEH-CODEDPTX = ' GAR-VEH-CODEDPTX               0000000
151210**** MAGOUILLES ANTILLES : SI PAS DE PLAQUE IMMATRIC.FOURNIE      0000000
151220**** ON PREND DEPARTEMENT MARTINIQUE PAR DEFAUT                   0000000
151230     MOVE SPACE TO W-IMMAT.                                       0000000
151240     IF   GAR-VEH-CODEDPTX = '97'                                 0000000
151250     AND  GAR-VEH-NUMIMMATR = SPACE                               0000000
151260          MOVE '972' TO W-VEHDEPT                                 0000000
151270                        ZDEPART-CODE                              0000000
151280                        ZPREFECT-CODE.                            0000000
151290**** MAGOUILLES ANTILLES ON PREND CODE DEPT PLAQUE IMMAT.         0000000
151300**** S'IL EST FOURNI SS FORME 11122333 OU 11222333                0000000
151310     IF   GAR-VEH-CODEDPTX = '97'                                 0000000
151320     AND  GAR-VEH-NUMIMMATR NOT = SPACE                           0000000
151330          MOVE GAR-VEH-NUMIMMATR TO W-IMMAT  W-IMMAT6             0000000
151340****      CAS PLAQUE BONNE    : ON PREND DEPT APPROPRIE           0000000
151350          IF   W-IMMAT-2 = '971' OR '972' OR '973'                0000000
151360               MOVE W-IMMAT-2 TO W-VEHDEPT                        0000000
151370                                 ZDEPART-CODE                     0000000
151380                                 ZPREFECT-CODE                    0000000
151390          Else                                                    0000000
151400          IF   W-IMMAT6-2 = '971' OR '972' OR '973'               0000000
151410               MOVE W-IMMAT6-2 TO W-VEHDEPT                       0000000
151420                                  ZDEPART-CODE                    0000000
151430                                  ZPREFECT-CODE                   0000000
151440****      CAS PLAQUE MAUVAISE : ON PREND MARTINIQUE               0000000
151450           ELSE MOVE '972' TO W-VEHDEPT                           0000000
151460                             ZDEPART-CODE                         0000000
151470                             ZPREFECT-CODE.                       0000000
151480                                                                  0000000
151490     IF   GAR-VEH-CODEDPTX = '97'                                 0000000
151500     AND  IPPMA2-CAISSE =  '05360'                                0000000
151510          MOVE '979' TO W-VEHDEPT                                 0000000
151520                        ZDEPART-CODE                              0000000
151530                        ZPREFECT-CODE.                            0000000
151540                                                                  0000000
151550     CALL 'ZCALLPGM' USING ZDEPART2                               0000000
151560                           ZDEPART-CODE                           0000000
151570                           ZDEPART-LIBELLE.                       0000000
151580***                                                               0000000
151590     MOVE ZDEPART-LIBELLE        TO IPPEDG-VEDEPART.              0000000
151600     PERFORM LECTURE-ZPREFECT.                                    0000000
151610                                                                  0000000
151620*-------------------------                                        0000000
151630 LECTURE-ZPREFECT.                                                0000000
151640*-------------------------                                        0000000
151650D    DISPLAY 'ZPREFECT-CODE = ' ZPREFECT-CODE.                    0000000
151660D    DISPLAY 'CLIRAD-ADRADR-INSEE = ' CLIRAD-ADRADR-INSEE.        0000000
151670*                                                                 0000000
151680     MOVE CLIRAD-ADRADR-INSEE TO CODE-INSEE                       0000000
151690     SET IPXSSP-DONNEES-NON-TROUVEES TO TRUE                      0000000
151700     IF CLIRAD-ADRADR-INSEE (1:2) = '49'                          0000000
151710D       DISPLAY 'ON APPELLE IPXZSPRE'                             0000000
151720        INITIALIZE IPXSSP                                         0000000
151730        MOVE CLIRAD-ADRADR-INSEE  TO IPXSSP-CD-INSEE              0000000
151740        CALL 'ZCALLPGM' USING IPXZSPRE                            0000000
151750                              IPXSSP                              0000000
151760D       DISPLAY 'IPXSSP-CODE-RETOUR = ' IPXSSP-CODE-RETOUR        0000000
151770     END-IF                                                       0000000
151780     MOVE SPACES TO ZPREFECT-PARMS                                0000000
151790     IF IPXSSP-DONNEES-TROUVEES                                   0000000
151800        MOVE IPXSSP-SORTIE TO ZPREFECT-PARMS                      0000000
151810     ELSE                                                         0000000
151820D       DISPLAY 'ON APPELLE ZPREFEC2'                             0000000
151830D       DISPLAY 'ZPREFECT-CODE = ' ZPREFECT-CODE                  0000000
151840        CALL 'ZCALLPGM' USING ZPREFEC2                            0000000
151850                              ZPREFECT-CODE                       0000000
151860                              ZPREFECT-PARMS                      0000000
151870     END-IF                                                       0000000
151880                                                                  0000000
151890     IF ZPREFECT-PARMS NOT = SPACES                               0000000
151900          MOVE ZPREFECT-LOCALITE      TO IPPEDG-VEHINSLI          0000000
151910          MOVE ZPREFECT-DUDELA        TO IPPEDG-VEDUDELA          0000000
151920          IF   W-VEHDEPT   =  '979'                               0000000
151930               MOVE  'DES ' TO IPPEDG-VEDUDELA.                   0000000
151940* VERRUE PARISIENNE                                               0000000
151950*       IF  (ZDEPART-CODE   =  '075' OR ' 75' OR '75 ')           0000000
151960*           MOVE ZPREFECT-NOM            TO IPPEDG-VEDEPART.      0000000
151970***                                                               0000000
151980D    DISPLAY 'ZPREFECT-PARMS = ' ZPREFECT-PARMS.                  0000000
151990D    DISPLAY 'ZPREFECT-CODE  = ' ZPREFECT-CODE.                   0000000
152000D    DISPLAY 'ZPREFECT-LOCAL = ' ZPREFECT-LOCALITE.               0000000
152010D    DISPLAY 'ZPREFECT-DUDEL = ' ZPREFECT-DUDELA.                 0000000
152020                                                                  0000000
152030                                                                  0000000
152040*-------------------------                                        0000000
152050 RANG-EN-LETTRE-AL.                                               0000000
152060*-------------------------                                        0000000
152070     IF Z-RANG = '01'                                             0000000
152080        MOVE 'ERST      ' TO Z-LIBRANG                            0000000
152090     ELSE                                                         0000000
152100     IF Z-RANG = '02'                                             0000000
152110        MOVE 'ZWEIT     ' TO Z-LIBRANG                            0000000
152120     ELSE                                                         0000000
152130        MOVE  space       TO Z-LIBRANG.                           0000000
152140*-------------------------                                        0000000
152150 RANG-EN-LETTRE.                                                  0000000
152160*-------------------------                                        0000000
152170     IF Z-RANG = '01'                                             0000000
152180        MOVE 'PREMIER   ' TO Z-LIBRANG                            0000000
152190     ELSE                                                         0000000
152200     IF Z-RANG = '02'                                             0000000
152210        MOVE 'DEUXIEME  ' TO Z-LIBRANG                            0000000
152220     ELSE                                                         0000000
152230     IF Z-RANG = '03'                                             0000000
152240        MOVE 'TROISIEME ' TO Z-LIBRANG                            0000000
152250     ELSE                                                         0000000
152260     IF Z-RANG = '04'                                             0000000
152270        MOVE 'QUATRIEME ' TO Z-LIBRANG                            0000000
152280     ELSE                                                         0000000
152290     IF Z-RANG = '05'                                             0000000
152300        MOVE 'CINQUIEME ' TO Z-LIBRANG                            0000000
152310     ELSE                                                         0000000
152320     IF Z-RANG = '06'                                             0000000
152330        MOVE 'SIXIEME   ' TO Z-LIBRANG                            0000000
152340     ELSE                                                         0000000
152350     IF Z-RANG = '07'                                             0000000
152360        MOVE 'SEPTIEME  ' TO Z-LIBRANG                            0000000
152370     ELSE                                                         0000000
152380     IF Z-RANG = '08'                                             0000000
152390        MOVE 'HUITIEME  ' TO Z-LIBRANG                            0000000
152400     ELSE                                                         0000000
152410     IF Z-RANG = '09'                                             0000000
152420        MOVE 'NEUVIEME  ' TO Z-LIBRANG                            0000000
152430     ELSE                                                         0000000
152440        MOVE SPACES       TO Z-LIBRANG.                           0000000
152450*-------------------------                                        0000000
152460 TRAIT-INDICATEURS.                                               0000000
152470*-------------------------                                        0000000
152480                                                                  0000000
152490     MOVE '00' TO IPPPRI-INDASSUR                                 0000000
152500                                                                  0000000
152510     MOVE ZERO TO IPPPRI-INDASS0.                                 0000000
152520     MOVE '1'  TO IPPPRI-MODREMB.                                 0000000
152530                                                                  0000000
152540* MODREMB =  1 ASSUR EN dev                                       0000000
152550*            2 ASSUR EN dev ET CREDIPLAN                          0000000
152560*            3 ASSUR EN TAUX ( ipc ou (ipi et pas modges 6))      0000000
152570*            4 ASSUR EN TAUX ET CREDIPLAN                         0000000
152580*            9  IPC laval caisse 04899                            0000000
152590*                                                                 0000000
152600* indass0  = 0  si pas d'assur                              IPI   0000000
152610*          = 1  si assurance et fede hors teg  (11)          "    0000000
152620*          = 2  si autre ACM (cme mgen)                      "    0000000
152630*          = 3  si fede avec ass dans le teg (annecy)        "    0000000
152640*          = 4  si assurance SENIOR                          "    0000000
152650*                                                                 0000000
152660* indassur = 04 si deces seule     (meme si cotis = zero)    "    0000000
152670*          = 05 si deces + options (meme si cotis = zero)    "    0000000
152680*          = 06 si autre fede (33) (meme si cotis = zero)    "    0000000
152690* -------------                                                   0000000
152700*          = 03 si ipp en dev/10000  cotis > 0                    0000000
152710*          = 02 si ipc en dev/10000  cotis > 0                    0000000
152720*          = 01 si ipp-ipc en %      cotis > 0                    0000000
152730*          = 07 si SENIOR                                         0000000
152740*          = 08 si LACO IPC et TSE                                0000000
152750*                                                                 0000000
152760                                                                  0000000
152770     IF  IPPPRI-INDEPA  =  '1'                                    0000000
152780         IF  APXTRE-ENCOURS                                       0000000
152790             MOVE  '4'  TO  IPPPRI-MODREMB                        0000000
152800         ELSE                                                     0000000
152810             MOVE  '2'  TO  IPPPRI-MODREMB                        0000000
152820     ELSE                                                         0000000
152830         IF  APXTRE-ENCOURS                AND NOT                0000000
152840             SAY-MGES  =  '6'                                     0000000
152850             MOVE  '3'  TO  IPPPRI-MODREMB                        0000000
152860         ELSE                                                     0000000
152870             MOVE  '1'  TO  IPPPRI-MODREMB.                       0000000
152880                                                                  0000000
152890     IF  SAY-MGES  =  '6'                                         0000000
152900         IF  ( SAY-ASS-MENSUELLE )                                0000000
152910             If  SAY-PERDEG   = '5'                               0000000
152920                 MOVE '3'   TO  IPPPRI-MODREMB.                   0000000
152930                                                                  0000000
152940     IF  ORGS01-FEDE-LAVAL                                        0000000
152950         IF  IPPMA2-CAISSE  =  '04899'                            0000000
152960             IF  IPPMA2-LABEL-APPLI  =  'IPC'                     0000000
152970                 MOVE '9'   TO  IPPPRI-MODREMB.                   0000000
152980                                                                  0000000
152990     IF  (SAY-GAS1 = '6' AND SAY-GAS3 = '1')  or                  0000000
153000*        (SAY-GAS1 = 'Y' AND SAY-GAS3 = 'Y')                      0000000
153010         (APXTRE-FLGASS-DELEG )                                   0000000
153020           MOVE  '2' TO IPPPRI-INDASS0                            0000000
153030           MOVE '02' TO IPPPRI-INDASSUR                           0000000
153040     ELSE                                                         0000000
153050        IF (( SAI-MTASS  NUMERIC AND SAI-MTASS  NOT = ZERO)       0000000
153060         OR ( IPXCAL-O-TOT-ASS-OBL NUMERIC AND                    0000000
153070                         IPXCAL-O-TOT-ASS-OBL NOT = ZERO) )       0000000
153080           MOVE  '1' TO IPPPRI-INDASS0                            0000000
153090           MOVE '01' TO IPPPRI-INDASSUR                           0000000
153100        ELSE                                                      0000000
153110           IF ((ORGS01-FEDE-CEE)                                  0000000
153120                                                                  0000000
153130             AND   (SAY-CNAT  =  '291' OR '304')                  0000000
153140             AND  (SAY-GAS1  =  '3'                               0000000
153150              OR   SAY-GAS3  =  '3'))                             0000000
153160              MOVE  '1' TO IPPPRI-INDASS0                         0000000
153170              MOVE '01' TO IPPPRI-INDASSUR                        0000000
153180              MOVE '3'  TO IPPPRI-INDFRA.                         0000000
153190                                                                  0000000
153200     IF   (TEG-AVEC-ASS-I )                                       0000000
153210           IF   IPPPRI-INDASS0  =  '1'                            0000000
153220                MOVE  '3' TO IPPPRI-INDASS0                       0000000
153230           End-if                                                 0000000
153240     End-if                                                       0000000
153250     .                                                            0000000
153260                                                                  0000000
153270* re-positionnement  de indassur suite au teg sans assurance.     0000000
153280                                                                  0000000
153290     MOVE   ZERO  TO  IPPPRI-INDASSUR.                            0000000
153300                                                                  0000000
153310     IF   IPPMA2-LABEL-APPLI  =  'IPI'                            0000000
153320          IF               TEG-SANS-ASS-I                         0000000
153330              IF  IPXCAL-O-TOT-ASS-FAC NOT = ZERO                 0000000
153340                  MOVE  '05'  TO  IPPPRI-INDASSUR                 0000000
153350              ELSE                                                0000000
153360                 if SAI-MTASS  NUMERIC AND                        0000000
153370                    SAI-MTASS  = ZERO  and                        0000000
153380                   not (ORGS01-FEDE-CICP)                         0000000
153390                    MOVE  '00'  TO  IPPPRI-INDASSUR               0000000
153400                 else                                             0000000
153410                    MOVE  '04'  TO  IPPPRI-INDASSUR               0000000
153420                 end-if                                           0000000
153430                                                                  0000000
153440          ELSE                                                    0000000
153450              MOVE  '06'  TO  IPPPRI-INDASSUR                     0000000
153460          END-IF                                                  0000000
153470     END-IF.                                                      0000000
153480                                                                  0000000
153490     If  IPXCAL-SENIOR = 'O' or                                   0000000
153500         IPXCAL-O-ASS-FACU                                        0000000
153510         MOVE  '4'  TO  IPPPRI-INDASS0                            0000000
153520         MOVE '07'  TO  IPPPRI-INDASSUR                           0000000
153530     END-IF.                                                      0000000
153540                                                                  0000000
153550                                                                  0000000
153560D    DISPLAY 'IPPPRI-INDASSUR ' IPPPRI-INDASSUR                   0000000
153570D    DISPLAY 'SAI-MTASS ' SAI-MTASS                               0000000
153580D    DISPLAY 'MTOTASSU '  IPXCAL-O-TOT-ASS-OBL                    0000000
153590                                                                  0000000
153600     IF (( SAI-MTASS  NUMERIC AND SAI-MTASS  NOT = ZERO)          0000000
153610        OR ( IPXCAL-O-TOT-ASS-OBL NUMERIC AND                     0000000
153620                        IPXCAL-O-TOT-ASS-OBL NOT = ZERO) ) and    0000000
153630        not APXTRE-FLGASS-DELEG                                   0000000
153640                                                                  0000000
153650         IF   IPPMA2-LABEL-APPLI  =  'IPI'                        0000000
153660              MOVE  '1'   TO  D-GARCLAU (10)                      0000000
153670         ELSE                                                     0000000
153680* 2010 si ipp, 2030 ipc ass en % et 2040 ipc ass en F.            0000000
153690              MOVE  '1'   TO  D-GARCLAU (6)                       0000000
153700d    DISPLAY    'D-GARCLAU (6) '    D-GARCLAU (6)                 0000000
153710d    DISPLAY    'D-GARCLAU(10) '    D-GARCLAU (10)                0000000
153720                                                                  0000000
153730              IF   APXTRE-ENCOURS                                 0000000
153740                   PERFORM PERSONNE-ASSURE                        0000000
153750                   MOVE  '01'  TO  IPPPRI-INDASSUR                0000000
153760              ELSE                                                0000000
153770                   IF   IPPMA2-LABEL-APPLI  =  'IPP'              0000000
153780                        MOVE  '03'  TO  IPPPRI-INDASSUR           0000000
153790                   ELSE                                           0000000
153800                        MOVE  '02'  TO  IPPPRI-INDASSUR           0000000
153810                   END-IF                                         0000000
153820              END-IF                                              0000000
153830         END-IF                                                   0000000
153840     END-IF.                                                      0000000
153850                                                                  0000000
153860D    DISPLAY 'IPPPRI-INDASSUR ' IPPPRI-INDASSUR                   0000000
153870D    DISPLAY 'TAB-TYPGAR   '   TAB-TYPGAR.                        0000000
153880D    DISPLAY 'LIBAS1       '   IPPPRI-LIBAS1.                     0000000
153890D    DISPLAY 'LIBAS2       '   IPPPRI-LIBAS2.                     0000000
153900D    DISPLAY 'MODREMB      '   IPPPRI-MODREMB.                    0000000
153910D    DISPLAY 'INDASS0      '   IPPPRI-INDASS0.                    0000000
153920D    DISPLAY 'INDASSUR     '   IPPPRI-INDASSUR.                   0000000
153930D    DISPLAY ' TEG-IMMO    '   TEG-IMMO.                          0000000
153940*                                                                 0000000
153950**** IPI : CLAUSE GARANTIE ASSURANCE DES EMPRUNTEURS              0000000
153960*                                                                 0000000
153970     MOVE  ZERO   TO  IPPPRI-CODASS1  IPPPRI-CODASS2.             0000000
153980*  la zone LIBAS1 est utilise pour les dates de l'avis SGFGAS    0000000
153990*                                                                 0000000
154000     IF  NOT ( SAY-GAS1 = ZERO OR SPACE)                          0000000
154010         MOVE  SAY-GAS1    TO IPPPRI-CODASS1.                     0000000
154020                                                                  0000000
154030     IF  NOT ( SAY-GAS3 = ZERO OR SPACE)                          0000000
154040         MOVE  SAY-GAS3    TO IPPPRI-CODASS2.                     0000000
154050D    DISPLAY  'IPPPRI-CODASS1 = ' IPPPRI-CODASS1.                 0000000
154060D    DISPLAY  'IPPPRI-CODASS2 = ' IPPPRI-CODASS2.                 0000000
154070*                                                                 0000000
154080                                                                  0000000
154090*                                                                 0000000
154100     MOVE SPACE TO IPPPRI-REFERCMS.                               0000000
154110*    MOVE Z-HYPOTHEQUE TO IPPPRI-INDHYPSP.                        0000000
154120                                                                  0000000
154130     IF  IPPMA2-LABEL-APPLI  =  'IPP'                             0000000
154140         MOVE  ZERO  TO  IPPPRI-REMBANT                           0000000
154150                                                                  0000000
154160         IF  NOT  (CAI-CAIREGIM  =  4)                            0000000
154170             IF  SAY-VTAU  =  1                                   0000000
154180                 IF  NOT ((IPPMA2-2-CNAT9 (IP) > 600 AND < 610)   0000000
154190                      OR  (IPPMA2-2-CNAT (IP) = '620' OR '621')   0000000
154200                   OR  (IPPMA2-2-CNAT (IP) > '640' and < '648'))  0000000
154210                     MOVE 1  TO  IPPPRI-REMBANT.                  0000000
154220                                                                  0000000
154230*                                                                 0000000
154240     STRING   SAY-APBR '.'                                        0000000
154250              SAY-GUI  '.'                                        0000000
154260              SAY-CPT  '.'                                        0000000
154270              SAY-CLEDOM    DELIMITED BY SIZE                     0000000
154280                                 INTO IPPPRI-LERIB.               0000000
154290                                                                  0000000
154300     MOVE '0'           TO  MD-DEVISE                             0000000
154310                                                                  0000000
154320     move  say-mges         to  ipppri-mixte(2:1)                 0000000
154330     move  '0'              to  ipppri-mixte(1:1)                 0000000
154340                                                                  0000000
154350     IF  IPXPRO-CREDIT-MIXTE                                      0000000
154360d        display 'SAY-MIXT-TAUDB-V :' SAY-MIXT-TAUDB-V            0000000
154370d        display 'SAY-MIXT-TAUDB-F :' SAY-MIXT-TAUDB-F            0000000
154380d        display 'APXTRE-TAUTARPLV :' APXTRE-TAUTARPLV            0000000
154390         MOVE  '1'              TO  IPPPRI-MIXTE (1:1)            0000000
154400*--mpe pour tse : recalcul du taux si l'assurance a chang        0000000
154410         IF   SAY-MIXT-TAUDB-V  NUMERIC                           0000000
154420              If  APXTRE-ENCOURS                                  0000000
154430                  If Pret-tse-oui                                 0000000
154440                     MOVE IPPCPL-MIXT-TAUHA-V TO W-TMIXV          0000000
154450                  Else                                            0000000
154460                     compute   W-TMIXV   =                        0000000
154470                       SAY-MIXT-TAUDB-V   -  APXTRE-TAUTARPLV     0000000
154480                  End-If                                          0000000
154490                  MOVE W-TMIXV           TO  IPPPRI-MIXTV         0000000
154500              Else                                                0000000
154510                   MOVE  SAY-MIXT-TAUDB-V to  W-TMIXV             0000000
154520                   MOVE  W-TMIXV          to  IPPPRI-MIXTV        0000000
154530              END-IF                                              0000000
154540         END-IF                                                   0000000
154550                                                                  0000000
154560         IF   SAY-MIXT-TAUDB-F  NUMERIC                           0000000
154570              If  APXTRE-ENCOURS                                  0000000
154580                  If Pret-tse-oui                                 0000000
154590                     MOVE IPPCPL-MIXT-TAUHA-F TO W-TMIXF          0000000
154600                  Else                                            0000000
154610                     compute   W-TMIXF   =                        0000000
154620                         SAY-MIXT-TAUDB-F   -  APXTRE-TAUTARPLV   0000000
154630                  End-If                                          0000000
154640                  MOVE W-TMIXF         TO  IPPPRI-MIXTF           0000000
154650              Else                                                0000000
154660                   MOVE  SAY-MIXT-TAUDB-F to  W-TMIXF             0000000
154670                   MOVE  W-TMIXF          to  IPPPRI-MIXTF        0000000
154680              END-IF                                              0000000
154690         END-IF                                                   0000000
154700                                                                  0000000
154710         IF  SAY-MIXT-PCT9  NUMERIC                               0000000
154720             MOVE  SAY-MIXT-PCT9     TO  W-PCT                    0000000
154730             MOVE W-PCT              TO  IPPPRI-MIXPCF            0000000
154740             COMPUTE  W-PCT  =  100   -  W-PCT                    0000000
154750             MOVE  W-PCT             TO  IPPPRI-MIXPCV            0000000
154760         Else                                                     0000000
154770             MOVE  50                TO  IPPPRI-MIXPCF  W-PCT     0000000
154780             MOVE  50                TO  IPPPRI-MIXPCV            0000000
154790         End-if                                                   0000000
154800         PERFORM  CALCUL-INT-MIXT                                 0000000
154810         STRING  IPPPRI-MIXTE (1:1)                               0000000
154820                 IPPPRI-VARTAUX                                   0000000
154830                         DELIMITED BY SIZE                        0000000
154840                         INTO  IPPPRI-MIXTZ                       0000000
154850     End-if                                                       0000000
154860     .                                                            0000000
154870                                                                  0000000
154880d    display ' mixtz ' ipppri-mixtz.                              0000000
154890                                                                  0000000
154900                                                                  0000000
154910     IF  SAY-CALINT  =  '2'                                       0000000
154920         MOVE  ZERO  TO  IPPPRI-TEGPER                            0000000
154930                                                                  0000000
154940     ELSE                                                         0000000
154950         IF  SAY-MGES  =  '6'                                     0000000
154960             IF  SAY-PERDEG  =  '5'                               0000000
154970                 MOVE  ZERO  TO  IPPPRI-TEGPER                    0000000
154980             ELSE                                                 0000000
154990                 MOVE  '1'   TO  IPPPRI-TEGPER                    0000000
155000         ELSE                                                     0000000
155010             MOVE  '1'   TO  IPPPRI-TEGPER                        0000000
155020                                                                  0000000
155030         END-IF                                                   0000000
155040     END-IF                                                       0000000
155050                                                                  0000000
155060     if  say-ass-mensuelle                                        0000000
155070         if (say-mges    =  '6'   and                             0000000
155080             say-perdeg  =  '5'   and                             0000000
155090             IPXCAL-O-TOT-ASS-OBL NUMERIC AND                     0000000
155100                        IPXCAL-O-TOT-ASS-OBL NOT = ZERO)          0000000
155110             Move  '2'  to  ipppri-capi                           0000000
155120         Else                                                     0000000
155130             Move  '1'  to  ipppri-capi                           0000000
155140         End-if                                                   0000000
155150     Else                                                         0000000
155160         Move  '0'  to  ipppri-capi                               0000000
155170     End-if                                                       0000000
155180     .                                                            0000000
155190                                                                  0000000
155200D    DISPLAY 'capi   ' IPPPRI-CAPI.                               0000000
155210D    DISPLAY 'TEGPER ' IPPPRI-TEGPER.                             0000000
155220                                                                  0000000
155230*------------------                                               0000000
155240 CALCUL-INT-MIXT.                                                 0000000
155250*------------------                                               0000000
155260                                                                  0000000
155270     IF  SAY-MGES    =  '2'                                       0000000
155280         Perform  CALCUL-INT-MIXT-A                               0000000
155290     Else                                                         0000000
155300         Perform  CALCUL-INT-MIXT-P                               0000000
155310                                                                  0000000
155320     End-if                                                       0000000
155330     .                                                            0000000
155340                                                                  0000000
155350                                                                  0000000
155360*------------------                                               0000000
155370 CALCUL-INT-MIXT-A.                                               0000000
155380*------------------                                               0000000
155390                                                                  0000000
155400                                                                  0000000
155410     Compute  ZT-CAPI  = ( SAY-MTCRED *  w-pct ) / 100            0000000
155420*    MOVE SAY-MTCRED         TO ZT-CAPI                           0000000
155430     MOVE 1                  TO ZT-PERIO                          0000000
155440     MOVE SAY-DURAM          TO ZT-DURAM                          0000000
155450     MOVE ZERO               TO ZT-TERME                          0000000
155460     MOVE W-TMIXV            TO ZT-TAUX                           0000000
155470     MOVE '2'                TO ZT-NBDEC                          0000000
155480     MOVE '04'               TO PRTLNK-FONCTION                   0000000
155490     CALL 'ZCALLPGM'  USING  ZPRTTAUN                             0000000
155500                             ZPRTTAUN-PARMS                       0000000
155510                             PRTLNK                               0000000
155520d    display 'prtlnk         ' prtlnk                             0000000
155530     IF  PRTLNK-RC-OK                                             0000000
155540d        display 'z-totinter  av ' z-totinter                     0000000
155550d        display 'zt-terme       ' zt-terme                       0000000
155560         COMPUTE  W-TOTINTV  =                                    0000000
155570                 ( ZT-TERME  * SAY-DURAM ) - ZT-CAPI              0000000
155580         MOVE  W-TOTINTV  TO  IPPPRI-TOTINTER                     0000000
155590         COMPUTE  Z-TOTINTER = Z-TOTINTER - W-TOTINTV             0000000
155600d        display 'ipppri-totinter        ' ipppri-totinter        0000000
155610     Else                                                         0000000
155620         set  PRTLNK-RC-OK   to  true                             0000000
155630         move  space         to  PRTLNK-LIBELLE                   0000000
155640     END-IF                                                       0000000
155650     MOVE  Z-TOTINTER  TO  IPPPRI-MIXINTFX                        0000000
155660d    display 'ipppri-mixintf         ' ipppri-mixintfx            0000000
155670     .                                                            0000000
155680                                                                  0000000
155690                                                                  0000000
155700*------------------                                               0000000
155710 CALCUL-INT-MIXT-P.                                               0000000
155720*------------------                                               0000000
155730                                                                  0000000
155740     MOVE W-TMIXV            TO ZT-TAUX                           0000000
155750     COMPUTE  W-TOTINTV  =                                        0000000
155760       (((Z-TOTINTER * W-PCT) / 100) / SAY-TAUDB ) * ZT-TAUX      0000000
155770     MOVE  W-TOTINTV  TO  IPPPRI-TOTINTER                         0000000
155780     COMPUTE  Z-TOTINTER  =  Z-TOTINTER  -  W-TOTINTV             0000000
155790D    DISPLAY 'IPPPRI-TOTINTER        ' IPPPRI-TOTINTER            0000000
155800                                                                  0000000
155810     MOVE  Z-TOTINTER  TO  IPPPRI-MIXINTFX                        0000000
155820     .                                                            0000000
155830*------------------                                               0000000
155840 PERSONNE-ASSURE.                                                 0000000
155850*------------------                                               0000000
155860*  la zone LIBAS1 est utilise pour les dates de l'avis SGFGAS    0000000
155870                                                                  0000000
155880     MOVE   SAY-GAS1       TO WORK-ASVI1.                         0000000
155890     MOVE   SAY-GAS3       TO WORK-ASVI2.                         0000000
155900     MOVE      SPACE       TO IDPASS.                             0000000
155910                                                                  0000000
155920     IF   ORGS01-ASSIMILE-IDF                                     0000000
155930          MOVE '19'             TO IDPMSGX-FED                    0000000
155940     ELSE                                                         0000000
155950          MOVE IPPMA2-FED       TO IDPMSGX-FED                    0000000
155960     END-IF                                                       0000000
155970                                                                  0000000
155980     MOVE IPPMA2-CAISSE    TO IDPMSGX-CAISSE.                     0000000
155990                                                                  0000000
156000D    DISPLAY  'CODE ASS =' WORK-ASVI.                             0000000
156010*                                                                 0000000
156020*    ACCES A LA TABLE IDPFFASS                                    0000000
156030**-                                                               0000000
156040     CALL 'ZCALLPGM' USING IDPATASS                               0000000
156050                           CTL                                    0000000
156060                           IDPMSGX                                0000000
156070                           WORK-ASVI                              0000000
156080                           IDPASS                                 0000000
156090                           PCBSPI.                                0000000
156100                                                                  0000000
156110D    DISPLAY 'IDPASS     = ' IDPASS.                              0000000
156120D    DISPLAY 'PCBSPI     = ' PCBSPI.                              0000000
156130D    DISPLAY 'CTL        = ' CTL.                                 0000000
156140     IF   CTL-RETOUR NOT = ZERO                                   0000000
156150          MOVE ZERO TO CTL-RETOUR.                                0000000
156160*                                                                 0000000
156170     MOVE  SPACE    TO   IPPPRI-LIBAS1.                           0000000
156180     MOVE  SPACE    TO   IPPPRI-LIBAS2.                           0000000
156190*                                                                 0000000
156200     IF   IPPMA2-2-PERASS(1) = '1'                                0000000
156210          MOVE IDPASS-LIBELLE-1 TO IPPPRI-LIBAS1                  0000000
156220          MOVE IDPASS-LIBELLE-2 TO IPPPRI-LIBAS2                  0000000
156230          IF  NOT ( SAY-GAS1 =  SPACE)                            0000000
156240              MOVE  SAY-GAS1    TO IPPPRI-CODASS1                 0000000
156250          END-IF                                                  0000000
156260          IF  NOT ( SAY-GAS3 =  SPACE)                            0000000
156270              MOVE  SAY-GAS3    TO IPPPRI-CODASS2                 0000000
156280          END-IF                                                  0000000
156290     ELSE                                                         0000000
156300          MOVE IDPASS-LIBELLE-1 TO IPPPRI-LIBAS2                  0000000
156310          MOVE IDPASS-LIBELLE-2 TO IPPPRI-LIBAS1                  0000000
156320          IF  NOT ( SAY-GAS1 =  SPACE)                            0000000
156330              MOVE  SAY-GAS1    TO IPPPRI-CODASS2                 0000000
156340          END-IF                                                  0000000
156350          IF  NOT ( SAY-GAS3 =  SPACE)                            0000000
156360              MOVE  SAY-GAS3    TO IPPPRI-CODASS1                 0000000
156370          END-IF                                                  0000000
156380     END-IF.                                                      0000000
156390*------------------                                               0000000
156400 TRI-TABDEST.                                                     0000000
156410*------------------                                               0000000
156420     IF D-DESTTYP (I-DEST) = 'CAI' OR = 'EMP' OR = 'NOT'          0000000
156430        NEXT SENTENCE                                             0000000
156440     ELSE                                                         0000000
156450           COMPUTE JG = I-DEST + 1                                0000000
156460           PERFORM LEC-TABLE-DEST VARYING IG FROM JG BY 1         0000000
156470                                  UNTIL IG > 52                   0000000
156480                                     OR POSTE-DEST (IG) = SPACES. 0000000
156490*----------------                                                 0000000
156500 LEC-TABLE-DEST.                                                  0000000
156510*----------------                                                 0000000
156520     IF D-DESTTYP (IG) = D-DESTTYP (I-DEST)                       0000000
156530     AND D-INDEX  (IG) < D-INDEX   (I-DEST)                       0000000
156540        MOVE POSTE-DEST (I-DEST) TO TRAV-POSTE                    0000000
156550        MOVE POSTE-DEST (IG)     TO POSTE-DEST (I-DEST)           0000000
156560        MOVE TRAV-POSTE          TO POSTE-DEST (IG).              0000000
156570                                                                  0000000
156580     IF D-DESTTYP (I-DEST) = 'VEH'                                0000000
156590     AND D-DESTTYP (IG) NOT = 'VEH'                               0000000
156600        MOVE POSTE-DEST (I-DEST) TO TRAV-POSTE                    0000000
156610        MOVE POSTE-DEST (IG)     TO POSTE-DEST (I-DEST)           0000000
156620        MOVE TRAV-POSTE          TO POSTE-DEST (IG).              0000000
156630                                                                  0000000
156640     IF D-DESTTYP (I-DEST) = 'NOU'                                0000000
156650     AND (D-DESTTYP (IG) = 'CAU' OR = 'NFC' OR 'NFA')             0000000
156660        MOVE POSTE-DEST (I-DEST) TO TRAV-POSTE                    0000000
156670        MOVE POSTE-DEST (IG)     TO POSTE-DEST (I-DEST)           0000000
156680        MOVE TRAV-POSTE          TO POSTE-DEST (IG).              0000000
156690                                                                  0000000
156700     IF (D-DESTTYP (I-DEST) = 'NFC' OR 'NFA')                     0000000
156710     AND D-DESTTYP (IG) = 'CAU'                                   0000000
156720        MOVE POSTE-DEST (I-DEST) TO TRAV-POSTE                    0000000
156730        MOVE POSTE-DEST (IG)     TO POSTE-DEST (I-DEST)           0000000
156740        MOVE TRAV-POSTE          TO POSTE-DEST (IG).              0000000
156750                                                                  0000000
156760*-------------                                                    0000000
156770 TRI-VARTAUX.                                                     0000000
156780*-------------                                                    0000000
156790     COMPUTE JG = ICLAU + 1.                                      0000000
156800     PERFORM TEST-VARTAUX VARYING IG FROM JG BY 1                 0000000
156810                                  UNTIL IG > 10.                  0000000
156820*----------------                                                 0000000
156830 TEST-VARTAUX.                                                    0000000
156840*----------------                                                 0000000
156850     IF D-VARTAUX (IG) NOT = ZERO                                 0000000
156860        IF D-VARTAUX (IG) < D-VARTAUX (ICLAU)                     0000000
156870        OR D-VARTAUX (ICLAU) = ZERO                               0000000
156880                                                                  0000000
156890        MOVE D-VARTAUX-TOUT (ICLAU) TO W-TOUT                     0000000
156900        MOVE D-VARTAUX-TOUT (IG)    TO D-VARTAUX-TOUT (ICLAU)     0000000
156910        MOVE W-TOUT                 TO D-VARTAUX-TOUT (IG).       0000000
156920                                                                  0000000
156930*          MOVE D-VARTAUX (ICLAU) TO W-VARTAUX                    0000000
156940*          MOVE D-VARTAUX (IG)    TO D-VARTAUX (ICLAU)            0000000
156950*          MOVE W-VARTAUX         TO D-VARTAUX (IG).              0000000
156960* pas de fusion si chatel                                         0000000
156970                                                                  0000000
156980     IF ( D-VARTAUX (ICLAU)  <  1000  or                          0000000
156990          D-VARTAUX (ICLAU)  >  2000  )                           0000000
157000          IF D-VARTAUX (IG) = D-VARTAUX (ICLAU)                   0000000
157010             MOVE ZERO              TO D-VARTAUX-TOUT (IG).       0000000
157020                                                                  0000000
157030*-------------                                                    0000000
157040 TRI-AUTRECL.                                                     0000000
157050*-------------                                                    0000000
157060     COMPUTE JG = ICLAU + 1.                                      0000000
157070     PERFORM TEST-AUTRECL VARYING IG FROM JG BY 1                 0000000
157080                                  UNTIL IG > NB-CLA.              0000000
157090*----------------                                                 0000000
157100 TEST-AUTRECL.                                                    0000000
157110*----------------                                                 0000000
157120     IF D-AUTRES (IG) NOT = ZERO                                  0000000
157130        IF D-AUTRES (IG) < D-AUTRES (ICLAU)                       0000000
157140        OR D-AUTRES (ICLAU) = ZERO                                0000000
157150           MOVE D-AUTRES-TOUT (ICLAU) TO W-AUTRES                 0000000
157160           MOVE D-AUTRES-TOUT (IG)    TO D-AUTRES-TOUT (ICLAU)    0000000
157170           MOVE W-AUTRES              TO D-AUTRES-TOUT (IG).      0000000
157180                                                                  0000000
157190     IF D-AUTRES (IG) = D-AUTRES (ICLAU)                          0000000
157200        MOVE ZERO TO D-AUTRES-TOUT (IG).                          0000000
157210                                                                  0000000
157220*----------------                                                 0000000
157230 CALL-IPPBATC1.                                                   0000000
157240*----------------                                                 0000000
157250     MOVE SPACE              TO ZONE-DOCU.                        0000000
157260     MOVE ZERO               TO CTL-R34.                          0000000
157270     MOVE ZERO               TO CTL-R12.                          0000000
157280                                                                  0000000
157290     Evaluate TRUE                                                0000000
157300       When NOT 88-entete-init                                    0000000
157310       When Dido-Etat = zero                                      0000000
157320         Continue                                                 0000000
157330                                                                  0000000
157340       When Appel-Appli = 'GPR' Or 'GP2'                          0000000
157350         If Appel-Fed = '13'                                      0000000
157360           Or ( Appel-Fed = '11' And ORGS01-ASSIMILE-CMA )        0000000
157370             Set  88-Entete-CMS  TO True                          0000000
157380*--  Move 'Envoi  C M S  CREDIT - ANGERS '          to cai-cainom0000000
157390         End-If                                                   0000000
157400                                                                  0000000
157410       When Appel-Appli NOT = 'IPC'                               0000000
157420         Set  88-Entete          To  true                         0000000
157430                                                                  0000000
157440       When Appel-Fed = '13'                                      0000000
157450         Set  88-Entete-CMO-C    To  true                         0000000
157460*--  Move 'Envoi au service courrier CMO - La ROCHE' to cai-cainom0000000
157470                                                                  0000000
157480       When Appel-Fed = '11' And ORGS01-ASSIMILE-CMA              0000000
157490         Set  88-Entete-CMA-C    To  true                         0000000
157500*--  Move 'Envoi au service courrier CMA - ANGERS  ' to cai-cainom0000000
157510     End-Evaluate                                                 0000000
157520     .                                                            0000000
157530                                                                  0000000
157540                                                                  0000000
157550d    display 'ZONE1-STOCK   '  ZONE1-STOCK                        0000000
157560d    display 'ZONE2-STOCK   '  ZONE2-STOCK                        0000000
157570d    display 'IPPEDG-STOCK1 '  IPPEDG-STOCK(1)                    0000000
157580d    display 'IPPEDG-STOCK2 '  IPPEDG-STOCK(2)                    0000000
157590d    move     IPPEDG-STOCK(01) to IPPEDG                          0000000
157600d    display 'IPPEDG-CAU1TITR1 1 ' IPPEDG-CAU1TITR                0000000
157610d    display 'IPPEDG-CAU1PRNM1 1 ' IPPEDG-CAU1PRNM                0000000
157620d    display 'IPPEDG-CAU1NOM 1 1 ' IPPEDG-CAU1NOM                 0000000
157630                                                                  0000000
157640d    move     IPPEDG-STOCK(02) to IPPEDG                          0000000
157650d    display 'IPPEDG-CAU1TITR1 2 ' IPPEDG-CAU1TITR                0000000
157660d    display 'IPPEDG-CAU1PRNM1 2 ' IPPEDG-CAU1PRNM                0000000
157670d    display 'IPPEDG-CAU1NOM 1 2 ' IPPEDG-CAU1NOM                 0000000
157680                                                                  0000000
157690d    move     IPPEDG-STOCK(09) to IPPEDG                          0000000
157700d    display 'IPPEDG-CAU1TITR2 1 ' IPPEDG-CAU1TITR                0000000
157710d    display 'IPPEDG-CAU1PRNM2 1 ' IPPEDG-CAU1PRNM                0000000
157720d    display 'IPPEDG-CAU1NOM 2 1 ' IPPEDG-CAU1NOM                 0000000
157730                                                                  0000000
157740d    move     IPPEDG-STOCK(10) to IPPEDG                          0000000
157750d    display 'IPPEDG-CAU1TITR2 2 ' IPPEDG-CAU1TITR                0000000
157760d    display 'IPPEDG-CAU1PRNM2 2 ' IPPEDG-CAU1PRNM                0000000
157770d    display 'IPPEDG-CAU1NOM 2 2 ' IPPEDG-CAU1NOM                 0000000
157780                                                                  0000000
157790d    display 'ZONE3-STOCK   '  ZONE3-STOCK                        0000000
157800d    display 'ZONE4-STOCK   '  ZONE4-STOCK                        0000000
157810*                                                                 0000000
157820D    DISPLAY  'TABL2-STOCK 1   ' TABL2-STOCK (1) (501 : 287)      0000000
157830D    DISPLAY  'IPPPRI-MTOTHYP  ' IPPPRI-MTOTHYP                   0000000
157840D    DISPLAY  'IPPPRI-TTAUTO   ' IPPPRI-TTAUTO                    0000000
157850D    DISPLAY  'IPPPRI-DURFRANC ' IPPPRI-DURFRANC                  0000000
157860D    DISPLAY  'IPPPRI-DATEJ    ' IPPPRI-DATEJ.                    0000000
157870D    DISPLAY  'ZONE1-STOCK     ' ZONE1-STOCK.                     0000000
157880D    DISPLAY  'IPPPRI-INDTZ av ' IPPPRI-INDTZ.                    0000000
157890D    DISPLAY  'IPPPRI-MIXTE AV ' IPPPRI-MIXTE.                    0000000
157900D    DISPLAY  'rdegoethe '                                        0000000
157910D    DISPLAY  'IPPPRI-eigmar   ' IPPPRI-eigmar                    0000000
157920D    DISPLAY  'prescau         ' ZONE1-STOCK(1993 : 1)            0000000
157930D    DISPLAY  'IPPRGT-TXRETENUX' IPPRGT-TXRETENUX                 0000000
157940D        DISPLAY 'CAI-SAV-ADR12'    CAI-SAV-ADR1                  0000000
157950D        DISPLAY 'CAI-SAV-ADR22'    CAI-SAV-ADR2                  0000000
157960D        DISPLAY 'CAI-SAV-ADR32'    CAI-SAV-ADR3                  0000000
157970D        DISPLAY 'gar-eb-prevue'    gar-eb-prevue                 0000000
157980D        DISPLAY 'gar-ec-prevue'    gar-ec-prevue                 0000000
157990D    DISPLAY 'Chatel1'    CHA-PAL(1)                              0000000
158000D    DISPLAY 'Chatel2'    CHA-PAL(2)                              0000000
158010D    DISPLAY 'Chatel3'    CHA-PAL(3)                              0000000
158020D    DISPLAY 'IPPPRI-INDPRSAL ' IPPPRI-INDPRSAL                   0000000
158030                                                                  0000000
158040     IF  EDIT-TEST                                                0000000
158050D    DISPLAY 'EDIT-TEST '                                         0000000
158060D    DISPLAY   CST-TESTI                                          0000000
158070             MOVE 'T'   TO EDITION-GAGE-ONLY.                     0000000
158080                                                                  0000000
158090     CALL 'ZCALLPGM' USING IPPBATC1                               0000000
158100                                PCBSPI                            0000000
158110                                IPPCAI                            0000000
158120                                PGM-REFUNIC                       0000000
158130                                ZDEBPGM-DATES-AND-CO              0000000
158140                                ZONE1-STOCK                       0000000
158150                                ZONE2-STOCK                       0000000
158160                                ZONE3-STOCK                       0000000
158170                                ZONE4-STOCK                       0000000
158180                                PRTCO41                           0000000
158190                                PRTCO42                           0000000
158200                                PRTCO43                           0000000
158210                                PRTCO44                           0000000
158220                                IDPTAM                            0000000
158230                                ZONE5-STOCK                       0000000
158240                                FEDIT-STOCK                       0000000
158250                                IDPSTA                            0000000
158260                                INDIC-TRAIT                       0000000
158270                                TABLE-DESTINATAIRES               0000000
158280                                CLAUSIER-VARTAUX                  0000000
158290                                CLAUSIER-TYPGAR                   0000000
158300                                CLAUSIER-AUTRES                   0000000
158310                                DONNEES-PLF                       0000000
158320                                ZONE6-STOCK                       0000000
158330                                W-TAB-GAR                         0000000
158340                                TEST-1                            0000000
158350                                CTL                               0000000
158360                                CODE-INSEE                        0000000
158370                                LCHATEL.                          0000000
158380                                                                  0000000
158390D    DISPLAY 'AAM - APPEL IPPBATC1 '                              0000000
158400D    DISPLAY 'AAM - CTL-R34 = ' CTL-R34                           0000000
158410     IF  CTL-R34 NOT = ZERO                                       0000000
158420         MOVE  45  TO TEST-1                                      0000000
158430         PERFORM  TRAIT-ANOMALIE                                  0000000
158440     ELSE                                                         0000000
158450         if   88-IPPBATC1-CONT                                    0000000
158460          and  NOT ( AVENANT  OR CONTRAT-GPR )                    0000000
158470             IF  IPPMA2-LABEL-APPLI  =  'IPI'                     0000000
158480                  ADD  1  TO  CPT-IPI                             0000000
158490             ELSE                                                 0000000
158500               IF  IPPMA2-LABEL-APPLI  =  'IPC'                   0000000
158510                    ADD  1  TO  CPT-IPC                           0000000
158520               ELSE                                               0000000
158530                    ADD  1  TO  CPT-IPP                           0000000
158540               END-IF                                             0000000
158550             END-IF                                               0000000
158560         END-IF                                                   0000000
158570     END-IF.                                                      0000000
158580                                                                  0000000
158590*-------------------------                                        0000000
158600 TRAIT-BANQUE-G.                                                  0000000
158610*-------------------------                                        0000000
158620*                                                                 0000000
158630                                                                  0000000
158640     PERFORM  APPEL-ZORGFBCG.                                     0000000
158650                                                                  0000000
158660                                                                  0000000
158670*    ****************************                                 0000000
158680*    *   GENERATION DES ETATS   *                                 0000000
158690*    *         CONTROLES        *                                 0000000
158700*    *         FACTURES         *                                 0000000
158710*    *         ANOMALIES        *                                 0000000
158720*    ****************************                                 0000000
158730                                                                  0000000
158740*-------------------------                                        0000000
158750*TRAIT-CONTROLE.                                                  0000000
158760*-------------------------                                        0000000
158770*    PERFORM ECRITURE-CONTROLE                                    0000000
158780*            VARYING IT FROM 1 BY 1                               0000000
158790*              UNTIL LIG-STOCK (IT) = SPACES.                     0000000
158800*                                                                 0000000
158810*-------------------------                                        0000000
158820 TRAIT-ANOMALIE-GRAVE.                                            0000000
158830*-------------------------                                        0000000
158840     MOVE  100  TO  NOMBRE-ANOMALIE.                              0000000
158850     PERFORM TRAIT-ANOMALIE.                                      0000000
158860                                                                  0000000
158870*-------------------------                                        0000000
158880 TRAIT-ANOMALIE.                                                  0000000
158890*-------------------------                                        0000000
158900                                                                  0000000
158910     MOVE SPACE           TO LIGNE-ANOM.                          0000000
158920     MOVE IPPMA2-CAISSE   TO LIG-ANOM-CAISSE.                     0000000
158930     MOVE IPPMA2-RACINE   TO LIG-ANOM-RACINE.                     0000000
158940     MOVE IPPMA2-DOSS          TO LIG-ANOM-DOSSIER.               0000000
158950     MOVE IPPMA2-LABEL-APPLI   TO LIG-ANOM-LABEL.                 0000000
158960     IF IND-ANOM = 0                                              0000000
158970        MOVE SPACE        TO LIG-ANOM-CATEGORIE                   0000000
158980        MOVE SPACE        TO LIG-ANOM-TYPE                        0000000
158990     ELSE                                                         0000000
159000        MOVE IPPMA2-2-CAT (IND-ANOM) TO LIG-ANOM-CATEGORIE        0000000
159010        MOVE Z-TYPPRET    TO LIG-ANOM-TYPE.                       0000000
159020     MOVE TEST-1          TO LIG-ANOM-TEST.                       0000000
159030     MOVE LIB-ANOM (TEST-1) TO LIG-ANOM-MOTIF.                    0000000
159040* Pas de message anomalie si le dossier a ete supprim de IPPMA2  0000000
159050*                                                                 0000000
159060     IF  NOT  (TEST-1   =  28 )                                   0000000
159070         ADD  1  TO NOMBRE-ANOMALIE                               0000000
159080         MOVE  NOMBRE-ANOMALIE TO  LIG-ANOM-NB                    0000000
159090         PERFORM TRAITEMENT-LIGNE-DETAIL-A.                       0000000
159100                                                                  0000000
159110     IF  NOMBRE-ANOMALIE  >  100                                  0000000
159120         PERFORM  RECYCLAGE-INFO                                  0000000
159130                            UNTIL  FF-APPEL NOT = ZERO            0000000
159140         MOVE       40        TO  CTL-R34                         0000000
159150         MOVE       40        TO  TEST-1                          0000000
159160         MOVE SPACE           TO LIGNE-ANOM                       0000000
159170         PERFORM TRAITEMENT-LIGNE-DETAIL-A                        0000000
159180         MOVE LIB-ANOM (TEST-1) TO LIG-ANOM-MOTIF                 0000000
159190         PERFORM TRAITEMENT-LIGNE-DETAIL-A                        0000000
159200     ELSE                                                         0000000
159210         PERFORM  ECRITURE-RECYCLE                                0000000
159220         SET  DOSSIER-KO  TO TRUE                                 0000000
159230         MOVE  ZERO  TO  CTL-R34.                                 0000000
159240*                                                                 0000000
159250 WARNING-1.                                                       0000000
159260                                                                  0000000
159270        Move  space  to  ligne-anom                               0000000
159280        String   IPPMA2-CAISSE ' '                                0000000
159290                 IPPMA2-RACINE ' '                                0000000
159300                 IPPMA2-DOSS                                      0000000
159310                '  C est un nouveau PTZ ' delimited by size       0000000
159320                            into LIGNE-ANOM                       0000000
159330         PERFORM TRAITEMENT-LIGNE-DETAIL-A                        0000000
159340     .                                                            0000000
159350*                                                                 0000000
159360* EN CAS DE FIN ANORMALE (+ DE NN ANOMALIE) ON RECYCLE LE FICHIER 0000000
159370*   APPEL POUR LE TRAITEMENT SUIVANT.                             0000000
159380*                                                                 0000000
159390*                                                                 0000000
159400                                                                  0000000
159410 RECYCLAGE-INFO.                                                  0000000
159420                                                                  0000000
159430     PERFORM  ECRITURE-RECYCLE.                                   0000000
159440                                                                  0000000
159450     IF  FF-APPEL  =  ZERO                                        0000000
159460         PERFORM LECTURE-APPEL.                                   0000000
159470                                                                  0000000
159480                                                                  0000000
159490 TRAITEMENT-LIGNE-DETAIL-A.                                       0000000
159500*-------------------------                                        0000000
159510     MOVE LIGNE-ANOM    TO LIGNE-A.                               0000000
159520d    display ' anomalie*****'                                     0000000
159530d    display  ligne-a                                             0000000
159540d    display ' anomalie*****'                                     0000000
159550     PERFORM ECRITURE-ANOMALIE.                                   0000000
159560                                                                  0000000
159570                                                                  0000000
159580*           *************************************                 0000000
159590*           *************************************                 0000000
159600*           ***                               ***                 0000000
159610*           ***      O P E R A T I O N S      ***                 0000000
159620*           ***                               ***                 0000000
159630*           ***        D ' E N T R E E        ***                 0000000
159640*           ***                               ***                 0000000
159650*           ***           S O R T I E         ***                 0000000
159660*           ***                               ***                 0000000
159670*           *************************************                 0000000
159680*           *************************************                 0000000
159690*                                                                 0000000
159700*-------------------------  FICHIER SAISIE  ------------          0000000
159710 LECTURE-APPEL.                                                   0000000
159720*-------------------------                                        0000000
159730D    DISPLAY 'LECTURE-APPEL : '.                                  0000000
159740     MOVE ZERO TO ZREF-FCRD.                                      0000000
159750     READ FAPPEL  INTO APPEL                                      0000000
159760                  AT END MOVE 1 TO FF-APPEL.                      0000000
159770     IF   FF-APPEL = 0                                            0000000
159780          MOVE APPEL-CLE  TO ZREF-FCRD  w-fcrd                    0000000
159790d         DISPLAY 'APPEL-APPLI ' APPEL-APPLI                      0000000
159800d         DISPLAY 'APPEL-CLE : ' APPEL-CLE                        0000000
159810          ADD 1           TO CPT-APPEL                            0000000
159820                                                                  0000000
159830          IF    APPEL-APPLI  = 'GP3'                              0000000
159840                set tordu to true                                 0000000
159850                move  'GPR'  to  APPEL-APPLI                      0000000
159860          Else                                                    0000000
159870                set normal to true                                0000000
159880          end-if                                                  0000000
159890                                                                  0000000
159900          IF    APPEL-APPLI  = 'GPR'                              0000000
159910               SET  AVENANT  TO  TRUE                             0000000
159920          ELSE                                                    0000000
159930            IF    APPEL-APPLI  = 'GP2'                            0000000
159940                  if  appli-fed  =  '20'                          0000000
159950                      SET  CONTRAT-GPR  TO  TRUE                  0000000
159960                  else                                            0000000
159970                      SET  AVENANT      TO  TRUE                  0000000
159980                  End-if                                          0000000
159990            ELSE                                                  0000000
160000                  SET  CONTRAT  TO  TRUE.                         0000000
160010                                                                  0000000
160020*-------------------------  BASE MASTER  ---------------          0000000
160030 LECTURE-IPPMA2-GU.                                               0000000
160040*-------------------------                                        0000000
160050                                                                  0000000
160060     MOVE SPACE        TO IPPMA2.                                 0000000
160070     MOVE ZREF-FCRD    TO IPPMA2-CLE.                             0000000
160080D    DISPLAY 'LECTURE MASTER GU / CLE ' IPPMA2-CLE.               0000000
160090     MOVE ZERO TO CTL-R34.                                        0000000
160100     MOVE 'EQ'         TO CODOP-SSA-IPPMA2.                       0000000
160110*                                                                 0000000
160120     Set  IPXESM-S-LM900-GAR3-NON  to  true                       0000000
160130     Set 88-gar1   to  true                                       0000000
160140                                                                  0000000
160150     Perform  Appel-ipxzma2g                                      0000000
160160                                                                  0000000
160170*** COMPTEUR DE PRETS EN DEVISE.                                  0000000
160180     IF   CTL-R34 = ZERO                                          0000000
160190         IF  IPPMA2-DEVISE  =  SPACE                              0000000
160200             MOVE  'EUR'  TO IPPMA2-DEVISE                        0000000
160210         END-IF                                                   0000000
160220         IF  (IPPMA2-DEVISE  =   'EUR')                           0000000
160230             ADD  1 TO CPT-PRETEUR                                0000000
160240         ELSE                                                     0000000
160250             ADD  1 TO CPT-PRETDEV.                               0000000
160260                                                                  0000000
160270     IF   CTL-R34 = ZERO                                          0000000
160280          ADD   1       TO  CPT-IPPMA2                            0000000
160290                                                                  0000000
160300          IF  CONTRAT OR  CONTRAT-GPR                             0000000
160310              SET  IPPMA2-TROUVE   TO  TRUE                       0000000
160320              MOVE  0       TO  TEST-1                            0000000
160330          ELSE                                                    0000000
160340              IF ((IPPMA2-EMP-TITUL  =  ZERO OR SPACE)  OR        0000000
160350                   IPPMA2-EXIST-OBJ  NOT  =  '1')                 0000000
160360                   SET  PAS-DE-IPPMA2   TO  TRUE                  0000000
160370                   PERFORM  INIT-IPPMA2                           0000000
160380              ELSE                                                0000000
160390                   SET  IPPMA2-TROUVE   TO  TRUE                  0000000
160400              END-IF                                              0000000
160410     ELSE                                                         0000000
160420        SET  PAS-DE-IPPMA2   TO  TRUE                             0000000
160430        IF  CONTRAT OR  CONTRAT-GPR                               0000000
160440              MOVE 28      TO TEST-1                              0000000
160450              PERFORM  TRAIT-ANOMALIE                             0000000
160460        ELSE                                                      0000000
160470              MOVE  ZERO     TO CTL-R34                           0000000
160480              PERFORM  INIT-IPPMA2.                               0000000
160490                                                                  0000000
160500 INIT-IPPMA2.                                                     0000000
160510                                                                  0000000
160520     INITIALIZE  IPPMA2.                                          0000000
160530     MOVE ZREF-FCRD    TO IPPMA2-CLE.                             0000000
160540     MOVE APPEL-CAT    TO IPPMA2-2-CAT(1).                        0000000
160550                                                                  0000000
160560*-------------------------  BASE COMPLEMENT ------------          0000000
160570 LECTURE-IPPCPL-GU.                                               0000000
160580*-------------------------                                        0000000
160590                                                                  0000000
160600     MOVE SPACE           TO IPPCPL-DONNEES.                      0000000
160610     MOVE ZERO            TO CTL-R34.                             0000000
160620     MOVE IPPMA2-FED      TO IPPCPL-FED.                          0000000
160630     MOVE IPPMA2-CAISSE   TO IPPCPL-CAISSE.                       0000000
160640     MOVE IPPMA2-RACINE   TO IPPCPL-RACINE.                       0000000
160650     MOVE IPPMA2-DOSS     TO IPPCPL-DOSS.                         0000000
160660D    DISPLAY 'LECTURE IPPCPL GU / CLE ' IPPCPL-CLE.               0000000
160670     MOVE 'EQ'            TO CODOP-SSA-IPPCPL.                    0000000
160680     CALL 'ZCALLPGM' USING IPPABCPL                               0000000
160690                           GU                                     0000000
160700                           CODOP-SSA-IPPCPL                       0000000
160710                           PCBCPL                                 0000000
160720                           IPPCPL                                 0000000
160730                           CTL.                                   0000000
160740                                                                  0000000
160750D    DISPLAY 'LECTURE IPPCPL GU / CTL ' CTL.                      0000000
160760D    DISPLAY 'LECTURE IPPCPL          ' IPPCPL                    0000000
160770D    DISPLAY '----------------------- '.                          0000000
160780     IF   CTL-R34 = ZERO                                          0000000
160790          ADD   1  TO  CPT-IPPCPL                                 0000000
160800          MOVE  1  TO  EXIST-IPPCPL                               0000000
160810        IF  IPPCPL-CODENR  =  'G'                                 0000000
160820              MOVE  IPPCPL-PRTSAY TO  PRTSAYT                     0000000
160830        END-IF                                                    0000000
160840                                                                  0000000
160850     ELSE                                                         0000000
160860     MOVE  ZEROS  TO  EXIST-IPPCPL                                0000000
160870          DISPLAY 'LECTURE IPPCPL GU / CLE ' IPPCPL-CLE           0000000
160880          DISPLAY 'ctl ' ctl                                      0000000
160890          MOVE 34      TO TEST-1                                  0000000
160900          PERFORM  TRAIT-ANOMALIE                                 0000000
160910          MOVE ZERO TO CTL-R34.                                   0000000
160920                                                                  0000000
160930 LECTURE-IPPCPL-R.                                                0000000
160940*-------------------------                                        0000000
160950                                                                  0000000
160960     MOVE SPACE           TO IPPCPLR-DONNEES.                     0000000
160970     MOVE ZERO            TO CTL-R34.                             0000000
160980     MOVE IPPMA2-FED      TO IPPCPLR-FED.                         0000000
160990     MOVE IPPMA2-CAISSE   TO IPPCPLR-CAISSE.                      0000000
161000     MOVE IPPMA2-RACINE   TO IPPCPLR-RACINE.                      0000000
161010     MOVE IPPMA2-DOSS     TO IPPCPLR-DOSS.                        0000000
161020     MOVE 'R'             TO IPPCPLR-CODENR                       0000000
161030     MOVE ZERO            TO IPPCPLR-CAT.                         0000000
161040D    DISPLAY 'LECTURE IPPCPLB GU / CLE ' IPPCPLR-CLE.             0000000
161050     MOVE 'EQ'            TO CODOP-SSA-IPPCPL.                    0000000
161060     CALL 'ZCALLPGM' USING IPPABCPL                               0000000
161070                           GU                                     0000000
161080                           CODOP-SSA-IPPCPL                       0000000
161090                           PCBCPL                                 0000000
161100                           IPPCPLR                                0000000
161110                           CTL.                                   0000000
161120                                                                  0000000
161130D    DISPLAY 'LECTURE IPPCPLR GU / CTL ' CTL.                     0000000
161140D    DISPLAY '----------------------- '.                          0000000
161150                                                                  0000000
161160     IF   CTL-R34 = 'GE' OR 'GB'                                  0000000
161170         DISPLAY 'LECTURE IPPCPLR GU / CLE ' IPPCPL-CLE           0000000
161180         MOVE 34      TO TEST-1                                   0000000
161190         PERFORM  TRAIT-ANOMALIE                                  0000000
161200         MOVE ZERO TO CTL-R34.                                    0000000
161210                                                                  0000000
161220 LECTURE-PRET-IDCHAB.                                             0000000
161230*--------------------                                             0000000
161240                                                                  0000000
161250     initialize ichcom                                            0000000
161260     Set ICHCOM-ICHPPRT-LEC-PRT   to true                         0000000
161270     String ORGS01-BANQUE                                         0000000
161280            APPEL-CAI                                             0000000
161290            '000'  APPEL-RAC                                      0000000
161300            APPEL-CAT                                             0000000
161310          delimited by size    into YICHPRT-PRT-REF               0000000
161320d    display 'Pret recherch :' YICHPRT-PRT-REF                   0000000
161330                                                                  0000000
161340     CALL 'ZCALLPGM' USING  ICHPPRT                               0000000
161350                            ICHCOM                                0000000
161360                            ICHPRT                                0000000
161370                                                                  0000000
161380d    display 'ichcom :' ichcom                                    0000000
161390     Evaluate true                                                0000000
161400        When ICHCOM-RET-OK                                        0000000
161410           continue                                               0000000
161420d          display 'YICHPRT-PTZ-BAR :' YICHPRT-PTZ-BAR            0000000
161430        When other                                                0000000
161440           Move 65      to TEST-1                                 0000000
161450           PERFORM  TRAIT-ANOMALIE                                0000000
161460           MOVE ZERO    TO CTL-R34                                0000000
161470     End-evaluate                                                 0000000
161480     .                                                            0000000
161490                                                                  0000000
161500 LECTURE-IPPCPL-B.                                                0000000
161510*-------------------------                                        0000000
161520                                                                  0000000
161530     MOVE SPACE           TO IPPCPLB-DONNEES.                     0000000
161540     MOVE ZERO            TO CTL-R34.                             0000000
161550     MOVE IPPMA2-FED      TO IPPCPLB-FED.                         0000000
161560     MOVE IPPMA2-CAISSE   TO IPPCPLB-CAISSE.                      0000000
161570     MOVE IPPMA2-RACINE   TO IPPCPLB-RACINE.                      0000000
161580     MOVE IPPMA2-DOSS     TO IPPCPLB-DOSS.                        0000000
161590     MOVE 'B'             TO IPPCPLB-CODENR                       0000000
161600     MOVE ZERO            TO IPPCPLB-CAT.                         0000000
161610D    DISPLAY 'LECTURE IPPCPLB GU / CLE ' IPPCPLB-CLE.             0000000
161620     MOVE 'EQ'            TO CODOP-SSA-IPPCPL.                    0000000
161630     CALL 'ZCALLPGM' USING IPPABCPL                               0000000
161640                           GU                                     0000000
161650                           CODOP-SSA-IPPCPL                       0000000
161660                           PCBCPL                                 0000000
161670                           IPPCPLB                                0000000
161680                           CTL.                                   0000000
161690                                                                  0000000
161700D    DISPLAY 'LECTURE IPPCPLB GU / CTL ' CTL.                     0000000
161710D    DISPLAY '----------------------- '.                          0000000
161720     IF   CTL-R34  =  ZERO                                        0000000
161730          MOVE  1 TO  EXIST-OBJET-PRT                             0000000
161740     ELSE                                                         0000000
161750          MOVE  ZERO  TO  EXIST-OBJET-PRT                         0000000
161760          MOVE  ZERO  TO  CTL-R34.                                0000000
161770                                                                  0000000
161780 LECTURE-IPPCPL-O.                                                0000000
161790*-------------------------                                        0000000
161800                                                                  0000000
161810     MOVE SPACE           TO IPPCPLO-DONNEES.                     0000000
161820     MOVE ZERO            TO CTL-R34.                             0000000
161830     MOVE IPPMA2-FED      TO IPPCPLO-FED.                         0000000
161840     MOVE IPPMA2-CAISSE   TO IPPCPLO-CAISSE.                      0000000
161850     MOVE IPPMA2-RACINE   TO IPPCPLO-RACINE.                      0000000
161860     MOVE IPPMA2-DOSS     TO IPPCPLO-DOSS.                        0000000
161870     MOVE 'O'             TO IPPCPLO-CODENR                       0000000
161880     MOVE ZERO            TO IPPCPLO-CAT.                         0000000
161890D    DISPLAY 'LECTURE IPPCPL GU / CLE ' IPPCPLO-CLE.              0000000
161900     MOVE 'EQ'            TO CODOP-SSA-IPPCPL.                    0000000
161910     CALL 'ZCALLPGM' USING IPPABCPL                               0000000
161920                           GU                                     0000000
161930                           CODOP-SSA-IPPCPL                       0000000
161940                           PCBCPL                                 0000000
161950                           IPPCPLO                                0000000
161960                           CTL.                                   0000000
161970                                                                  0000000
161980D    DISPLAY 'LECTURE IPPCPL GU / CTL ' CTL.                      0000000
161990D    DISPLAY '----------------------- '.                          0000000
162000     IF   CTL-R34  =  ZERO                                        0000000
162010          MOVE  1 TO  EXIST-OBJET-PRT                             0000000
162020     ELSE                                                         0000000
162030          MOVE  ZERO  TO  EXIST-OBJET-PRT                         0000000
162040          MOVE  ZERO  TO  CTL-R34.                                0000000
162050                                                                  0000000
162060 LECTURE-IPPCPL-E.                                                0000000
162070*------------------ eig --                                        0000000
162080                                                                  0000000
162090     MOVE SPACE           TO IPPCPLE-DONNEES.                     0000000
162100     MOVE ZERO            TO CTL-R34.                             0000000
162110     MOVE IPPMA2-FED      TO IPPCPLE-FED.                         0000000
162120     MOVE IPPMA2-CAISSE   TO IPPCPLE-CAISSE.                      0000000
162130     MOVE IPPMA2-RACINE   TO IPPCPLE-RACINE.                      0000000
162140     MOVE IPPMA2-DOSS     TO IPPCPLE-DOSS.                        0000000
162150     MOVE 'E'             TO IPPCPLE-CODENR                       0000000
162160     MOVE SAY-CAT         TO IPPCPLE-CAT.                         0000000
162170D    DISPLAY 'LECTURE IPPCPL GU / CLE ' IPPCPLE-CLE.              0000000
162180     MOVE 'EQ'            TO CODOP-SSA-IPPCPL.                    0000000
162190     CALL 'ZCALLPGM' USING IPPABCPL                               0000000
162200                           GU                                     0000000
162210                           CODOP-SSA-IPPCPL                       0000000
162220                           PCBCPL                                 0000000
162230                           IPPCPLE                                0000000
162240                           CTL.                                   0000000
162250                                                                  0000000
162260D    DISPLAY 'LECTURE IPPCPL GU / CTL ' CTL.                      0000000
162270D    DISPLAY  IPPCPLE-EIG-LIBAC1                                  0000000
162280D    DISPLAY  IPPCPLE-EIG-LIBAC2                                  0000000
162290     IF   CTL-R34  =  ZERO                                        0000000
162300          MOVE  1 TO  EXIST-CPL-EIG                               0000000
162310     ELSE                                                         0000000
162320          MOVE  ZERO  TO  EXIST-CPL-EIG                           0000000
162330          MOVE  ZERO  TO  CTL-R34.                                0000000
162340                                                                  0000000
162350******************************************************************0000000
162360*  RECHERCHE DES ADRESSES DES EMPRUNTEURS OU COEMPRUNTEURS       *0000000
162370******************************************************************0000000
162380 RECHERCHE-ADRESSE.                                               0000000
162390                                                                  0000000
162400     MOVE SPACES           TO  CLIRAD.                            0000000
162410*    ** SI L'ADR. COURRIER N'EXISTE PAS, ON PRENDRA L'ADR. LEGALE 0000000
162420     MOVE ' '   TO CLIRAD-TYPTRT.                                 0000000
162430*    ** RECHERCHE PAR PROGRAMME BATCH                             0000000
162440     MOVE '2'   TO CLIRAD-APPEL.                                  0000000
162450*    ** LECTURE D'UNE ADRESSE                                     0000000
162460     MOVE '1'   TO CLIRAD-ACTION.                                 0000000
162470                                                                  0000000
162480     MOVE '123' TO CLIRAD-ZKSDSNR.                                0000000
162490     MOVE SPACE TO CLIRAD-ORGANISME.                              0000000
162500                                                                  0000000
162510*    ** REFERENCE DU CLIENT                                       0000000
162520     MOVE ZERO             TO  CLIRAD-REF-CLIENT.                 0000000
162530     MOVE WADR-BANQUE      TO  CLIRAD-REFB-BANQUE.                0000000
162540     MOVE WADR-CAISSE      TO  CLIRAD-REFB-CAISSE.                0000000
162550     MOVE WADR-RACINE9     TO  CLIRAD-REFB-RACINE.                0000000
162560                                                                  0000000
162570*    ** TYPE D'ADRESSE A RECHERCHER : ADRESSE LEGALE DU TITULAIRE 0000000
162580                                                                  0000000
162590     MOVE 'LG'        TO  CLIRAD-ADRTYPE.                         0000000
162600     IF  WADR-TITUL = 0                                           0000000
162610         MOVE '1'         TO  W-TIT2                              0000000
162620     ELSE                                                         0000000
162630         MOVE WADR-TITUL  TO  W-TIT2.                             0000000
162640     MOVE W-TIT       TO  CLIRAD-NRTYPE.                          0000000
162650                                                                  0000000
162660     MOVE SPACE       TO  CLIRAD-CDTITRE.                         0000000
162670                                                                  0000000
162680*    ** CRITERES DE PRESENTATION DE L'ADRESSE                     0000000
162690     MOVE '6'         TO  CLIRAD-NBLIGNES.                        0000000
162700                                                                  0000000
162710*    ** FORMAT DE L'ADRESSE COMPACTE                              0000000
162720     MOVE SPACE       TO  CLIRAD-ELIMIN.                          0000000
162730     MOVE 'N'         TO  CLIRAD-UTILINDIC.                       0000000
162740                                                                  0000000
162750     MOVE ZERO        TO  CLIRAD-NRLEGAL.                         0000000
162760                                                                  0000000
162770*    ** SITE EN FONCTION DU CODE BANQUE                           0000000
162780*    MOVE SPACES      TO  CLIRAD-SITE.                            0000000
162790*                                                                 0000000
162800                                                                  0000000
162810     PERFORM APPEL-RADSP805.                                      0000000
162820                                                                  0000000
162830D    IF CLIRAD-STATUS = SPACE                                     0000000
162840D       PERFORM DISPLAY-ADRESSE VARYING KJ FROM 1 BY 1            0000000
162850D                  UNTIL KJ > 6.                                  0000000
162860                                                                  0000000
162870     IF CLIRAD-STATUS = SPACE                                     0000000
162880          MOVE CLIRAD-ADR-LIGNE(1)  TO  W-ADRLIG1                 0000000
162890          MOVE CLIRAD-ADR-LIGNE(2)  TO  W-ADRLIG2                 0000000
162900          MOVE CLIRAD-ADR-LIGNE(3)  TO  W-ADRLIG3                 0000000
162910          MOVE CLIRAD-ADR-LIGNE(4)  TO  W-ADRLIG4                 0000000
162920          MOVE CLIRAD-ADR-LIGNE(5)  TO  W-ADRLIG5                 0000000
162930          MOVE CLIRAD-ADR-LIGNE(6)  TO  W-ADRLIG6                 0000000
162940          PERFORM COMPOSE-ADRESSE                                 0000000
162950      ELSE                                                        0000000
162960          MOVE     SPACES           TO  W-ADRLIG1                 0000000
162970                                        W-ADRLIG2                 0000000
162980                                        W-ADRLIG3                 0000000
162990                                        W-ADRLIG4                 0000000
163000                                        W-ADRLIG5                 0000000
163010                                        W-ADRLIG6.                0000000
163020                                                                  0000000
163030* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 0000000
163040dDISPLAY-ADRESSE.                                                 0000000
163050                                                                  0000000
163060d    DISPLAY CLIRAD-ADR-LIGCOD(KJ) ' '                            0000000
163070d            CLIRAD-ADR-LIGNE(KJ)  ' '                            0000000
163080d            CLIRAD-ADR-NBLIG     ' '                             0000000
163090d            'KJ = ' KJ.                                          0000000
163100                                                                  0000000
163110******************************************************************0000000
163120 APPEL-RADSP805.                                                  0000000
163130                                                                  0000000
163140* APPEL DE LA FONCTION RADSP805 POUR LA LECTURE DES ADRESSES      0000000
163150* CLIENT                                                          0000000
163160                                                                  0000000
163170D    DISPLAY 'clirad : ' CLIRAD                                   0000000
163180     CALL 'ZCALLPGM' USING RADSP805 CLIRAD                        0000000
163190                                    ADRCLI                        0000000
163200                                    ADRIND                        0000000
163210                                    ADRDES                        0000000
163220*                                   PCBCLT                        0000000
163230*                                   PCBDES                        0000000
163240*                                   PCBADR.                       0000000
163250                                                                  0000000
163260     IF CLIRAD-STATUS = 'LGE '                                    0000000
163270*--- Adresse non trouve                                          0000000
163280*PGI - R40738 - 10/06/2011 - DEB                                  0000000
163290        IF ( NOT SIT-ISC-TYPE-TEST )                              0000000
163300*       IF ( ZISC-IMS  NOT  = 'N' )                               0000000
163310*PGI - R40738 - 10/06/2011 - FIN                                  0000000
163320          AND   NOT  ADRESSE-CAUTION                              0000000
163330            MOVE 48                TO TEST-1                      0000000
163340            PERFORM  TRAIT-ANOMALIE                               0000000
163350        ELSE                                                      0000000
163360         DISPLAY 'il manque tjs des adresses pour caution !!! '   0000000
163370         DISPLAY WADR-BANQUE WADR-CAISSE WADR-RACINE9 WADR-TITUL  0000000
163380     ELSE                                                         0000000
163390     IF CLIRAD-STATUS NOT = SPACE                                 0000000
163400*---- ERREUR ACCES  BASES ADRESSES                                0000000
163410         MOVE CLIRAD-STATUS-234 TO CTL-R34                        0000000
163420        DISPLAY WADR-BANQUE WADR-CAISSE WADR-RACINE9 WADR-TITUL   0000000
163430        ' (' CLIRAD-REF-CLIENT ') : ' CLIRAD-STATUS-1 ' '         0000000
163440        CLIRAD-STATUS-234 ' -> ' CLIRAD-LIBERR                    0000000
163450D       DISPLAY 'INPUT = ' CLIRAD-INPUT                           0000000
163460        PERFORM TRAIT-ERREUR.                                     0000000
163470                                                                  0000000
163480 COMPOSE-ADRESSE.                                                 0000000
163490                                                                  0000000
163500     MOVE  SPACE                  TO WADR-RUE.                    0000000
163510     MOVE  SPACE                  TO WADR-LOC.                    0000000
163520     IF  W-ADRLIG4 NOT = SPACE                                    0000000
163530         MOVE W-ADRLIG4           TO WADR-RUE                     0000000
163540     ELSE                                                         0000000
163550         IF  W-ADRLIG3 NOT = SPACE                                0000000
163560             MOVE W-ADRLIG3       TO WADR-RUE.                    0000000
163570                                                                  0000000
163580     IF  W-ADRLIG5 NOT = SPACE                                    0000000
163590         MOVE W-ADRLIG5           TO WADR-LOC                     0000000
163600     ELSE                                                         0000000
163610         IF  ( W-ADRLIG4 NOT = SPACE )                            0000000
163620             AND ( W-ADRLIG3 NOT = SPACE )                        0000000
163630             MOVE W-ADRLIG3       TO WADR-LOC.                    0000000
163640                                                                  0000000
163650     MOVE W-ADRLIG6               TO W-ADRLIG-ACHEMIN             0000000
163660                                     WADR-CPBUR.                  0000000
163670                                                                  0000000
163680*-------------------------                                        0000000
163690 LECTURE-CLIENT-TIERS.                                            0000000
163700*-------------------------                                        0000000
163710                                                                  0000000
163720*   INITIALISATION ZONES DE TIEE10-L0001                          0000000
163730     MOVE 'B '             TO TIEE10-L0001-COD-ORG.               0000000
163740     MOVE 'C '             TO TIEE10-L0001-ROL.                   0000000
163750     MOVE 'C'              TO TIEE10-L0001-TYP-APE.               0000000
163760     MOVE 'I'              TO TIEE10-L0001-CODIF-PAY.             0000000
163770     MOVE 'N'              TO TIEE10-L0001-TOP-EI.                0000000
163780*    MOVE 'O'              TO TIEE10-L0001-TOP-EI.                0000000
163790     MOVE 'N'              TO TIEE10-L0001-TOP-TLC.               0000000
163800     MOVE DATJOUR          TO TIEE10-DAT-FRAICHEUR.               0000000
163810     MOVE HEUJOUR          TO TIEE10-HEU-FRAICHEUR.               0000000
163820                                                                  0000000
163830*   INITIALISATION ZONES DE TIEFAL: PARTIE FIXE ALLER             0000000
163840     PERFORM REMPLI-ZONES-FIXES.                                  0000000
163850     MOVE SC-TOUT-TIERS-L0001     TO TIEFAL-IDE-FON.              0000000
163860     MOVE 'LEU'                   TO TIEFAL-TYP-ACN.              0000000
163870     SET TIEE10-L0001-CYC-VIE-ACF TO TRUE.                        0000000
163880                                                                  0000000
163890     Initialize  ties10                                           0000000
163900                                                                  0000000
163910*    APPEL ACCESSEUR BASE TIERS                                   0000000
163920     CALL     'ZCALLPGM'      USING TIEGAPEL                      0000000
163930                                    TIEFAL                        0000000
163940                                    TIEE10                        0000000
163950                                    TIEFRE                        0000000
163960                                    TIES10                        0000000
163970                                    TIEGAPEL-BID1                 0000000
163980                                    TIEGAPEL-BID2.                0000000
163990                                                                  0000000
164000d    display 'ZISC-IMS  ' zisc-ims                                0000000
164010*PGI - R40738 - 10/06/2011 - DEB                                  0000000
164020d    display 'SIT-ISC-CODE-IMS= ' SIT-ISC-CODE-IMS                0000000
164030*PGI - R40738 - 10/06/2011 - FIN                                  0000000
164040d    display 'TIES10  ' TIES10                                    0000000
164050                                                                  0000000
164060     IF  NOT  TIEFRE-TRT-CORRECT                                  0000000
164070*PGI - R40738 - 10/06/2011 - DEB                                  0000000
164080         IF  NOT SIT-ISC-TYPE-TEST                                0000000
164090*        IF  ZISC-IMS  NOT  =  'N'                                0000000
164100*PGI - R40738 - 10/06/2011 - FIN                                  0000000
164110             DISPLAY 'ACCES TIEE10-L0001 : ' TIEFRE-MSG-ERR-MET   0000000
164120             DISPLAY 'TIEFAL = '                                  0000000
164130             DISPLAY  TIEFAL                                      0000000
164140             DISPLAY 'TIEE10 = '                                  0000000
164150             DISPLAY  TIEE10                                      0000000
164160             MOVE  47  TO TEST-1                                  0000000
164170             PERFORM  TRAIT-ANOMALIE                              0000000
164180         ELSE                                                     0000000
164190             MOVE '11'                TO TIEE10-L0001-COD-RGP     0000000
164200             MOVE '10278'             TO TIEE10-L0001-BQE         0000000
164210             MOVE '01421'             TO TIEE10-L0001-CAI         0000000
164220             MOVE '000311159'         TO TIEE10-L0001-RAC         0000000
164230             MOVE '01'                TO TIEE10-L0001-NUM-TTL     0000000
164240                                                                  0000000
164250             CALL     'ZCALLPGM'      USING TIEGAPEL              0000000
164260                                            TIEFAL                0000000
164270                                            TIEE10                0000000
164280                                            TIEFRE                0000000
164290                                            TIES10                0000000
164300                                            TIEGAPEL-BID1         0000000
164310                                            TIEGAPEL-BID2         0000000
164320                                                                  0000000
164330             IF NOT TIEFRE-TRT-CORRECT                            0000000
164340                DISPLAY 'ACCES TIEE10-L0001 : '                   0000000
164350                                       TIEFRE-MSG-ERR-MET         0000000
164360                DISPLAY 'TIEFAL = '                               0000000
164370                DISPLAY  TIEFAL                                   0000000
164380                DISPLAY 'TIEE10 = '                               0000000
164390                DISPLAY  TIEE10                                   0000000
164400                MOVE  47  TO TEST-1                               0000000
164410                PERFORM  TRAIT-ANOMALIE.                          0000000
164420                                                                  0000000
164430      IF SUITE                                                    0000000
164440         IF IPPMA2-LANGUE-ALLEMANDE                               0000000
164450            IF TIES10-L0001-NOM-USG (1) = TIES10-L0001-NJF (1)    0000000
164460                  MOVE  SPACE  TO TIES10-L0001-NJF (1)            0000000
164470             END-IF                                               0000000
164480          END-IF                                                  0000000
164490      END-IF                                                      0000000
164500      .                                                           0000000
164510*================================================================ 0000000
164520 LECTURE-REPRESENTANT-LEGAL.                                      0000000
164530                                                                  0000000
164540*   INITIALISATION ZONES DE TIEFAL: PARTIE FIXE ALLER             0000000
164550     PERFORM REMPLI-ZONES-FIXES                                   0000000
164560*   INITIALISATION ZONES DE TIEE03-L0001                          0000000
164570     initialize                    TIEE03                         0000000
164580                                                                  0000000
164590     MOVE w-tiers-pmo           TO w-tiers-pmoS9                  0000000
164600     MOVE w-tiers-pmoS9         TO TIEE03-L0001-TIE-NUM           0000000
164610     MOVE 'RLP'                 TO TIEE03-L0001-TYP-DEB           0000000
164620     MOVE 'RLP'                 TO TIEE03-L0001-TYP-FIN           0000000
164630     MOVE low-value             TO TIEE03-L0001-STY-DEB           0000000
164640     MOVE high-value            TO TIEE03-L0001-STY-FIN           0000000
164650     MOVE 'C'                   TO TIEE03-L0001-CYC-VIE-DEB       0000000
164660     MOVE 'C'                   TO TIEE03-L0001-CYC-VIE-FIN       0000000
164670                                                                  0000000
164680     MOVE DATJOUR               TO TIEE03-DAT-FRAICHEUR           0000000
164690     MOVE HEUJOUR               TO TIEE03-HEU-FRAICHEUR           0000000
164700                                                                  0000000
164710     move ORGS01-BANQUE           TO TIEFAL-IDE-EXT-BQE           0000000
164720     move IPPMA2-CAISSE           TO TIEFAL-IDE-EXT-CAI           0000000
164730     MOVE 'TIE-RELTIE'            TO TIEFAL-OBJ-GES               0000000
164740     MOVE 'L0001'                 TO TIEFAL-FON                   0000000
164750     MOVE 'LBS'                   TO TIEFAL-TYP-ACN               0000000
164760d    display '============================================='      0000000
164770d    display 'TIEFAL =' TIEFAL                                    0000000
164780d    display 'TIEE03 =' TIEE03                                    0000000
164790d    display 'w-tiers-pmo         =' w-tiers-pmo                  0000000
164800d    display '============================================='      0000000
164810                                                                  0000000
164820                                                                  0000000
164830                                                                  0000000
164840*    APPEL ACCESSEUR BASE TIERS                                   0000000
164850     CALL     'ZCALLPGM'      USING TIEGAPEL                      0000000
164860                                    TIEFAL                        0000000
164870                                    TIEE03                        0000000
164880                                    TIEFRE                        0000000
164890                                    TIES03                        0000000
164900                                    TIEGAPEL-BID1                 0000000
164910                                    TIEGAPEL-BID2                 0000000
164920                                                                  0000000
164930d    DISPLAY 'TIEFRE  = ' TIEFRE                                  0000000
164940d    DISPLAY 'TIES03  = ' TIES03                                  0000000
164950                                                                  0000000
164960     IF NOT TIEFRE-TRT-CORRECT                                    0000000
164970                                                                  0000000
164980        DISPLAY 'ACCES TIEE03-L0001 : ' TIEFRE-MSG-ERR-MET        0000000
164990        DISPLAY 'TIEFAL = '                                       0000000
165000        DISPLAY  TIEFAL                                           0000000
165010        DISPLAY 'TIEE03 = '                                       0000000
165020        DISPLAY  TIEE03                                           0000000
165030        MOVE  47  TO TEST-1                                       0000000
165040        PERFORM  TRAIT-ANOMALIE                                   0000000
165050     else                                                         0000000
165060*       if TIES03-L0001-STY(1) not = 'COG'                        0000000
165070           move TIES03-L0001-TIE-NUM(1) to w-tiers-phy            0000000
165080*       else                                                      0000000
165090*          move TIES03-L0001-TIE-NUM(2) to w-tiers-phy            0000000
165100*       end-if                                                    0000000
165110*       move TIES03-L0001-LIBREL                                  0000000
165120d       display 'w-tiers-phy=' w-tiers-phy                        0000000
165130d       display 'TIES03-L0001-LIBREL=' TIES03-L0001-LIBREL(1)     0000000
165140     END-IF                                                       0000000
165150     .                                                            0000000
165160*================================================================ 0000000
165170* RECHERCHE DU no DE TIERS SUR 13  PARTIR DE LA REFCM            0000000
165180 RECH-NO-TIERS-PMO.                                               0000000
165190                                                                  0000000
165200     INITIALIZE                  TIEFAL                           0000000
165210     INITIALIZE                  TIEE10                           0000000
165220     INITIALIZE                  TIEFRE                           0000000
165230     INITIALIZE                  TIES10A                          0000000
165240                                                                  0000000
165250     PERFORM REMPLI-ZONES-FIXES                                   0000000
165260                                                                  0000000
165270     move sc-tout-tiers-l0001        to tiefal-ide-fon            0000000
165280     move 'LEU'                      to tiefal-typ-acn            0000000
165290                                                                  0000000
165300     MOVE DATJOUR                    TO TIEE10-DAT-FRAICHEUR      0000000
165310     MOVE HEUJOUR                    TO TIEE10-HEU-FRAICHEUR      0000000
165320                                                                  0000000
165330     MOVE ORGS01-BANQUE              TO tiee10-l0001-bqe          0000000
165340     MOVE ORGS01-BANQUE              TO tiefal-ide-ext-bqe        0000000
165350     MOVE IPPMA2-CAISSE              TO tiee10-l0001-cai          0000000
165360     MOVE IPPMA2-CAISSE              TO tiefal-ide-ext-cai        0000000
165370                                                                  0000000
165380     string '000' IPPMA2-RACINE                                   0000000
165390     delimited size                into tiee10-l0001-rac          0000000
165400                                                                  0000000
165410*    MOVE '01'                       TO tiee10-l0001-num-ttl      0000000
165420     string '0' IPPMA2-EMP-TITUL                                  0000000
165430     delimited size                into tiee10-l0001-num-ttl      0000000
165440                                                                  0000000
165450     set  tiee10-l0001-ape-cpl       to true                      0000000
165460     set  tiee10-l0001-ei-non        to true                      0000000
165470     set  tiee10-l0001-tlc-non       to true                      0000000
165480                                                                  0000000
165490     set  tieval-cyc-vie-acf         to true                      0000000
165500     move tieval-cyc-vie             to tiee10-l0001-cyc-vie      0000000
165510                                                                  0000000
165520                                                                  0000000
165530d    DISPLAY ' tiee10-l0001-bqe    =' tiee10-l0001-bqe            0000000
165540d    DISPLAY ' tiee10-l0001-cai    =' tiee10-l0001-cai            0000000
165550d    DISPLAY ' tiee10-l0001-rac    =' tiee10-l0001-rac            0000000
165560d    DISPLAY ' tiee10-l0001-num-ttl=' tiee10-l0001-num-ttl        0000000
165570                                                                  0000000
165580     CALL 'ZCALLPGM'      USING TIEGAPEL                          0000000
165590                                TIEFAL                            0000000
165600                                TIEE10                            0000000
165610                                TIEFRE                            0000000
165620                                TIES10A                           0000000
165630                                TIEGAPEL-BID1                     0000000
165640                                TIEGAPEL-BID2                     0000000
165650                                                                  0000000
165660d    DISPLAY ' TIEFRE-COD-RET-PRI =' TIEFRE-COD-RET-PRIMAIRE      0000000
165670d    DISPLAY ' TIEFRE-COD-RET-SCD =' TIEFRE-COD-RET-SCD           0000000
165680d    DISPLAY ' TIEFRE-MSG-ERR-MET =' TIEFRE-MSG-ERR-MET           0000000
165690d    DISPLAY ' TIEFRE-MSG-ERR-TEC =' TIEFRE-MSG-ERR-TEC           0000000
165700                                                                  0000000
165710                                                                  0000000
165720     IF NOT TIEFRE-TRT-CORRECT                                    0000000
165730                                                                  0000000
165740        DISPLAY 'ACCES TIEE10-L0001 : ' TIEFRE-MSG-ERR-MET        0000000
165750        DISPLAY 'TIEFAL = '                                       0000000
165760        DISPLAY  TIEFAL                                           0000000
165770        DISPLAY 'TIEE10 = '                                       0000000
165780        DISPLAY  TIEE10                                           0000000
165790        MOVE  47  TO TEST-1                                       0000000
165800        PERFORM  TRAIT-ANOMALIE                                   0000000
165810     else                                                         0000000
165820        move ties10-l0001-tie-num (1) to w-tiers-pmo              0000000
165830d       display 'w-tiers-pmox=' w-tiers-pmox                      0000000
165840                                                                  0000000
165850     END-IF                                                       0000000
165860                                                                  0000000
165870     .                                                            0000000
165880*================================================================ 0000000
165890* RECHERCHE DU NOM D'UN TIERS                                     0000000
165900 RECH-NOM-REPRESENTANT-LEGAL.                                     0000000
165910                                                                  0000000
165920     INITIALIZE                 TIEFAL                            0000000
165930     INITIALIZE                 TIEE01                            0000000
165940     INITIALIZE                 TIEFRE                            0000000
165950     INITIALIZE                 TIES01                            0000000
165960                                                                  0000000
165970     PERFORM REMPLI-ZONES-FIXES                                   0000000
165980                                                                  0000000
165990     MOVE TIERS-L0001                TO TIEFAL-IDE-FON            0000000
166000     MOVE 'LEU'                      TO TIEFAL-TYP-ACN            0000000
166010     SET  TIEE01-L0001-APE-RED       TO TRUE                      0000000
166020                                                                  0000000
166030     MOVE DATJOUR                    TO TIEFAL-DATE               0000000
166040     MOVE HEUJOUR                    TO TIEFAL-HEURE              0000000
166050                                                                  0000000
166060     MOVE DATJOUR                    TO TIEE01-DAT-FRAICHEUR      0000000
166070     MOVE HEUJOUR                    TO TIEE01-HEU-FRAICHEUR      0000000
166080     MOVE W-TIERS-phy                TO TIEE01-L0001-TIE-NUM      0000000
166090                                                                  0000000
166100     SET TIEE01-L0001-APE-RED        TO TRUE                      0000000
166110     SET TIEE01-L0001-CODIF-PAY-INSEE TO TRUE                     0000000
166120                                                                  0000000
166130D    DISPLAY 'YTIEFAL      ='  TIEFAL                             0000000
166140D    DISPLAY 'YTIEE01      ='  TIEE01                             0000000
166150                                                                  0000000
166160     CALL 'ZCALLPGM'      USING TIEGAPEL                          0000000
166170                                TIEFAL                            0000000
166180                                TIEE01                            0000000
166190                                TIEFRE                            0000000
166200                                TIES01                            0000000
166210                                TIEGAPEL-BID1                     0000000
166220                                 TIEGAPEL-BID2                    0000000
166230                                                                  0000000
166240d    DISPLAY ' TIEFRE-COD-RET-PRI =' TIEFRE-COD-RET-PRIMAIRE      0000000
166250d    DISPLAY ' TIEFRE-COD-RET-SCD =' TIEFRE-COD-RET-SCD           0000000
166260d    DISPLAY ' TIEFRE-MSG-ERR-MET =' TIEFRE-MSG-ERR-MET           0000000
166270d    DISPLAY ' TIEFRE-MSG-ERR-TEC =' TIEFRE-MSG-ERR-TEC           0000000
166280                                                                  0000000
166290                                                                  0000000
166300     IF TIEFRE-COD-RET-PRIMAIRE = ZERO                            0000000
166310        STRING TIES01-L0001-TIT ' '                               0000000
166320               TIES01-L0001-NOM-USG ' '                           0000000
166330               TIES01-L0001-PRN                                   0000000
166340        DELIMITED SIZE INTO W-NOM-TIERS-RLP                       0000000
166350d       DISPLAY 'NOM TIERS=' W-NOM-TIERS-RLP                      0000000
166360     ELSE                                                         0000000
166370        MOVE  47  TO TEST-1                                       0000000
166380        PERFORM  TRAIT-ANOMALIE                                   0000000
166390     END-IF                                                       0000000
166400     .                                                            0000000
166410                                                                  0000000
166420                                                                  0000000
166430                                                                  0000000
166440                                                                  0000000
166450 INIT-IPPCAI.                                                     0000000
166460*------------                                                     0000000
166470                                                                  0000000
166480     PERFORM   RECHERCHE-CM-CIC.                                  0000000
166490                                                                  0000000
166500     PERFORM   RECHERCHE-LIBELLE-CAISSE.                          0000000
166510                                                                  0000000
166520     MOVE SPACE         TO IPPCAI.                                0000000
166530     MOVE '0000'        TO CAI-CAIREGIM.                          0000000
166540     SET  CAISSE-AUTRE  TO TRUE.                                  0000000
166550                                                                  0000000
166560     MOVE CAI-NOCAI     TO CAI-FEDE-CODE.                         0000000
166570     IF   CAI-CAICODE        =  '00399'                           0000000
166580          MOVE  APPEL-CAI  TO  CAI-CAICODE.                       0000000
166590     MOVE  SPACES                     TO  W-LIB-01-36             0000000
166600     PERFORM  INIT-IPPCAI-ORG.                                    0000000
166610     MOVE  ORGS03B-BUR-ADR-RUE      TO  CAI-CAIADR1               0000000
166620     MOVE  ORGS03B-BUR-ADR-LOC      TO  CAI-CAIADR2               0000000
166630     MOVE  ORGS03B-BUR-ADR-CODPOS   TO  CAI-CAIADRC               0000000
166640     MOVE  ORGS03B-BUR-ADR-BURDIST  TO  CAI-CAILOC                0000000
166650     .                                                            0000000
166660                                                                  0000000
166670     IF  ORGS03B-BUR-TEL-CLIENT  NOT  =  SPACE                    0000000
166680          MOVE 'TEL.:'                  TO CAI-CAITELPH-01-06     0000000
166690          MOVE  ORGS03B-BUR-TEL-CLIENT  TO  W-TEL15               0000000
166700          INSPECT  W-TEL14  REPLACING  ALL '-' BY ' '             0000000
166710          MOVE  W-TEL14                 TO  CAI-CAITELPH-07-20    0000000
166720     END-IF                                                       0000000
166730                                                                  0000000
166740     MOVE T-LIMITEE     TO CAI-CAIRESP.                           0000000
166750                                                                  0000000
166760     IF  NOT  ( ORGS01-BANQUE   =  '13070')                       0000000
166770                                                                  0000000
166780         IF  (ORGS03G-GUI-REGIME-LOCAL                            0000000
166790                  AND  CAI-CAICODE  NOT  =  '00389')              0000000
166800              PERFORM INIT-REGIME-LOCAL                           0000000
166810         ELSE                                                     0000000
166820             IF  ORGS03G-GUI-REGIME-GENE                          0000000
166830                 or  CAI-CAICODE  = '00389'                       0000000
166840                  PERFORM INIT-REGIME-GENERAL                     0000000
166850             END-IF                                               0000000
166860         END-IF                                                   0000000
166870     END-IF.                                                      0000000
166880                                                                  0000000
166890     SET   CAI-CAIDEVC-NON-FORCE  TO  TRUE                        0000000
166900                                                                  0000000
166910     IF  ORGS03G-GUI-SIRETX  NUMERIC                              0000000
166920          MOVE  ORGS03G-GUI-SIRET  TO  CAI-CAISIRET-N             0000000
166930     ELSE                                                         0000000
166940          IF  ORGS01-SIRETX  NUMERIC                              0000000
166950              MOVE  ORGS01-SIRET TO  CAI-CAISIRET-N               0000000
166960          ELSE                                                    0000000
166970              MOVE ZERO          TO  CAI-CAISIRET-N.              0000000
166980                                                                  0000000
166990**   If  CAI-CAICODE  =                                           0000000
167000*                         '06099'                                 0000000
167010*        Move  'En cours      '    to  CAI-CAISIRET               0000000
167020**   End-if                                                       0000000
167030                                                                  0000000
167040     MOVE '651D'       TO CAI-CAICAPE.                            0000000
167050                                                                  0000000
167060**** MISE EN PLACE INDICATEUR LYON ET ANNECY TRAITES PAR DIDO11   0000000
167070     IF   ORGS01-FEDE-CICP                                        0000000
167080          perform  PRETEUR-CICP                                   0000000
167090          MOVE '0'               TO CAI-CAIDIDO                   0000000
167100     ELSE                                                         0000000
167110          MOVE '1'               TO CAI-CAIDIDO                   0000000
167120     END-IF                                                       0000000
167130                                                                  0000000
167140     IF   ORGS01-ASSIMILE-LYON                                    0000000
167150          MOVE '2'          TO CAI-CAIDIDO                        0000000
167160*    ELSE                                                         0000000
167170*      IF  ORGS01-FEDE-SAVOIE                                     0000000
167180*           MOVE '3'          TO CAI-CAIDIDO                      0000000
167190       ELSE                                                       0000000
167200         IF  ORGS01-FEDE-ANTILLES                                 0000000
167210              MOVE '7'          TO CAI-CAIDIDO                    0000000
167220         ELSE                                                     0000000
167230           IF  ORGS01-ASSIMILE-IDF                                0000000
167240                MOVE '8'          TO CAI-CAIDIDO.                 0000000
167250                                                                  0000000
167260                                                                  0000000
167270* BECM                                                            0000000
167280                                                                  0000000
167290     IF  (CAI-NOCAI  NOT LESS    THAN '1100100'                   0000000
167300     AND  CAI-NOCAI  NOT GREATER THAN '1100150')                  0000000
167310     OR  (CAI-NOCAI  NOT LESS    THAN '1100201'                   0000000
167320     AND  CAI-NOCAI  NOT GREATER THAN '1100240')                  0000000
167330     OR   CAI-NOCAI  = '1100200'                                  0000000
167340          MOVE '0004'     TO CAI-CAIREGIM                         0000000
167350          IF   ORGS01-BANQUE-BECM                                 0000000
167360                                                                  0000000
167370* modif du capital le 12.05.06  Johannes                          0000000
167380*             MOVE  91094420   TO CAI-CAICAPSO                    0000000
167390              MOVE  96864800   TO CAI-CAICAPSO                    0000000
167400              MOVE  'EUR'      TO CAI-CAIDEVC                     0000000
167410              SET   CAI-CAIDEVC-FORCE  TO  TRUE                   0000000
167420          ELSE                                                    0000000
167430              MOVE 1238758250  TO CAI-CAICAPSO                    0000000
167440          END-IF                                                  0000000
167450     END-IF.                                                      0000000
167460                                                                  0000000
167470* BFCM                                                            0000000
167480                                                                  0000000
167490     IF  NOT  ( ORGS01-BANQUE   =  '13070')                       0000000
167500                                                                  0000000
167510         IF  (CAI-NOCAI  NOT LESS    THAN '1100911'               0000000
167520         AND  CAI-NOCAI  NOT GREATER THAN '1100949')              0000000
167530         OR   CAI-NOCAI  = '1100910'                              0000000
167540*             MOVE 620114200  TO CAI-CAICAPSO                     0000000
167550*             MOVE 1296481550 TO CAI-CAICAPSO                     0000000
167560              MOVE 1302192250 TO CAI-CAICAPSO                     0000000
167570              SET   CAI-CAIDEVC-FORCE  TO  TRUE                   0000000
167580              MOVE  'EUR'      TO CAI-CAIDEVC                     0000000
167590              MOVE '0005'     TO CAI-CAIREGIM.                    0000000
167600                                                                  0000000
167610* CAISSE FEDERALE                                                 0000000
167620* CFCM                                                            0000000
167630         IF  (CAI-NOCAI  NOT LESS    THAN '1100151'               0000000
167640          AND  CAI-NOCAI  NOT GREATER THAN '1100190')             0000000
167650          OR   CAI-NOCAI  = '1100111'                             0000000
167660          OR   CAI-NOCAI  = '1100140'                             0000000
167670*             MOVE  994198740  TO CAI-CAICAPSO                    0000000
167680              MOVE 1855837648  TO CAI-CAICAPSO                    0000000
167690              SET   CAI-CAIDEVC-FORCE  TO  TRUE                   0000000
167700              MOVE  'EUR'      TO CAI-CAIDEVC                     0000000
167710              MOVE '0003'     TO CAI-CAIREGIM.                    0000000
167720**** ACHTUNG *** POSITION INDICATEUR PARTICULIER SI ARRAS         0000000
167730*    IF   CAI-FEDR   = '17'                                       0000000
167740     IF  ORGS01C-FEDE-ARRAS                                       0000000
167750          IF   CAI-NOCAI  NOT LESS    THAN '1700750'              0000000
167760          AND  CAI-NOCAI  NOT GREATER THAN '1700760'              0000000
167770               MOVE '0003'     TO CAI-CAIREGIM                    0000000
167780          ELSE MOVE '0002'     TO CAI-CAIREGIM.                   0000000
167790*                                                                 0000000
167800D    DISPLAY 'ORGS01C-FEDE    =  ' ORGS01C-FEDE.                  0000000
167810D    display 'ORGS01-BANQUE   =  ' ORGS01-BANQUE.                 0000000
167820D    DISPLAY 'CAI-CAIREGIM    =  ' CAI-CAIREGIM .                 0000000
167830*  BECMN                                                          0000000
167840     IF  ORGS01-BANQUE   =  '13298'                               0000000
167850         MOVE '0007'     TO CAI-CAIREGIM.                         0000000
167860* CICP                                                            0000000
167870     IF  ORGS01-BANQUE   =  '30066'                               0000000
167880         MOVE '0000'     TO CAI-CAIREGIM.                         0000000
167890                                                                  0000000
167900*  cin                                                            0000000
167910     IF  ORGS01-BANQUE   =  '10688'                               0000000
167920         MOVE '0006'     TO CAI-CAIREGIM                          0000000
167930     END-IF                                                       0000000
167940                                                                  0000000
167950*  cin                                                            0000000
167960     IF  ORGS01-BANQUE   =  '12719'                               0000000
167970         MOVE '0007'     TO CAI-CAIREGIM                          0000000
167980     END-IF                                                       0000000
167990                                                                  0000000
168000*  fedebail                                                       0000000
168010     IF  ORGS01-BANQUE   =  '13070'                               0000000
168020         MOVE '6'     TO CAI-CAIDIDO                              0000000
168030     END-IF                                                       0000000
168040D    DISPLAY 'CAI-CAIDIDO = ' CAI-CAIDIDO.                        0000000
168050                                                                  0000000
168060*  Laval                                                          0000000
168070     IF   CAI-NOCAI     =   '1400399'                             0000000
168080          MOVE  '0008'      TO CAI-CAIREGIM.                      0000000
168090                                                                  0000000
168100*  PARIS  CERTAINES CAISSES SONT ....                             0000000
168110                                                                  0000000
168120     IF   CAI-NOCAI  = '1100588'                                  0000000
168130          MOVE '0007'           TO CAI-CAIREGIM.                  0000000
168140                                                                  0000000
168150     MOVE  ORGS03G-GUI-VILLE-TRIB-INST  TO CAI-CAITRIBU.          0000000
168160D    DISPLAY 'CAI-CAITRIBU ' CAI-CAITRIBU.                        0000000
168170                                                                  0000000
168180     MOVE  SPACE       TO  CAI-CAIFAX                             0000000
168190     MOVE  ORGS01-FAX  TO  CAI-CAIFAX                             0000000
168200*                                                                 0000000
168210*     0002  =  Lyon                                               0000000
168220*     0003  =  Annecy                                             0000000
168230*     0004  =  Paris                                              0000000
168240*     0001  =  Le reste de la fede 11.                            0000000
168250*                                                                 0000000
168260     MOVE  ZERO     TO  CAI-INDFEDE.                              0000000
168270                                                                  0000000
168280         IF  ORGS01-ASSIMILE-IDF                                  0000000
168290             MOVE  '4'  TO  CAI-INDFEDE                           0000000
168300         ELSE                                                     0000000
168310             IF  ORGS01-FEDE-CEE                                  0000000
168320                 IF    ORGS01-ASSIMILE-LYON                       0000000
168330                       MOVE  '2'  TO  CAI-INDFEDE                 0000000
168340                 ELSE                                             0000000
168350                       MOVE  '1'  TO  CAI-INDFEDE                 0000000
168360                 END-IF                                           0000000
168370             END-IF                                               0000000
168380         END-IF                                                   0000000
168390*    END-IF                                                       0000000
168400     .                                                            0000000
168410                                                                  0000000
168420D    DISPLAY ' FAX      '    CAI-CAIFAX.                          0000000
168430D    DISPLAY ' CAIREGIM '    CAI-CAIREGIM.                        0000000
168440D    DISPLAY ' CAISIRET '    CAI-CAISIRET.                        0000000
168450D    DISPLAY ' CAI-INDFEDE ' CAI-INDFEDE.                         0000000
168460                                                                  0000000
168470*---------------                                                  0000000
168480 PRETEUR-CICP.                                                    0000000
168490*---------------                                                  0000000
168500                                                                  0000000
168510     MOVE 'CREDIT INDUSTRIEL ET COMMERCIAL' TO CAI-PRETEUR.       0000000
168520                                                                  0000000
168530                                                                  0000000
168540*-------------------------                                        0000000
168550 INIT-NOM-CAISSE-CMDP.                                            0000000
168560*-------------------------                                        0000000
168570     MOVE 'CAISSE MUTUELLE DE DEPOTS ET DE PRETS '                0000000
168580                        TO CAI-CAINMSTD.                          0000000
168590     MOVE 'CMDP '       TO CAI-CAISIGLE.                          0000000
168600     MOVE W-LIB-06-36   TO CAI-CAINMSPE.                          0000000
168610                                                                  0000000
168620 INIT-NOM-CAISSE-CMPS.                                            0000000
168630*-------------------------                                        0000000
168640*              123456789.123456789.123456789.123456789.           0000000
168650*    MOVE 'CAISSE MUTUELLE DES PROFESSIONS DE SANTE '             0000000
168660*                       TO CAI-CAINMSTD.                          0000000
168670                                                                  0000000
168680     IF  CAI-CAICODE  =  '06120'                                  0000000
168690*        MOVE 'CAISSE MUTUELLE DES PROFESSIONS DE SANTE '         0000000
168700                                                                  0000000
168710         MOVE 'CAISSE DE CREDIT MUTUEL DES PROFESSIONS '          0000000
168720                            TO  CAI-CAINMSTD                      0000000
168730         MOVE  'DE SANTE - 75'     TO  CAI-CAINMSPE               0000000
168740       ELSE                                                       0000000
168750         MOVE 'CREDIT MUTUEL DES PROFESSIONS DE SANTE '           0000000
168760                            TO  CAI-CAINMSTD                      0000000
168770         MOVE W-LIB-06-36   TO  CAI-CAINMSPE                      0000000
168780     END-IF                                                       0000000
168790     MOVE 'CMPS '       TO CAI-CAISIGLE.                          0000000
168800                                                                  0000000
168810 INIT-NOM-CAISSE-CME.                                             0000000
168820*-------------------------                                        0000000
168830     IF  ORGS01-ASSIMILE-IDF                                      0000000
168840         MOVE 'CAISSE DE CREDIT MUTUEL ENSEIGNANT '               0000000
168850                            TO CAI-CAINMSTD                       0000000
168860     else                                                         0000000
168870         MOVE 'CAISSE MUTUELLE DES ENSEIGNANTS '                  0000000
168880                            TO CAI-CAINMSTD.                      0000000
168890     SET  CAISSE-CME   TO  TRUE.                                  0000000
168900     MOVE 'CME  '       TO CAI-CAISIGLE.                          0000000
168910     MOVE W-LIB-05-36   TO CAI-CAINMSPE.                          0000000
168920                                                                  0000000
168930 INIT-NOM-CAISSE-CCM.                                             0000000
168940*-------------------------                                        0000000
168950     MOVE 'CAISSE DE CREDIT MUTUEL '                              0000000
168960                         TO CAI-CAINMSTD.                         0000000
168970     MOVE 'CCM  '        TO CAI-CAISIGLE.                         0000000
168980     MOVE W-LIB-05-36    TO CAI-CAINMSPE.                         0000000
168990*    IF   APPEL-CAI     =  '07943'                                0000000
169000*         STRING W-LIB-05-36       DELIMITED BY '  '   sup le     0000000
169010*         '(BUREAU DES CAILLOLS)' DELIMITED BY SIZE   11/09/00    0000000
169020*                     INTO     CAI-CAINMSPE                       0000000
169030*    ELSE                                                         0000000
169040*        MOVE W-LIB-05-36   TO CAI-CAINMSPE.                      0000000
169050                                                                  0000000
169060 INIT-NOM-CAISSE-BER.                                             0000000
169070*-------------------------                                        0000000
169080     MOVE 'BANQUE DE L''ECONOMIE RHODANIENNE'                     0000000
169090                        TO CAI-CAINMSTD.                          0000000
169100     MOVE 'BER  '       TO CAI-CAISIGLE.                          0000000
169110     MOVE W-LIB-05-36   TO CAI-CAINMSPE.                          0000000
169120                                                                  0000000
169130 INIT-NOM-CAISSE-CESE.                                            0000000
169140*-------------------------                                        0000000
169150     MOVE 'CAISSE D''ECONOMIE DU SUD EST '                        0000000
169160                        TO CAI-CAINMSTD.                          0000000
169170     MOVE 'CESE '       TO CAI-CAISIGLE.                          0000000
169180     MOVE W-LIB-06-36   TO CAI-CAINMSPE.                          0000000
169190                                                                  0000000
169200 INIT-NOM-CAISSE-CFCM.                                            0000000
169210*-------------------------                                        0000000
169220     MOVE  'CAISSE FEDERALE CREDIT MUTUEL '                       0000000
169230                         TO  CAI-CAINMSTD.                        0000000
169240     MOVE  'CFCM '       TO  CAI-CAISIGLE.                        0000000
169250     MOVE  W-LIB-06-36   TO  CAI-CAINMSPE.                        0000000
169260                                                                  0000000
169270 INIT-NOM-CAISSE-CM.                                              0000000
169280*-------------------------                                        0000000
169290     MOVE 'CREDIT MUTUEL   '                                      0000000
169300                        TO CAI-CAINMSTD.                          0000000
169310     MOVE 'CM   '       TO CAI-CAISIGLE.                          0000000
169320     MOVE W-LIB-04-36   TO CAI-CAINMSPE.                          0000000
169330                                                                  0000000
169340 INIT-NOM-CAISSE-370.                                             0000000
169350*-------------------------                                        0000000
169360     MOVE 'C R E A V E N I R'      TO CAI-CAINMSPE.               0000000
169370                                                                  0000000
169380 INIT-NOM-CAISSE-AUTRE.                                           0000000
169390*-------------------------                                        0000000
169400                                                                  0000000
169410     MOVE  ORGS03G-GUI-LIBEL-STD  TO  CAI-CAINMSPE                0000000
169420     .                                                            0000000
169430                                                                  0000000
169440 INIT-REGIME-LOCAL.                                               0000000
169450*-------------------------                                        0000000
169460     MOVE  ORGS03G-GUI-VOLUME-RAC       TO  CAI-CAINUMRA.         0000000
169470     MOVE '/ '                          TO  CAI-CAINUMRA-T.       0000000
169480     MOVE  ORGS03G-GUI-ASSOCIATION-RAC  TO  CAI-CAIVOLRA.         0000000
169490     MOVE '0001'                        TO  CAI-CAIREGIM.         0000000
169500                                                                  0000000
169510 INIT-REGIME-GENERAL.                                             0000000
169520*-------------------------                                        0000000
169530     MOVE '0002'        TO CAI-CAIREGIM.                          0000000
169540                                                                  0000000
169550     MOVE 'IPPBATCH'   TO CTL-PGM-E.                              0000000
169560     MOVE SPACES       TO CTL-PGM-A.                              0000000
169570     MOVE SPACES       TO CTL-LIBELLE.                            0000000
169580     MOVE ZERO         TO CTL-RETOUR.                             0000000
169590                                                                  0000000
169600                                                                  0000000
169610*-------------------------  RUPTURE PREMIERE CAISSE -------       0000000
169620 RUPTURE-PREM-CAISSE.                                             0000000
169630*-------------------------                                        0000000
169640     IF TOP-INTERCALAIRE = '1'                                    0000000
169650        MOVE '2' TO TOP-INTERCALAIRE                              0000000
169660        PERFORM RUPTURE-DERN-CAISSE                               0000000
169670        MOVE '0' TO TOP-INTERCALAIRE.                             0000000
169680                                                                  0000000
169690*    ACCES AU FICHIER DES CAISSES                                 0000000
169700     PERFORM LECTURE-CAISSE.                                      0000000
169710                                                                  0000000
169720                                                                  0000000
169730 LECTURE-SCRIVENER.                                               0000000
169740                                                                  0000000
169750                                                                  0000000
169760     MOVE  1400           TO  IPCOND-CONDITION.                   0000000
169770     MOVE  'EUR'          TO  IPCOND-DEVISE                       0000000
169780     MOVE  ZEROS          TO  IPCOND-BANQUE                       0000000
169790     MOVE  W-DATE-8       TO  IPCOND-DATE-EFFET                   0000000
169800     MOVE     'PP'        TO  IPCOND-MODE.                        0000000
169810     CALL 'ZCALLPGM' USING ZPRTCOND                               0000000
169820                           PCBSPI                                 0000000
169830                           IPCOND                                 0000000
169840                           CTL-R34.                               0000000
169850                                                                  0000000
169860     IF  CTL-R34  =  ZERO                                         0000000
169870         MOVE  IPCOND-MONTANT9  TO  W-SCRIVENER-EUR               0000000
169880     ELSE                                                         0000000
169890         DISPLAY ' libelle '   IPCOND-LIBELLE                     0000000
169900         MOVE  21500            TO  W-SCRIVENER-EUR               0000000
169910         MOVE    ZERO  TO  CTL-R34                                0000000
169920     END-IF.                                                      0000000
169930                                                                  0000000
169940 LECTURE-MT-ASSUR.                                                0000000
169950* mt maxi 266 sans formalit assurance                            0000000
169960                                                                  0000000
169970     MOVE  1401            TO  IPCOND-CONDITION.                  0000000
169980     MOVE  'EUR'           TO  IPCOND-DEVISE                      0000000
169990     MOVE   ORGS01-BANQUE  TO  IPCOND-BANQUE                      0000000
170000                                                                  0000000
170010     MOVE  W-DATE-8        TO  IPCOND-DATE-EFFET.                 0000000
170020     MOVE     'PP'         TO  IPCOND-MODE.                       0000000
170030                                                                  0000000
170040     CALL 'ZCALLPGM' USING ZPRTCOND                               0000000
170050                           PCBSPI                                 0000000
170060                           IPCOND                                 0000000
170070                           CTL-R34.                               0000000
170080                                                                  0000000
170090     IF  CTL-R34  =  ZERO                                         0000000
170100         MOVE  IPCOND-MONTANT9  TO  W-MAX-266-EUR                 0000000
170110     ELSE                                                         0000000
170120         DISPLAY ' libelle '   IPCOND-LIBELLE                     0000000
170130         MOVE  40000            TO  W-MAX-266-EUR                 0000000
170140         MOVE    ZERO  TO  CTL-R34                                0000000
170150     END-IF.                                                      0000000
170160                                                                  0000000
170170                                                                  0000000
170180*-------------------------  RUPTURE DERNIERE CAISSE  ---          0000000
170190 RUPTURE-DERN-CAISSE.                                             0000000
170200*-------------------------                                        0000000
170210     IF  FF-APPEL = '1' AND DIDO-ETAT = '1'                       0000000
170220         MOVE '2' TO DIDO-ETAT.                                   0000000
170230                                                                  0000000
170240     set  88-IPPBATC1-i-o      to  true                           0000000
170250     PERFORM CALL-IPPBATC1.                                       0000000
170260     ADD  CAI-CPT1 TO TOT-CPT1.                                   0000000
170270     MOVE CAI-CPT1 TO CPT-DISP1.                                  0000000
170280     ADD  CAI-CPT2 TO TOT-CPT2.                                   0000000
170290     MOVE CAI-CPT2 TO CPT-DISP2.                                  0000000
170300     ADD  CAI-CPT3 TO TOT-CPT3.                                   0000000
170310     MOVE CAI-CPT3 TO CPT-DISP3.                                  0000000
170320                                                                  0000000
170330     DISPLAY 'CAISSE ' CAI-CAIFEDE CAI-CAICODE                    0000000
170340             ' '       ORGS03G-GUI-LIBEL-STD                      0000000
170350             '     NBDOC =' CPT-DISP1                             0000000
170360             '     NBLEC =' CPT-DISP2                             0000000
170370             '     NBOUT =' CPT-DISP3.                            0000000
170380                                                                  0000000
170390*-------------------------                                        0000000
170400 OUVERTURE-XICS.                                                  0000000
170410*-------------------------                                        0000000
170420     MOVE SPACES TO IPPCAI.                                       0000000
170430     MOVE SPACES TO ZONE1-STOCK                                   0000000
170440                    ZONE2-STOCK                                   0000000
170450                    ZONE3-STOCK                                   0000000
170460                    ZONE4-STOCK                                   0000000
170470                    PRTCO41                                       0000000
170480                    PRTCO42                                       0000000
170490                    PRTCO43                                       0000000
170500                    PRTCO44                                       0000000
170510                    IDPTAM                                        0000000
170520                    ZONE5-STOCK                                   0000000
170530                    FEDIT-STOCK                                   0000000
170540                    IDPSTA.                                       0000000
170550     set  88-IPPBATC1-i-o      to  true                           0000000
170560     PERFORM CALL-IPPBATC1.                                       0000000
170570     IF CTL-R34 NOT = ZERO                                        0000000
170580        MOVE 'ERREUR OUVERTURE IPPBATC1' TO ANOM-44               0000000
170590        MOVE  44  TO TEST-1                                       0000000
170600        PERFORM  TRAIT-ANOMALIE-GRAVE.                            0000000
170610                                                                  0000000
170620*-------------------------                                        0000000
170630 FERMETURE-DIDO.                                                  0000000
170640*-------------------------                                        0000000
170650     MOVE SPACES TO IPPCAI.                                       0000000
170660     MOVE SPACES TO ZONE1-STOCK                                   0000000
170670                    ZONE2-STOCK                                   0000000
170680                    ZONE3-STOCK                                   0000000
170690                    ZONE4-STOCK                                   0000000
170700                    PRTCO41                                       0000000
170710                    PRTCO42                                       0000000
170720                    PRTCO43                                       0000000
170730                    PRTCO44                                       0000000
170740                    IDPTAM                                        0000000
170750                    ZONE5-STOCK                                   0000000
170760                    FEDIT-STOCK                                   0000000
170770                    IDPSTA.                                       0000000
170780     set  88-IPPBATC1-i-o      to  true                           0000000
170790     PERFORM CALL-IPPBATC1.                                       0000000
170800     IF CTL-R34 NOT = ZERO                                        0000000
170810        MOVE 'ERREUR CLOTURE IPPBATC1' TO ANOM-44                 0000000
170820        MOVE  44  TO TEST-1                                       0000000
170830        PERFORM  TRAIT-ANOMALIE                                   0000000
170840     ELSE                                                         0000000
170850        MOVE TOT-CPT1 TO CPT-DISP1                                0000000
170860        MOVE TOT-CPT2 TO CPT-DISP2                                0000000
170870        MOVE TOT-CPT3 TO CPT-DISP3.                               0000000
170880                                                                  0000000
170890                                                                  0000000
170900                                                                  0000000
170910*-------------------------  ETAT DES ANOMALIES ---------          0000000
170920 ECRITURE-ANOMALIE.                                               0000000
170930*-------------------------                                        0000000
170940                                                                  0000000
170950     WRITE EANOM FROM LIGNE-A.                                    0000000
170960     ADD  1 TO CPT-ANOM.                                          0000000
170970                                                                  0000000
170980*PGI - R40738 - 10/06/2011 - DEB                                  0000000
170990     IF   SIT-ISC-TYPE-TEST                                       0000000
171000*    IF   ZISC-IMS = 'N'                                          0000000
171010*PGI - R40738 - 10/06/2011 - FIN                                  0000000
171020          DISPLAY LIGNE-A.                                        0000000
171030                                                                  0000000
171040*-------------------------  ETAT DES ANOMALIES ---------          0000000
171050 ECRITURE-WARNING.                                                0000000
171060*-------------------------                                        0000000
171070                                                                  0000000
171080     WRITE EANOM FROM LIGNE-A.                                    0000000
171090*    ADD  1 TO CPT-ANOM.                                          0000000
171100                                                                  0000000
171110*PGI - R40738 - 10/06/2011 - DEB                                  0000000
171120     IF   SIT-ISC-TYPE-TEST                                       0000000
171130*    IF   ZISC-IMS = 'N'                                          0000000
171140*PGI - R40738 - 10/06/2011 - FIN                                  0000000
171150          DISPLAY LIGNE-A.                                        0000000
171160                                                                  0000000
171170*-------------------------  FICHIER MVTS 116 RECYCLES --          0000000
171180 ECRITURE-RECYCLE.                                                0000000
171190*--- recyclage pendant 5 traitement                               0000000
171200                                                                  0000000
171210     IF  APPEL-NBJ NOT  NUMERIC                                   0000000
171220         MOVE  ZERO  TO  APPEL-NBJ.                               0000000
171230                                                                  0000000
171240         IF  APPEL-NBJ  <  6                                      0000000
171250             ADD  1  TO APPEL-NBJ                                 0000000
171260             WRITE EFREC FROM APPEL                               0000000
171270             ADD  1 TO CPT-RECYC.                                 0000000
171280                                                                  0000000
171290*-------------------------                                        0000000
171300*-------------------------  SUPPRESSION BORDEREAU ------          0000000
171310 SUPPRESSION-IPPCPL.                                              0000000
171320*-------------------------                                        0000000
171330     MOVE 'DLI'        TO GBPR2-ACCES.                            0000000
171340     MOVE 'DLET'       TO GBPR2-APPEL.                            0000000
171350     MOVE 'B IPPBATCH' TO GBPR2-ORIGINE.                          0000000
171360     MOVE '***'        TO GBPR2-INTERVENTION.                     0000000
171370     MOVE 'GDP'        TO GBPR2-TYPENREG.                         0000000
171380     MOVE SPACES       TO GBPR2-CLEMIN-IPPMA2.                    0000000
171390     MOVE SPACES       TO GBPR2-CLEMAX-IPPMA2.                    0000000
171400     MOVE IPPMA2-CLE   TO IPPCPL-CLE.                             0000000
171410     MOVE 'G'          TO IPPCPL-CODENR.                          0000000
171420     PERFORM SUPPRESSION-LOOP                                     0000000
171430             VARYING IT FROM 1 BY 1 UNTIL IT > 4                  0000000
171440                  OR IPPMA2-2-TAB-PRET (IT) = SPACES              0000000
171450                  OR IPPMA2-2-CAT    (IT) NOT NUMERIC             0000000
171460                  OR IPPMA2-2-CNAT   (IT) NOT NUMERIC             0000000
171470                  OR CTL-R34 NOT = ZERO.                          0000000
171480                                                                  0000000
171490 SUPPRESSION-LOOP.                                                0000000
171500*-----------------                                                0000000
171510     MOVE IPPMA2-2-CAT (IT) TO IPPCPL-CAT.                        0000000
171520     MOVE '0'          TO IPPMA2-2-EXIST-PRT (IT).                0000000
171530     MOVE '0'          TO IPPMA2-2-EXIST-GDP (IT).                0000000
171540     MOVE '0'          TO IPPMA2-2-EXIST-APR (IT).                0000000
171550     MOVE '0'          TO IPPMA2-2-EXIST-PRI (IT).                0000000
171560     MOVE '0'          TO IPPMA2-2-EXIST-BQE (IT).                0000000
171570     MOVE '0'          TO IPPMA2-2-EXIST-EIG (IT).                0000000
171580     MOVE IPPCPL       TO GBPR2-CLEMIN-IPPCPL.                    0000000
171590     MOVE IPPCPL       TO GBPR2-CLEMAX-IPPCPL.                    0000000
171600     MOVE IPPCPL       TO IPPCPLR.                                0000000
171610     PERFORM CALL-IPPGBPR2.                                       0000000
171620                                                                  0000000
171630                                                                  0000000
171640*----------------                                                 0000000
171650 CALL-IPPGBPR2.                                                   0000000
171660*-----------------                                                0000000
171670     MOVE  ZERO       TO  CTL-R34.                                0000000
171680     MOVE   PGM-AAQQQ        TO  CTL-DATE.                        0000000
171690     MOVE  W-HEURE9          TO  CTL-TIME.                        0000000
171700     CALL 'ZCALLPGM' USING IPPGBPR2                               0000000
171710                             CTL                                  0000000
171720                             GBPR2-ACCES                          0000000
171730                             GBPR2-APPEL                          0000000
171740                             GBPR2-ORIGINE                        0000000
171750                             GBPR2-INTERVENTION                   0000000
171760                             GBPR2-TYPENREG                       0000000
171770                             GBPR2-CLEMIN-IPPMA2                  0000000
171780                             GBPR2-CLEMAX-IPPMA2                  0000000
171790                             GBPR2-CLEMIN-IPPCPL                  0000000
171800                             GBPR2-CLEMAX-IPPCPL                  0000000
171810                             IPPMA2                               0000000
171820                             IPPMA2R                              0000000
171830                             IPPCPL                               0000000
171840                             IPPCPLR                              0000000
171850                             PCBMAS                               0000000
171860                             PCBCPL.                              0000000
171870     IF CTL-R34 = 'GE' OR 'GB'                                    0000000
171880        MOVE ZERO TO CTL-R34                                      0000000
171890     ELSE                                                         0000000
171900     IF CTL-R34 NOT = ZERO                                        0000000
171910        MOVE  44  TO  TEST-1                                      0000000
171920        MOVE  SPACE                  TO ANOM-44                   0000000
171930        STRING 'ERREUR MAJ DB IPP '                               0000000
171940               CTL-RETOUR DELIMITED BY SIZE INTO ANOM-44          0000000
171950        PERFORM  TRAIT-ANOMALIE.                                  0000000
171960                                                                  0000000
171970 REMPLI-ZONES-FIXES.                                              0000000
171980*     ALIMENTATION PARTIE FIXE ALLER TIEFAL                       0000000
171990                                                                  0000000
172000      MOVE ALL SPACE            TO TIEFAL.                        0000000
172010      MOVE 'CDTAMORTISSABLE'    TO TIEFAL-BLOC-EME.               0000000
172020      MOVE 'BATCHPRET'          TO TIEFAL-APL-EME.                0000000
172030      MOVE 'IPPBATCH'           TO TIEFAL-PGM-EME.                0000000
172040      MOVE 'IMS'                TO TIEFAL-TYP-EME.                0000000
172050*     RECHERCHE SITE ASSOCIE A LA CAISSE                          0000000
172060*                                                                 0000000
172070                                                                  0000000
172080*PGI - R40738 - 10/06/2011 - DEB                                  0000000
172090      MOVE  SIT-ISC-CODE-IMS    TO  TIEFAL-NOM-EME                0000000
172100*     MOVE  XX-SITE-MODULE      TO  TIEFAL-NOM-EME                0000000
172110*PGI - R40738 - 10/06/2011 - FIN                                  0000000
172120                                                                  0000000
172130                                                                  0000000
172140           IF PRTLNK-TRAIT = 'B'                                  0000000
172150                IF PRTLNK-ENVIRON = 'I'                           0000000
172160                     MOVE 'TI'    TO TIEFAL-MOD-TRT               0000000
172170                ELSE                                              0000000
172180                     MOVE 'TD'    TO TIEFAL-MOD-TRT               0000000
172190           ELSE                                                   0000000
172200                MOVE 'TR'         TO TIEFAL-MOD-TRT.              0000000
172210                                                                  0000000
172220           MOVE 'OPC'              TO TIEFAL-IDE-LGE.             0000000
172230           MOVE PGM-JOBNAME        TO TIEFAL-IDE-PHY.             0000000
172240           MOVE 'B'                TO TIEFAL-IDE-EXT-COD-ORG.     0000000
172250           MOVE TIEE10-L0001-BQE   TO TIEFAL-IDE-EXT-BQE.         0000000
172260           MOVE TIEE10-L0001-CAI   TO TIEFAL-IDE-EXT-CAI.         0000000
172270           MOVE DATJOUR            TO TIEFAL-DATE.                0000000
172280           MOVE HEUJOUR            TO TIEFAL-HEURE.               0000000
172290                                                                  0000000
172300                                                                  0000000
172310                                                                  0000000
172320                                                                  0000000
172330                                                                  0000000
172340*-------------------------  TRAITEMENT DES ERREURS GRAVES -       0000000
172350 TRAIT-ERREUR.                                                    0000000
172360*-------------------------                                        0000000
172370*                                                                 0000000
172380     DISPLAY '*** ENREG APPEL = ' APPEL-CLE.                      0000000
172390     DISPLAY '*** CTL-MESSAGE = ' CTL-MESSAGE.                    0000000
172400     DISPLAY '*** ACTION      =  PREVENIR  ' w-dest1.             0000000
172410*PGI - R40738 - 10/06/2011 - DEB                                  0000000
172420     If  not  SIT-ISC-TYPE-TEST                                   0000000
172430*    If  not  site-de-test                                        0000000
172440*PGI - R40738 - 10/06/2011 - FIN                                  0000000
172450         MOVE  62  TO  TEST-1                                     0000000
172460         PERFORM  TRAIT-ANOMALIE.                                 0000000
172470                                                                  0000000
172480*-------------------------  TRAITEMENT FIN PROGRAMMME  ----       0000000
172490 FIN-PGM.                                                         0000000
172500*-------------------------                                        0000000
172510                                                                  0000000
172520     IF  NB-MAJ-KO  >  20                                         0000000
172530         MOVE  51  TO  TEST-1                                     0000000
172540         PERFORM  TRAIT-ANOMALIE.                                 0000000
172550                                                                  0000000
172560d    display 'ipppri-objet :' ipppri-objet '>>'                   0000000
172570                                                                  0000000
172580     DISPLAY 'TOTAL  '                                            0000000
172590             '        '                                           0000000
172600             '************************************'               0000000
172610             '     NBDOC =' CPT-DISP1                             0000000
172620             '     NBLEC =' CPT-DISP2                             0000000
172630             '     NBOUT =' CPT-DISP3.                            0000000
172640                                                                  0000000
172650     MOVE CPT-APPEL         TO NB-ENREG-EDITION.                  0000000
172660     DISPLAY '   - NB ENREG.FICHIER FAPPEL LUS ...........: '     0000000
172670                  NB-ENREG-EDITION.                               0000000
172680     MOVE CPT-IPPMA2        TO NB-ENREG-EDITION.                  0000000
172690     DISPLAY '   - NB MASTER LUS .........................: '     0000000
172700                  NB-ENREG-EDITION.                               0000000
172710     MOVE CPT-IPPCPL        TO NB-ENREG-EDITION.                  0000000
172720     DISPLAY '   - NB IPPCPL LUS .........................: '     0000000
172730                  NB-ENREG-EDITION.                               0000000
172740     MOVE CPT-FACT          TO NB-ENREG-EDITION.                  0000000
172750     DISPLAY '   - NB MVTS. FACTURES .....................: '     0000000
172760                  NB-ENREG-EDITION.                               0000000
172770                                                                  0000000
172780                                                                  0000000
172790     MOVE CPT-EDIT          TO NB-ENREG-EDITION.                  0000000
172800     DISPLAY '   - NB LIGNES EDITION .....................: '     0000000
172810                  NB-ENREG-EDITION.                               0000000
172820     MOVE CPT-ANOM          TO NB-ENREG-EDITION.                  0000000
172830     DISPLAY '   - NB ENREG.FICHIER ANOMALIE ECRITS.......: '     0000000
172840                  NB-ENREG-EDITION.                               0000000
172850     MOVE CPT-RECYC         TO NB-ENREG-EDITION.                  0000000
172860     DISPLAY '   - NB ENREG.FICHIER APPEL RECYCLES .......: '     0000000
172870                  NB-ENREG-EDITION.                               0000000
172880     MOVE CPT-FMVT          TO NB-ENREG-EDITION.                  0000000
172890     DISPLAY '   - NB ENREG.MOUVEMENTS (TRACE) ECRITS.....: '     0000000
172900                  NB-ENREG-EDITION.                               0000000
172910     MOVE CPT-PRETDEV       TO NB-ENREG-EDITION.                  0000000
172920     DISPLAY '   - NB PRETS EN DEVISE.....................: '     0000000
172930                  NB-ENREG-EDITION.                               0000000
172940     MOVE CPT-EVT           TO NB-ENREG-EDITION.                  0000000
172950     DISPLAY '   - NB de EVT crs .......................: '     0000000
172960                  NB-ENREG-EDITION.                               0000000
172970     MOVE CPT-AVENANT-PTZ   TO NB-ENREG-EDITION.                  0000000
172980     DISPLAY '   - NB AVENANT dits PTZ .................: '     0000000
172990                  NB-ENREG-EDITION.                               0000000
173000     MOVE CPT-AVENANT       TO NB-ENREG-EDITION.                  0000000
173010     DISPLAY '   - NB AVENANT dits .....................: '     0000000
173020                  NB-ENREG-EDITION.                               0000000
173030     MOVE TOT-CPT3          TO NB-ENREG-EDITION.                  0000000
173040     DISPLAY '   - NB MVTS. XICS .........................: '     0000000
173050                  NB-ENREG-EDITION.                               0000000
173060     MOVE CPT-IPXMAJ-ECRITS TO NB-ENREG-EDITION.                  0000000
173070     DISPLAY '   - NB IPXMAJ ECRITS POUR MAJ IPPMA2.......: '     0000000
173080                  NB-ENREG-EDITION.                               0000000
173090                                                                  0000000
173100*                                                                 0000000
173110     If   ( PGM-JOBNAME (1:6) = 'PRETJ8'  or                      0000000
173120            PGM-JOBNAME   =     'IPR1J545' )                      0000000
173130          Continue                                                0000000
173140     Else                                                         0000000
173150       If  cpt-anom  not  =  zero                                 0000000
173160           set  y-a-des-anos  to  true                            0000000
173170       End-if                                                     0000000
173180       if  cpt-ipc +  cpt-ipi +  cpt-ipp   not = zero             0000000
173190* Entete                                                          0000000
173200         MOVE space    TO LIGNE-A                                 0000000
173210         PERFORM ECRITURE-ANOMALIE                                0000000
173220                                                                  0000000
173230         MOVE space    TO LIGNE-A                                 0000000
173240         string   '--> '                                          0000000
173250                    pgm-datclair                                  0000000
173260                    delimited  by  size  into  ligne-a            0000000
173270         PERFORM ECRITURE-ANOMALIE                                0000000
173280                                                                  0000000
173290         MOVE space    TO LIGNE-A                                 0000000
173300         string   ' Heure .... '                                  0000000
173310                    pgm-heure                                     0000000
173320                    delimited  by  size  into  ligne-a            0000000
173330         PERFORM ECRITURE-ANOMALIE                                0000000
173340                                                                  0000000
173350         MOVE space    TO LIGNE-A                                 0000000
173360         string   ' Centre .... '                                 0000000
173370                    pgm-nom    '                  '               0000000
173380                    delimited  by  size  into  ligne-a            0000000
173390         PERFORM ECRITURE-ANOMALIE                                0000000
173400                                                                  0000000
173410         MOVE space    TO LIGNE-A                                 0000000
173420         string   ' Nom JOB.............. '                       0000000
173430                     PGM-JOBNAME                                  0000000
173440                  ' Dernire FEDE traite '                       0000000
173450                    SEQ-APPEL-FEDE                                0000000
173460                    delimited  by  size  into  ligne-a            0000000
173470         PERFORM ECRITURE-ANOMALIE                                0000000
173480                                                                  0000000
173490         MOVE space    TO LIGNE-A                                 0000000
173500         string   ' Nom STEP ............ '                       0000000
173510                     PGM-STEPNAME                                 0000000
173520                    delimited  by  size  into  ligne-a            0000000
173530         PERFORM ECRITURE-ANOMALIE                                0000000
173540                                                                  0000000
173550         MOVE space    TO LIGNE-A                                 0000000
173560         string   ' Nom PGM  ............ '                       0000000
173570                    'IPPBATCH'                                    0000000
173580                    delimited  by  size  into  ligne-a            0000000
173590         PERFORM ECRITURE-ANOMALIE                                0000000
173600                                                                  0000000
173610         MOVE space    TO LIGNE-A                                 0000000
173620         string   ' Version PGM ......... '                       0000000
173630                    COMPILE-DATE (4:2)                            0000000
173640                      '/'                                         0000000
173650                    COMPILE-DATE (1:2)                            0000000
173660                      '/'                                         0000000
173670                    COMPILE-DATE (7:2)                            0000000
173680                    '  /  '                                       0000000
173690                    COMPILE-HEURE                                 0000000
173700                    delimited  by  size  into  ligne-a            0000000
173710         PERFORM ECRITURE-ANOMALIE                                0000000
173720                                                                  0000000
173730         MOVE space    TO LIGNE-A                                 0000000
173740         PERFORM ECRITURE-ANOMALIE                                0000000
173750                                                                  0000000
173760         MOVE CPT-IPC           TO NB-ENREG-EDITION               0000000
173770         MOVE space    TO LIGNE-A                                 0000000
173780         string   ' NB contrats IPC ..... '                       0000000
173790                    NB-ENREG-EDITION                              0000000
173800                    delimited  by  size  into  ligne-a            0000000
173810                                                                  0000000
173820         PERFORM ECRITURE-ANOMALIE                                0000000
173830                                                                  0000000
173840         MOVE CPT-IPI           TO NB-ENREG-EDITION               0000000
173850         MOVE space    TO LIGNE-A                                 0000000
173860         string   ' NB contrats IPI ..... '                       0000000
173870                    NB-ENREG-EDITION                              0000000
173880                    delimited  by  size  into  ligne-a            0000000
173890                                                                  0000000
173900         PERFORM ECRITURE-ANOMALIE                                0000000
173910                                                                  0000000
173920         MOVE CPT-IPP           TO NB-ENREG-EDITION               0000000
173930         MOVE space    TO LIGNE-A                                 0000000
173940         string   ' NB contrats IPP ..... '                       0000000
173950                    NB-ENREG-EDITION                              0000000
173960                    delimited  by  size  into  ligne-a            0000000
173970                                                                  0000000
173980         PERFORM ECRITURE-ANOMALIE                                0000000
173990                                                                  0000000
174000         MOVE CPT-AVENANT-ptz   TO NB-ENREG-EDITION               0000000
174010         MOVE space    TO LIGNE-A                                 0000000
174020         string   ' NB Avenants PTZ ..... '                       0000000
174030                    NB-ENREG-EDITION                              0000000
174040                    delimited  by  size  into  ligne-a            0000000
174050                                                                  0000000
174060         PERFORM ECRITURE-ANOMALIE                                0000000
174070                                                                  0000000
174080         MOVE CPT-AVENANT       TO NB-ENREG-EDITION               0000000
174090         MOVE space    TO LIGNE-A                                 0000000
174100         string   ' NB Avenants ......... '                       0000000
174110                    NB-ENREG-EDITION                              0000000
174120                    delimited  by  size  into  ligne-a            0000000
174130                                                                  0000000
174140         PERFORM ECRITURE-ANOMALIE                                0000000
174150                                                                  0000000
174160         MOVE space    TO LIGNE-A                                 0000000
174170         string   '                              ------'          0000000
174180                    delimited  by  size  into  ligne-a            0000000
174190         PERFORM ECRITURE-ANOMALIE                                0000000
174200                                                                  0000000
174210         COMPUTE  CPT-FACT = CPT-IPC + CPT-IPP + CPT-IPI          0000000
174220                                     + CPT-AVENANT                0000000
174230                                     + CPT-AVENANT-PTZ            0000000
174240         MOVE CPT-FACT          TO NB-ENREG-EDITION               0000000
174250         MOVE space    TO LIGNE-A                                 0000000
174260         string   ' NB contrats dits... '                       0000000
174270                    NB-ENREG-EDITION                              0000000
174280                    delimited  by  size  into  ligne-a            0000000
174290                                                                  0000000
174300         PERFORM ECRITURE-ANOMALIE                                0000000
174310     END-IF                                                       0000000
174320     .                                                            0000000
174330     PERFORM FIN-STANDARD.                                        0000000
174340                                                                  0000000
174350*---------------                                                  0000000
174360 FIN-STANDARD.                                                    0000000
174370*---------------                                                  0000000
174380     PERFORM  FERMETURE-ADRESSE-CLIENT.                           0000000
174390     CLOSE FAPPEL                                                 0000000
174400           FANOM                                                  0000000
174410           FRECYC                                                 0000000
174420           FEVT.                                                  0000000
174430                                                                  0000000
174440     IF MAJ-IPPMA2-PAR-IPXBMA2J                                   0000000
174450        CLOSE IPXMAJ                                              0000000
174460     END-IF                                                       0000000
174470                                                                  0000000
174480     PERFORM  SP-ENVOI-MAIL                                       0000000
174490                                                                  0000000
174500     CALL 'ZCALLPGM' USING ZCLOPGM2                               0000000
174510                           INIPGM                                 0000000
174520     END-CALL.                                                    0000000
174530     MOVE ZERO TO RETURN-CODE.                                    0000000
174540                                                                  0000000
174550     STOP RUN.                                                    0000000
174560                                                                  0000000
174570                                                                  0000000
174580 ZDAT2-ZDAT2000.                                                  0000000
174590     INITIALIZE DATS20                                            0000000
174600     IF CV-ZDATE-PARAM-F1-TYPEJ THEN                              0000000
174610         MOVE 'J'  TO  DATS20-I-ENTREE-TYPE1                      0000000
174620     ELSE                                                         0000000
174630         MOVE 'Q'  TO  DATS20-I-ENTREE-TYPE1                      0000000
174640     END-IF                                                       0000000
174650     IF CV-ZDATE-PARAM-F1-SENSJ THEN                              0000000
174660         MOVE 'J'  TO  DATS20-I-ENTREE-SENS1                      0000000
174670     END-IF                                                       0000000
174680     IF CV-ZDATE-PARAM-F1-SENSM THEN                              0000000
174690         MOVE 'M'  TO  DATS20-I-ENTREE-SENS1                      0000000
174700     END-IF                                                       0000000
174710     IF CV-ZDATE-PARAM-F1-SENSA THEN                              0000000
174720         MOVE 'A'  TO  DATS20-I-ENTREE-SENS1                      0000000
174730     END-IF                                                       0000000
174740     IF CV-ZDATE-PARAM-F2-TYPEJ THEN                              0000000
174750         MOVE 'J'  TO  DATS20-I-RETOUR-TYPE1                      0000000
174760     ELSE                                                         0000000
174770         MOVE 'O'  TO  DATS20-I-RETOUR-PACKE                      0000000
174780         MOVE 'Q'  TO  DATS20-I-RETOUR-TYPE1                      0000000
174790     END-IF                                                       0000000
174800     IF CV-ZDATE-PARAM-F2-SENSJ THEN                              0000000
174810         MOVE 'J'  TO  DATS20-I-RETOUR-SENS1                      0000000
174820     END-IF                                                       0000000
174830     IF CV-ZDATE-PARAM-F2-SENSM THEN                              0000000
174840         MOVE 'M'  TO  DATS20-I-RETOUR-SENS1                      0000000
174850     END-IF                                                       0000000
174860     IF CV-ZDATE-PARAM-F2-SENSA THEN                              0000000
174870         MOVE 'A'  TO  DATS20-I-RETOUR-SENS1                      0000000
174880     END-IF                                                       0000000
174890     IF CV-ZDATE-PARAM-F2-SEP THEN                                0000000
174900         MOVE CV-ZDATE-PARAM-SEP TO DATS20-I-RETOUR-SEPAR         0000000
174910     ELSE                                                         0000000
174920         MOVE 'S'                TO DATS20-I-RETOUR-SEPAR         0000000
174930     END-IF                                                       0000000
174940     MOVE CV-ZDATE-DATE1  TO DATS20-I-DATE1                       0000000
174950     MOVE 'D01'           TO DATS20-I-FONCTION                    0000000
174960     MOVE ZDAT2000-GESTION-SIECLE TO DATS20-I-RETOUR-SIECLE       0000000
174970     CALL 'ZCALLPGM' USING ZDAT2000 DATS20                        0000000
174980     IF DATS20-O-PAS-ERREUR  THEN                                 0000000
174990         MOVE DATS20-O-DATE TO CV-ZDATE-DATE2                     0000000
175000     END-IF                                                       0000000
175010     MOVE DATS20-O-CODRET TO CV-ZDATE-PARAM-RETOUR.               0000000
175020                                                                  0000000
175030 ZDAT2-PRETNBJ.                                                   0000000
175040                                                                  0000000
175050         IF DATS20-I-DATE1 < DATS20-I-DATE2                       0000000
175060             MOVE -1         TO    DATS20-O-NBJOURS-9             0000000
175070         ELSE                                                     0000000
175080             MOVE 'E01'      TO    DATS20-I-FONCTION              0000000
175090             MOVE 'J'        TO    DATS20-I-ENTREE-TYPE1          0000000
175100             MOVE 'A'        TO    DATS20-I-ENTREE-SENS1          0000000
175110             MOVE 'J'        TO    DATS20-I-ENTREE-TYPE2          0000000
175120             MOVE 'A'        TO    DATS20-I-ENTREE-SENS2          0000000
175130             CALL 'ZCALLPGM' USING ZDAT2000 DATS20                0000000
175140         END-IF.                                                  0000000
175150* recherche si caisse du cm ou agence du cic                      0000000
175160 RECHERCHE-CM-CIC.                                                0000000
175170                                                                  0000000
175180     INITIALIZE ORGENT                                            0000000
175190                ORGS01                                            0000000
175200                                                                  0000000
175210     SET  ORGENT-TYPE-ELEMENTAIRE  TO TRUE                        0000000
175220     SET  ORGENT-FCT-INFO-STANDARD TO TRUE                        0000000
175230     MOVE APPEL-CAI                TO ORGENT-NUM-GUICHETX         0000000
175240                                                                  0000000
175250*                                                                 0000000
175260D    DISPLAY  'ORGENT *' ORGENT '**'                              0000000
175270                                                                  0000000
175280     CALL  'ZCALLPGM'  USING  ZORGFBC                             0000000
175290                              ORGENT                              0000000
175300                              ORGS01                              0000000
175310     IF  NOT ORGS01-OK                                            0000000
175320                                                                  0000000
175330D        DISPLAY  'ZORGFBC  APPEL EN ERREUR'                      0000000
175340D        DISPLAY  '  CODE RETOUR *' ORGS01-CODE-RETOUR '**'       0000000
175350D        DISPLAY  '  LIBELLE     *' ORGS01-CR-LIBELLE             0000000
175360D        DISPLAY  '  ORGS01      *' ORGS01 '**'                   0000000
175370D        DISPLAY  '  ORGS01-banque  *' ORGS01-banque              0000000
175380                                                                  0000000
175390        MOVE  ORGS01-CR-LIBELLE   TO  ANOM-01                     0000000
175400        MOVE  ORGS01-CODE-RETOUR  TO  CTL-R34                     0000000
175410        MOVE  01                  TO  TEST-1                      0000000
175420        PERFORM  TRAIT-ANOMALIE                                   0000000
175430*                                                                 0000000
175440       ELSE                                                       0000000
175450*                                                                 0000000
175460          IF  ORGENT-NUM-GUICHETX  = '06120'                      0000000
175470              SET  ORGS01-ASSIMILE-IDF   TO   TRUE                0000000
175480          Else                                                    0000000
175490                                                                  0000000
175500            IF  ORGS01-BANQUE        = '13070'                    0000000
175510                SET  ORGS01-FEDE-CEE       TO   TRUE              0000000
175520                SET  ORGS01-BANQUE-CM      TO   TRUE              0000000
175530            END-IF                                                0000000
175540          End-if                                                  0000000
175550D        DISPLAY  'ZORGFBC  APPEL CORRECT'                        0000000
175560D        DISPLAY  '  CODE RETOUR *' ORGS01-CODE-RETOUR '**'       0000000
175570D        DISPLAY  '  SITE        *' ORGS01-CENTREL '**'           0000000
175580D        DISPLAY  '  ORGS01      *' ORGS01 '**'                   0000000
175590     END-IF                                                       0000000
175600                                                                  0000000
175610*PGI - R40738 - 10/06/2011 - DEB                                  0000000
175620     If  SIT-ISC-TYPE-TEST        or                              0000000
175630*    If  XX-SITE-MODULE  =  'NI'  or                              0000000
175640*PGI - R40738 - 10/06/2011 - FIN                                  0000000
175650          orgs01-fede-cee         or                              0000000
175660          orgs01-fede-laval       or                              0000000
175670          orgs01-fede-arras       or                              0000000
175680          orgs01-fede-antilles                                    0000000
175690          set  88-ps-oui  to  true                                0000000
175700     Else                                                         0000000
175710          set  88-ps-non  to  true                                0000000
175720     End-if                                                       0000000
175730     .                                                            0000000
175740                                                                  0000000
175750                                                                  0000000
175760D    DISPLAY 'IMS = ' ZISC-IMS.                                   0000000
175770D    DISPLAY 'FEDE= ' ORGS01-FEDE.                                0000000
175780D    DISPLAY 'ASSIMIL = ' ORGS01-FEDERATION-ASSIMIL.              0000000
175790*-------------------------                                        0000000
175800 RECHERCHE-LIBELLE-CAISSE.                                        0000000
175810*-------------------------                                        0000000
175820                                                                  0000000
175830     INITIALIZE ORGENT                                            0000000
175840                ORGS03.                                           0000000
175850                                                                  0000000
175860     SET ORGENT-TYPE-UNITAIRE        TO TRUE                      0000000
175870     SET ORGENT-FCT-INFO-STANDARD    TO TRUE                      0000000
175880     SET ORGENT-RADICAL-OBJET-GUICHET TO TRUE                     0000000
175890     SET ORGENT-BMP                  TO TRUE                      0000000
175900     move  space                     TO ORGENT-NOM-OBJET          0000000
175910     STRING  ORGS01-BANQUE                                        0000000
175920             APPEL-CAI                                            0000000
175930                            DELIMITED BY SIZE                     0000000
175940                                      INTO ORGENT-NOM-OBJET       0000000
175950d    display 'ORGENT-NOM-OBJET '           ORGENT-NOM-OBJET       0000000
175960                                                                  0000000
175970     CALL 'ZCALLPGM' USING ZORGFBC                                0000000
175980                           ORGENT                                 0000000
175990                           ORGS03.                                0000000
176000                                                                  0000000
176010     IF NOT ORGS03-OK                                             0000000
176020D        DISPLAY  'ZORGFBC  APPEL EN ERREUR'                      0000000
176030D        DISPLAY  '  CODE RETOUR *' ORGS03-CODE-RETOUR '**'       0000000
176040D        DISPLAY  '  LIBELLE     *' ORGS03-CR-LIBELLE             0000000
176050D        DISPLAY  '  ORGS01      *' ORGS03 '**'                   0000000
176060                                                                  0000000
176070        MOVE  ORGS03-CR-LIBELLE   TO  ANOM-01                     0000000
176080        MOVE  ORGS03-CODE-RETOUR  TO  CTL-R34                     0000000
176090        MOVE  01                  TO  TEST-1                      0000000
176100        PERFORM  TRAIT-ANOMALIE                                   0000000
176110     END-IF                                                       0000000
176120     .                                                            0000000
176130                                                                  0000000
176140                                                                  0000000
176150***********************************                               0000000
176160*  APPEL MODULE ZORGFBC POUR GAR  *                               0000000
176170************************************                              0000000
176180*                                                                 0000000
176190  APPEL-ZORGFBCG.                                                 0000000
176200                                                                  0000000
176210     INITIALIZE ORGS01G                                           0000000
176220                                                                  0000000
176230     SET   ORGENT-TYPE-ELEMENTAIRE   TO TRUE                      0000000
176240     SET   ORGENT-FCT-INFO-STANDARD  TO TRUE                      0000000
176250                                                                  0000000
176260*                                                                 0000000
176270D    DISPLAY  'ORGENT *' ORGENT '**'                              0000000
176280                                                                  0000000
176290     CALL  'ZCALLPGM'  USING  ZORGFBC                             0000000
176300                              ORGENT                              0000000
176310                              ORGS01G                             0000000
176320     IF  NOT ORGS01G-OK                                           0000000
176330                                                                  0000000
176340D        DISPLAY  'ZORGFBC GAR APPEL EN ERREUR'                   0000000
176350D        DISPLAY  '  CODE RETOUR *' ORGS01G-CODE-RETOUR '**'      0000000
176360D        DISPLAY  '  LIBELLE     *' ORGS01G-CR-LIBELLE            0000000
176370D        DISPLAY  '  ORGS01      *' ORGS01G '**'                  0000000
176380                                                                  0000000
176390        MOVE  ORGS01G-CR-LIBELLE   TO  ANOM-01                    0000000
176400        MOVE  ORGS01G-CODE-RETOUR  TO  CTL-R34                    0000000
176410        MOVE  01                   TO  TEST-1                     0000000
176420        PERFORM  TRAIT-ANOMALIE                                   0000000
176430*                                                                 0000000
176440D      ELSE                                                       0000000
176450         IF  ORGENT-NUM-GUICHETX  = '06120'                       0000000
176460             SET  ORGS01G-ASSIMILE-IDF   TO   TRUE                0000000
176470         END-IF                                                   0000000
176480                                                                  0000000
176490D        DISPLAY  'ZORGFBC GAR APPEL CORRECT'                     0000000
176500D        DISPLAY  '  CODE RETOUR *' ORGS01G-CODE-RETOUR '**'      0000000
176510D        DISPLAY  '  SITE        *' ORGS01G-CENTREL '**'          0000000
176520D        DISPLAY  '  ORGS01      *' ORGS01G '**'                  0000000
176530     END-IF                                                       0000000
176540     .                                                            0000000
176550                                                                  0000000
176560 RECHERCHE-LIB-BUREAU.                                            0000000
176570*                                                                 0000000
176580                                                                  0000000
176590     INITIALIZE ORGENT                                            0000000
176600                ORGS03A.                                          0000000
176610                                                                  0000000
176620     MOVE  SPACES                  TO  ORGENT                     0000000
176630     SET  ORGENT-TP                TO  TRUE                       0000000
176640     SET  ORGENT-TYPE-UNITAIRE     TO  TRUE                       0000000
176650     SET  ORGENT-FCT-INFO-STANDARD TO  TRUE                       0000000
176660     SET  ORGENT-RADICAL-OBJET-BUREAU  TO TRUE                    0000000
176670     MOVE  SPACES                  TO  ORGENT-NOM-OBJET           0000000
176680     if  APPEL-ROUT-FILL(2:2)  numeric                            0000000
176690         STRING  ORGS01-BANQUE                                    0000000
176700                 APPEL-CAI                                        0000000
176710                 APPEL-ROUT-FILL(2:2)                             0000000
176720            DELIMITED  BY  SIZE                                   0000000
176730            INTO                        ORGENT-NOM-OBJET          0000000
176740     Else                                                         0000000
176750         STRING  ORGS01-BANQUE                                    0000000
176760                 APPEL-CAI                                        0000000
176770                 '00'                                             0000000
176780            DELIMITED  BY  SIZE                                   0000000
176790            INTO                        ORGENT-NOM-OBJET          0000000
176800     End-if                                                       0000000
176810                                                                  0000000
176820*    MOVE  APPEL-ROUT-FILL(2:2) TO    IPPPRI-BUREAU               0000000
176830                                                                  0000000
176840     CALL  'ZCALLPGM'  USING  ZORGFBC                             0000000
176850                              ORGENT                              0000000
176860                              ORGS03A                             0000000
176870                                                                  0000000
176880     END-CALL                                                     0000000
176890                                                                  0000000
176900     IF  NOT  ORGS03A-OK                                          0000000
176910                                                                  0000000
176920d        DISPLAY  '*** ZORGFBC APPEL ORGS03 BUREAU EN ERREUR ** ' 0000000
176930d                      ORGENT-NOM-OBJET                     ' **' 0000000
176940d        DISPLAY  '    CODE RETOUR *' ORGS03A-CODE-RETOUR   ' **' 0000000
176950d        DISPLAY  '    LIBELLE     *' ORGS03A-CR-LIBELLE    ' **' 0000000
176960                                                                  0000000
176970         MOVE  SPACE                 TO   CAI-NOM-UAG             0000000
176980     else                                                         0000000
176990         MOVE  ORGS03A-BUR-LIBELLE   to   CAI-NOM-UAG             0000000
177000d        display  'Bureau '    ORGENT-NOM-OBJET                   0000000
177010d        display   ORGS03A-BUR-LIBELLE                            0000000
177020     END-IF                                                       0000000
177030     .                                                            0000000
177040                                                                  0000000
177050                                                                  0000000
177060*------------------------*                                        0000000
177070 TRAITEMENT-FRAIS-TIMBRE.                                         0000000
177080*------------------------*                                        0000000
177090*                                                                 0000000
177100                                                                  0000000
177110d    display 'say-nb-timbres = ' say-nb-timbre9                   0000000
177120d    display '1= calx , 0=cal1 '                                  0000000
177130     IF  SAY-NB-TIMBRES  NUMERIC  AND                             0000000
177140         SAY-NB-TIMBRE9  >  ZEROS                                 0000000
177150           PERFORM  TRAITEMENT-FRAIS-TIMBRE-S                     0000000
177160     END-IF.                                                      0000000
177170*                                                                 0000000
177180 TRAITEMENT-FRAIS-TIMBRE-S.                                       0000000
177190*------------------------*                                        0000000
177200                                                                  0000000
177210d    display 'say-fraut9 = ' say-fraut9                           0000000
177220     MOVE  ZEROS             TO  ZZ-FRAIS-TIMB                    0000000
177230     MOVE  ZEROS             TO  ZZ-FRAUT9                        0000000
177240     IF  SAY-FRAUT  NOT  NUMERIC                                  0000000
177250         MOVE  ZEROS         TO  SAY-FRAUT9                       0000000
177260     END-IF                                                       0000000
177270     MOVE  SAY-FRAUT9        TO  ZZ-FRAUT9                        0000000
177280                                                                  0000000
177290     INITIALIZE  IPCTIM                                           0000000
177300     if   SAY-NB-TIMBRES  numeric                                 0000000
177310          MOVE  SAY-NB-TIMBRE9        TO  IPCTIM-NB-TIM           0000000
177320     END-IF                                                       0000000
177330     MOVE  SAY-FED               TO  IPCTIM-FED                   0000000
177340     MOVE  SAY-BANQ              TO  IPCTIM-BANQUE                0000000
177350     MOVE  SAY-NCAIS             TO  IPCTIM-CAISSE                0000000
177360     MOVE  SAY-CNAT              TO  IPCTIM-CNAT                  0000000
177370     MOVE  SAY-CD-SOUS-PROD      TO  IPCTIM-SPRD                  0000000
177380     MOVE  SAY-DEVISE            TO  IPCTIM-DEV-DOS               0000000
177390     MOVE  W-DATE                TO  IPCTIM-DATOFF                0000000
177400                                                                  0000000
177410     IF  IPPMA2-NOTAIRE  NOT  =  SPACES                           0000000
177420          MOVE  'O'    TO  IPCTIM-NOTAIRE                         0000000
177430       ELSE                                                       0000000
177440          MOVE  'N'    TO  IPCTIM-NOTAIRE                         0000000
177450     END-IF                                                       0000000
177460                                                                  0000000
177470*                                                                 0000000
177480                                                                  0000000
177490     CALL  'ZCALLPGM'  USING  ZPRTTIMB                            0000000
177500                              IPCTIM                              0000000
177510                              CTL                                 0000000
177520                              PCBCO1                              0000000
177530                              PCBCO2                              0000000
177540                              PCBCO3                              0000000
177550                              PCBCO4                              0000000
177560                              PCBSPI                              0000000
177570                              IOPCB                               0000000
177580     END-CALL                                                     0000000
177590                                                                  0000000
177600     IF   IPCTIM-RETCOD  =  ZERO                                  0000000
177610          MOVE  ZERO            TO  CTL-R34                       0000000
177620          MOVE  IPCTIM-MT-TIM9  TO  ZZ-FRAIS-TIMB                 0000000
177630     ELSE                                                         0000000
177640          MOVE  ZEROS           TO  ZZ-FRAIS-TIMB                 0000000
177650          MOVE  IPCTIM-RETCOD   TO  CTL-R34                       0000000
177660          MOVE  IPCTIM-LIBELLE  TO  ANOM-LIB-56                   0000000
177670          MOVE  56              TO  TEST-1                        0000000
177680          PERFORM  TRAIT-ANOMALIE                                 0000000
177690     END-IF                                                       0000000
177700                                                                  0000000
177710     ADD   ZZ-FRAIS-TIMB        TO  ZZ-FRAUT9                     0000000
177720     MOVE  ZZ-FRAUT9            TO  SAY-FRAUT9                    0000000
177730     move  zero                 to  SAY-NB-TIMBRES                0000000
177740                                                                  0000000
177750     .                                                            0000000
177760                                                                  0000000
177770***  fin frais timbre                                             0000000
177780                                                                  0000000
177790*                                                                 0000000
177800*                                                                 0000000
177810*------------------------*                                        0000000
177820 CLAUSES-AUTRES-PRESCRIP.                                         0000000
177830*------------------------*                                        0000000
177840                                                                  0000000
177850d    display '** CLAUSES-AUTRES-PRESCRIP  **'                     0000000
177860d    DISPLAY 'CLAUSES-AUTRES  PRESCRIP DEBUT'.                    0000000
177870d    DISPLAY '-IP          = ' IP.                                0000000
177880d    DISPLAY '-CLAUSIER-AUTRES PRESCRI DEBUT = ' CLAUSIER-AUTRES. 0000000
177890d    DISPLAY 'ICLAUA  '  ICLAUA.                                  0000000
177900                                                                  0000000
177910     IF  NOT  (SAY-PRESCRI  = SPACES  OR  ZEROS)                  0000000
177920            PERFORM  SP-RECH-PRESCRI                              0000000
177930     END-IF                                                       0000000
177940     .                                                            0000000
177950D    DISPLAY '-CLAUSIER-AUTRES PRESCRI FIN   = ' CLAUSIER-AUTRES. 0000000
177960                                                                  0000000
177970*----------------*                                                0000000
177980 SP-RECH-PRESCRI.                                                 0000000
177990*----------------*                                                0000000
178000                                                                  0000000
178010                                                                  0000000
178020d    DISPLAY  'Debut Gespar IPXPRESC'                             0000000
178030     INITIALIZE                    PARFRE                         0000000
178040     INITIALIZE                    ZPAVRE                         0000000
178050     INITIALIZE                    PARFAL                         0000000
178060                                                                  0000000
178070     MOVE  'IPP'                TO PARFAL-BLOC-EME                0000000
178080     MOVE  'IPPBATCH'           TO PARFAL-PGM-EME                 0000000
178090     MOVE  'IPR1'               TO PARFAL-APL-EME                 0000000
178100     MOVE  'CENTRAL'            TO PARFAL-TYP-EME                 0000000
178110     SET PARFAL-TEMPS-DIFFERE-IMS  TO TRUE                        0000000
178120     MOVE  'IPPBATCH'           TO PARFAL-IDE-LGE                 0000000
178130                                   PARFAL-IDE-PHY                 0000000
178140     MOVE  DATJOURN             TO PARFAL-DATE                    0000000
178150     MOVE  HEUJOURN             TO PARFAL-HEURE                   0000000
178160     MOVE  'PAR-PARAMETRE-TECHNIQUE' TO PARFAL-OBJ-GES            0000000
178170     MOVE  'L1003'              TO PARFAL-FON                     0000000
178180     MOVE  'LEI'                TO PARFAL-TYP-ACN                 0000000
178190                                                                  0000000
178200     INITIALIZE                    ZPAVAL                         0000000
178210     MOVE  'IPXPRESC'           TO ZPAVAL-L1003-COD-TAB           0000000
178220     MOVE  SAY-PRESCRI          TO ZPAVAL-L1003-CLE-POS-TAB       0000000
178230                                                                  0000000
178240     MOVE  '='                  TO ZPAVAL-L1003-COD-OPE           0000000
178250     MOVE  1                    TO ZPAVAL-L1003-NUM-CURS          0000000
178260     MOVE  DATE10               TO ZPAVAL-L1003-DATE-CONSULT      0000000
178270     MOVE  SPACE                TO ZPAVAL-L1003-COD-GRP           0000000
178280                                   ZPAVAL-L1003-COD-FED           0000000
178290                                   ZPAVAL-L1003-COD-BQE           0000000
178300     MOVE  ZERO                 TO ZPAVAL-L1003-CHOIX-POSTE       0000000
178310                                   ZPAVAL-L1003-FUSION            0000000
178320                                                                  0000000
178330     SET  ZPAVAL-L1003-APPEL-INITIAL TO TRUE                      0000000
178340d    DISPLAY  'PARFAL ' PARFAL                                    0000000
178350d    DISPLAY  'ZPAVAL ' ZPAVAL                                    0000000
178360     CALL  'ZCALLPGM' USING ZPARAPEL                              0000000
178370                            PARFAL                                0000000
178380                            ZPAVAL                                0000000
178390                            PARFRE                                0000000
178400                            ZPAVRE                                0000000
178410     END-CALL                                                     0000000
178420d    DISPLAY  'PARFRE ' PARFRE                                    0000000
178430                                                                  0000000
178440d    DISPLAY  'CLAUSIER-AUTRES AVANT' CLAUSIER-AUTRES             0000000
178450d    DISPLAY  'ICLAUA ' ICLAUA                                    0000000
178460     IF  PARFRE-TRT-CORRECT                                       0000000
178470d      DISPLAY 'ZPAVRE-L1003-ZON-VAR-PO ' ZPAVRE-L1003-ZON-VAR-PO 0000000
178480       MOVE  ZPAVRE-L1003-ZON-VAR-PO TO GESPAR-PRESCRIP           0000000
178490d      DISPLAY  'TAB-PRESCRIP ' TAB-PRESCRIP                      0000000
178500       IF  ICLAUA LESS THAN NB-CLA                                0000000
178510         IF  NOT  (NO-CLAUSE-PRESCRIP  =  SPACE  OR  ZERO)        0000000
178520             ADD   1                   TO ICLAUA                  0000000
178530             MOVE  1   TO D-AUTRES-PRET (ICLAUA)                  0000000
178540             MOVE  NO-CLAUSE-PRESCRIP  TO  D-AUTRES (ICLAUA)      0000000
178550         END-IF                                                   0000000
178560       END-IF                                                     0000000
178570     END-IF                                                       0000000
178580d    DISPLAY  'CLAUSIER-AUTRES APRES' CLAUSIER-AUTRES             0000000
178590d    DISPLAY  'ICLAUA ' ICLAUA                                    0000000
178600d    DISPLAY  'Fin Gespar IPXPRESC'                               0000000
178610     .                                                            0000000
178620                                                                  0000000
178630*NDE-27/05/2003 - Dbut                                           0000000
178640 INIT-ATMXAR.                                                     0000000
178650                                                                  0000000
178660     INITIALIZE ATMXAR                                            0000000
178670     MOVE DATJOUR                  TO ATMXAR-ORIMSG-DATDMD        0000000
178680     MOVE HEUJOUR                  TO ATMXAR-ORIMSG-HEUDMD        0000000
178690     MOVE 'IPI'                    TO ATMXAR-ORIMSG-BLCEME        0000000
178700     MOVE 'IPPBATCH'               TO ATMXAR-ORIMSG-PGMEME        0000000
178710     SET  ATMXAR-MODTRT-TMSDIF     TO TRUE                        0000000
178720     SET  ATMXAR-TYPACN-UNQ        TO TRUE                        0000000
178730     MOVE 'X1011'                  TO ATMXAR-SCEDMD-FCT           0000000
178740     .                                                            0000000
178750                                                                  0000000
178760 ALIM-YACMPSB.                                                    0000000
178770                                                                  0000000
178780     MOVE LOW-VALUE             TO YACMPSB                        0000000
178790                                                                  0000000
178800     MOVE 'SPITAB'              TO ACMPSB-IDENT-PCB (1)           0000000
178810     SET  ACMPSB-PTR-PCB (1)    TO ADDRESS OF PCBSPI              0000000
178820     MOVE 1                     TO ACMPSB-NB-PCB                  0000000
178830     .                                                            0000000
178840                                                                  0000000
178850                                                                  0000000
178860 APPEL-APRGAPEL-O.                                                0000000
178870                                                                  0000000
178880     PERFORM INIT-ATMXAR                                          0000000
178890     INITIALIZE APRE11 APRS11                                     0000000
178900     SET   APRE11-ACCES-BATCH-OUV   TO TRUE                       0000000
178910                                                                  0000000
178920     CALL 'ZCALLPGM' USING  APRGAPEL                              0000000
178930                            ATMXAR                                0000000
178940                            APRE11                                0000000
178950                            APRS11                                0000000
178960                                                                  0000000
178970     IF NOT ATMXAR-CODRET-TRTCRF                                  0000000
178980D        DISPLAY 'PB APRGAPEL : ' ATMXAR-RTA-MSGERRMET            0000000
178990         MOVE SPACE    TO LIGNE-A                                 0000000
179000         STRING   ' PB APRGAPEL-O:'                               0000000
179010                    ATMXAR-RTA-MSGERRMET(1:65)                    0000000
179020                    DELIMITED  BY  SIZE  INTO  LIGNE-A            0000000
179030         PERFORM ECRITURE-ANOMALIE                                0000000
179040     END-IF                                                       0000000
179050     .                                                            0000000
179060 APPEL-APRGAPEL-F.                                                0000000
179070                                                                  0000000
179080     PERFORM INIT-ATMXAR                                          0000000
179090     INITIALIZE APRE11 APRS11                                     0000000
179100     SET   APRE11-ACCES-BATCH-FER   TO TRUE                       0000000
179110                                                                  0000000
179120     CALL 'ZCALLPGM' USING  APRGAPEL                              0000000
179130                            ATMXAR                                0000000
179140                            APRE11                                0000000
179150                            APRS11                                0000000
179160                                                                  0000000
179170     IF NOT ATMXAR-CODRET-TRTCRF                                  0000000
179180D        DISPLAY 'PB APRGAPEL : ' ATMXAR-RTA-MSGERRMET            0000000
179190         MOVE SPACE    TO LIGNE-A                                 0000000
179200         STRING   ' PB APRGAPEL-F:'                               0000000
179210                    ATMXAR-RTA-MSGERRMET(1:65)                    0000000
179220                    DELIMITED  BY  SIZE  INTO  LIGNE-A            0000000
179230         PERFORM ECRITURE-ANOMALIE                                0000000
179240     END-IF                                                       0000000
179250     .                                                            0000000
179260*NDE-27/05/2003 - Fin                                             0000000
179270                                                                  0000000
179280*-------------------------                                        0000000
179290 LECTURE-CAISSE.                                                  0000000
179300*-------------------------                                        0000000
179310*                                                                 0000000
179320                                                                  0000000
179330     MOVE ZERO          TO CTL-R34.                               0000000
179340     MOVE APPEL-FED     TO SEQ-APPEL-FEDE.                        0000000
179350     MOVE APPEL-CAI     TO SEQ-APPEL-CAIS.                        0000000
179360     MOVE APPEL-ROUT    TO SEQ-ROUT.                              0000000
179370                                                                  0000000
179380     If APPEL-FEDECAIS = '1400389'                                0000000
179390       OR ( APPEL-FEDECAIS >= '1400381'                           0000000
179400        AND APPEL-FEDECAIS <= '1400384' )                         0000000
179410          MOVE  '00399'     TO  SEQ-APPEL-CAIS                    0000000
179420     End-If                                                       0000000
179430                                                                  0000000
179440**** Lecture ORGS01 Pour guichet  ----> ORGS01C                   0000000
179450                                                                  0000000
179460     PERFORM  LEC-ORG01-GUI                                       0000000
179470                                                                  0000000
179480**** Lecture ORGS03 pour Guichet  ----> ORGS03G                   0000000
179490                                                                  0000000
179500     IF  CTL-R34  =  ZEROS                                        0000000
179510         PERFORM  LEC-ORG03-GUI                                   0000000
179520     END-IF                                                       0000000
179530                                                                  0000000
179540**** Lecture ORGS03 pour Bureau   ----> ORGS03B                   0000000
179550                                                                  0000000
179560     IF  CTL-R34  =  ZEROS                                        0000000
179570         PERFORM  LEC-ORG03-BUR                                   0000000
179580     END-IF                                                       0000000
179590                                                                  0000000
179600* renseigner ......                                               0000000
179610                                                                  0000000
179620     MOVE ZERO  TO  CAI-CPT1                                      0000000
179630                    CAI-CPT2                                      0000000
179640                    CAI-CPT3                                      0000000
179650     MOVE  ORGS01C-FEDE     TO  CAI-FEDE                          0000000
179660     MOVE  ORGS01C-GUICHET  TO  CAI-CAISSE                        0000000
179670     PERFORM  INIT-IPPCAI                                         0000000
179680     PERFORM   REMPLI-ZONES-FIXES                                 0000000
179690     .                                                            0000000
179700                                                                  0000000
179710*--------------*                                                  0000000
179720 LEC-ORG01-GUI.                                                   0000000
179730*--------------*                                                  0000000
179740                                                                  0000000
179750     INITIALIZE ORGENT                                            0000000
179760                ORGS01C                                           0000000
179770                                                                  0000000
179780     SET  ORGENT-TYPE-ELEMENTAIRE  TO TRUE                        0000000
179790     SET  ORGENT-FCT-INFO-STANDARD TO TRUE                        0000000
179800                                                                  0000000
179810     MOVE SEQ-APPEL-CAIS           TO ORGENT-NUM-GUICHETX         0000000
179820                                                                  0000000
179830     CALL 'ZCALLPGM' USING ZORGFBC                                0000000
179840                           ORGENT                                 0000000
179850                           ORGS01C                                0000000
179860     END-CALL                                                     0000000
179870                                                                  0000000
179880     IF  NOT  ORGS01C-OK                                          0000000
179890         MOVE  ORGS01C-CODE-RETOUR        TO  CTL-R34             0000000
179900         MOVE  ZERO                       TO  CTL-R12             0000000
179910         MOVE  ORGS01C-CR-LIBELLE (1:40)  TO  ANOM-44             0000000
179920         MOVE  44                         TO TEST-1               0000000
179930         PERFORM  TRAIT-ANOMALIE                                  0000000
179940         MOVE  SPACE                      TO  ORGS01C-PRIVE       0000000
179950D        DISPLAY 'libelle err orgs01c : ' ORGS01C-CR-LIBELLE      0000000
179960     END-IF                                                       0000000
179970     .                                                            0000000
179980                                                                  0000000
179990*                                                                 0000000
180000*****    RECHERCHE ORGS03 GUICHET                                 0000000
180010*                                                                 0000000
180020                                                                  0000000
180030*--------------*                                                  0000000
180040 LEC-ORG03-GUI.                                                   0000000
180050*--------------*                                                  0000000
180060                                                                  0000000
180070     INITIALIZE ORGENT                                            0000000
180080                ORGS03G                                           0000000
180090                                                                  0000000
180100     MOVE  SPACES                       TO  ORGENT                0000000
180110     SET  ORGENT-TP                     TO  TRUE                  0000000
180120     SET  ORGENT-TYPE-UNITAIRE          TO  TRUE                  0000000
180130     SET  ORGENT-FCT-INFO-STANDARD      TO  TRUE                  0000000
180140     SET  ORGENT-RADICAL-OBJET-GUICHET  TO  TRUE                  0000000
180150     MOVE  SPACES                  TO  ORGENT-NOM-OBJET           0000000
180160                                                                  0000000
180170     STRING  ORGS01C-BANQUE  ORGS01C-GUICHET                      0000000
180180        DELIMITED  BY  SIZE                                       0000000
180190        INTO                        ORGENT-NOM-OBJET              0000000
180200                                                                  0000000
180210     CALL  'ZCALLPGM'  USING  ZORGFBC                             0000000
180220                              ORGENT                              0000000
180230                              ORGS03G                             0000000
180240     END-CALL                                                     0000000
180250                                                                  0000000
180260     IF  NOT  ORGS03G-OK                                          0000000
180270                                                                  0000000
180280d        DISPLAY  '*** ZORGFBC APPEL ORGS03 GUICHET EN ERREUR ** '0000000
180290d                ORGS01C-BANQUE ' ** '  ORGS01C-GUICHET    ' **'  0000000
180300d        DISPLAY  '    CODE RETOUR *'  ORGS03G-CODE-RETOUR ' **'  0000000
180310d        DISPLAY  '    LIBELLE     *'  ORGS03G-CR-LIBELLE  ' **'  0000000
180320                                                                  0000000
180330         MOVE  ORGS03G-CODE-RETOUR        TO  CTL-R34             0000000
180340         MOVE  ZERO                       TO  CTL-R12             0000000
180350         MOVE  ORGS03G-CR-LIBELLE (1:40)  TO  ANOM-44             0000000
180360         MOVE  44                         TO  TEST-1              0000000
180370         PERFORM  TRAIT-ANOMALIE                                  0000000
180380         MOVE  SPACE                      TO  ORGS03G-PRIVE       0000000
180390     END-IF                                                       0000000
180400     .                                                            0000000
180410                                                                  0000000
180420*                                                                 0000000
180430*****    RECHERCHE ORGS03B BUREAU                                 0000000
180440*                                                                 0000000
180450                                                                  0000000
180460*--------------*                                                  0000000
180470 LEC-ORG03-BUR.                                                   0000000
180480*--------------*                                                  0000000
180490                                                                  0000000
180500     INITIALIZE ORGENT                                            0000000
180510                ORGS03B.                                          0000000
180520                                                                  0000000
180530     MOVE  SPACES                  TO  ORGENT                     0000000
180540     SET  ORGENT-TP                TO  TRUE                       0000000
180550     SET  ORGENT-TYPE-UNITAIRE     TO  TRUE                       0000000
180560     SET  ORGENT-FCT-INFO-STANDARD TO  TRUE                       0000000
180570     SET  ORGENT-RADICAL-OBJET-BUREAU  TO TRUE                    0000000
180580     MOVE  SPACES                  TO  ORGENT-NOM-OBJET           0000000
180590                                                                  0000000
180600     STRING  ORGS01C-BANQUE                                       0000000
180610             ORGS01C-GUICHET                                      0000000
180620             '00'                                                 0000000
180630        DELIMITED  BY  SIZE                                       0000000
180640        INTO                        ORGENT-NOM-OBJET              0000000
180650                                                                  0000000
180660     CALL  'ZCALLPGM'  USING  ZORGFBC                             0000000
180670                              ORGENT                              0000000
180680                              ORGS03B                             0000000
180690     END-CALL                                                     0000000
180700                                                                  0000000
180710     IF  NOT  ORGS03B-OK                                          0000000
180720                                                                  0000000
180730d        DISPLAY  '*** ZORGFBC APPEL ORGS03 BUREAU EN ERREUR ** ' 0000000
180740d                   ORGS01C-BANQUE ' ** '  ORGS01C-GUICHET ' **'  0000000
180750d        DISPLAY  '    CODE RETOUR *' ORGS03B-CODE-RETOUR   ' **' 0000000
180760d        DISPLAY  '    LIBELLE     *' ORGS03B-CR-LIBELLE    ' **' 0000000
180770                                                                  0000000
180780         MOVE  ORGS03B-CODE-RETOUR        TO  CTL-R34             0000000
180790         MOVE  ZERO                       TO  CTL-R12             0000000
180800         MOVE  ORGS03B-CR-LIBELLE (1:40)  TO  ANOM-44             0000000
180810         MOVE  44                         TO  TEST-1              0000000
180820         PERFORM  TRAIT-ANOMALIE                                  0000000
180830         MOVE  SPACE                      TO  ORGS03B-PRIVE       0000000
180840     END-IF                                                       0000000
180850                                                                  0000000
180860     .                                                            0000000
180870                                                                  0000000
180880                                                                  0000000
180890*----------------*                                                0000000
180900 INIT-IPPCAI-ORG.                                                 0000000
180910*----------------*                                                0000000
180920*                                                                 0000000
180930                                                                  0000000
180940     MOVE ORGS03G-GUI-LIBEL-STD  TO  W-LIB-01-36.                 0000000
180950                                                                  0000000
180960     PERFORM INIT1-IPPCAI.                                        0000000
180970                                                                  0000000
180980     IF  CAI-CAISIGLE  =  SPACES                                  0000000
180990         MOVE  ORGS03G-GUI-LIBEL-COUR    TO  W-LIB-01-36          0000000
181000         PERFORM  INIT1-IPPCAI                                    0000000
181010     END-IF                                                       0000000
181020                                                                  0000000
181030d    display  'CAI-CAINMSTD '  CAI-CAINMSTD                       0000000
181040d    display  'CAI-CAISIGLE '  CAI-CAISIGLE                       0000000
181050d    display  'CAI-CAINMSPE '  CAI-CAINMSPE                       0000000
181060     .                                                            0000000
181070                                                                  0000000
181080*-------------*                                                   0000000
181090 INIT1-IPPCAI.                                                    0000000
181100*-------------*                                                   0000000
181110*                                                                 0000000
181120                                                                  0000000
181130     IF   W-LIB-01-05 = 'CMDP '                                   0000000
181140          PERFORM INIT-NOM-CAISSE-CMDP                            0000000
181150     ELSE                                                         0000000
181160     IF   W-LIB-01-05 = 'CMPS '                                   0000000
181170          PERFORM INIT-NOM-CAISSE-CMPS                            0000000
181180     ELSE                                                         0000000
181190     IF   W-LIB-01-04 = 'CME '                                    0000000
181200          PERFORM INIT-NOM-CAISSE-CME                             0000000
181210     ELSE                                                         0000000
181220     IF   W-LIB-01-04 = 'CCM '                                    0000000
181230          PERFORM INIT-NOM-CAISSE-CCM                             0000000
181240     ELSE                                                         0000000
181250     IF   W-LIB-01-04 = 'BER '                                    0000000
181260          PERFORM INIT-NOM-CAISSE-BER                             0000000
181270     ELSE                                                         0000000
181280     IF   W-LIB-01-05 = 'CESE '                                   0000000
181290          PERFORM INIT-NOM-CAISSE-CESE                            0000000
181300     ELSE                                                         0000000
181310     IF   W-LIB-01-05 = 'CFCM '                                   0000000
181320          PERFORM INIT-NOM-CAISSE-CFCM                            0000000
181330     ELSE                                                         0000000
181340     IF   W-LIB-01-03 = 'CM '                                     0000000
181350          PERFORM INIT-NOM-CAISSE-CM                              0000000
181360     ELSE                                                         0000000
181370     IF   CAI-CAICODE = '00370'                                   0000000
181380          PERFORM INIT-NOM-CAISSE-370                             0000000
181390     ELSE                                                         0000000
181400          PERFORM INIT-NOM-CAISSE-AUTRE                           0000000
181410     .                                                            0000000
181420*                                                                 0000000
181430 APPEL-IPXZCALY.                                                  0000000
181440*                                                                 0000000
181450*   88 IPXCAL-I-FCT-MGESX-AF     VALUE '01'.                      0000000
181460*   88 IPXCAL-I-FCT-MGESX-SF     VALUE '02'.                      0000000
181470*   88 IPXCAL-I-FCT-MGESX-AF-AV  VALUE '03'.                      0000000
181480*   88 IPXCAL-I-FCT-MGES6-AV     VALUE '05'.                      0000000
181490*   88 IPXCAL-I-FCT-MGES6        VALUE '06'.                      0000000
181500*   88 IPXCAL-I-FCT-MGES7        VALUE '07'.                      0000000
181510*                                                                 0000000
181520*     IPXCAL-I-OPTION-TEG-TAEG   ne rend PAS de dtail du TAEG    0000000
181530*     IPXCAL-I-OPTION-TEG-TAEG-B    rend le dtail du TAEG (TEG). 0000000
181540                                                                  0000000
181550                                                                  0000000
181560     IF   IPPMA2-LABEL-APPLI  =  'IPC' OR                         0000000
181570          SAY-CODRET = '1'                                        0000000
181580          SET IPXCAL-I-OPTION-TEG-TAEG-B TO TRUE                  0000000
181590     Else                                                         0000000
181600          SET IPXCAL-I-OPTION-TEG        to true                  0000000
181610     End-if                                                       0000000
181620                                                                  0000000
181630*rdegoethe                                                        0000000
181640     If   dossier-goethe  or langue-allemande                     0000000
181650          Move  'O'    to   IPXCAL-I-GEOTHE                       0000000
181660          SET IPXCAL-I-OPTION-TEG-TAEG-B TO TRUE                  0000000
181670     End-if                                                       0000000
181680*rdegoethe                                                        0000000
181690                                                                  0000000
181700     Set IPXCAL-I-SANS-PRTSMP  to true                            0000000
181710     SET IPXCAL-I-TRT-BATCH    TO TRUE                            0000000
181720*PGI - R40738 - 10/06/2011 - DEB                                  0000000
181730     move  SIT-ISC-CODE-IMS    to IPXCAL-I-IMS-EXEC               0000000
181740*    move  XX-SITE-MODULE      to IPXCAL-I-IMS-EXEC               0000000
181750*PGI - R40738 - 10/06/2011 - FIN                                  0000000
181760                                                                  0000000
181770     IF  EXIST-PRTCPT  =  1   AND                                 0000000
181780         CP2-DATOUV  NUMERIC                                      0000000
181790             MOVE     CP2-DATOUV         TO   IPXCAL-I-DATOUV     0000000
181800     ELSE                                                         0000000
181810             MOVE       datjour          TO   IPXCAL-I-DATOUV     0000000
181820     END-IF                                                       0000000
181830                                                                  0000000
181840     MOVE  IPPMA2-LABEL-APPLI  to  IPXCAL-I-APPLI                 0000000
181850D    DISPLAY ' SAY-MGES ' SAY-MGES                                0000000
181860     if  avenant                                                  0000000
181870         If  say-mges =  '6'                                      0000000
181880             set  IPXCAL-I-FCT-MGES6-AV     to  true              0000000
181890         else                                                     0000000
181900             set  IPXCAL-I-FCT-MGESX-AF-AV  to  true              0000000
181910     else                                                         0000000
181920         If  say-mges =  '6'                                      0000000
181930             set  IPXCAL-I-FCT-MGES6        to  true              0000000
181940         else                                                     0000000
181950                 set  IPXCAL-I-FCT-MGESX-AF     to  true          0000000
181960         End-if                                                   0000000
181970     End-if.                                                      0000000
181980                                                                  0000000
181990     MOVE 'IPPBATCH'         TO IPXCAL-I-ORIGINE                  0000000
182000     MOVE CONTRAT-AVENANT    TO IPXCAL-I-CONTRAT-AVENANT          0000000
182010D    DISPLAY 'ties10-l0001-typ (1) ' ties10-l0001-typ (1)         0000000
182020                                                                  0000000
182030                                                                  0000000
182040D    DISPLAY ' SAY-TAUDBLT = ' SAY-TAUDBLT                        0000000
182050D    DISPLAY ' SAY-TAUDB   = ' SAY-TAUDB                          0000000
182060D    DISPLAY ' CPT-CRD     = ' CPT-CRD                            0000000
182070                                                                  0000000
182080     CALL 'ZCALLPGM' USING IPXZCALY                               0000000
182090                           PRTLNK                                 0000000
182100                           PRTCO1                                 0000000
182110                           PRTCO3                                 0000000
182120                           PRTCO4                                 0000000
182130                           CTL                                    0000000
182140                           IPXCA5                                 0000000
182150                           BIDON1                                 0000000
182160                           PRTSAY                                 0000000
182170                           PRTSMP                                 0000000
182180                           PRTCPT                                 0000000
182190                           EXIST-PRTCPT                           0000000
182200                           IPXCAL                                 0000000
182210                           PCBCO1                                 0000000
182220                           PCBCO2                                 0000000
182230                           PCBCO3                                 0000000
182240                           PCBCO4                                 0000000
182250                           PCBSPI                                 0000000
182260                           .                                      0000000
182270                                                                  0000000
182280d      display '**APRES IPXZCALY ****'                            0000000
182290D      DISPLAY ' CPT-CRD     = ' CPT-CRD                          0000000
182300D      display 'ctl-libelle = ' ctl-libelle.                      0000000
182310D      display 'ctl-R34     = ' ctl-r34.                          0000000
182320D      display  'IPXCAL-O-TEG-PAR-PER '  IPXCAL-O-TEG-PAR-PER     0000000
182330D      display  'IPXCAL-O-TEG '          IPXCAL-O-TEG             0000000
182340                                                                  0000000
182350     If  ctl-r34  not  =  zero                                    0000000
182360         MOVE     43           TO  TEST-1                         0000000
182370         MOVE     CTL-LIBELLE  TO  ANOM-43                        0000000
182380         PERFORM  TRAIT-ANOMALIE                                  0000000
182390     else                                                         0000000
182400         MOVE  IPXCAL-FLGTYPASS      TO APXTRE-FLGTYPASS          0000000
182410         MOVE  IPXCAL-TAUTARPLV      TO APXTRE-TAUTARPLV          0000000
182420         MOVE  IPXCAL-FLGASS         TO APXTRE-FLGASS             0000000
182430         MOVE  IPXCAL-TEGASS         TO APXTRE-TEGASS             0000000
182440d    display '  IPXCAL-SENIOR    ' IPXCAL-SENIOR                  0000000
182450d    display '  APXTRE-FLGTYPASS ' APXTRE-FLGTYPASS               0000000
182460d    display '  APXTRE-FLGASS    ' APXTRE-FLGASS                  0000000
182470d    display '  APXTRE-TAUTARPLV ' APXTRE-TAUTARPLV               0000000
182480d    display '  APXTRE-TEGASS    ' APXTRE-TEGASS                  0000000
182490*                                                                 0000000
182500**                                                                0000000
182510d    display '**CHA0102 APRES IPXZCALY ****'                      0000000
182520d    display '  '                                                 0000000
182530d    move  IPXCAL-O-TAEG                 to  ed-txass             0000000
182540d    display ' IPXCAL-O-TAEG          :'  ed-txass  '****'        0000000
182550d    move  IPXCAL-O-TEG-X                to  ed-txass             0000000
182560d    display ' IPXCAL-O-TEG-X         :'  ed-txass  '****'        0000000
182570d    move  IPXCAL-O-TEG-PAR-PER-X        to  ed-txass             0000000
182580d    display ' IPXCAL-O-TEG-PAR-PER-X :'  ed-txass  '****'        0000000
182590d    move  IPXCAL-O-TCAS                 to  ed-txass             0000000
182600d    display ' IPXCAL-O-TCAS          :'  ed-txass  '****'        0000000
182610d    move  IPXCAL-O-TCOM                 to  ed-txass             0000000
182620d    display ' IPXCAL-O-TCOM          :'  ed-txass  '****'        0000000
182630d    move  IPXCAL-O-TFRAUT               to  ed-txass             0000000
182640d    display ' IPXCAL-O-TFRAUT        :'  ed-txass  '****'        0000000
182650d    move  IPXCAL-O-TFRH                 to  ed-txass             0000000
182660d    display ' IPXCAL-O-TFRH          :'  ed-txass  '****'        0000000
182670d    move  IPXCAL-O-TEFF                 to  ed-txass             0000000
182680d    display ' IPXCAL-O-TEFF          :'  ed-txass  '****'        0000000
182690d    move  IPXCAL-TAUTARPLV              to  ed-txass             0000000
182700d    display ' IPXCAL-TAUTARPLV       :'  ed-txass'****'          0000000
182710d    move  IPXCAL-TEGASS                  to  ed-txass            0000000
182720d    display ' IPXCAL-TEGASS          :'  ed-txass'****'          0000000
182730d    display '******'                                             0000000
182740d    display '  '                                                 0000000
182750                                                                  0000000
182760     End-if.                                                      0000000
182770                                                                  0000000
182780d    perform  varying  ii  from 1 by 1                            0000000
182790d               until  ii  >  10                                  0000000
182800d      display 'TAM-DAT  ' ii ' '  TAM-DAT   OF PRTCO4(II)        0000000
182810d      display 'TAM-SDP  ' ii ' '  TAM-SDP   OF PRTCO4(II)        0000000
182820d      display 'TAM-INT  ' ii ' '  TAM-INT   OF PRTCO4(II)        0000000
182830d      display 'TAM-ASS  ' ii ' '  TAM-ASS   OF PRTCO4(II)        0000000
182840d      display 'TAM-AMO  ' ii ' '  TAM-AMO   OF PRTCO4(II)        0000000
182850d    end-perform.                                                 0000000
182860                                                                  0000000
182870                                                                  0000000
182880 CHGT-CALX-DIVERS.                                                0000000
182890                                                                  0000000
182900*                                                                 0000000
182910*  tatatata                                                       0000000
182920*                                                                 0000000
182930                                                                  0000000
182940     Move  space    to  sai-travail.                              0000000
182950                                                                  0000000
182960d    display 'ipxcal-o-teg = ' ipxcal-o-teg                       0000000
182970d    display 'ipxcal-o-tps = ' ipxcal-o-tps                       0000000
182980     move  TAM-TINT  OF PRTCO4          to  SAI-TINT              0000000
182990     move  TAM-TASS  OF PRTCO4          to  SAI-MTASS             0000000
183000     IF   IPPMA2-LABEL-APPLI  =  'IPC' OR                         0000000
183010          SAY-CODRET = '1'                                        0000000
183020*rdegoethe                                                        0000000
183030          or ( dossier-goethe  or langue-allemande )              0000000
183040*rdegoethe                                                        0000000
183050          move  IPXCAL-O-TAEG           to  SAI-TEGL              0000000
183060     Else                                                         0000000
183070          move  IPXCAL-O-TEG            to  SAI-TEGL              0000000
183080     End-if                                                       0000000
183090     move  IPXCAL-O-TCOM           to  SAI-TCOM                   0000000
183100     move  IPXCAL-O-TPS            to  SAI-TPS                    0000000
183110* maujean debut                                                   0000000
183120*    IF  orgs01-assimile-cmm                                      0000000
183130*         move  IPXCAL-O-TFRAUT       to  SAI-TFRAUT              0000000
183140*         move  IPXCAL-O-TFRH         to  SAI-TFRH                0000000
183150*    ELSE                                                         0000000
183160         compute SAI-TFRAUT = IPXCAL-O-TFRAUT + IPXCAL-O-TFRH     0000000
183170*    END-IF                                                       0000000
183180                                                                  0000000
183190* maujean fin                                                     0000000
183200     move  IPXCAL-O-TCAS           to  SAI-TCAS                   0000000
183210     move  IPXCAL-O-TEFF           to  SAI-TEFF.                  0000000
183220D    DISPLAY 'SAI-TEFF        :' SAI-TEFF                         0000000
183230D    DISPLAY 'IPXCAL-O-TEFF   :' IPXCAL-O-TEFF                    0000000
183240                                                                  0000000
183250d    perform  varying  ii  from 1 by 1                            0000000
183260d               until  ii  >  10                                  0000000
183270d      display 'TAM-DAT  ' ii ' '  TAM-DAT   OF PRTCO4(II)        0000000
183280d      display 'TAM-SDP  ' ii ' '  TAM-SDP   OF PRTCO4(II)        0000000
183290d      display 'TAM-INT  ' ii ' '  TAM-INT   OF PRTCO4(II)        0000000
183300d      display 'TAM-ASS  ' ii ' '  TAM-ASS   OF PRTCO4(II)        0000000
183310d      display 'TAM-AMO  ' ii ' '  TAM-AMO   OF PRTCO4(II)        0000000
183320d    end-perform                                                  0000000
183330                                                                  0000000
183340     IF IP = 1                                                    0000000
183350        MOVE PRTCO4    TO PRTCO41                                 0000000
183360     ELSE                                                         0000000
183370     IF IP = 2                                                    0000000
183380        MOVE PRTCO4    TO PRTCO42                                 0000000
183390     ELSE                                                         0000000
183400     IF IP = 3                                                    0000000
183410        MOVE PRTCO4    TO PRTCO43                                 0000000
183420     ELSE                                                         0000000
183430     IF IP = 4                                                    0000000
183440        MOVE PRTCO4    TO PRTCO44.                                0000000
183450     MOVE  IPXCAL-O-NBECH9  TO  SAI-NPER                          0000000
183460                                SAI-NPER-STOCK (IP)               0000000
183470     MOVE  SAY-CNAT         TO  SAI-CNAT-STOCK (IP)               0000000
183480     MOVE  SAY-PERFR        TO  SAI-PERFR-STOCK(IP)               0000000
183490     MOVE  SPACE            TO  SAI-TYPB-STOCK (IP)               0000000
183500                                                                  0000000
183510     IF  SA2-DATEC NUMERIC                                        0000000
183520         STRING SA2-DATEC(7:2)                                    0000000
183530                SA2-DATEC(5:2)                                    0000000
183540                SA2-DATEC(1:4) DELIMITED BY SIZE                  0000000
183550                          INTO SAI-DATEC-STOCK (IP)               0000000
183560     ELSE                                                         0000000
183570         MOVE ZERO      TO SAI-DATEC-STOCK (IP)                   0000000
183580     End-if.                                                      0000000
183590                                                                  0000000
183600*-----------------------------------------------------------      0000000
183610 LECTURE-GARANTIE.                                                0000000
183620*-------------                                                    0000000
183630*   appel gar3 pour charger GARFIC                                0000000
183640*                                                                 0000000
183650     Initialize              IPXFAL                               0000000
183660**                                                                0000000
183670**...Mise en forme bloc emetteur                                  0000000
183680     move 'CDTAMORTISSABLE'  to IPXFAL-EME-BLO                    0000000
183690     move 'BATCHPRET'        to IPXFAL-EME-APL                    0000000
183700     move  PGM-STEPNAME      to IPXFAL-EME-PGM                    0000000
183710**                                                                0000000
183720**.. Plateforme                                                   0000000
183730**.. type de plateforme   = IMS                                   0000000
183740     move 'IMS'              to IPXFAL-EME-PFO-TYP                0000000
183750**                                                                0000000
183760**.. nom de la plateforme = site de traitement                    0000000
183770*PGI - R40738 - 10/06/2011 - DEB                                  0000000
183780     move SIT-ISC-CODE-IMS   to IPXFAL-EME-PFO-NOM                0000000
183790*    move ZISC-IMS           to IPXFAL-EME-PFO-NOM                0000000
183800*PGI - R40738 - 10/06/2011 - FIN                                  0000000
183810**                                                                0000000
183820**.. Mode de traitement                                           0000000
183830     set IPXFAL-EME-MOD-TRT-BA-IMS to true                        0000000
183840**                                                                0000000
183850**.. Identification de l'utilisateur                              0000000
183860     move 'OPC'              to IPXFAL-UTI-LGE                    0000000
183870*PGI - R40738 - 10/06/2011 - DEB                                  0000000
183880     If SIT-ISC-TYPE-TEST                                         0000000
183890*    If site-de-test                                              0000000
183900*PGI - R40738 - 10/06/2011 - FIN                                  0000000
183910        move  'TESTBATC'        to IPXFAL-UTI-PHY                 0000000
183920     Else                                                         0000000
183930        move  'IPPBATCH'        to IPXFAL-UTI-PHY                 0000000
183940     End-if                                                       0000000
183950**                                                                0000000
183960**.. Date et heure                                                0000000
183970     move DATJOUR            to IPXFAL-DATE                       0000000
183980     MOVE HEUJOUR            TO IPXFAL-HEURE                      0000000
183990**                                                                0000000
184000**.. Identification de la demande                                 0000000
184010     move 'GAR3'             to IPXFAL-DEM-OBJ-GES                0000000
184020*                                                                 0000000
184030*    set TOP-LECTURE-DEB     to true                              0000000
184040                                                                  0000000
184050     move  orgs01-banque     to  IPXESM-E-LM400-REF-PRT-BQE       0000000
184060     move  ippma2-caisse     to  IPXESM-E-LM400-REF-PRT-CAI       0000000
184070     string  '000' ippma2-racine                                  0000000
184080            delimited by size  into IPXESM-E-LM400-REF-PRT-RAC    0000000
184090     move  IPPMA2-2-CAT (IP) to  IPXESM-E-LM400-REF-PRT-CAT       0000000
184100     move  ippma2-devise     to  IPXESM-E-LM400-REF-PRT-DEV       0000000
184110     move  ippma2-doss       to  IPXESM-E-LM400-REF-DOS           0000000
184120                                                                  0000000
184130     set  IPXFRE-TRT-CORRECT         to true                      0000000
184140     set  IPXFAL-IPXZGAR3-FON-LM400  to true                      0000000
184150*                                                                 0000000
184160*msc-GAR3-05/2005                                                 0000000
184170     set  TOP-PRET-XXXX-GARANTIE     to true                      0000000
184180*                                                                 0000000
184190*--> Recherche des garanties du prt                              0000000
184200*                                                                 0000000
184210     PERFORM  APPEL-IPXZGAR3                                      0000000
184220*                                                                 0000000
184230D    display 'Code retour IPXZGAR3 : ' IPXFRE-COD-RET-PRI         0000000
184240D    display 'Msg mtier  IPXZGAR3 : ' IPXFRE-MSG-MET             0000000
184250                                                                  0000000
184260*msc-GAR3-05/2005 - cas des prts sans garantie                   0000000
184270*    If  not ( IPXFRE-TRT-CORRECT )                               0000000
184280     evaluate true                                                0000000
184290     when IPXFRE-TRT-CORRECT                                      0000000
184300          move IPXESM-S-LM400-DONNEES     to GARFIC               0000000
184310D         DISPLAY 'sbo10012006'                                   0000000
184320D         DISPLAY 'GARFIC '  GARFIC                               0000000
184330D         DISPLAY 'sbo10012006 caution'                           0000000
184340D         DISPLAY 'GAR-CLE-CAU(1)  =' GAR-CLE-CAU(1)              0000000
184350D         DISPLAY 'GAR-CLE-CAU(2)  =' GAR-CLE-CAU(2)              0000000
184360D         DISPLAY 'sbo10012006 hypotheque'                        0000000
184370D         DISPLAY 'GAR-HYP-DESCR-L1=' GAR-HYP-DESCR-L1            0000000
184380D         DISPLAY 'GAR-HYP-DESCR-L2=' GAR-HYP-DESCR-L2            0000000
184390D         DISPLAY 'GAR-HYP-DESCR-L3=' GAR-HYP-DESCR-L3            0000000
184400D         DISPLAY 'GAR-HYP-DESCR-L4=' GAR-HYP-DESCR-L4            0000000
184410D         DISPLAY 'GAR-HYP-DESCR-L5=' GAR-HYP-DESCR-L5            0000000
184420D         DISPLAY 'GAR-HYP-RUE     =' GAR-HYP-RUE                 0000000
184430D         DISPLAY 'GAR-HYP-LOCALITE=' GAR-HYP-LOCALITE            0000000
184440D         DISPLAY 'GAR-HYP-BURDIS  =' GAR-HYP-BURDIS              0000000
184450D         DISPLAY 'GAR-RANG ' GAR-RANG                            0000000
184460D         DISPLAY 'GAR-CAUTION '   GAR-CAUTION                    0000000
184470D         DISPLAY 'GAR-LIB-DESCR ' GAR-LIB-DESCR                  0000000
184480                                                                  0000000
184490                                                                  0000000
184500D         DISPLAY 'Inscription   ' IPXESM-S-LM400-INSCRIPTION     0000000
184510          if  IPXESM-S-LM400-INSCRIPTION  not  =  space           0000000
184520              move IPXESM-S-LM400-INSCRIPTION to gar32c-pins (1)  0000000
184530* sbo13062006 on fait un passage notaire pour chaque garantie     0000000
184540* en gar3 s'il y une inscription notaire                          0000000
184550              if gar32c-ins-typ-liu (1)  =  '1'                   0000000
184560                 perform TRAIT-NOTAIRE-GAR3                       0000000
184570              end-if                                              0000000
184580          End-if                                                  0000000
184590         set  TOP-PRET-AVEC-GARANTIE to true                      0000000
184600*                                                                 0000000
184610*    pas de garantie pour ce prt                                 0000000
184620     when IPXFRE-DONNEES-NON-TROUVEES                             0000000
184630         set TOP-PRET-SANS-GARANTIE  to true                      0000000
184640     when other                                                   0000000
184650          If  avenant                                             0000000
184660              move Space  to                                      0000000
184670                              garfic                              0000000
184680                              gar32c-pins (1)                     0000000
184690                              IPXFRE-MSG-MET                      0000000
184700                                                                  0000000
184710              move Zero   to  IPXFRE-COD-RET-PRI                  0000000
184720          Else                                                    0000000
184730                                                                  0000000
184740              move IPXESM-S-LM400-DONNEES     to GARFIC           0000000
184750              MOVE  57              TO  CTL-R34                   0000000
184760              MOVE  space           TO  ANOM-LIB-57               0000000
184770              String  IPXFRE-COD-RET-PRI                          0000000
184780                 IPXFRE-MSG-MET  delimited by size                0000000
184790                                  INTO  ANOM-LIB-57               0000000
184800              MOVE  57              TO  TEST-1                    0000000
184810              PERFORM  TRAIT-ANOMALIE                             0000000
184820          End-if                                                  0000000
184830                                                                  0000000
184840     End-evaluate                                                 0000000
184850     .                                                            0000000
184860*================================================================ 0000000
184870* rinitialisation de la recherhce des garanties pour             0000000
184880* 2ieme passage en langue allemande                               0000000
184890 LECTURE-GAR3-INIT.                                               0000000
184900*-------------                                                    0000000
184910*                                                                 0000000
184920     Initialize              IPXFAL                               0000000
184930**                                                                0000000
184940**...Mise en forme bloc emetteur                                  0000000
184950     move 'CDTAMORTISSABLE'  to IPXFAL-EME-BLO                    0000000
184960     move 'BATCHPRET'        to IPXFAL-EME-APL                    0000000
184970     move  PGM-STEPNAME      to IPXFAL-EME-PGM                    0000000
184980**                                                                0000000
184990**.. Plateforme                                                   0000000
185000**.. type de plateforme   = IMS                                   0000000
185010     move 'IMS'              to IPXFAL-EME-PFO-TYP                0000000
185020**                                                                0000000
185030**.. nom de la plateforme = site de traitement                    0000000
185040*PGI - R40738 - 10/06/2011 - DEB                                  0000000
185050     move SIT-ISC-CODE-IMS   to IPXFAL-EME-PFO-NOM                0000000
185060*    move ZISC-IMS           to IPXFAL-EME-PFO-NOM                0000000
185070*PGI - R40738 - 10/06/2011 - FIN                                  0000000
185080**                                                                0000000
185090**.. Mode de traitement                                           0000000
185100     set IPXFAL-EME-MOD-TRT-BA-IMS to true                        0000000
185110**                                                                0000000
185120**.. Identification de l'utilisateur                              0000000
185130     move 'OPC'              to IPXFAL-UTI-LGE                    0000000
185140*PGI - R40738 - 10/06/2011 - DEB                                  0000000
185150     If SIT-ISC-TYPE-TEST                                         0000000
185160*    If site-de-test                                              0000000
185170*PGI - R40738 - 10/06/2011 - FIN                                  0000000
185180        move  'TESTBATC'        to IPXFAL-UTI-PHY                 0000000
185190     Else                                                         0000000
185200        move  'IPPBATCH'        to IPXFAL-UTI-PHY                 0000000
185210     End-if                                                       0000000
185220**                                                                0000000
185230**.. Date et heure                                                0000000
185240     move DATJOUR            to IPXFAL-DATE                       0000000
185250     MOVE HEUJOUR            TO IPXFAL-HEURE                      0000000
185260**                                                                0000000
185270**.. Identification de la demande                                 0000000
185280     move 'GAR3'             to IPXFAL-DEM-OBJ-GES                0000000
185290*                                                                 0000000
185300*    set TOP-LECTURE-DEB     to true                              0000000
185310                                                                  0000000
185320*    move  orgs01-banque     to  IPXESM-E-LM400-REF-PRT-BQE       0000000
185330*    move  ippma2-caisse     to  IPXESM-E-LM400-REF-PRT-CAI       0000000
185340*    string  '000' ippma2-racine                                  0000000
185350*           delimited by size  into IPXESM-E-LM400-REF-PRT-RAC    0000000
185360*    move  IPPMA2-2-CAT (IP) to  IPXESM-E-LM400-REF-PRT-CAT       0000000
185370*    move  ippma2-devise     to  IPXESM-E-LM400-REF-PRT-DEV       0000000
185380*    move  ippma2-doss       to  IPXESM-E-LM400-REF-DOS           0000000
185390                                                                  0000000
185400     set  IPXFRE-TRT-CORRECT         to true                      0000000
185410     set  IPXFAL-IPXZGAR3-FON-LM408  to true                      0000000
185420*                                                                 0000000
185430*msc-GAR3-05/2005                                                 0000000
185440*    set  TOP-PRET-XXXX-GARANTIE     to true                      0000000
185450*                                                                 0000000
185460*--> Recherche des garanties du prt                              0000000
185470*                                                                 0000000
185480     PERFORM  APPEL-IPXZGAR3                                      0000000
185490*                                                                 0000000
185500D    display 'Code retour IPXZGAR3 : ' IPXFRE-COD-RET-PRI         0000000
185510D    display 'Msg mtier  IPXZGAR3 : ' IPXFRE-MSG-MET             0000000
185520                                                                  0000000
185530*msc-GAR3-05/2005 - cas des prts sans garantie                   0000000
185540*    If  not ( IPXFRE-TRT-CORRECT )                               0000000
185550     evaluate true                                                0000000
185560     when IPXFRE-TRT-CORRECT                                      0000000
185570D         DISPLAY 'sbo11092006 initialisation correcte de LM408'  0000000
185580          Continue                                                0000000
185590*    pas de garantie pour ce prt                                 0000000
185600     when other                                                   0000000
185610          If  avenant                                             0000000
185620              move Space  to                                      0000000
185630                              garfic                              0000000
185640                              gar32c-pins (1)                     0000000
185650          Else                                                    0000000
185660                                                                  0000000
185670              move IPXESM-S-LM400-DONNEES     to GARFIC           0000000
185680              MOVE  57              TO  CTL-R34                   0000000
185690              MOVE  space           TO  ANOM-LIB-57               0000000
185700              String  IPXFRE-COD-RET-PRI                          0000000
185710                 IPXFRE-MSG-MET  delimited by size                0000000
185720                                  INTO  ANOM-LIB-57               0000000
185730              MOVE  57              TO  TEST-1                    0000000
185740              PERFORM  TRAIT-ANOMALIE                             0000000
185750          End-if                                                  0000000
185760                                                                  0000000
185770     End-evaluate                                                 0000000
185780     .                                                            0000000
185790*==============================================================   0000000
185800*                                                                 0000000
185810 APPEL-IPXZGAR3.                                                  0000000
185820                                                                  0000000
185830      Call 'ZCALLPGM'      using IPXZGAR3                         0000000
185840                                 IPXFAL                           0000000
185850                                 IPXFRE                           0000000
185860                                 IPXESM                           0000000
185870                                 IOPCB                            0000000
185880                                 W-ALTPCB                         0000000
185890                                 PCBSPI                           0000000
185900                                 PCBNOT                           0000000
185910      End-call                                                    0000000
185920      .                                                           0000000
185930                                                                  0000000
185940*    APPEL ACCESSEUR  GARANTIES  mise en table                    0000000
185950*-----------------------------------------------------------------0000000
185960 APPEL-IPXM0003.                                                  0000000
185970*                                                                 0000000
185980D    display 'SOUS-PROGRAMME : APPEL-IPXM0003'                    0000000
185990*                                                                 0000000
186000*--> Initialisation                                               0000000
186010     move zeros              to  IGAR                             0000000
186020*    move spaces             to  IPXESM1                          0000000
186030*                                                                 0000000
186040     move  orgs01-banque     to  IPXESM1-E-LM300-PRT-BANQUE       0000000
186050     move  ippma2-caisse     to  IPXESM1-E-LM300-PRT-CAISSE       0000000
186060     string  '000' ippma2-racine                                  0000000
186070              delimited by size  into  IPXESM1-E-LM300-PRT-RACINE 0000000
186080     move  IPPMA2-2-CAT (IP) to  IPXESM1-E-LM300-PRT-NUM          0000000
186090     move  ippma2-devise     to  IPXESM1-E-LM300-PRT-DEVISE       0000000
186100     move  IPXFAL            to  IPXFAL1                          0000000
186110*                                                                 0000000
186120*... MEF partie fixe aller                                        0000000
186130     set  IPXFAL1-IPXM0003-FON-LM300 to true                      0000000
186140*                                                                 0000000
186150*                                                                 0000000
186160*... MEF partie entre/sortie variable                            0000000
186170*    Rfrence du prt                                            0000000
186180     move NBGAR-PRET         to IPXESM1-E-LM300-NB-GAR            0000000
186190*                                                                 0000000
186200*... Appel accesseur garanties                                    0000000
186210                                                                  0000000
186220                                                                  0000000
186230     call 'ZCALLPGM'      using IPXM0003                          0000000
186240                                IPXFAL1                           0000000
186250                                IPXFRE1                           0000000
186260                                IPXESM1                           0000000
186270                                IOPCB                             0000000
186280                                W-ALTPCB                          0000000
186290                                PCbSPI                            0000000
186300     end-call                                                     0000000
186310                                                                  0000000
186320*--> Chargement garantie Crdit Logement                          0000000
186330*                                                                 0000000
186340*msc-GAR3-05/2005                                                 0000000
186350*    S'il n'y a pas de garantie pour ce prt :                    0000000
186360*    - le code retour est Traitement correct                      0000000
186370*    - le compteur IPXESM1-S-LM300-NB-GAR-TOT est  zeros         0000000
186380*                                                                 0000000
186390*msc-corr-05/2005                                                 0000000
186400*    if  IPXFRE-TRT-CORRECT                                       0000000
186410     if  IPXFRE1-TRT-CORRECT                                      0000000
186420*                                                                 0000000
186430                                                                  0000000
186440         if  IPXESM1-S-LM300-GAR-CLOGT not = spaces               0000000
186450             add  1          to IGAR                              0000000
186460             move   IPXESM1-S-LM300-ANC-GAR-CLO                   0000000
186470                                to   WP-CODE-GARGAR  (IP IGAR)    0000000
186480             move   IPXESM1-S-LM300-NAT-GAR-CLO                   0000000
186490                                to   WP-CODE-GARNAG  (IP IGAR)    0000000
186500             move   IPXESM1-S-LM300-GAR-GDP-CLO                   0000000
186510                                to  WP-CODE-GARANTIE(IP IGAR)     0000000
186520             Compute Igar2  =  ( igar + ( 100 * ip ) )            0000000
186530             move    IGAR        to  WP-NO-ORDRE9    (IP IGAR)    0000000
186540             If  PAS-DE-IPPMA2                                    0000000
186550               if  igar < 5                                       0000000
186560                 move WP-CODE-GARANTIE(IP IGAR) to                0000000
186570                                IPPMA2-2-CODE-GARANTIE(IP IGAR)   0000000
186580                 move igar   to i-xxx                             0000000
186590                 move i-xxx  to IPPMA2-2-NO-ORDRE9(IP IGAR)       0000000
186600                                                                  0000000
186610               end-if                                             0000000
186620             end-if                                               0000000
186630         end-if                                                   0000000
186640*                                                                 0000000
186650*    --> Chargement garantie CMH                                  0000000
186660*                                                                 0000000
186670         if  IPXESM1-S-LM300-GAR-CMH  not = spaces                0000000
186680d            display 'IPXESM1-S-LM300-NAT-GAR-CMH '               0000000
186690d                     IPXESM1-S-LM300-NAT-GAR-CMH                 0000000
186700             add  1          to IGAR                              0000000
186710             move   IPXESM1-S-LM300-ANC-GAR-CMH                   0000000
186720                                to   WP-CODE-GARGAR  (IP IGAR)    0000000
186730             move   IPXESM1-S-LM300-NAT-GAR-CMH                   0000000
186740                                to   WP-CODE-GARNAG  (IP IGAR)    0000000
186750             move   IPXESM1-S-LM300-GAR-GDP-CMH                   0000000
186760                                to  WP-CODE-GARANTIE(IP IGAR)     0000000
186770             Compute Igar2  =  ( igar + ( 100 * ip ) )            0000000
186780             move    IGAR2       to  WP-NO-ORDRE9    (IP IGAR)    0000000
186790             If  PAS-DE-IPPMA2                                    0000000
186800               if  igar < 5                                       0000000
186810                 move WP-CODE-GARANTIE(IP IGAR) to                0000000
186820                                IPPMA2-2-CODE-GARANTIE(IP IGAR)   0000000
186830                 move igar   to i-xxx                             0000000
186840                 move i-xxx  to IPPMA2-2-NO-ORDRE9(IP IGAR)       0000000
186850                                                                  0000000
186860               end-if                                             0000000
186870             end-if                                               0000000
186880         end-if                                                   0000000
186890*                                                                 0000000
186900*    --> Chargement autres garanties                              0000000
186910*                                                                 0000000
186920         perform                                                  0000000
186930             varying I       from 1 by 1                          0000000
186940             until   I       > IPXESM1-S-LM300-NB-GAR-AUT         0000000
186950             or      IGAR    > 7                                  0000000
186960                                                                  0000000
186970*                                                                 0000000
186980             if  IPXESM1-S-LM300-GAR-LIG-AUT (I) not = spaces     0000000
186990               add  1      to IGAR                                0000000
187000d              display 'IPXESM1-S-LM300-ANC-GAR-AUT '             0000000
187010d                       IPXESM1-S-LM300-ANC-GAR-AUT (i)           0000000
187020               move   IPXESM1-S-LM300-ANC-GAR-AUT   (i)           0000000
187030                                 to  WP-CODE-GARGAR  (IP IGAR)    0000000
187040               move   IPXESM1-S-LM300-NAT-GAR-AUT   (i)           0000000
187050                                to   WP-CODE-GARNAG  (IP IGAR)    0000000
187060d              display 'IPXESM1-S-LM300-GAR-GDP-AUT '             0000000
187070d                       IPXESM1-S-LM300-GAR-GDP-AUT (i)           0000000
187080               move   IPXESM1-S-LM300-GAR-GDP-AUT (i)             0000000
187090                                to  WP-CODE-GARANTIE(IP IGAR)     0000000
187100               Compute Igar2  =  ( igar + ( 100 * ip ) )          0000000
187110               move    IGAR        to  WP-NO-ORDRE9    (IP IGAR)  0000000
187120               If  PAS-DE-IPPMA2                                  0000000
187130                if  igar < 5                                      0000000
187140                 move WP-CODE-GARANTIE(IP IGAR) to                0000000
187150                                IPPMA2-2-CODE-GARANTIE(IP IGAR)   0000000
187160                 move igar   to i-xxx                             0000000
187170                 move i-xxx  to IPPMA2-2-NO-ORDRE9(IP IGAR)       0000000
187180                                                                  0000000
187190                end-if                                            0000000
187200               end-if                                             0000000
187210                                                                  0000000
187220               IF  COND-HYPO (IP IGAR)                            0000000
187230                   SET  PRET-AVEC-HYPO  TO  TRUE                  0000000
187240               END-IF                                             0000000
187250                                                                  0000000
187260             end-if                                               0000000
187270*                                                                 0000000
187280         end-perform                                              0000000
187290*                                                                 0000000
187300* sbo06022007 si pas de garantie hypo on ajoute un promesse d'hyp 0000000
187310         IF ( PRET-SANS-HYPO                 AND                  0000000
187320              ORGS01-FEDE-CEE                                     0000000
187330               and IPPMA2-LABEL-APPLI  =  'IPI' )                 0000000
187340                                                                  0000000
187350             IF  NOT  (IPPMA2-LANGUE-ALLEMANDE )                  0000000
187360                 ADD  1  TO  Igar                                 0000000
187370                 MOVE  '$$'   TO   WP-CODE-GARANTIE(IP Igar)      0000000
187380                 MOVE  '250'  TO   WP-CODE-GARGAR  (IP Igar)      0000000
187390                                   WP-CODE-GARNAG  (IP Igar)      0000000
187400                 MOVE  '999'  TO   WP-NO-ORDRE     (IP Igar)      0000000
187410             END-IF                                               0000000
187420         END-IF                                                   0000000
187430d    display 'Igar  = ' igar                                      0000000
187440*                                                                 0000000
187450     Else                                                         0000000
187460          MOVE  58              TO  CTL-R34                       0000000
187470          MOVE  space           TO  ANOM-LIB-58                   0000000
187480          String  IPXFRE1-COD-RET-PRI                             0000000
187490                  IPXFRE1-MSG-MET  delimited by size              0000000
187500                                  INTO  ANOM-LIB-58               0000000
187510          MOVE  58              TO  TEST-1                        0000000
187520          PERFORM  TRAIT-ANOMALIE                                 0000000
187530     End-if                                                       0000000
187540     .                                                            0000000
187550*                                                                 0000000
187560*-----------------------------------------------------------      0000000
187570 APPEL-IPXZMA2G.                                                  0000000
187580*                                                                 0000000
187590                                                                  0000000
187600     MOVE 'CDTAMORTISSABLE'    TO IPXFAL-EME-BLO                  0000000
187610     MOVE 'BATCHPRET'          TO IPXFAL-EME-APL                  0000000
187620     MOVE  PGM-STEPNAME        TO IPXFAL-EME-PGM                  0000000
187630     MOVE 'OPC'                TO IPXFAL-UTI-LGE                  0000000
187640*PGI - R40738 - 10/06/2011 - DEB                                  0000000
187650     If SIT-ISC-TYPE-TEST                                         0000000
187660*    If site-de-test                                              0000000
187670*PGI - R40738 - 10/06/2011 - FIN                                  0000000
187680        move  'TESTBATC'        to IPXFAL-UTI-PHY                 0000000
187690     Else                                                         0000000
187700        move  'IPPBATCH'        to IPXFAL-UTI-PHY                 0000000
187710     End-if                                                       0000000
187720**                                                                0000000
187730*--> Code fonction accesseur                                      0000000
187740     set IPXFAL-IPXZMA2G-FON-LM900 to true                        0000000
187750                                                                  0000000
187760     Move  'GAR3'                  to IPXFAL-DEM-OBJ-GES          0000000
187770*--> indicatuer Batch / TP                                        0000000
187780     set IPXFAL-EME-MOD-TRT-BA-IMS to true                        0000000
187790*    move  'BP'  to  IPXFAL-EME-MOD-TRT                           0000000
187800*--> Stockage code oprateur                                      0000000
187810*    EQ --> Egal                                                  0000000
187820*    GE --> Suprieur ou gal                                     0000000
187830     move CODOP-SSA-IPPMA2   to IPXESM-E-LM900-SSA-OPERATEUR      0000000
187840*                                                                 0000000
187850*--> stockage cl d'acces                                         0000000
187860     move IPPMA2-CLE         to IPXESM-E-LM900-IPPMA2-CLE         0000000
187870*                                                                 0000000
187880*--> stockage type de demande Crdit logement                     0000000
187890     move Space             to IPXESM-E-LM900-TYPE-CLO-DEM        0000000
187900                                                                  0000000
187910     Set  IPXESM-E-LM900-FCT-GU-AVEC  to  true                    0000000
187920*                                                                 0000000
187930*--> Module de lecture adapt pour GAR3                           0000000
187940*                                                                 0000000
187950     call 'ZCALLPGM'      using IPXZMA2G                          0000000
187960                                IPXFAL                            0000000
187970                                IPXFRE                            0000000
187980                                IPXESM                            0000000
187990                                IOPCB                             0000000
188000                                W-ALTPCB                          0000000
188010                                PCBSPI                            0000000
188020                                PCBMAS                            0000000
188030                                PCBCPL                            0000000
188040     end-call                                                     0000000
188050*                                                                 0000000
188060     If   IPXFRE-TRT-CORRECT                                      0000000
188070*    --> Stockage donnes lues dans IPPMA2                        0000000
188080         move IPXESM-S-LM900-IPPMA2 to IPPMA2                     0000000
188090d        display 'gar3?? ' IPXESM-S-LM900-CAISSE-GAR3             0000000
188100         Set 88-gar3   to  true                                   0000000
188110     Else                                                         0000000
188120*    --> IPPMA2 N'EXISTE PAS  ou autre ........                   0000000
188130         Move  'GE'  to  ctl-r34                                  0000000
188140     end-if                                                       0000000
188150*                                                                 0000000
188160     .                                                            0000000
188170*--------------------*                                            0000000
188180 INITIALISATION-X4005.                                            0000000
188190*--------------------*                                            0000000
188200*                                                                 0000000
188210                                                                  0000000
188220     INITIALIZE ATMXAR                                            0000000
188230     INITIALIZE APXTA5                                            0000000
188240     INITIALIZE APXTR5                                            0000000
188250     INITIALIZE APXPTR                                            0000000
188260     INITIALIZE IPXAPX                                            0000000
188270                                                                  0000000
188280*PGI - R40738 - 10/06/2011 - DEB                                  0000000
188290     MOVE   SIT-ISC-CODE-IMS    TO IPXAPX-SITE                    0000000
188300*    STRING ZISC-IMS                                              0000000
188310*           'I'                                                   0000000
188320*           DELIMITED BY SIZE INTO IPXAPX-SITE                    0000000
188330*PGI - R40738 - 10/06/2011 - FIN                                  0000000
188340                                                                  0000000
188350     MOVE 'IPPBATCH'              TO IPXAPX-ZUSER                 0000000
188360                                                                  0000000
188370     Set IPXAPX-APXTA5            To True                         0000000
188380     MOVE DATJOUR                 TO ATMXAR-ORIMSG-DATDMD         0000000
188390     MOVE WS-HEURE-R              TO ATMXAR-ORIMSG-HEUDMD         0000000
188400                                                                  0000000
188410     MOVE 'ASSURANCES'            TO ATMXAR-ORIMSG-BLCEME         0000000
188420     MOVE 'IPR1'                  TO ATMXAR-ORIMSG-APNEME         0000000
188430* nom du programme en majuscule !                                 0000000
188440     MOVE 'IPPBATCH'              TO ATMXAR-ORIMSG-PGMEME         0000000
188450     MOVE SAY-APPLIC              TO ATMXAR-ORIMSG-IDELGQUTI      0000000
188460*    MOVE                         TO ATMXAR-ORIMSG-IDEPHYUTI      0000000
188470     SET  ATMXAR-ORIGMSG-PLFEME-TYPIMS  TO TRUE                   0000000
188480     SET  ATMXAR-MODTRT-TMSDIF          TO TRUE                   0000000
188490     SET  ATMXAR-CODRET-TRTCRF          TO TRUE                   0000000
188500                                                                  0000000
188510     MOVE 'LECT DOSSIER'          TO ATMXAR-ORIMSG-IDTMSG         0000000
188520     SET ATMXAR-TYPFCT-CTL        TO TRUE                         0000000
188530     SET ATMXAR-TYPACN-CTL        TO TRUE                         0000000
188540     MOVE 'X4005'                 TO ATMXAR-SCEDMD-FCT            0000000
188550                                                                  0000000
188560d    display 'ATMXAR-ORIMSG-DATDMD      =  '                      0000000
188570d             ATMXAR-ORIMSG-DATDMD                                0000000
188580d    display 'ATMXAR-ORIMSG-HEUDMD      =  '                      0000000
188590d             ATMXAR-ORIMSG-HEUDMD                                0000000
188600d    display 'ATMXAR-ORIMSG-BLCEME      =  '                      0000000
188610d             ATMXAR-ORIMSG-BLCEME                                0000000
188620d    display 'ATMXAR-ORIMSG-APNEME      =  '                      0000000
188630d             ATMXAR-ORIMSG-APNEME                                0000000
188640d    display 'ATMXAR-ORIMSG-PGMEME      =  '                      0000000
188650d             ATMXAR-ORIMSG-PGMEME                                0000000
188660d    display 'ATMXAR-ORIMSG-IDELGQUTI   =  '                      0000000
188670d             ATMXAR-ORIMSG-IDELGQUTI                             0000000
188680d    display 'ATMXAR-ORIMSG-IDEPHYUTI   =  '                      0000000
188690d             ATMXAR-ORIMSG-IDEPHYUTI                             0000000
188700d    display 'ATMXAR-ORIMSG-IDTMSG      =  '                      0000000
188710d             ATMXAR-ORIMSG-IDTMSG                                0000000
188720d    display 'ATMXAR-SCEDMD-FCT         =  '                      0000000
188730d             ATMXAR-SCEDMD-FCT                                   0000000
188740****** INFO PRET                                                  0000000
188750     MOVE DATJOUR                 TO APXTA5-DATTAR                0000000
188760     MOVE SAY-CNAT                TO APXTA5-CODPRD                0000000
188770     MOVE SAY-CD-SOUS-PROD        TO APXTA5-CODSPD                0000000
188780     STRING SAY-BANQ                                              0000000
188790            SAY-NCAIS                                             0000000
188800            '000'                                                 0000000
188810            SAY-RACINE                                            0000000
188820            SAY-CAT                                               0000000
188830                  DELIMITED BY SIZE INTO APXTA5-REFPRT            0000000
188840     MOVE SAY-DEVISE                  TO APXTA5-DEV               0000000
188850     MOVE say-fed                     TO APXTA5-FED               0000000
188860                                                                  0000000
188870     MOVE say-objet                   TO APXTA5-OBJET             0000000
188880                                                                  0000000
188890     MOVE ZERO                        TO APXTA5-CHOM              0000000
188900                                                                  0000000
188910                                                                  0000000
188920*    pour pouvoir grer les codes du type DD qui ne concerne      0000000
188930*    une seule tte                                               0000000
188940     MOVE 100                     TO APXTA5-ENT-QTOGAR (1)        0000000
188950                                     APXTA5-QTODC  (1)            0000000
188960                                     APXTA5-QTOIT  (1)            0000000
188970                                     APXTA5-QTOPE  (1)            0000000
188980     MOVE 100                     TO APXTA5-ENT-QTOGAR (2)        0000000
188990                                     APXTA5-QTODC  (2)            0000000
189000                                     APXTA5-QTOIT  (2)            0000000
189010                                     APXTA5-QTOPE  (2)            0000000
189020                                                                  0000000
189030     IF   EXIST-PRTSAYG = 1                                       0000000
189040          MOVE  CP2-DATOUV         TO APXTA5-DATOUV               0000000
189050                                      APXTA5-DATTAR               0000000
189060     ELSE                                                         0000000
189070          MOVE  DATJOUR            TO APXTA5-DATOUV               0000000
189080                                      APXTA5-DATTAR               0000000
189090     END-IF                                                       0000000
189100     MOVE say-gas1                TO  APXTA5-CODASS (1)           0000000
189110     MOVE say-gas3                TO  APXTA5-CODASS (2)           0000000
189120     MOVE say-gas2                TO  APXTA5-ENT-CODDCI (1)       0000000
189130     MOVE say-gas4                TO  APXTA5-ENT-CODDCI (2)       0000000
189140     MOVE say-duram               TO  APXTA5-DUR                  0000000
189150     if not avenant                                               0000000
189160        IF  say-mtcre   NUMERIC                                   0000000
189170            MOVE say-mtcred       TO APXTA5-MNTPRT                0000000
189180        ELSE                                                      0000000
189190            MOVE ZERO                  TO APXTA5-MNTPRT           0000000
189200        END-IF                                                    0000000
189210     ELSE                                                         0000000
189220        IF  w-say-mtcred  NUMERIC                                 0000000
189230            MOVE w-say-mtcred       TO APXTA5-MNTPRT              0000000
189240        ELSE                                                      0000000
189250            MOVE ZERO                  TO APXTA5-MNTPRT           0000000
189260        END-IF                                                    0000000
189270     END-IF                                                       0000000
189280                                                                  0000000
189290     IF  SAY-TAUSURD NUMERIC                                      0000000
189300         MOVE SAY-TSURD        TO APXTA5-SPMDC (1)                0000000
189310     ELSE                                                         0000000
189320         MOVE ZERO                  TO APXTA5-SPMDC (1)           0000000
189330     END-IF                                                       0000000
189340                                                                  0000000
189350     IF  SAY-TAUSURI NUMERIC                                      0000000
189360         MOVE SAY-TSURI        TO APXTA5-SPMIT (1)                0000000
189370     ELSE                                                         0000000
189380         MOVE ZERO                  TO APXTA5-SPMIT (1)           0000000
189390     END-IF                                                       0000000
189400                                                                  0000000
189410                                                                  0000000
189420     If   say-capass    numeric   and                             0000000
189430          say-capass    >   zero                                  0000000
189440          MOVE say-capass         TO APXTA5-ENT-CAPASS            0000000
189450     Else                                                         0000000
189460          MOVE zero               TO APXTA5-ENT-CAPASS            0000000
189470     End-if                                                       0000000
189480                                                                  0000000
189490*                                                                 0000000
189500d    display 'APXTA5-FED    = ' APXTA5-FED                        0000000
189510d    display 'APXTA5-DATTAR = ' APXTA5-DATTAR                     0000000
189520d    display 'APXTA5-CODPRD = ' APXTA5-CODPRD                     0000000
189530d    display 'APXTA5-CODSPD = ' APXTA5-CODSPD                     0000000
189540d    display 'APXTA5-MNTPRT = ' APXTA5-MNTPRT                     0000000
189550d    display 'APXTA5-DEV    = ' APXTA5-DEV                        0000000
189560d    display 'APXTA5-CODASS (1) = ' APXTA5-CODASS  (1)            0000000
189570d    display 'APXTA5-CODASS (2) = ' APXTA5-CODASS  (2)            0000000
189580                                                                  0000000
189590****** INFO TETE                                                  0000000
189600     MOVE 1                       TO APXTA5-NUMTET    (1)         0000000
189610*    if ties10-l0001-typ (1) = '1' AND                            0000000
189620*       IND-CALCUL-TEGASS = 'O'                                   0000000
189630*       STRING IPPPRI-EMP1NAIS  (7:4)                             0000000
189640*              IPPPRI-EMP1NAIS  (4:2)                             0000000
189650*              IPPPRI-EMP1NAIS  (1:2)                             0000000
189660*                DELIMITED BY SIZE INTO APXTA5-DATNAI    (1)      0000000
189670*    else                                                         0000000
189680         move '00000000'  to APXTA5-datnai (1)                    0000000
189690         if APXTA5-codass (2) not = spaces                        0000000
189700            move '00000000' to APXTA5-datnai (2)                  0000000
189710         end-if                                                   0000000
189720*    end-if                                                       0000000
189730D    DISPLAY 'APXTA5-DATNAI (1) = ' APXTA5-DATNAI (1)             0000000
189740*    IF   TIEVAL1-STA-SAL                                         0000000
189750*         MOVE 'O'                TO APXTA5-CODSAL    (1)         0000000
189760*    ELSE                                                         0000000
189770*         MOVE 'N'                TO APXTA5-CODSAL    (1)         0000000
189780*    END-IF                                                       0000000
189790                                                                  0000000
189800*    IF IND-CALCUL-TEGASS = 'O'                                   0000000
189810*       MOVE TIES10-L0001-STA-CM (1) TO APXTA5-CODSAL (1)         0000000
189820*    END-IF                                                       0000000
189830     SET  APXTA5-ENT-NORMAL (1) TO TRUE                           0000000
189840                                                                  0000000
189850     IF IPPMA2-COEMP-RACINE  NUMERIC AND                          0000000
189860        IPPMA2-COEMP-RACINE  NOT = ZERO                           0000000
189870        MOVE 2                       TO APXTA5-NUMTET    (2)      0000000
189880*       IF IND-CALCUL-TEGASS = 'O'                                0000000
189890*          STRING IPPPRI-EMP2NAIS  (7:4)                          0000000
189900*                 IPPPRI-EMP2NAIS  (4:2)                          0000000
189910*                 IPPPRI-EMP2NAIS  (1:2)                          0000000
189920*                DELIMITED BY SIZE INTO APXTA5-DATNAI    (2)      0000000
189930*       ELSE                                                      0000000
189940            move '00000000' to APXTA5-datnai (2)                  0000000
189950*       END-IF                                                    0000000
189960d       DISPLAY 'APXTA5-DATNAI (2) = ' APXTA5-DATNAI (2)          0000000
189970        SET  APXTA5-ENT-NORMAL (2) TO TRUE                        0000000
189980*       IF   TIEVAL2-STA-SAL                                      0000000
189990*            MOVE 'O'                TO APXTA5-CODSAL    (2)      0000000
190000*       ELSE                                                      0000000
190010*            MOVE 'N'                TO APXTA5-CODSAL    (2)      0000000
190020*       END-IF                                                    0000000
190030     end-if                                                       0000000
190040                                                                  0000000
190050d    display 'APXTA5-REFPRT = ' APXTA5-REFPRT                     0000000
190060                                                                  0000000
190070     If   say-mges  =  '6'                                        0000000
190080         SET APXTA5-CODTAR-INFINE       TO TRUE                   0000000
190090     else                                                         0000000
190100         SET APXTA5-CODTAR-AMORTISSABLE TO TRUE                   0000000
190110     End-if                                                       0000000
190120     Move  say-codgesass  to  ipxapx-i-tse-codges                 0000000
190130     .                                                            0000000
190140*                                                                 0000000
190150 APPEL-IPXZAPPP.                                                  0000000
190160*---------------*                                                 0000000
190170                                                                  0000000
190180     PERFORM INITIALISATION-X4005                                 0000000
190190                                                                  0000000
190200     MOVE   'BATCHEVT'             TO IPXAPX-ZUSER                0000000
190210                                                                  0000000
190220     if ctl-r34 = zero                                            0000000
190230        CALL 'ZCALLPGM' USING IPXZAPPP                            0000000
190240                              ATMXAR                              0000000
190250                              APXTA5                              0000000
190260                              APXTR5                              0000000
190270                              IPXAPX                              0000000
190280                                                                  0000000
190290        IF ATMXAR-CODRET-TRTNONVLD                                0000000
190300d          DISPLAY 'ERREUR APXGAPEL'                              0000000
190310d          DISPLAY 'ATMXAR-RTA-MSGERRMET = '                      0000000
190320d                   ATMXAR-RTA-MSGERRMET                          0000000
190330d          DISPLAY 'ATMXAR-RTA-CODRETPMR = '                      0000000
190340d                   ATMXAR-RTA-CODRETPMR                          0000000
190350d          DISPLAY 'ATMXAR-RTA-CODRETSCD = '                      0000000
190360d                   ATMXAR-RTA-CODRETSCD                          0000000
190370d          DISPLAY 'ATMXAR-RTA-MSGERRMET-PGM    = '               0000000
190380d                   ATMXAR-RTA-MSGERRMET-PGM                      0000000
190390d          DISPLAY 'ATMXAR-RTA-MSGERRMET-RETPMR = '               0000000
190400d                   ATMXAR-RTA-MSGERRMET-RETPMR                   0000000
190410d          DISPLAY 'ATMXAR-RTA-MSGERRMET-RETSCD = '               0000000
190420d                   ATMXAR-RTA-MSGERRMET-RETSCD                   0000000
190430d          DISPLAY 'ATMXAR-RTA-MSGERRMET-MSG    = '               0000000
190440d                   ATMXAR-RTA-MSGERRMET-MSG                      0000000
190450           DISPLAY 'APXTA5-DATTAR = ' APXTA5-DATTAR               0000000
190460           DISPLAY 'APXTA5-CODPRD = ' APXTA5-CODPRD               0000000
190470           DISPLAY 'APXTA5-CODSPD = ' APXTA5-CODSPD               0000000
190480           DISPLAY 'APXTA5-MNTPRT = ' APXTA5-MNTPRT               0000000
190490           DISPLAY 'APXTA5-DUR    = ' APXTA5-DUR                  0000000
190500           DISPLAY 'APXTA5-CODASS (1) = ' APXTA5-CODASS  (1)      0000000
190510           DISPLAY 'APXTA5-CODASS (2) = ' APXTA5-CODASS  (2)      0000000
190520           DISPLAY 'APXTA5-DATNAI (1) = ' APXTA5-DATNAI (1)       0000000
190530           DISPLAY 'APXTA5-DATNAI (2) = ' APXTA5-DATNAI (2)       0000000
190540           move 59 to test-1                                      0000000
190550           move ATMXAR-RTA-MSGERRMET-MSG (1:27) to ANOM-LIB-59    0000000
190560           Perform Trait-anomalie                                 0000000
190570        END-IF                                                    0000000
190580     END-IF                                                       0000000
190590     .                                                            0000000
190600                                                                  0000000
190610 RECHERCHE-BUREAU.                                                0000000
190620                                                                  0000000
190630     Move 'T'                      to  CDCREC-TYPE-APPEL          0000000
190640     Move 'S'                      to  CDCREC-E-REF-TYPE          0000000
190650                                                                  0000000
190660     Move 'O'                      to  CDCREC-E-LIB-CDC           0000000
190670     Move  APPEL-CAI               to  CDCREC-E-SAS-CAISSE        0000000
190680     MOVE  appel-user50            TO  CDCREC-E-SAS-IDSAS         0000000
190690                                                                  0000000
190700*    move  '36601'                 to  CDCREC-E-SAS-CAISSE        0000000
190710*    MOVE  'O077400'               TO  CDCREC-E-SAS-IDSAS         0000000
190720                                                                  0000000
190730     Move  'O'                     to  CDCREC-E-LIB-CDC           0000000
190740     Set EXTENSION-CAISSE          to  true                       0000000
190750*    Set FILTRE-CAISSE             to  true                       0000000
190760     Set CDC-UNIQUE                to  true                       0000000
190770                                                                  0000000
190780     Call   'ZCALLPGM'   using   ZCDCREC CDCREC                   0000000
190790                                                                  0000000
190800d    display 'CDCREC-CDRET = ' CDCREC-CDRET                       0000000
190810d    display 'CDCREC-MESSAGE = ' CDCREC-MESSAGE                   0000000
190820                                                                  0000000
190830d    display  ' caisse = '       CDCREC-E-SAS-CAISSE              0000000
190840d    display  ' USER   = '       CDCREC-E-SAS-IDSAS               0000000
190850                                                                  0000000
190860d    display 'S-cdc    =' CDCREC-S-CDC    (1)                     0000000
190870d    display 'S-titre  =' CDCREC-S-TITRE  (1)                     0000000
190880d    display 'S-nom    =' CDCREC-S-NOM    (1)                     0000000
190890d    display 'S-prenom =' CDCREC-S-PRENOM (1)                     0000000
190900d    display 'S-teleph =' CDCREC-S-TELEPH (1)                     0000000
190910d    display 'S-telecop=' CDCREC-S-TELECOP(1)                     0000000
190920d    display 'S-memoid =' CDCREC-S-MEMOID (1)                     0000000
190930d    display 'S-sasid  =' CDCREC-S-SASID  (1)                     0000000
190940d    display 'S-email  =' CDCREC-S-EMAIL  (1)                     0000000
190950d    display 'S-str-rat=' CDCREC-S-STR-RAT(1)                     0000000
190960                                                                  0000000
190970                                                                  0000000
190980     if  CDCREC-CDRET  =  SPACES   and                            0000000
190990         CDCREC-S-STR-RAT(1) not  =  space                        0000000
191000         Perform   APPEL-ZORGFBC-BURO                             0000000
191010     End-if                                                       0000000
191020     .                                                            0000000
191030                                                                  0000000
191040 APPEL-ZORGFBC-BURO.                                              0000000
191050*------------------*                                              0000000
191060                                                                  0000000
191070     INITIALIZE ORGENT                                            0000000
191080     INITIALIZE ORGS03                                            0000000
191090                                                                  0000000
191100     MOVE  SPACE                 TO  ORGENT-NOM-OBJET.            0000000
191110                                                                  0000000
191120     STRING  orgs01-banque                                        0000000
191130             CDCREC-S-STR-RAT(1) (3:7) delimited  BY SIZE         0000000
191140                                 INTO    ORGENT-NOM-OBJET         0000000
191150                                                                  0000000
191160     DISPLAY  'ORGENT-NOM-OBJET      : ' ORGENT-NOM-OBJET         0000000
191170                                                                  0000000
191180     SET ORGENT-TYPE-UNITAIRE         TO TRUE                     0000000
191190     SET ORGENT-RADICAL-OBJET-BUREAU  TO TRUE                     0000000
191200     SET ORGENT-FCT-INFO-STANDARD     TO TRUE                     0000000
191210     SET ORGENT-TP                    TO TRUE                     0000000
191220                                                                  0000000
191230     CALL 'ZCALLPGM' USING ZORGFBC                                0000000
191240                           ORGENT                                 0000000
191250                           ORGS03                                 0000000
191260     END-CALL                                                     0000000
191270                                                                  0000000
191280     IF NOT ORGS03-OK                                             0000000
191290        DISPLAY  'ZORGFBC  CODE RETOUR  : '  ORGS03-CODE-RETOUR   0000000
191300        DISPLAY  'LIBELLE ERR ORGS03 : ' ORGS03-CR-LIBELLE        0000000
191310        MOVE SPACE            TO  ORGS03  CAI-UAG-TEL             0000000
191320                                          CAI-UAG-FAX             0000000
191330     Else                                                         0000000
191340         MOVE  ORGS03-BUR-TEL-TECHNIQUE    TO  CAI-UAG-TEL        0000000
191350         MOVE  ORGS03-BUR-FAX              TO  CAI-UAG-FAX        0000000
191360     END-IF                                                       0000000
191370     .                                                            0000000
191380                                                                  0000000
191390                                                                  0000000
191400 APPEL-ZPSOVAL.                                                   0000000
191410*--------------                                                   0000000
191420     INITIALIZE PSOVAL                                            0000000
191430     MOVE PRTLNK-DATE TO PSOVAL-DAT                               0000000
191440     MOVE SAY-BANQ    TO PSOVAL-COD-BQE                           0000000
191450     MOVE SAY-NCAIS   TO PSOVAL-COD-CAI                           0000000
191460                                                                  0000000
191470     CALL 'ZCALLPGM' USING ZPSOVAL                                0000000
191480                           PSOVAL                                 0000000
191490                           PCBCO1                                 0000000
191500                           PCBCO2                                 0000000
191510                           PCBCO3                                 0000000
191520                           PCBCO4                                 0000000
191530                           PCBBIDPSO                              0000000
191540     END-CALL                                                     0000000
191550                                                                  0000000
191560     If  orgs01-assimile-cmsmb                                    0000000
191570         move 1 to  PSOVAL-VAL-PRIN                               0000000
191580     End-if                                                       0000000
191590                                                                  0000000
191600     .                                                            0000000
191610                                                                  0000000
191620                                                                  0000000
191630***************************************************               0000000
191640*    DISPLAY ENREG. DE TYPE CLAUSES SPECIFIQUES   *               0000000
191650                                                                  0000000
191660dDISP-CLAUSE-SPECIF.                                              0000000
191670d    DISPLAY '  '                                                 0000000
191680d    DISPLAY '***   IPPCPL CLAUSES SPECIFIQUES'                   0000000
191690d    display '    IPPMAS-EXIST-CLAUSE-DOS   :'                    0000000
191700d                            IPPMA2-EXIST-CLAUSE-DOS  ':'         0000000
191710d    display '    IPPMASR-EXIST-CLAUSE-DOS  :'                    0000000
191720d                            IPPMA2R-EXIST-CLAUSE-DOS ':'         0000000
191730d    DISPLAY '***        IPPCPL DEB  ***'                         0000000
191740d    DISPLAY '  '                                                 0000000
191750d    DISPLAY ' IPPCPL-CLAUSE-SALARIE :' IPPCPL-CLAUSE-SALARIE ':' 0000000
191760d    DISPLAY ' IPPCPL-CLAUSE-ASS-CNP :' IPPCPL-CLAUSE-ASS-CNP ':' 0000000
191770d    DISPLAY '***  IPPCPL-CLAUSES-NO'                             0000000
191780d    DISPLAY '   IPPCPL-CLAUSE-NO 1  :' IPPCPL-CLAUSE-NO (1) ':'  0000000
191790d    DISPLAY '   IPPCPL-CLAUSE-NO 2  :' IPPCPL-CLAUSE-NO (2) ':'  0000000
191800d    DISPLAY '   IPPCPL-CLAUSE-NO 3  :' IPPCPL-CLAUSE-NO (3) ':'  0000000
191810d    DISPLAY '   IPPCPL-CLAUSE-NO 4  :' IPPCPL-CLAUSE-NO (4) ':'  0000000
191820d    DISPLAY '   IPPCPL-CLAUSE-NO 5  :' IPPCPL-CLAUSE-NO (5) ':'  0000000
191830d    DISPLAY '   IPPCPL-CLAUSE-NO 6  :' IPPCPL-CLAUSE-NO (6) ':'  0000000
191840d    DISPLAY '   IPPCPL-CLAUSE-NO 7  :' IPPCPL-CLAUSE-NO (7) ':'  0000000
191850d    DISPLAY '   IPPCPL-CLAUSE-NO 8  :' IPPCPL-CLAUSE-NO (8) ':'  0000000
191860d    DISPLAY '   IPPCPL-CLAUSE-NO 9  :' IPPCPL-CLAUSE-NO (9) ':'  0000000
191870d    DISPLAY '   IPPCPL-CLAUSE-NO 10 :' IPPCPL-CLAUSE-NO (10) ':' 0000000
191880d    DISPLAY ' IPPCPL-CLAUSE-LS      :' IPPCPL-CLAUSE-LS ':'      0000000
191890d    DISPLAY ' IPPCPL-CLAUSE-TITRE   :' IPPCPL-CLAUSE-TITRE ':'   0000000
191900d    DISPLAY '***  IPPCPL-CLAUSE-TEXTES'                          0000000
191910d    DISPLAY '   IPPCPL-CLAUSE-TEXTE 1  :'                        0000000
191920d                                IPPCPL-CLAUSE-TEXTE (1) ':'      0000000
191930d    DISPLAY '   IPPCPL-CLAUSE-TEXTE 2  :'                        0000000
191940d                                IPPCPL-CLAUSE-TEXTE (2) ':'      0000000
191950d    DISPLAY '   IPPCPL-CLAUSE-TEXTE 3  :'                        0000000
191960d                                IPPCPL-CLAUSE-TEXTE (3) ':'      0000000
191970d    DISPLAY '   IPPCPL-CLAUSE-TEXTE 4  :'                        0000000
191980d                                IPPCPL-CLAUSE-TEXTE (4) ':'      0000000
191990d    DISPLAY '   IPPCPL-CLAUSE-TEXTE 5  :'                        0000000
192000d                                IPPCPL-CLAUSE-TEXTE (5) ':'      0000000
192010d    DISPLAY '   IPPCPL-CLAUSE-TEXTE 6  :'                        0000000
192020d                                IPPCPL-CLAUSE-TEXTE (6) ':'      0000000
192030d    DISPLAY '  '                                                 0000000
192040d    display '   IPPMA2-LABEL-APPLI            :'                 0000000
192050d                            IPPMA2-LABEL-APPLI ':'               0000000
192060d    display '   IPPMA2-EXIST-CLAUSE-DOS       :'                 0000000
192070d                            IPPMA2-EXIST-CLAUSE-DOS  ':'         0000000
192080d    display '   IPPMA2R-EXIST-CLAUSE-DOS      :'                 0000000
192090d                            IPPMA2R-EXIST-CLAUSE-DOS ':'         0000000
192100d    display '   IPPMA2-2-EXIST-CLAUSE-PRT (1) :'                 0000000
192110d                          IPPMA2-2-EXIST-CLAUSE-PRT (1) ':'      0000000
192120d    display '  '                                                 0000000
192130d    DISPLAY '***        IPPCPL FIN  ***'                         0000000
192140d    .                                                            0000000
192150                                                                  0000000
192160*-------------*                                                   0000000
192170 SP-ENVOI-MAIL.                                                   0000000
192180*-------------*                                                   0000000
192190*                                                                 0000000
192200     OPEN  INPUT  FANOM                                           0000000
192210                                                                  0000000
192220     SET OUI-PREMIERE  TO TRUE                                    0000000
192230     INITIALIZE        YIPXMES                                    0000000
192240     SET  NON-FF-ANOM  TO  TRUE                                   0000000
192250                                                                  0000000
192260     PERFORM  UNTIL  OUI-FF-ANOM                                  0000000
192270                                                                  0000000
192280         READ  FANOM   AT  END                                    0000000
192290            SET   OUI-FF-ANOM   TO  TRUE                          0000000
192300         END-READ                                                 0000000
192310                                                                  0000000
192320       IF  NON-FF-ANOM                                            0000000
192330                                                                  0000000
192340          if  y-a-des-anos                                        0000000
192350              Move  '***'  to  ipxmes-titre (15 : 3)              0000000
192360          End-if                                                  0000000
192370                                                                  0000000
192380          IF  OUI-PREMIERE                                        0000000
192390d             display  eanom                                      0000000
192400              MOVE  EANOM  TO  LIGNE-ANOM                         0000000
192410              PERFORM  ENT-MAIL                                   0000000
192420              SET  NON-PREMIERE  TO  TRUE                         0000000
192430          END-IF                                                  0000000
192440                                                                  0000000
192450          ADD  1  TO  CPT-NB-MES                                  0000000
192460          ADD  1  TO  GG                                          0000000
192470                                                                  0000000
192480          IF  GG  >  40                                           0000000
192490              MOVE  LIB-ANOM-SUIT1  TO  IPXMES-LIBEL (GG)         0000000
192500              PERFORM  MEP-DEBMES                                 0000000
192510              PERFORM  APPEL-IPXZMAIL                             0000000
192520              MOVE  SPACES  TO  IPXMES-MSGES                      0000000
192530              MOVE  1  TO  GG                                     0000000
192540              MOVE  LIB-ANOM-SUIT2  TO  IPXMES-LIBEL (GG)         0000000
192550              ADD   1  TO  GG                                     0000000
192560              MOVE  EANOM  TO  IPXMES-LIBEL (GG)                  0000000
192570            ELSE                                                  0000000
192580              MOVE  EANOM  TO  IPXMES-LIBEL (GG)                  0000000
192590          END-IF                                                  0000000
192600                                                                  0000000
192610       ELSE                                                       0000000
192620                                                                  0000000
192630**        IF  OUI-PREMIERE                                        0000000
192640*             PERFORM  SANS-MESSAGE                               0000000
192650**        END-IF                                                  0000000
192660                                                                  0000000
192670          IF  GG  >  ZERO                                         0000000
192680              PERFORM  MEP-DEBMES                                 0000000
192690              PERFORM  APPEL-IPXZMAIL                             0000000
192700              MOVE  SPACES  TO  IPXMES-MSGES                      0000000
192710          END-IF                                                  0000000
192720                                                                  0000000
192730       END-IF                                                     0000000
192740                                                                  0000000
192750     END-PERFORM                                                  0000000
192760                                                                  0000000
192770*                                                                 0000000
192780     CLOSE  FANOM                                                 0000000
192790* pour vider le fichier ano pour viter le double envoi.          0000000
192800                                                                  0000000
192810     OPEN  output FANOM                                           0000000
192820     CLOSE  FANOM                                                 0000000
192830     .                                                            0000000
192840                                                                  0000000
192850*----------*                                                      0000000
192860 MEP-DEBMES.                                                      0000000
192870*----------*                                                      0000000
192880*                                                                 0000000
192890                                                                  0000000
192900     MOVE  'T'               TO   IPXMES-TYPE                     0000000
192910     SET  IPXMES-VERIF-SPI-NON TO TRUE                            0000000
192920     SET   IPXMES-MES-MES    TO  TRUE                             0000000
192930                                                                  0000000
192940     perform desti-mail                                           0000000
192950                                                                  0000000
192960*PGI - R40738 - 10/06/2011 - DEB                                  0000000
192970     if  SIT-ISC-TYPE-TEST                                        0000000
192980*    if  XX-SITE-MODULE  = 'NI'                                   0000000
192990*PGI - R40738 - 10/06/2011 - FIN                                  0000000
193000         if  cst-mail  =  spaces                                  0000000
193010             MOVE  W-DEST1             TO  ipxmes-user            0000000
193020d            display 'wdest-1 = ' w-dest1                         0000000
193030         Else                                                     0000000
193040             MOVE  cst-mail               TO   IPXMES-USER        0000000
193050d            display 'cst-mail= ' cst-mail                        0000000
193060         End-if                                                   0000000
193070     Else                                                         0000000
193080                                                                  0000000
193090* trt destinataire 1                                              0000000
193100         MOVE  W-DEST1             TO  ipxmes-user                0000000
193110d        display 'wdest-1 = ' w-dest1                             0000000
193120                                                                  0000000
193130     End-if                                                       0000000
193140     display  'mail-pour ' IPXMES-USER                            0000000
193150     display  'mail-pour ' IPXMES-USER                            0000000
193160     display  'mail-pour ' IPXMES-USER                            0000000
193170     MOVE  'IPX'             TO   IPXMES-APPLI                    0000000
193180     MOVE  'IPPBATCH'        TO   IPXMES-NOMPGM                   0000000
193190     SET IPXMES-VERIF-ADR-NON TO TRUE                             0000000
193200     MOVE  SPACES            TO   IPXMES-RESERVE                  0000000
193210     MOVE  SPACES            TO   IPXMES-ERREUR                   0000000
193220     .                                                            0000000
193230                                                                  0000000
193240*--------------*                                                  0000000
193250 APPEL-IPXZMAIL.                                                  0000000
193260*--------------*                                                  0000000
193270*                                                                 0000000
193280     if   nombre-anomalie not = zero                              0000000
193290         Display 'Mail envoy  ' IPXMES-USER                     0000000
193300         Display 'Appli         ' IPXMES-APPLI                    0000000
193310         Display 'Nom PGM       ' IPXMES-NOMPGM                   0000000
193320                                                                  0000000
193330         CALL  'ZCALLPGM'    USING  IPXZMAIL                      0000000
193340                                    PCBSPI                        0000000
193350                                    YIPXMES                       0000000
193360         END-CALL                                                 0000000
193370                                                                  0000000
193380         IF  IPXMES-CDE-ERREUR  =  ZEROS  OR                      0000000
193390                               SPACES                             0000000
193400             DISPLAY  'YIPXMES-CDE-ERREUR  *'  IPXMES-CDE-ERREUR  0000000
193410             DISPLAY  'YIPXMES-ERR-PGM     *'  IPXMES-ERR-PGM     0000000
193420             DISPLAY  'YIPXMES-MES-ERREUR  *'  IPXMES-MES-ERREUR  0000000
193430             DISPLAY  '      '                                    0000000
193440         END-IF                                                   0000000
193450     END-IF                                                       0000000
193460     .                                                            0000000
193470                                                                  0000000
193480                                                                  0000000
193490 ENT-MAIL.                                                        0000000
193500                                                                  0000000
193510     MOVE    W-FCRD(1:2)             TO  IPXMES-FEDE              0000000
193520                                                                  0000000
193530*PGI - R40738 - 10/06/2011 - DEB                                  0000000
193540     string  SIT-ISC-CODE-IMS ' '                                 0000000
193550*    string  XX-SITE-module  ' '                                  0000000
193560*PGI - R40738 - 10/06/2011 - FIN                                  0000000
193570             W-FCRD(1:2)  ' '                                     0000000
193580             W-FCRD(3:5)  delimited by size into IPXMES-TITRE     0000000
193590d    display 'IPXMES-TITRE ' IPXMES-TITRE                         0000000
193600     .                                                            0000000
193610                                                                  0000000
193620*------------*                                                    0000000
193630 SANS-MESSAGE.                                                    0000000
193640*------------*                                                    0000000
193650*                                                                 0000000
193660     PERFORM  MEP-DEBMES                                          0000000
193670                                                                  0000000
193680*    MOVE  XX-SITE-MODULE  TO  IPXMES-FEDE                        0000000
193690*    MOVE  XX-SITE-NOM     TO  IPXMES-TITRE                       0000000
193700     MOVE  W-FCRD(1:2)  TO  IPXMES-FEDE                           0000000
193710*PGI - R40738 - 10/06/2011 - DEB                                  0000000
193720     string  SIT-ISC-CODE-IMS ' '                                 0000000
193730*    string  XX-SITE-module  ' '                                  0000000
193740*PGI - R40738 - 10/06/2011 - FIN                                  0000000
193750             W-FCRD(1:2)  ' '                                     0000000
193760             W-FCRD(3:5)  delimited by size into IPXMES-TITRE     0000000
193770     MOVE  SPACES          TO  IPXMES-MSGES                       0000000
193780     MOVE  LIB-FIC-VIDE    TO  IPXMES-LIBEL (1)                   0000000
193790                                                                  0000000
193800     PERFORM  APPEL-IPXZMAIL                                      0000000
193810     .                                                            0000000
193820*                                                                 0000000
193830 LECT-SPI-DELEG.                                                  0000000
193840                                                                  0000000
193850     SET AUTO-CTR-DLG-NON TO TRUE                                 0000000
193860     INITIALIZE IPXDLG                                            0000000
193870     MOVE W-FCRD(1:2) TO  IPXDLG-FED                              0000000
193880     MOVE ORGS01-BANQUE TO  IPXDLG-BANQUE                         0000000
193890     MOVE W-FCRD(3:5) TO  IPXDLG-CAISSE                           0000000
193900     MOVE DATJOUR        TO  IPXDLG-DATE-JOUR                     0000000
193910     SET  IPXDLG-ORIG-BAT TO TRUE                                 0000000
193920                                                                  0000000
193930D    DISPLAY ' IPXDLG-FED       -> ' IPXDLG-FED                   0000000
193940D    DISPLAY ' IPXDLG-BANQUE    -> ' IPXDLG-BANQUE                0000000
193950D    DISPLAY ' IPXDLG-CAISSE    -> ' IPXDLG-CAISSE                0000000
193960D    DISPLAY ' IPXDLG-DATE-JOUR -> ' IPXDLG-DATE-JOUR             0000000
193970                                                                  0000000
193980     CALL 'ZCALLPGM' USING IPXZADLG                               0000000
193990                           IPXDLG                                 0000000
194000                           PCBSPI                                 0000000
194010                                                                  0000000
194020     EVALUATE TRUE                                                0000000
194030     WHEN IPXDLG-RETOUR-ERR                                       0000000
194040          MOVE 'ERREUR ACCES  IPXCTRDLG (SPITAB)'                 0000000
194050                   TO ANOM-60                                     0000000
194060**********MOVE SPI-RETCOD                           TO CTL-R34    0000000
194070          MOVE  PARFRE-COD-RET-PRIMAIRE(3:2) TO CTL-R34           0000000
194080          MOVE  60  TO TEST-1                                     0000000
194090          PERFORM  TRAIT-ANOMALIE                                 0000000
194100     WHEN IPXDLG-RETOUR-OK                                        0000000
194110          SET  AUTO-CTR-DLG-OUI      TO  TRUE                     0000000
194120     WHEN OTHER                                                   0000000
194130          CONTINUE                                                0000000
194140     END-EVALUATE                                                 0000000
194150                                                                  0000000
194160D    DISPLAY 'AUTO-CTR-DLG  = ' AUTO-CTR-DLG                      0000000
194170     .                                                            0000000
194180* SBO22032006                                                     0000000
194190*=================================================================0000000
194200 LECTURE-PRTCONDI.                                                0000000
194210     SET MAJ-IPPMA2-IPPBATCH-NUIT  TO TRUE                        0000000
194220     MOVE  '5004'         TO  IPCOND-CONDITION.                   0000000
194230     MOVE  '   '          TO  IPCOND-DEVISE                       0000000
194240     MOVE  ORGS01-BANQUE  TO  IPCOND-BANQUE                       0000000
194250     MOVE  W-DATE-8       TO  IPCOND-DATE-EFFET                   0000000
194260     MOVE     'PP'        TO  IPCOND-MODE.                        0000000
194270D    DISPLAY ' IPCOND-CLE  ' IPCOND-CLE.                          0000000
194280     CALL 'ZCALLPGM' USING ZPRTCOND                               0000000
194290                           PCBSPI                                 0000000
194300                           IPCOND                                 0000000
194310                           CTL-R34.                               0000000
194320D    DISPLAY ' CTL-R34         ' CTL-R34.                         0000000
194330D    DISPLAY ' libelle '   IPCOND-LIBELLE .                       0000000
194340                                                                  0000000
194350     IF  NOT (CTL-R34  =  ZERO)                                   0000000
194360         STRING 'PB PRTCONDI ' CTL-R34                            0000000
194370                ' CLE ' IPCOND-CLE '/'                            0000000
194380         DELIMITED SIZE          INTO ANOM-60                     0000000
194390         MOVE  61  TO TEST-1                                      0000000
194400         PERFORM  TRAIT-ANOMALIE                                  0000000
194410     ELSE                                                         0000000
194420         IF  IPCOND-LIBELLE (1:3) = 'OUI'                         0000000
194430             SET MAJ-IPPMA2-PAR-IPXBMA2J   TO TRUE                0000000
194440         END-IF                                                   0000000
194450     END-IF.                                                      0000000
194460     .                                                            0000000
194470*==============================================================   0000000
194480 ECRITURE-MAJ-IPPMA2.                                             0000000
194490     INITIALIZE YIPXMAJ-ENREG-MAJ                                 0000000
194500     MOVE '20'                      TO YIPXMAJ-CODENR-MAJ         0000000
194510     MOVE 'DLI     '                TO YIPXMAJ-ACCES              0000000
194520     MOVE REPL                      TO YIPXMAJ-APPEL              0000000
194530                                                                  0000000
194540     EVALUATE TRUE                                                0000000
194550        WHEN AVENANT                                              0000000
194560           MOVE 'AVENANT   '        TO YIPXMAJ-ORIGINE            0000000
194570        WHEN CONTRAT-GPR                                          0000000
194580           MOVE 'CONTRATGPR'        TO YIPXMAJ-ORIGINE            0000000
194590*       WHEN CONTRAT-EDITE = 'O'                                  0000000
194600        WHEN OTHER                                                0000000
194610           MOVE 'CONTRAT   '        TO YIPXMAJ-ORIGINE            0000000
194620*          MOVE 'IPPBATCH  '        TO YIPXMAJ-ORIGINE            0000000
194630     END-EVALUATE                                                 0000000
194640                                                                  0000000
194650     MOVE '***'                     TO YIPXMAJ-INTERVENTION       0000000
194660     MOVE 'DOS'                     TO YIPXMAJ-TYPENREG           0000000
194670     MOVE IPPMA2-CLE                TO YIPXMAJ-CLEMIN-IPPMA2      0000000
194680     MOVE IPPMA2-CLE                TO YIPXMAJ-CLEMAX-IPPMA2      0000000
194690     MOVE SPACES                    TO YIPXMAJ-CLEMIN-IPPCPL      0000000
194700     MOVE SPACES                    TO YIPXMAJ-CLEMAX-IPPCPL      0000000
194710     MOVE APPEL-CAT                 TO YIPXMAJ-TYPSER             0000000
194720     MOVE ORGS01-BANQUE             TO YIPXMAJ-BANQUE             0000000
194730     MOVE EDT-OK                    TO YIPXMAJ-EDITION-IPX        0000000
194740     MOVE GDP-OK                    TO YIPXMAJ-EDITION-GDP        0000000
194750     MOVE W-DATRAIT                 TO YIPXMAJ-DATE-TRAIT         0000000
194760                                                                  0000000
194770     WRITE YIPXMAJ                                                0000000
194780     ADD 1 TO CPT-IPXMAJ-ECRITS                                   0000000
194790     .                                                            0000000
194800*==============================================================   0000000
194810 ECRITURE-MAJ-IPPMA2-ENTETE.                                      0000000
194820     INITIALIZE YIPXMAJ-ENREG-MAJ                                 0000000
194830     MOVE '10'                      TO YIPXMAJ-CODENR-ENTETE      0000000
194840     MOVE DATJOUR                   TO YIPXMAJ-DATE               0000000
194850     MOVE HEUJOUR                   TO YIPXMAJ-HEURE              0000000
194860*PGI - R40738 - 10/06/2011 - DEB                                  0000000
194870     MOVE SIT-ISC-CODE-IMS          TO YIPXMAJ-SITE-MODULE        0000000
194880*    MOVE XX-SITE-MODULE            TO YIPXMAJ-SITE-MODULE        0000000
194890*PGI - R40738 - 10/06/2011 - FIN                                  0000000
194900     MOVE XX-SITE-NOM               TO YIPXMAJ-SITE-NOM           0000000
194910     MOVE ORGS01-BANQUE             TO YIPXMAJ-BANQUE             0000000
194920                                                                  0000000
194930     WRITE YIPXMAJ                                                0000000
194940     ADD 1 TO CPT-IPXMAJ-ECRITS                                   0000000
194950     .                                                            0000000
194960                                                                  0000000
194970*-----------*                                                     0000000
194980 INIT-SBCFAL.                                                     0000000
194990*-----------*                                                     0000000
195000*                                                                 0000000
195010     INITIALIZE SBCFAL                                            0000000
195020                SBCFRE                                            0000000
195030                                                                  0000000
195040     MOVE  'INSTRUCTIONCDT'           TO  SBCFAL-BLOC-EME         0000000
195050     MOVE  'IPPBATCH'                 TO  SBCFAL-PGM-EME          0000000
195060     MOVE  'IPR1'                     TO  SBCFAL-APL-EME          0000000
195070                                                                  0000000
195080     SET   SBCFAL-TYP-EME-CENTRAL     TO  TRUE                    0000000
195090     SET   SBCFAL-TEMPS-REEL          TO  TRUE                    0000000
195100     SET   SBCFAL-ACN-LECTURE-UNIQUE  TO  TRUE                    0000000
195110     MOVE  'SBC-RESTITUTION'          TO  SBCFAL-OBJ-GES          0000000
195120     MOVE  'L0001'                    TO  SBCFAL-FON              0000000
195130*    IF  DATJOUR  NUMERIC                                         0000000
195140*        MOVE  DATJOURN               TO  SBCFAL-DATE             0000000
195150*      ELSE                                                       0000000
195160*        MOVE  ZERO                   TO  SBCFAL-DATE             0000000
195170*    END-IF                                                       0000000
195180*    MOVE  HEUJOURN                   TO  SBCFAL-HEURE            0000000
195190     MOVE  ZEROS  TO  SBCFAL-DATE                                 0000000
195200     MOVE  ZEROS  TO  SBCFAL-HEURE                                0000000
195210     .                                                            0000000
195220                                                                  0000000
195230*--------------*                                                  0000000
195240 APPEL-SBCGAPEL.                                                  0000000
195250*--------------*                                                  0000000
195260*                                                                 0000000
195270     INITIALIZE SBCE01                                            0000000
195280                SBCS01                                            0000000
195290                                                                  0000000
195300     MOVE  'GUI'               TO  SBCE01-L0001-IDE-ORG           0000000
195310     MOVE  SAY-BANQ            TO  SBCE01-L0001-REF-ORG(1:5)      0000000
195320                                   SBCE01-L0001-COD-BQE           0000000
195330     MOVE  SAY-NCAIS           TO  SBCE01-L0001-REF-ORG(6:5)      0000000
195340     MOVE  COND-NUMERO         TO  SBCE01-L0001-REF-CND           0000000
195350     MOVE  SAY-DEVISE          TO  SBCE01-L0001-DEVISE            0000000
195360d    display ' sbo29012007 '                                      0000000
195370d    display 'SBCE01-L0001-REF-CND=' SBCE01-L0001-REF-CND         0000000
195380d    display 'SBCE01-L0001-DEVISE =' SBCE01-L0001-DEVISE          0000000
195390     MOVE  SPACES              TO  SBCE01-L0001-IDE-PRD           0000000
195400     MOVE  SPACES              TO  SBCE01-L0001-REF-PRD           0000000
195410     MOVE  SPACES              TO  SBCE01-L0001-REF-CLI           0000000
195420                                   SBCE01-L0001-IDE-CLI           0000000
195430     MOVE  'M'                 TO  SBCE01-L0001-TYPE-DEMANDE      0000000
195440                                                                  0000000
195450     SET  SBCE01-L0001-CONTRAINTES    TO  TRUE                    0000000
195460     SET  SBCE01-L0001-SANS-CONTROLE  TO  TRUE                    0000000
195470                                                                  0000000
195480     IF   DATOUV-SSAAMMJJ NUMERIC                                 0000000
195490          AND  DATOUV-SSAAMMJJ  >  ZERO                           0000000
195500          MOVE  DATOUV-SSAAMMJJ  TO  SBCE01-L0001-DATE-EFFET      0000000
195510     END-IF                                                       0000000
195520                                                                  0000000
195530*                                                                 0000000
195540     CALL 'ZCALLPGM' USING SBCGAPEL                               0000000
195550                           SBCFAL                                 0000000
195560                           SBCE01                                 0000000
195570                           SBCFRE                                 0000000
195580                           SBCS01                                 0000000
195590                           IOPCB-BIDON                            0000000
195600                           SPIPCB-BIDON                           0000000
195610                           PCBCO1                                 0000000
195620                           PCBCO2                                 0000000
195630                           PCBCO3                                 0000000
195640                           PCBCO4                                 0000000
195650     END-CALL                                                     0000000
195660     .                                                            0000000
195670*                                                                 0000000
195680*-------------------*                                             0000000
195690 APPEL-SBCGAPEL-1825.                                             0000000
195700*-------------------*                                             0000000
195710*                                                                 0000000
195720     INITIALIZE SBCE01                                            0000000
195730                SBCS01                                            0000000
195740                                                                  0000000
195750     MOVE  'GUI'               TO  SBCE01-L0001-IDE-ORG           0000000
195760     MOVE  SAY-BANQ            TO  SBCE01-L0001-REF-ORG(1:5)      0000000
195770                                   SBCE01-L0001-COD-BQE           0000000
195780     MOVE  SAY-NCAIS           TO  SBCE01-L0001-REF-ORG(6:5)      0000000
195790     MOVE  '0001825'          TO  SBCE01-L0001-REF-CND            0000000
195800     MOVE  SAY-DEVISE          TO  SBCE01-L0001-DEVISE            0000000
195810     MOVE  SPACES              TO  SBCE01-L0001-IDE-PRD           0000000
195820     MOVE  SPACES              TO  SBCE01-L0001-REF-PRD           0000000
195830     MOVE  SPACES              TO  SBCE01-L0001-REF-CLI           0000000
195840                                   SBCE01-L0001-IDE-CLI           0000000
195850     MOVE  'M'                 TO  SBCE01-L0001-TYPE-DEMANDE      0000000
195860     SET  SBCE01-L0001-CONTRAINTES    TO  TRUE                    0000000
195870     SET  SBCE01-L0001-SANS-CONTROLE  TO  TRUE                    0000000
195880                                                                  0000000
195890     STRING    IPPPRI-DATINDEX (7:4)                              0000000
195900               IPPPRI-DATINDEX (4:2)                              0000000
195910               IPPPRI-DATINDEX (1:2)                              0000000
195920               DELIMITED  BY  SIZE                                0000000
195930                         INTO  SBCE01-L0001-DATE-EFFET            0000000
195940                                                                  0000000
195950*                                                                 0000000
195960     CALL 'ZCALLPGM' USING SBCGAPEL                               0000000
195970                           SBCFAL                                 0000000
195980                           SBCE01                                 0000000
195990                           SBCFRE                                 0000000
196000                           SBCS01                                 0000000
196010                           IOPCB-BIDON                            0000000
196020                           SPIPCB-BIDON                           0000000
196030                           PCBCO1                                 0000000
196040                           PCBCO2                                 0000000
196050                           PCBCO3                                 0000000
196060                           PCBCO4                                 0000000
196070     END-CALL                                                     0000000
196080     .                                                            0000000
196090                                                                  0000000
196100D    DISPLAY 'SBCE01-L0001-DATE-EFFET :'                          0000000
196110D                                 SBCE01-L0001-DATE-EFFET  '**'   0000000
196120D    DISPLAY 'SBCS01-L0001-FMT-CAR (1)  :'                        0000000
196130D                                 SBCS01-L0001-FMT-CAR (1) '**'   0000000
196140D    DISPLAY 'SBCFRE-COD-RET-PRIMAIRE   :'                        0000000
196150D                                 SBCFRE-COD-RET-PRIMAIRE  '**'   0000000
196160     .                                                            0000000
196170*-------------------------------------------------------------    0000000
196180 APPEL-SBCGAPEL-3679.                                             0000000
196190*-------------------*                                             0000000
196200*                                                                 0000000
196210     INITIALIZE SBCE01                                            0000000
196220                SBCS01                                            0000000
196230                                                                  0000000
196240     MOVE  'GUI'               TO  SBCE01-L0001-IDE-ORG           0000000
196250     MOVE  SAY-BANQ            TO  SBCE01-L0001-REF-ORG(1:5)      0000000
196260                                   SBCE01-L0001-COD-BQE           0000000
196270     MOVE  SAY-NCAIS           TO  SBCE01-L0001-REF-ORG(6:5)      0000000
196280     MOVE  '0003679'          TO  SBCE01-L0001-REF-CND            0000000
196290     MOVE  SAY-DEVISE          TO  SBCE01-L0001-DEVISE            0000000
196300     MOVE  SPACES              TO  SBCE01-L0001-IDE-PRD           0000000
196310     MOVE  SPACES              TO  SBCE01-L0001-REF-PRD           0000000
196320     MOVE  SPACES              TO  SBCE01-L0001-REF-CLI           0000000
196330                                   SBCE01-L0001-IDE-CLI           0000000
196340     MOVE  'M'                 TO  SBCE01-L0001-TYPE-DEMANDE      0000000
196350     SET  SBCE01-L0001-CONTRAINTES    TO  TRUE                    0000000
196360     SET  SBCE01-L0001-SANS-CONTROLE  TO  TRUE                    0000000
196370                                                                  0000000
196380     STRING    IPPPRI-DATINDEX (7:4)                              0000000
196390               IPPPRI-DATINDEX (4:2)                              0000000
196400               IPPPRI-DATINDEX (1:2)                              0000000
196410               DELIMITED  BY  SIZE                                0000000
196420                         INTO  SBCE01-L0001-DATE-EFFET            0000000
196430                                                                  0000000
196440*                                                                 0000000
196450     CALL 'ZCALLPGM' USING SBCGAPEL                               0000000
196460                           SBCFAL                                 0000000
196470                           SBCE01                                 0000000
196480                           SBCFRE                                 0000000
196490                           SBCS01                                 0000000
196500                           IOPCB-BIDON                            0000000
196510                           SPIPCB-BIDON                           0000000
196520                           PCBCO1                                 0000000
196530                           PCBCO2                                 0000000
196540                           PCBCO3                                 0000000
196550                           PCBCO4                                 0000000
196560     END-CALL                                                     0000000
196570     .                                                            0000000
196580                                                                  0000000
196590D    DISPLAY 'SBCE01-L0001-DATE-EFFET :'                          0000000
196600D                                 SBCE01-L0001-DATE-EFFET  '**'   0000000
196610D    DISPLAY 'SBCS01-L0001-FMT-CAR (1)  :'                        0000000
196620D                                 SBCS01-L0001-FMT-CAR (1) '**'   0000000
196630D    DISPLAY 'SBCFRE-COD-RET-PRIMAIRE   :'                        0000000
196640D                                 SBCFRE-COD-RET-PRIMAIRE  '**'   0000000
196650     .                                                            0000000
196660*-------------------------------------------------------------    0000000
196670* Recherche si prt avec Tarification Initio                      0000000
196680*-------------------------------------------------------------    0000000
196690 TYPE-TARIF-42.                                                   0000000
196700*                                                                 0000000
196710     Set  TARIF-INITIO-KO   To True                               0000000
196720                                                                  0000000
196730     Perform INIT-CLOFAL                                          0000000
196740     Perform INIT-FCT-LP920                                       0000000
196750                                                                  0000000
196760     Perform APPEL-CLOPGES                                        0000000
196770     If  CLOFRE-TRT-CORRECT                                       0000000
196780                                                                  0000000
196790       If CLOESP-S-LP920-CLO-TARIF = 'I'                          0000000
196800         Set  TARIF-INITIO-OK   To True                           0000000
196810       End-If                                                     0000000
196820                                                                  0000000
196830     End-If                                                       0000000
196840                                                                  0000000
196850     Continue.                                                    0000000
196860*---------------------------------------------------------------- 0000000
196870* Appel accesseur physique CLOPGES                                0000000
196880*-----------------------------------------------------------------0000000
196890 APPEL-CLOPGES.                                                   0000000
196900*                                                                 0000000
196910     CALL 'ZCALLPGM'   USING CLOPGES                              0000000
196920                             CLOFAL                               0000000
196930                             CLOFRE                               0000000
196940                             CLOESP                               0000000
196950*                                                                 0000000
196960     EVALUATE TRUE                                                0000000
196970       WHEN CLOFRE-TRT-CORRECT                                    0000000
196980       WHEN CLOFRE-DONNEES-NON-TROUVEES                           0000000
196990         CONTINUE                                                 0000000
197000       WHEN OTHER                                                 0000000
197010D        DISPLAY 'PB CLOPGES  : ' CLOFRE-MSG-MET-MSG              0000000
197020         MOVE CLOFRE-MSG-MET-MSG(1:40) TO ANOM-63                 0000000
197030         MOVE  63  TO TEST-1                                      0000000
197040         PERFORM  TRAIT-ANOMALIE                                  0000000
197050     END-EVALUATE                                                 0000000
197060     CONTINUE.                                                    0000000
197070*---------------------------------------------------------------- 0000000
197080* Initialisation paramtre fixe Aller accesseur physique          0000000
197090*-----------------------------------------------------------------0000000
197100 INIT-CLOFAL.                                                     0000000
197110*                                                                 0000000
197120     Initialize              CLOFAL                               0000000
197130                                                                  0000000
197140     move 'CDTAMORTISSABLE'    to CLOFAL-EME-BLO                  0000000
197150     move 'BATCHPRET'          to CLOFAL-EME-APL                  0000000
197160     move  PGM-STEPNAME        to CLOFAL-EME-PGM                  0000000
197170     move 'IMS'                to CLOFAL-EME-PFO-TYP              0000000
197180*PGI - R40738 - 10/06/2011 - DEB                                  0000000
197190     move SIT-ISC-CODE-IMS     to CLOFAL-EME-PFO-NOM              0000000
197200*    move ZISC-IMS             to CLOFAL-EME-PFO-NOM              0000000
197210*PGI - R40738 - 10/06/2011 - FIN                                  0000000
197220     move 'OPC'                to CLOFAL-UTI-LGE                  0000000
197230*PGI - R40738 - 10/06/2011 - DEB                                  0000000
197240     If SIT-ISC-TYPE-TEST                                         0000000
197250*    If site-de-test                                              0000000
197260*PGI - R40738 - 10/06/2011 - FIN                                  0000000
197270        move  'TESTBATC'       to CLOFAL-UTI-PHY                  0000000
197280     Else                                                         0000000
197290        move  'IPPBATCH'       to CLOFAL-UTI-PHY                  0000000
197300     End-if                                                       0000000
197310     move DATJOUR              to CLOFAL-DAT                      0000000
197320     move HEUJOUR              to CLOFAL-HEU                      0000000
197330     move 'CLO'                to CLOFAL-DEM-OBJ-GES              0000000
197340                                                                  0000000
197350     set  CLOFAL-EME-MOD-TRT-TD-DB2 To True                       0000000
197360     Continue.                                                    0000000
197370*---------------------------------------------------------------- 0000000
197380* Initialisation paramtre variable Aller accesseur physique      0000000
197390*-----------------------------------------------------------------0000000
197400 INIT-FCT-LP920.                                                  0000000
197410                                                                  0000000
197420     INITIALIZE  CLOESP                                           0000000
197430     MOVE ORGS01-BANQUE      TO CLOESP-E-LP920-BANQUE             0000000
197440     MOVE IPPMA2-CAISSE      TO CLOESP-E-LP920-CAISSE             0000000
197450     STRING                                                       0000000
197460         '000'                                                    0000000
197470         IPPMA2-RACINE                                            0000000
197480         IPPMA2-2-CAT (IP)                                        0000000
197490         DELIMITED BY SIZE INTO CLOESP-E-LP920-COMPTE             0000000
197500     MOVE IPPMA2-DEVISE      TO CLOESP-E-LP920-DEVISE             0000000
197510                                                                  0000000
197520     SET CLOFAL-GES-FON-LP920      TO TRUE                        0000000
197530     SET CLOFAL-DEM-ACN-LEC-UNI    TO TRUE                        0000000
197540                                                                  0000000
197550     Continue.                                                    0000000
197560                                                                  0000000
197570 APPEL-ZPARAPEL-L1003.                                            0000000
197580*---------------------                                            0000000
197590D    DISPLAY  'ZPAVAL ' ZPAVAL                                    0000000
197600     CALL  'ZCALLPGM' USING ZPARAPEL                              0000000
197610                            PARFAL                                0000000
197620                            ZPAVAL                                0000000
197630                            PARFRE                                0000000
197640                            ZPAVRE                                0000000
197650     END-CALL                                                     0000000
197660D    DISPLAY  'PARFRE ' PARFRE                                    0000000
197670D    DISPLAY  'TABLE / CLE :' ZPAVAL-L1003-COD-TAB '/'            0000000
197680D             ZPAVAL-L1003-CLE-POS-TAB                            0000000
197690D    DISPLAY  'ZPAVRE-L1003-ZON-VAR-PO :'                         0000000
197700D             ZPAVRE-L1003-ZON-VAR-PO                             0000000
197710     .                                                            0000000
197720                                                                  0000000
197730 INIT-ZPARAPEL-L1003.                                             0000000
197740*--------------------                                             0000000
197750     INITIALIZE                    PARFRE                         0000000
197760     INITIALIZE                    ZPAVRE                         0000000
197770     INITIALIZE                    PARFAL                         0000000
197780     MOVE  'IPP'                TO PARFAL-BLOC-EME                0000000
197790     MOVE  'IPPBATCH'           TO PARFAL-PGM-EME                 0000000
197800     MOVE  'IPR1'               TO PARFAL-APL-EME                 0000000
197810     MOVE  'CENTRAL'            TO PARFAL-TYP-EME                 0000000
197820     SET PARFAL-TEMPS-DIFFERE-IMS  TO TRUE                        0000000
197830     MOVE  'IPPBATCH'           TO PARFAL-IDE-LGE                 0000000
197840                                   PARFAL-IDE-PHY                 0000000
197850     MOVE  DATJOUR              TO PARFAL-DATE                    0000000
197860     MOVE  HEUJOUR              TO PARFAL-HEURE                   0000000
197870     MOVE  'PAR-PARAMETRE-TECHNIQUE' TO PARFAL-OBJ-GES            0000000
197880     MOVE  'L1003'              TO PARFAL-FON                     0000000
197890     MOVE  'LEI'                TO PARFAL-TYP-ACN                 0000000
197900D    DISPLAY  'PARFAL ' PARFAL                                    0000000
197910     INITIALIZE                    ZPAVAL                         0000000
197920     MOVE  '='                  TO ZPAVAL-L1003-COD-OPE           0000000
197930     MOVE  1                    TO ZPAVAL-L1003-NUM-CURS          0000000
197940     MOVE  DATJOUR       (1:4)  TO ZPAVAL-L1003-DATE-CONSULT(1:4) 0000000
197950     MOVE  '-'                  TO ZPAVAL-L1003-DATE-CONSULT(5:1) 0000000
197960     MOVE  DATJOUR       (5:2)  TO ZPAVAL-L1003-DATE-CONSULT(6:2) 0000000
197970     MOVE  '-'                  TO ZPAVAL-L1003-DATE-CONSULT(8:1) 0000000
197980     MOVE  DATJOUR       (7:2)  TO ZPAVAL-L1003-DATE-CONSULT(9:2) 0000000
197990     MOVE  SPACE                TO ZPAVAL-L1003-COD-GRP           0000000
198000                                   ZPAVAL-L1003-COD-FED           0000000
198010                                   ZPAVAL-L1003-COD-BQE           0000000
198020     MOVE  ZERO                 TO ZPAVAL-L1003-CHOIX-POSTE       0000000
198030                                   ZPAVAL-L1003-FUSION            0000000
198040     SET  ZPAVAL-L1003-APPEL-INITIAL TO TRUE                      0000000
198050     .                                                            0000000
198060                                                                  0000000
198070 COMPTER-PRET-SALARIE.                                            0000000
198080                                                                  0000000
198090     Move  zero  to   nb-pret-salarie                             0000000
198100                                                                  0000000
198110     If  not  (ippma2-2-cnat(1)  = '205' or '206' or '291'        0000000
198120                                                  or '   ')       0000000
198130         Add  1   to   nb-pret-salarie                            0000000
198140     Else                                                         0000000
198150       If  not  (ippma2-2-cnat(2)  = '205' or '206' or '291'      0000000
198160                                                   or '   ')      0000000
198170           Add  1   to   nb-pret-salarie                          0000000
198180       Else                                                       0000000
198190         If  not  (ippma2-2-cnat(3)  = '205' or '206' or '291'    0000000
198200                                                    or '   ')     0000000
198210             Add  1   to   nb-pret-salarie                        0000000
198220         Else                                                     0000000
198230           If  not  (ippma2-2-cnat(4)  = '205' or '206' or '291'  0000000
198240                                                      or '   ')   0000000
198250               Add  1   to   nb-pret-salarie                      0000000
198260           End-if                                                 0000000
198270         End-if                                                   0000000
198280       End-if                                                     0000000
198290     End-if                                                       0000000
198300     .                                                            0000000
198310                                                                  0000000
198320 RECALCUL-TAUX.                                                   0000000
198330*--------------                                                   0000000
198340                                                                  0000000
198350*--on recalcule le taux pour les assurances en % : si l'assurance 0000000
198360*--a t modifie dans TSE, on ne le sait pas, il faut recalculer 0000000
198370*--systmatiquement             recalculer                        0000000
198380D     DISPLAY 'AVANT LE CALCUL :'                                 0000000
198390D     DISPLAY 'SAY-TAUDB       :' SAY-TAUDB                       0000000
198400D     DISPLAY 'SAY-MIXT-TAUDB-V:' SAY-MIXT-TAUDB-V                0000000
198410D     DISPLAY 'SAY-MIXT-TAUDB-F:' SAY-MIXT-TAUDB-F                0000000
198420D     DISPLAY 'SAY-TAUFR       :' SAY-TAUFR                       0000000
198430                                                                  0000000
198440      PERFORM  APPEL-IPXZAPPP                                     0000000
198450D     DISPLAY 'APXTR5-TAUASSPRT:' APXTR5-TAUASSPRT                0000000
198460                                                                  0000000
198470      IF APXTR5-TYPTAR-ENCOURS                                    0000000
198480         IF SAY-TAUDB NUMERIC  and                                0000000
198490            IPPCPL-TAUDB-HA  numeric                              0000000
198500            COMPUTE SAY-TAUDB =                                   0000000
198510                 IPPCPL-TAUDB-HA + APXTR5-TAUASSPRT               0000000
198520         END-IF                                                   0000000
198530         IF SAY-MIXT-TAUDB-V NUMERIC and                          0000000
198540            IPPCPL-MIXT-TAUHA-V  numeric                          0000000
198550            COMPUTE SAY-MIXT-TAUDB-V =                            0000000
198560              IPPCPL-MIXT-TAUHA-V + APXTR5-TAUASSPRT              0000000
198570         END-IF                                                   0000000
198580         IF SAY-MIXT-TAUDB-F NUMERIC and                          0000000
198590            IPPCPL-MIXT-TAUHA-F  numeric                          0000000
198600            COMPUTE SAY-MIXT-TAUDB-F =                            0000000
198610              IPPCPL-MIXT-TAUHA-F + APXTR5-TAUASSPRT              0000000
198620         END-IF                                                   0000000
198630         IF SAY-TAUFR NUMERIC  and                                0000000
198640            IPPCPL-TAUDB-HA  numeric                              0000000
198650            COMPUTE SAY-TAUFR =                                   0000000
198660                 IPPCPL-TAUFR-HA + APXTR5-TAUASSPRT               0000000
198670         END-IF                                                   0000000
198680      END-IF                                                      0000000
198690                                                                  0000000
198700                                                                  0000000
198710D     DISPLAY 'APRES LE CALCUL :'                                 0000000
198720D     DISPLAY 'SAY-TAUDB       :' SAY-TAUDB                       0000000
198730D     DISPLAY 'SAY-MIXT-TAUDB-V:' SAY-MIXT-TAUDB-V                0000000
198740D     DISPLAY 'SAY-MIXT-TAUDB-F:' SAY-MIXT-TAUDB-F                0000000
198750D     DISPLAY 'SAY-TAUFR       :' SAY-TAUFR                       0000000
198760      .                                                           0000000
198770*=================================================================0000000
198780 rech-titulaires.                                                 0000000
198790      set Titulaires-non-trouves  to true                         0000000
198800      INITIALIZE                         YIPX020                  0000000
198810                                                                  0000000
198820      MOVE 'BATCHPRET'                TO YIPX020-APL-EME          0000000
198830      MOVE 'TI'                       TO YIPX020-MOD-TRT          0000000
198840      MOVE 'OPC'                      TO YIPX020-IDE-LGE          0000000
198850      MOVE PGM-JOBNAME                TO YIPX020-IDE-PHY          0000000
198860                                                                  0000000
198870      MOVE ORGS01-BANQUE              TO YIPX020-BANQUE           0000000
198880      MOVE SAY-NCAIS                  TO YIPX020-CAISSE           0000000
198890      MOVE SAY-RACINE9                TO YIPX020-RACINE           0000000
198900      MOVE SAY-CAT                    TO YIPX020-TYPSER           0000000
198910      string                                                      0000000
198920             SAY-CNAT                                             0000000
198930             SAY-CD-SOUS-PROD(2:2)                                0000000
198940      delimited size                into YIPX020-PRODUIT          0000000
198950d     display 'YIPX020-APL-EME    =' YIPX020-APL-EME              0000000
198960d     display 'YIPX020-MOD-TRT    =' YIPX020-MOD-TRT              0000000
198970d     display 'YIPX020-IDE-LGE    =' YIPX020-IDE-LGE              0000000
198980d     display 'YIPX020-IDE-PHY    =' YIPX020-IDE-PHY              0000000
198990                                                                  0000000
199000d     display 'YIPX020-BANQUE     =' YIPX020-BANQUE               0000000
199010d     display 'YIPX020-CAISSE     =' YIPX020-CAISSE               0000000
199020d     display 'YIPX020-RACINE     =' YIPX020-RACINE               0000000
199030d     display 'YIPX020-TYPSER     =' YIPX020-TYPSER               0000000
199040d     display 'YIPX020-PRODUIT    =' YIPX020-PRODUIT              0000000
199050                                                                  0000000
199060      CALL  'ZCALLPGM' USING IPXZ0020                             0000000
199070                             YIPX020                              0000000
199080                             IOPCB                                0000000
199090                                                                  0000000
199100      if yipx020-CRTO1 = zero                                     0000000
199110         set Titulaires-trouves  to true                          0000000
199120d        display 'YIPX020-TITBQE  (1)=' YIPX020-TITBQE  (1)       0000000
199130d        display 'YIPX020-TITCAI  (1)=' YIPX020-TITCAI  (1)       0000000
199140d        display 'YIPX020-TITRAC  (1)=' YIPX020-TITRAC  (1)       0000000
199150d        display 'YIPX020-TITNOTIT(1)=' YIPX020-TITNOTIT(1)       0000000
199160                                                                  0000000
199170d        display 'YIPX020-TITBQE  (2)=' YIPX020-TITBQE  (2)       0000000
199180d        display 'YIPX020-TITCAI  (2)=' YIPX020-TITCAI  (2)       0000000
199190d        display 'YIPX020-TITRAC  (2)=' YIPX020-TITRAC  (2)       0000000
199200d        display 'YIPX020-TITNOTIT(2)=' YIPX020-TITNOTIT(2)       0000000
199210                                                                  0000000
199220                                                                  0000000
199230         If    YIPX020-TITCAI  (1) = YIPX020-TITCAI  (2) and      0000000
199240               YIPX020-TITRAC  (1) = YIPX020-TITRAC  (2) and      0000000
199250               YIPX020-TITNOTIT(1) > YIPX020-TITNOTIT(2)          0000000
199260               move  YIPX020-TITNOTIT(1) to w-tit11               0000000
199270               move  YIPX020-TITNOTIT(2) to YIPX020-TITNOTIT(1)   0000000
199280               move  w-tit11             to YIPX020-TITNOTIT(2)   0000000
199290         end-if                                                   0000000
199300      end-if                                                      0000000
199310      .                                                           0000000
199320                                                                  0000000
199330 calcul-age.                                                      0000000
199340          INITIALIZE  DATS20                                      0000000
199350          INITIALIZE W-NBANNEES                                   0000000
199360        MOVE TIES10-L0001-DAT-NAI (1)                             0000000
199370                           TO W-date-nais                         0000000
199380          MOVE W-date-naisaa TO  XX-SSAA                          0000000
199390          MOVE W-date-naismm TO  XX-mois                          0000000
199400          MOVE W-date-naisjj TO  XX-jour                          0000000
199410          MOVE  'E01'        TO  DATS20-I-FONCTION                0000000
199420          MOVE  XX-SSAAMMJJ  TO  DATS20-I-DATE1                   0000000
199430          MOVE  'J'          TO  DATS20-I-ENTREE-TYPE1            0000000
199440          MOVE  'A'          TO  DATS20-I-ENTREE-SENS1            0000000
199450          MOVE  DATJOUR      TO  DATS20-I-DATE2                   0000000
199460          MOVE  'J'          TO  DATS20-I-ENTREE-TYPE2            0000000
199470          MOVE  'A'          TO  DATS20-I-ENTREE-SENS2            0000000
199480          MOVE  'Q'          TO  DATS20-I-TYPINFO                 0000000
199490          CALL  'ZCALLPGM'  USING  ZDAT2000                       0000000
199500                                   DATS20                         0000000
199510          IF   DATS20-O-PAS-ERREUR                                0000000
199520               MOVE DATS20-O-NBANNEES-9 TO W-NBANNEES             0000000
199530               DISPLAY 'DAT-NAI = ' TIES10-L0001-DAT-NAI (1)      0000000
199540               DISPLAY 'DATjour = ' DATS20-I-DATE1                0000000
199550               DISPLAY 'DATnais = ' DATS20-I-DATE2                0000000
199560               DISPLAY 'AGE  = ' W-NBANNEES                       0000000
199570          ELSE                                                    0000000
199580               DISPLAY 'ERREUR calcul  age      '                 0000000
199590               DISPLAY 'DAT-NAI = ' TIES10-L0001-DAT-NAI (1)      0000000
199600               DISPLAY 'DATJOUR = ' DATJOUR                       0000000
199610          END-IF.                                                 0000000
199620 calcul-age-fin.                                                  0000000
199630      exit.                                                       0000000
199640                                                                  0000000
199650dDisp-chatel.                                                     0000000
199660                                                                  0000000
199670d    Display ' Cas +++                 ' CHA-SIG-PLUS     (1)     0000000
199680d    Display ' Taux                    ' CHA-VAR-PLUS     (1)     0000000
199690d    Display ' Terme 1                 ' CHA-TER-PLUS   (1 1)     0000000
199700d    Display ' Duree 1                 ' CHA-DUR-PLUS   (1 1)     0000000
199710d    Display ' duree                   ' CHA-DIFDU-PLUS   (1)     0000000
199720d    Display ' Cout                    ' CHA-COUT-PLUS    (1)     0000000
199730d    Display '                         '                          0000000
199740d    Display ' Cas ---                 ' CHA-SIG-MOINS    (1)     0000000
199750d    Display ' Taux                    ' CHA-VAR-MOINS    (1)     0000000
199760d    Display ' Terme 1                 ' CHA-TER-MOINS  (1 1)     0000000
199770d    Display ' Duree 1                 ' CHA-DUR-MOINS  (1 1)     0000000
199780d    Display ' duree                   ' CHA-DIFDU-MOINS  (1)     0000000
199790d    Display ' Cout                    ' CHA-COUT-MOINS   (1)     0000000
199800d    Display '                         '                          0000000
199810d    Display ' Cas autre               ' CHA-SIG-AUT      (1)     0000000
199820d    Display ' Taux                    ' CHA-VAR-AUT      (1)     0000000
199830d    Display ' Terme 1                 ' CHA-TER-AUT    (1 1)     0000000
199840d    Display ' Duree 1                 ' CHA-DUR-AUT    (1 1)     0000000
199850d    Display ' duree                   ' CHA-DIFDU-AUT    (1)     0000000
199860d    Display ' Cout                    ' CHA-COUT-AUT     (1)     0000000
199870d    .                                                            0000000
199880*=================================================================0000000
199890* renseigner destinataire par dfaut                              0000000
199900* cle gespar filire                                              0000000
199910*=================================================================0000000
199920 init-destinataire.                                               0000000
199930     move spaces to w-dest1 w-dest2 w-dest3 w-dest4 w-dest5       0000000
199940     move spaces to w-copy1 w-copy2                               0000000
199950     STRING 'BATCH     ' '        ' '     '                       0000000
199960     DELIMITED BY SIZE INTO ZPAVAL-L1003-CLE-POS-TAB              0000000
199970     PERFORM APPEL-ZPARAPEL                                       0000000
199980     IF DESTPLANT                                                 0000000
199990        DISPLAY 'PB DANS ZPARAPEL  :' PARFRE-MET-MSG              0000000
200000        DISPLAY 'CODE RETOUR PRIMAIRE : '                         0000000
200010        PARFRE-COD-RET-PRIMAIRE                                   0000000
200020        DISPLAY 'CODE RETOUR SECONDAIRE : ' PARFRE-COD-RET-SCD    0000000
200030        DISPLAY 'PROGRAMME              : ' PARFRE-MET-PGM        0000000
200040     END-IF                                                       0000000
200050     .                                                            0000000
200060* traitement appel gespar                                         0000000
200070 desti-mail.                                                      0000000
200080     INITIALIZE PARFAL ZPAVAL PARFRE ZPAVRE                       0000000
200090     MOVE 'IPR1'                  TO PARFAL-BLOC-EME              0000000
200100                                     PARFAL-APL-EME               0000000
200110     MOVE YOURPGM                 TO PARFAL-PGM-EME               0000000
200120     MOVE 'CENTRAL'               TO PARFAL-TYP-EME               0000000
200130     SET PARFAL-TEMPS-DIFFERE-IMS TO TRUE                         0000000
200140     MOVE YOURPGM                 TO PARFAL-IDE-LGE               0000000
200150                                     PARFAL-IDE-PHY               0000000
200160     MOVE DATJOUR                 TO PARFAL-DATE                  0000000
200170     MOVE W-HEURE                 TO PARFAL-HEURE                 0000000
200180     SET PAR-PARAMETRE-TECHNIQUE-L1003 TO TRUE                    0000000
200190     MOVE PARFON-IDE-FON          TO PARFAL-IDE-FON               0000000
200200     SET PARFAL-ACN-LECTURE-INITIALE TO TRUE                      0000000
200210     INITIALIZE ZPAVAL-L1003-DONNEES                              0000000
200220     MOVE '='                     TO ZPAVAL-L1003-COD-OPE         0000000
200230     MOVE 0                       TO ZPAVAL-L1003-CHOIX-POSTE     0000000
200240     STRING datjour-aa '-' datjour-mm '-' datjour-jj              0000000
200250     DELIMITED BY SIZE          INTO ZPAVAL-L1003-DATE-CONSULT    0000000
200260     MOVE 1                       TO ZPAVAL-L1003-FUSION          0000000
200270     SET ZPAVAL-L1003-APPEL-INITIAL TO TRUE                       0000000
200280     MOVE 1                       TO ZPAVAL-L1003-NUM-CURS        0000000
200290     MOVE SPACES                  TO ZPAVAL-L1003-COD-FED         0000000
200300                                     ZPAVAL-L1003-COD-GRP         0000000
200310                                     ZPAVAL-L1003-COD-BQE         0000000
200320                                     ZPAVAL-L1003-COD-LNG-ISO     0000000
200330                                     ZPAVAL-L1003-COD-PAY-ISO     0000000
200340     MOVE 'B0001597'         TO ZPAVAL-L1003-COD-TAB              0000000
200350         SET PARFAL-ACN-LECTURE-INITIALE TO TRUE                  0000000
200360         STRING 'BATCH     ' YOURPGM '     '                      0000000
200370         DELIMITED BY SIZE INTO ZPAVAL-L1003-CLE-POS-TAB          0000000
200380         display 'PARFAL = ' PARFAL                               0000000
200390         display 'ZPAVAL = ' ZPAVAL                               0000000
200400         display 'PARFRE = ' PARFRE                               0000000
200410         display 'ZPAVRE = ' ZPAVRE                               0000000
200420         PERFORM APPEL-ZPARAPEL                                   0000000
200430         IF DESTPLANT                                             0000000
200440            DISPLAY 'PB DANS ZPARAPEL  :' PARFRE-MET-MSG          0000000
200450            DISPLAY 'CODE RETOUR PRIMAIRE : '                     0000000
200460            PARFRE-COD-RET-PRIMAIRE                               0000000
200470            DISPLAY 'CODE RETOUR SECONDAIRE : '                   0000000
200480            PARFRE-COD-RET-SCD                                    0000000
200490            DISPLAY 'PROGRAMME              : ' PARFRE-MET-PGM    0000000
200500         END-IF                                                   0000000
200510* RECHERCHE DESTINATAIRE PAR DFAUT                               0000000
200520         IF DESTNOT-ANOM                                          0000000
200530            DISPLAY 'recherche destinataire par defaut * '        0000000
200540            DISPLAY 'PB DANS ZPARAPEL  :' PARFRE-MET-MSG          0000000
200550            DISPLAY 'CODE RETOUR PRIMAIRE : '                     0000000
200560            PARFRE-COD-RET-PRIMAIRE                               0000000
200570            DISPLAY 'CODE RETOUR SECONDAIRE : '                   0000000
200580            PARFRE-COD-RET-SCD                                    0000000
200590            DISPLAY 'PROGRAMME              : ' PARFRE-MET-PGM    0000000
200600           PERFORM INIT-DESTINATAIRE                              0000000
200610         END-IF                                                   0000000
200620     .                                                            0000000
200630*================================================================ 0000000
200640*    appel a gespar                                               0000000
200650*================================================================ 0000000
200660 APPEL-ZPARAPEL.                                                  0000000
200670     CALL 'ZCALLPGM' USING ZPARAPEL                               0000000
200680                           PARFAL                                 0000000
200690                           ZPAVAL                                 0000000
200700                           PARFRE                                 0000000
200710                           ZPAVRE                                 0000000
200720     END-CALL                                                     0000000
200730     IF PARFRE-TRT-CORRECT                                        0000000
200740        MOVE ZPAVRE-L1003-ZON-VAR-PO(1:80)  TO W-DEST1            0000000
200750        MOVE ZPAVRE-L1003-ZON-VAR-PO(81:80) TO W-DEST2            0000000
200760        MOVE ZPAVRE-L1003-ZON-VAR-PO(161:80) TO W-DEST3           0000000
200770        MOVE ZPAVRE-L1003-ZON-VAR-PO(241:80) TO W-DEST4           0000000
200780        MOVE ZPAVRE-L1003-ZON-VAR-PO(321:80) TO W-DEST5           0000000
200790        MOVE ZPAVRE-L1003-ZON-VAR-PO(401:80) TO W-COPY1           0000000
200800        MOVE ZPAVRE-L1003-ZON-VAR-PO(481:80) TO W-COPY2           0000000
200810        SET DESTOK-ANOM TO TRUE                                   0000000
200820     ELSE                                                         0000000
200830       IF PARFRE-DONNEES-NON-TROUVEES                             0000000
200840          SET DESTNOT-ANOM TO TRUE                                0000000
200850       ELSE                                                       0000000
200860          SET DESTPLANT TO TRUE                                   0000000
200870       END-IF                                                     0000000
200880     END-IF.                                                      0000000
200890*                                                                 0000000
200900 FIN-IPPBATCH.                                                    0000000
