[![Build status](https://github.com/TypeCobolTeam/TypeCobol/actions/workflows/dotnet.yml/badge.svg?branch=master)](https://github.com/TypeCobolTeam/TypeCobol/actions/workflows/dotnet.yml)


# TypeCobol
TypeCobol is two things:
 - An open source Cobol 85 incremental parser (+Typedef of  Cobol 2002)
 - An extension of Cobol 85 language (named TypeCobol) which can then be converted to Cobol 85
    - Like TypeScript with JavaScript

## Open source parser
Our parser is based on IBM Enterprise Cobol 5.1 for zOS syntax.
We'll certainly implement IBM Enterprise Cobol 6 in 2018/19.

This parser can be used :
 - as C# API
 - with our [Command Line interface ](https://github.com/TypeCobolTeam/TypeCobol/wiki/Command-Line-Interface)
 - with our LanguageServer Protocol implementation to plug our paser with [RDZ](http://www.ibm.com/software/products/fr/ibm-developer-for-z-systems-enterprise-edition) (still a work in progress).
 - You can also look at our https://github.com/TypeCobolTeam/TypeCobolBuild project which use our C# API from a Java RTC plugin



## Extension of Cobol 85 syntax
TypeCobol extends Cobol 85 with the following features:
 - [Type mechanism](https://github.com/TypeCobolTeam/TypeCobol/wiki/TypeCobolTypesNutshell) (like TypeDef of Cobol 2002)
   - TypeCobol comes with intrinsic types: [Boolean](https://github.com/TypeCobolTeam/TypeCobol/wiki/TypeCobolTypeBool), [Date](https://github.com/TypeCobolTeam/TypeCobol/wiki/TypeCobolTypeDate), ...
 - [Procedures](https://github.com/TypeCobolTeam/TypeCobol/wiki/TypeCobolFunctionNutshell) :
    - Procedure looks like nested program but with shorter syntax and parameters are clearly categorized as input, in-out or output
    - Arguments of a procedure must match between Caller and procedure signature
    - We support procedures overloading
 - [Operator `::`](https://github.com/TypeCobolTeam/TypeCobol/wiki/TypeCobolNameQualification) which allow to qualify a variable starting with the top most variable
    - Same behavior as operators `of` and `in`, but you have to start with the parent variable

TypeCobol code is then translated to Cobol 85 compliant with IBM Enterprise Cobol 5.1 for zOS syntax.

### Integration with IDE
We provide [minimal integration with RDZ](https://github.com/TypeCobolTeam/TypeCobol/wiki/RDZPreprocessor).

We also have an integration with RDZ and our LanguageServer. This is still a work in progress and the RDZ plugin is currently private.
Maybe this will change in the future.

The LanguageServer allows us to provide:
 - Errors in real time as you type your code
 - Code completion for Type, variables, procedures and operator `::`
 - Go to a definition of a variable
 

# Project status and documentation
This project is currently maintained by 4 persons and our company starts to use it since July 2017.

The documentation is still very limited.
If you are interested don't hesitate to contact us so we can give you more information.


# Architecture overview

## Visual Studio solution and projects
The best way to test this project is to download and install both tools (for free) on your local machine, [login to Github from Visual Studio Team Explorer](http://channel9.msdn.com/Series/ConnectOn-Demand/217), then refresh this page and click on the *Open in Visual Studio* button which should appear on the right of the repository : this action will clone the solution in your local Git repository and open it in Visual Studio.

The solution contains these projects :
- **TypeCobol** is the main project, it implements a complete Cobol compiler front-end
- **TypeCobol.Test** provides unit tests which can be launched from the *Test Explorer* in Visual Studio
- **Codegen** provides the mechanism to transform TypeCobol code to Cobol 85
- **TypeCobol.LanguageServer** implements the LanguageServer protocol
- **TypeCobol.Transform** is useful to store the TypeCobol source code and the generated Cobol85 code into one single file.

## Dependencies on third party librairies

The following librairies are included in the Visual Studio projects by the Nuget package manager :

- [ANTLR 4](http://www.antlr.org/) : The [C# target](https://github.com/sharwell/antlr4cs) of the ANTLR 4 parser generator for Visual Studio 2010+ projects.

- [ANTLR 4 Runtime](https://github.com/sharwell/antlr4cs) : The runtime library for parsers generated by the C# target of ANTLR 4. This package supports projects targeting .NET 2.0 or newer, and built using Visual Studio 2008 or newer.

- [Reactive Extensions - Main Library](http://introtorx.com/) : Reactive Extensions Main Library combining the interfaces, core, LINQ, and platform services libraries. The Reactive Extensions (Rx) is a library to compose asynchronous and event-based programs using observable collections and LINQ-style query operators.

- [System.Collections.Immutable](http://blogs.msdn.com/b/dotnet/archive/2013/09/25/immutable-collections-ready-for-prime-time.aspx) : This package provides collections that are thread safe and guaranteed to never change their contents, also known as immutable collections. Like strings, any methods that perform modifications will not change the existing instance but instead return a new instance. For efficiency reasons, the implementation uses a sharing mechanism to ensure that newly created instances share as much data as possible with the previous instance while ensuring that operations have a predictable time complexity.

